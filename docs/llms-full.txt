# https://docs.pyrevitlabs.io/ llms-full.txt

## pyRevit Development Tools
[Skip to content](https://docs.pyrevitlabs.io/#pyrevit-can-help-you)

pyRevitRapid Application Development (RAD)Environment for Autodesk Revit®

[![GitHub issues](https://img.shields.io/github/issues/pyrevitlabs/pyRevit.svg?style=for-the-badge)](https://github.com/pyrevitlabs/pyRevit/issues)[![GitHub forks](https://img.shields.io/github/forks/pyrevitlabs/pyRevit.svg?style=for-the-badge)](https://github.com/pyrevitlabs/pyRevit/network)[![GitHub stars](https://img.shields.io/github/stars/pyrevitlabs/pyRevit.svg?style=for-the-badge&colorB=red)](https://github.com/pyrevitlabs/pyRevit/stargazers)[![License: GPL v3](https://img.shields.io/badge/License-GPL%20v3-blue.svg?style=for-the-badge)](http://www.gnu.org/licenses/gpl-3.0)[![made with love in portland](https://img.shields.io/badge/%3C%2F%3E%20with%20%3C3-Portland%2C%20OR-green.svg?style=for-the-badge)](https://en.wikipedia.org/wiki/Portland,_Oregon)

pyRevit helps you quickly sketch out your automation and addon ideas, in whichever language that you are most comfortable with, inside the Revit environment and using its APIs. It also ships with an extensive set of powerful tools that showcase its capabilities as a development environment. Download and install pyRevit, launch Revit, and note the new pyRevit tab that includes these tools. pyRevit also ships with a handy CLI utility for customized configuration and deployment of your tools, and a telemetry server to monitor pyRevit usage across your teams.

### pyRevit can help you

- Add a **powerful set of free tools to your Revit workflows**.
- **Sketch out** your automation **ideas quickly** in python
- **Write your own Revit addons** for Revit using python ( [IronPython](https://ironpython.net/) or [CPython](https://www.python.org/)), C#, VB.Net
- **Distribute your tools** (pyRevit, [Dynamo](https://dynamobim.org/), or [Grasshopper](https://www.rhino3d.com/inside)) easily to your teams using a unified interface
- **Share your tools** with the community

# Getting Started

## Get Started Using pyRevit

[Install pyRevit](https://www.notion.so/Install-pyRevit-98ca4359920a42c3af5c12a7c99a196d)

[Create Custom Patterns](https://www.notion.so/Create-Custom-Patterns-6b8db11b87ed49d98144b75407685152)

[Manage Keynotes](https://www.notion.so/Manage-Keynotes-6f083d6f66fe43d68dc5d5407c8e19da)

[Configure pyRevit](https://www.notion.so/Configure-pyRevit-461d8f564ba743d0ad7e843a7b3b2afe)

[Install Extensions](https://www.notion.so/Install-Extensions-0753ab78c0ce46149f962acc50892491)

**↓** More guides are available here

[HOW TO Guides](https://www.notion.so/HOW-TO-Guides-dc20e0e227b74d9bbc775699904152cb)

## Get Started Developing for pyRevit

[Create Your First Command](https://www.notion.so/Create-Your-First-Command-2509b43e28bd498fba937f5c1be7f485)

**↓** Read the pyRevit API reference to know everything about pyRevit available modules, functions, ...

[pyRevit API Reference](https://pyrevitlabs.github.io/pyRevit/reference/pyrevit/)

**↓** Read the docs to know everything about pyRevit scripts, extensions, ...

[Developer Docs](https://www.notion.so/Developer-Docs-2c88f3ecccde422d9504e20b6b9e04f8)

**↓** pyRevit has a powerful command line utility

[pyRevit CLI](https://www.notion.so/pyRevit-CLI-c50de95259114db795db5bd3f19f8e2a)

**↓** And when you are ready to deploy your tools to your team

[pyRevit For Teams](https://www.notion.so/pyRevit-For-Teams-ddc6c312d6f6488691eed2ec7704fd97)

# Staying Updated

Follow [pyRevit on Twitter](https://twitter.com/pyrevit) to stay notified about the upcoming changes and follow [pyRevit Release Notes](https://github.com/pyrevitlabs/pyRevit/releases) for the breaking changes

**↓** Check out the blog for news

[Blog](https://www.notion.so/Blog-5bcadb69d8ab43c8ba5ee547e42a129f)

**↓** And the future plans for pyRevit are laid out here

[Roadmap](https://www.notion.so/Roadmap-8f353f66ffe94a5ea6676f0d3c5df5bd)

# Dealing with Issues

Check the list of [Currently Open](https://github.com/pyrevitlabs/pyRevit/issues) and [Previously Reported Issues](https://github.com/pyrevitlabs/pyRevit/issues?q=is%3Aissue+is%3Aclosed) for anything similar to yours.

**↓** See the FAQ page for questions

[FAQs](https://www.notion.so/FAQs-70774c29e0ed41388f9a7857bc2e24dc)

**↓** See the guide below on how to report new issues

[Reporting New Issues](https://www.notion.so/Reporting-New-Issues-f1fdd62cf6074b318bfe8ddfbc2d8d98)

# Getting Involved

**↓** Get involved with the community of developers, creating tools with and for pyRevit

[Community](https://www.notion.so/Community-eb501192c78c4d2f884f0cc34532058e)

## Share Your Passion

**↓** Help making pyRevit better

[Help with Documentation](https://www.notion.so/Help-with-Documentation-3ad04b6431a046a3bc9ca584eeea51fa)

[Help Translate pyRevit](https://www.notion.so/Help-Translate-pyRevit-c26063a6c9824667a07c6a40b28c70d4)

[Create Tutorials](https://www.notion.so/Create-Tutorials-d25685ddb11d4eb6a76001325715cfb5)

[Share Revit Build Numbers](https://www.notion.so/Share-Revit-Build-Numbers-90817d95875c48d0accb802035bfcb68)

## Share Your Code

**↓** Help making pyRevit core and tools better

[Improve pyRevit Core](https://www.notion.so/Improve-pyRevit-Core-109f014ece0043ed8e523605312b1305)

[Contribute New Tools](https://www.notion.so/Contribute-New-Tools-800ecc0cee8e47b484f22359c4fe4307)

[Share Your Extensions](https://www.notion.so/Share-Your-Extensions-48ff84d4eae846f4aa9567fca32ff4fe)

[Bundle Shelf](https://www.notion.so/Bundle-Shelf-d1b57b18fd33426aa77d29de2e8b6cf7)

## Share Your Coins

**↓** Help making pyRevit financially stronger

[Support on OpenCollective](https://opencollective.com/pyrevitlabs)

[Support Guidelines](https://www.notion.so/Support-on-Patreon-cdf92ba547154f7a85d32b526dc5e59b)

[Supporters](https://www.notion.so/Supporters-4f3350243ba24dcd8228df6262723629)

# Contributors

Made with [contrib.rocks](https://contrib.rocks/)

[![](https://contrib.rocks/image?repo=pyrevitlabs/pyRevit)](https://github.com/pyrevitlabs/pyRevit/graphs/contributors)

* * *

\\*\\*\\*\\* with 🖤 in [Portland](https://en.m.wikipedia.org/wiki/Portland,_Oregon), Oregon

Copyright © 2014-2025 by Ehsan Iran-Nejad (pyrevitlabs.io) - All Rights Reserved

No part of this publication may be reproduced, distributed, or transmitted in any form or by any means, including photocopying, recording, or other electronic or mechanical methods, without the prior written permission of the publisher.

Back to top

## pyRevit Output Window
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/output/#pyrevit.output)

# output

Provide access to output window and its functionality.

This module provides access to the output window for the currently running
pyRevit command. The proper way to access this wrapper object is through
the :func: `get_output` of :mod: `pyrevit.script` module. This method, in return
uses the `pyrevit.output` module to get access to the output wrapper.

Examples:

```md-code__content
from pyrevit import script
output = script.get_output()

```

Here is the source of :func: `pyrevit.script.get_output`. As you can see this
functions calls the :func: `pyrevit.output.get_output` to receive the
output wrapper.

.. literalinclude:: ../../pyrevitlib/pyrevit/script.py
:pyobject: get\_output

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `DEFAULT_STYLESHEET_NAME = 'outputstyles.css'``module-attribute`

### `active_stylesheet = user_config.output_stylesheet or get_default_stylesheet()``module-attribute`

## Classes

### `PyRevitOutputWindow`

Bases: `object`

Wrapper to interact with the output window.

#### Attributes

##### `window``property`

`PyRevitLabs.PyRevit.Runtime.ScriptConsole`: Return output window object.

##### `renderer``property`

Return html renderer inside output window.

Returns:

| Type | Description |
| --- | --- |
| `WebBrowser` | HTML renderer |

##### `output_id``property`

str: Return id of the output window.

In current implementation, Id of output window is equal to the
unique id of the pyRevit command it belongs to. This means that all
output windows belonging to the same pyRevit command, will have
identical output\_id values.

##### `output_uniqueid``property`

str: Return unique id of the output window.

In current implementation, unique id of output window is a GUID string
generated when the output window is opened. This id is unique to the
instance of output window.

##### `is_closed_by_user``property`

Whether the window has been closed by the user.

##### `last_line``property`

Last line of the output window.

##### `debug_mode``property``writable`

Set debug mode on output window and stream.

This will cause the output window to print information about the
buffer stream and other aspects of the output window mechanism.

#### Functions

##### `self_destruct(seconds)`

Set self-destruct (close window) timer.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `seconds` | `int` | number of seconds after which window is closed. | _required_ |

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>``` | ```md-code__content<br>def self_destruct(self, seconds):<br>    """Set self-destruct (close window) timer.<br>    Args:<br>        seconds (int): number of seconds after which window is closed.<br>    """<br>    if self.window:<br>        self.window.SelfDestructTimer(seconds)<br>``` |

##### `inject_to_head(element_tag, element_contents, attribs=None)`

Inject html element to current html head of the output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element_tag` | `str` | html tag of the element e.g. 'div' | _required_ |
| `element_contents` | `str` | html code of the element contents | _required_ |
| `attribs` |  | obj: `dict`): dictionary of attribute names and value | `None` |

Examples:

```md-code__content
output = pyrevit.output.get_output()
output.inject_to_head('script',
                      '',   # no script since it's a link
                      {'src': js_script_file_path})

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>``` | ````md-code__content<br>def inject_to_head(self, element_tag, element_contents, attribs=None):<br>    """Inject html element to current html head of the output window.<br>    Args:<br>        element_tag (str): html tag of the element e.g. 'div'<br>        element_contents (str): html code of the element contents<br>        attribs (:obj:`dict`): dictionary of attribute names and value<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        output.inject_to_head('script',<br>                              '',   # no script since it's a link<br>                              {'src': js_script_file_path})<br>        ```<br>    """<br>    html_element = self.renderer.Document.CreateElement(element_tag)<br>    if element_contents:<br>        html_element.InnerHtml = element_contents<br>    if attribs:<br>        for attribute, value in attribs.items():<br>            html_element.SetAttribute(attribute, value)<br>    # inject the script into head<br>    head_el = self._get_head_element()<br>    head_el.AppendChild(html_element)<br>    if self.window:<br>        self.window.WaitReadyBrowser()<br>```` |

##### `inject_to_body(element_tag, element_contents, attribs=None)`

Inject html element to current html body of the output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element_tag` | `str` | html tag of the element e.g. 'div' | _required_ |
| `element_contents` | `str` | html code of the element contents | _required_ |
| `attribs` |  | obj: `dict`): dictionary of attribute names and value | `None` |

Examples:

```md-code__content
output = pyrevit.output.get_output()
output.inject_to_body('script',
                      '',   # no script since it's a link
                      {'src': js_script_file_path})

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>``` | ````md-code__content<br>def inject_to_body(self, element_tag, element_contents, attribs=None):<br>    """Inject html element to current html body of the output window.<br>    Args:<br>        element_tag (str): html tag of the element e.g. 'div'<br>        element_contents (str): html code of the element contents<br>        attribs (:obj:`dict`): dictionary of attribute names and value<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        output.inject_to_body('script',<br>                              '',   # no script since it's a link<br>                              {'src': js_script_file_path})<br>        ```<br>    """<br>    html_element = self.renderer.Document.CreateElement(element_tag)<br>    if element_contents:<br>        html_element.InnerHtml = element_contents<br>    if attribs:<br>        for attribute, value in attribs.items():<br>            html_element.SetAttribute(attribute, value)<br>    # inject the script into body<br>    body_el = self._get_body_element()<br>    body_el.AppendChild(html_element)<br>    if self.window:<br>        self.window.WaitReadyBrowser()<br>```` |

##### `inject_script(script_code, attribs=None, body=False)`

Inject script tag into current head (or body) of the output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `script_code` | `str` | javascript code | _required_ |
| `attribs` |  | obj: `dict`): dictionary of attribute names and value | `None` |
| `body` | `bool` | injects script into body instead of head | `False` |

Examples:

```md-code__content
output = pyrevit.output.get_output()
output.inject_script('',   # no script since it's a link
                     {'src': js_script_file_path})

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>``` | ````md-code__content<br>def inject_script(self, script_code, attribs=None, body=False):<br>    """Inject script tag into current head (or body) of the output window.<br>    Args:<br>        script_code (str): javascript code<br>        attribs (:obj:`dict`): dictionary of attribute names and value<br>        body (bool, optional): injects script into body instead of head<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        output.inject_script('',   # no script since it's a link<br>                             {'src': js_script_file_path})<br>        ```<br>    """<br>    if body:<br>        self.inject_to_body('script', script_code, attribs=attribs)<br>    else:<br>        self.inject_to_head('script', script_code, attribs=attribs)<br>```` |

##### `add_style(style_code, attribs=None)`

Inject style tag into current html head of the output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `style_code` | `str` | css styling code | _required_ |
| `attribs` |  | obj: `dict`): dictionary of attribute names and value | `None` |

Examples:

```md-code__content
output = pyrevit.output.get_output()
output.add_style('body { color: blue; }')

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>``` | ````md-code__content<br>def add_style(self, style_code, attribs=None):<br>    """Inject style tag into current html head of the output window.<br>    Args:<br>        style_code (str): css styling code<br>        attribs (:obj:`dict`): dictionary of attribute names and value<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        output.add_style('body { color: blue; }')<br>        ```<br>    """<br>    self.inject_to_head('style', style_code, attribs=attribs)<br>```` |

##### `get_head_html()`

str: Return inner code of html head element.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>267<br>268<br>269<br>``` | ```md-code__content<br>def get_head_html(self):<br>    """str: Return inner code of html head element."""<br>    return self._get_head_element().InnerHtml<br>``` |

##### `set_title(new_title)`

Set window title to the new title.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>271<br>272<br>273<br>274<br>``` | ```md-code__content<br>def set_title(self, new_title):<br>    """Set window title to the new title."""<br>    if self.window:<br>        self.window.Title = new_title<br>``` |

##### `set_width(width)`

Set window width to the new width.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def set_width(self, width):<br>    """Set window width to the new width."""<br>    if self.window:<br>        self.window.Width = width<br>``` |

##### `set_height(height)`

Set window height to the new height.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def set_height(self, height):<br>    """Set window height to the new height."""<br>    if self.window:<br>        self.window.Height = height<br>``` |

##### `set_font(font_family, font_size)`

Set window font family to the new font family and size.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `font_family` | `str` | font family name e.g. 'Courier New' | _required_ |
| `font_size` | `int` | font size e.g. 16 | _required_ |

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>``` | ```md-code__content<br>def set_font(self, font_family, font_size):<br>    """Set window font family to the new font family and size.<br>    Args:<br>        font_family (str): font family name e.g. 'Courier New'<br>        font_size (int): font size e.g. 16<br>    """<br>    self.renderer.Font = \<br>        framework.Drawing.Font(font_family,<br>                               font_size,<br>                               framework.Drawing.FontStyle.Regular,<br>                               framework.Drawing.GraphicsUnit.Point)<br>``` |

##### `resize(width, height)`

Resize window to the new width and height.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>299<br>300<br>301<br>302<br>``` | ```md-code__content<br>def resize(self, width, height):<br>    """Resize window to the new width and height."""<br>    self.set_width(width)<br>    self.set_height(height)<br>``` |

##### `center()`

Center the output window on the screen.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>``` | ```md-code__content<br>def center(self):<br>    """Center the output window on the screen."""<br>    screen_area = HOST_APP.proc_screen_workarea<br>    left = \<br>        (abs(screen_area.Right - screen_area.Left) / 2) \<br>            - (self.get_width() / 2)<br>    top = \<br>        (abs(screen_area.Top - screen_area.Bottom) / 2) \<br>            - (self.get_height() / 2)<br>    self.window.Left = left<br>    self.window.Top = top<br>``` |

##### `get_title()`

str: Return current window title.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>316<br>317<br>318<br>319<br>``` | ```md-code__content<br>def get_title(self):<br>    """str: Return current window title."""<br>    if self.window:<br>        return self.window.Text<br>``` |

##### `get_width()`

int: Return current window width.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>321<br>322<br>323<br>324<br>``` | ```md-code__content<br>def get_width(self):<br>    """int: Return current window width."""<br>    if self.window:<br>        return self.window.Width<br>``` |

##### `get_height()`

int: Return current window height.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>326<br>327<br>328<br>329<br>``` | ```md-code__content<br>def get_height(self):<br>    """int: Return current window height."""<br>    if self.window:<br>        return self.window.Height<br>``` |

##### `close()`

Close the window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>331<br>332<br>333<br>334<br>``` | ```md-code__content<br>def close(self):<br>    """Close the window."""<br>    if self.window:<br>        self.window.Close()<br>``` |

##### `close_others(all_open_outputs=False)`

Close all other windows that belong to the current command.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `all_open_outputs` | `bool` | Close all any other windows if True | `False` |

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>``` | ```md-code__content<br>def close_others(self, all_open_outputs=False):<br>    """Close all other windows that belong to the current command.<br>    Args:<br>        all_open_outputs (bool): Close all any other windows if True<br>    """<br>    if all_open_outputs:<br>        ScriptConsoleManager.CloseActiveOutputWindows(self.window)<br>    else:<br>        ScriptConsoleManager.CloseActiveOutputWindows(self.window,<br>                                                     self.output_id)<br>``` |

##### `hide()`

Hide the window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>348<br>349<br>350<br>351<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide the window."""<br>    if self.window:<br>        self.window.Hide()<br>``` |

##### `show()`

Show the window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>353<br>354<br>355<br>356<br>``` | ```md-code__content<br>def show(self):<br>    """Show the window."""<br>    if self.window:<br>        self.window.Show()<br>``` |

##### `lock_size()`

Lock window size.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>358<br>359<br>360<br>361<br>``` | ```md-code__content<br>def lock_size(self):<br>    """Lock window size."""<br>    if self.window:<br>        self.window.LockSize()<br>``` |

##### `unlock_size()`

Unock window size.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>363<br>364<br>365<br>366<br>``` | ```md-code__content<br>def unlock_size(self):<br>    """Unock window size."""<br>    if self.window:<br>        self.window.UnlockSize()<br>``` |

##### `freeze()`

Freeze output content update.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>368<br>369<br>370<br>371<br>``` | ```md-code__content<br>def freeze(self):<br>    """Freeze output content update."""<br>    if self.window:<br>        self.window.Freeze()<br>``` |

##### `unfreeze()`

Unfreeze output content update.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>373<br>374<br>375<br>376<br>``` | ```md-code__content<br>def unfreeze(self):<br>    """Unfreeze output content update."""<br>    if self.window:<br>        self.window.Unfreeze()<br>``` |

##### `save_contents(dest_file)`

Save html code of the window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `dest_file` | `str` | full path of the destination html file | _required_ |

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>378<br>379<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>387<br>388<br>389<br>390<br>``` | ```md-code__content<br>def save_contents(self, dest_file):<br>    """Save html code of the window.<br>    Args:<br>        dest_file (str): full path of the destination html file<br>    """<br>    if self.renderer:<br>        html = \<br>            self.renderer.Document.Body.OuterHtml.encode('ascii', 'ignore')<br>        doc_txt = self.renderer.DocumentText<br>        full_html = doc_txt.lower().replace('<body></body>', html)<br>        with open(dest_file, 'w') as output_file:<br>            output_file.write(full_html)<br>``` |

##### `open_url(dest_url)`

Open url page in output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `dest_url` | `str` | web url of the target page | _required_ |

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>``` | ```md-code__content<br>def open_url(self, dest_url):<br>    """Open url page in output window.<br>    Args:<br>        dest_url (str): web url of the target page<br>    """<br>    if self.renderer:<br>        self.renderer.Navigate(dest_url, False)<br>``` |

##### `open_page(dest_file)`

Open html page in output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `dest_file` | `str` | full path of the target html file | _required_ |

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>``` | ```md-code__content<br>def open_page(self, dest_file):<br>    """Open html page in output window.<br>    Args:<br>        dest_file (str): full path of the target html file<br>    """<br>    self.show()<br>    self.open_url('file:///' + dest_file)<br>``` |

##### `update_progress(cur_value, max_value)`

Activate and update the output window progress bar.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cur_value` | `float` | current progress value e.g. 50 | _required_ |
| `max_value` | `float` | total value e.g. 100 | _required_ |

Examples:

```md-code__content
output = pyrevit.output.get_output()
for i in range(100):
    output.update_progress(i, 100)

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>``` | ````md-code__content<br>def update_progress(self, cur_value, max_value):<br>    """Activate and update the output window progress bar.<br>    Args:<br>        cur_value (float): current progress value e.g. 50<br>        max_value (float): total value e.g. 100<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        for i in range(100):<br>            output.update_progress(i, 100)<br>        ```<br>    """<br>    if self.window:<br>        self.window.UpdateActivityBar(cur_value, max_value)<br>```` |

##### `reset_progress()`

Reset output window progress bar to zero.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>427<br>428<br>429<br>430<br>``` | ```md-code__content<br>def reset_progress(self):<br>    """Reset output window progress bar to zero."""<br>    if self.window:<br>        self.window.UpdateActivityBar(0, 1)<br>``` |

##### `hide_progress()`

Hide output window progress bar.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>432<br>433<br>434<br>435<br>``` | ```md-code__content<br>def hide_progress(self):<br>    """Hide output window progress bar."""<br>    if self.window:<br>        self.window.SetActivityBarVisibility(False)<br>``` |

##### `unhide_progress()`

Unhide output window progress bar.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def unhide_progress(self):<br>    """Unhide output window progress bar."""<br>    if self.window:<br>        self.window.SetActivityBarVisibility(True)<br>``` |

##### `indeterminate_progress(state)`

Show or hide indeterminate progress bar.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>444<br>445<br>``` | ```md-code__content<br>def indeterminate_progress(self, state):<br>    """Show or hide indeterminate progress bar."""<br>    if self.window:<br>        self.window.UpdateActivityBar(state)<br>``` |

##### `show_logpanel()`

Show output window logging panel.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def show_logpanel(self):<br>    """Show output window logging panel."""<br>    if self.window:<br>        self.window.SetActivityBarVisibility(True)<br>``` |

##### `hide_logpanel()`

Hide output window logging panel.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>``` | ```md-code__content<br>def hide_logpanel(self):<br>    """Hide output window logging panel."""<br>    if self.window:<br>        self.show_logpanel()<br>        self.window.SetActivityBarVisibility(False)<br>``` |

##### `log_debug(message)`

Report DEBUG message into output logging panel.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>458<br>459<br>460<br>461<br>462<br>``` | ```md-code__content<br>def log_debug(self, message):<br>    """Report DEBUG message into output logging panel."""<br>    if self.window:<br>        self.show_logpanel()<br>        self.window.activityBar.ConsoleLog(message)<br>``` |

##### `log_success(message)`

Report SUCCESS message into output logging panel.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>464<br>465<br>466<br>467<br>468<br>``` | ```md-code__content<br>def log_success(self, message):<br>    """Report SUCCESS message into output logging panel."""<br>    if self.window:<br>        self.show_logpanel()<br>        self.window.activityBar.ConsoleLogOK(message)<br>``` |

##### `log_info(message)`

Report INFO message into output logging panel.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>470<br>471<br>472<br>473<br>474<br>``` | ```md-code__content<br>def log_info(self, message):<br>    """Report INFO message into output logging panel."""<br>    if self.window:<br>        self.show_logpanel()<br>        self.window.activityBar.ConsoleLogInfo(message)<br>``` |

##### `log_warning(message)`

Report WARNING message into output logging panel.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>476<br>477<br>478<br>479<br>480<br>``` | ```md-code__content<br>def log_warning(self, message):<br>    """Report WARNING message into output logging panel."""<br>    if self.window:<br>        self.show_logpanel()<br>        self.window.activityBar.ConsoleLogWarning(message)<br>``` |

##### `log_error(message)`

Report ERROR message into output logging panel.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>482<br>483<br>484<br>485<br>486<br>``` | ```md-code__content<br>def log_error(self, message):<br>    """Report ERROR message into output logging panel."""<br>    if self.window:<br>        self.show_logpanel()<br>        self.window.activityBar.ConsoleLogError(message)<br>``` |

##### `set_icon(iconpath)`

Sets icon on the output window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>488<br>489<br>490<br>491<br>``` | ```md-code__content<br>def set_icon(self, iconpath):<br>    """Sets icon on the output window."""<br>    if self.window:<br>        self.window.SetIcon(iconpath)<br>``` |

##### `reset_icon()`

Sets icon on the output window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>493<br>494<br>495<br>496<br>``` | ```md-code__content<br>def reset_icon(self):<br>    """Sets icon on the output window."""<br>    if self.window:<br>        self.window.ResetIcon()<br>``` |

##### `print_html(html_str)``staticmethod`

Add the html code to the output window.

Examples:

```md-code__content
output = pyrevit.output.get_output()
output.print_html('<strong>Title</strong>')

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>509<br>``` | ````md-code__content<br>@staticmethod<br>def print_html(html_str):<br>    """Add the html code to the output window.<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        output.print_html('<strong>Title</strong>')<br>        ```<br>    """<br>    print(coreutils.prepare_html_str(html_str),<br>          end="")<br>```` |

##### `print_code(code_str)``staticmethod`

Print code to the output window with special formatting.

Examples:

```md-code__content
output = pyrevit.output.get_output()
output.print_code('value = 12')

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>511<br>512<br>513<br>514<br>515<br>516<br>517<br>518<br>519<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>``` | ````md-code__content<br>@staticmethod<br>def print_code(code_str):<br>    """Print code to the output window with special formatting.<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        output.print_code('value = 12')<br>        ```<br>    """<br>    code_div = '<div class="code">{}</div>'<br>    print(<br>        coreutils.prepare_html_str(<br>            code_div.format(<br>                code_str.replace('    ', '&nbsp;'*4)<br>                )<br>            ),<br>        end=""<br>        )<br>```` |

##### `print_md(md_str)``staticmethod`

Process markdown code and print to output window.

Examples:

```md-code__content
output = pyrevit.output.get_output()
output.print_md('### Title')

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>543<br>544<br>545<br>``` | ````md-code__content<br>@staticmethod<br>def print_md(md_str):<br>    """Process markdown code and print to output window.<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        output.print_md('### Title')<br>        ```<br>    """<br>    tables_ext = 'pyrevit.coreutils.markdown.extensions.tables'<br>    markdown_html = markdown.markdown(md_str, extensions=[tables_ext])<br>    markdown_html = markdown_html.replace('\n', '').replace('\r', '')<br>    html_code = coreutils.prepare_html_str(markdown_html)<br>    print(html_code, end="")<br>```` |

##### `print_table(table_data, columns=None, formats=None, title='', last_line_style='')`

Print provided data in a table in output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `table_data` | `list[iterable[Any]]` | 2D array of data | _required_ |
| `title` | `str` | table title | `''` |
| `columns` | `list[str]` | list of column names | `None` |
| `formats` | `list[str]` | column data formats | `None` |
| `last_line_style` | `str` | css style of last row | `''` |

Examples:

```md-code__content
data = [\
['row1', 'data', 'data', 80 ],\
['row2', 'data', 'data', 45 ],\
]
output.print_table(
table_data=data,
title="Example Table",
columns=["Row Name", "Column 1", "Column 2", "Percentage"],
formats=['', '', '', '{}%'],
last_line_style='color:red;'
)

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>547<br>548<br>549<br>550<br>551<br>552<br>553<br>554<br>555<br>556<br>557<br>558<br>559<br>560<br>561<br>562<br>563<br>564<br>565<br>566<br>567<br>568<br>569<br>570<br>571<br>572<br>573<br>574<br>575<br>576<br>577<br>578<br>579<br>580<br>581<br>582<br>583<br>584<br>585<br>586<br>587<br>588<br>589<br>590<br>591<br>592<br>593<br>594<br>595<br>596<br>597<br>598<br>599<br>600<br>601<br>602<br>603<br>604<br>605<br>606<br>607<br>608<br>609<br>610<br>611<br>612<br>613<br>614<br>615<br>616<br>617<br>618<br>619<br>``` | ````md-code__content<br>def print_table(self, table_data, columns=None, formats=None,<br>                title='', last_line_style=''):<br>    """Print provided data in a table in output window.<br>    Args:<br>        table_data (list[iterable[Any]]): 2D array of data<br>        title (str): table title<br>        columns (list[str]): list of column names<br>        formats (list[str]): column data formats<br>        last_line_style (str): css style of last row<br>    Examples:<br>        ```python<br>        data = [<br>        ['row1', 'data', 'data', 80 ],<br>        ['row2', 'data', 'data', 45 ],<br>        ]<br>        output.print_table(<br>        table_data=data,<br>        title="Example Table",<br>        columns=["Row Name", "Column 1", "Column 2", "Percentage"],<br>        formats=['', '', '', '{}%'],<br>        last_line_style='color:red;'<br>        )<br>        ```<br>    """<br>    if not columns:<br>        columns = []<br>    if not formats:<br>        formats = []<br>    if last_line_style:<br>        self.add_style('tr:last-child {{ {style} }}'<br>                       .format(style=last_line_style))<br>    zipper = itertools.izip_longest #pylint: disable=E1101<br>    adjust_base_col = '|'<br>    adjust_extra_col = ':---|'<br>    base_col = '|'<br>    extra_col = '{data}|'<br>    # find max column count<br>    max_col = max([len(x) for x in table_data])<br>    header = ''<br>    if columns:<br>        header = base_col<br>        for idx, col_name in zipper(range(max_col), columns, fillvalue=''): #pylint: disable=W0612<br>            header += extra_col.format(data=col_name)<br>        header += '\n'<br>    justifier = adjust_base_col<br>    for idx in range(max_col):<br>        justifier += adjust_extra_col<br>    justifier += '\n'<br>    rows = ''<br>    for entry in table_data:<br>        row = base_col<br>        for idx, attrib, attr_format \<br>                in zipper(range(max_col), entry, formats, fillvalue=''):<br>            if attr_format:<br>                value = attr_format.format(attrib)<br>            else:<br>                value = attrib<br>            row += extra_col.format(data=value)<br>        rows += row + '\n'<br>    table = header + justifier + rows<br>    self.print_md('### {title}'.format(title=title))<br>    self.print_md(table)<br>```` |

##### `print_image(image_path)`

Prints given image to the output.

Examples:

```md-code__content
output = pyrevit.output.get_output()
output.print_image(r'C:\image.gif')

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>621<br>622<br>623<br>624<br>625<br>626<br>627<br>628<br>629<br>630<br>631<br>632<br>633<br>634<br>``` | ````md-code__content<br>def print_image(self, image_path):<br>    r"""Prints given image to the output.<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        output.print_image(r'C:\image.gif')<br>        ```<br>    """<br>    self.print_html(<br>        "<span><img src=\"file:///{0}\"></span>".format(<br>            image_path<br>        )<br>    )<br>```` |

##### `insert_divider(level='')`

Add horizontal rule to the output window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>636<br>637<br>638<br>``` | ```md-code__content<br>def insert_divider(self, level=''):<br>    """Add horizontal rule to the output window."""<br>    self.print_md('%s\n-----' % level)<br>``` |

##### `next_page()`

Add hidden next page tag to the output window.

This is helpful to silently separate the output to multiple pages
for better printing.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>640<br>641<br>642<br>643<br>644<br>645<br>646<br>``` | ```md-code__content<br>def next_page(self):<br>    """Add hidden next page tag to the output window.<br>    This is helpful to silently separate the output to multiple pages<br>    for better printing.<br>    """<br>    self.print_html('<div class="nextpage"></div><div>&nbsp</div>')<br>``` |

##### `linkify(element_ids, title=None)``staticmethod`

Create clickable link for the provided element ids.

This method, creates the link but does not print it directly.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element_ids` | `ElementId | list[ElementId]` | single or multiple ids | _required_ |
| `title` | `str` | tile of the link. defaults to list of element ids | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str` | clickable link |

Examples:

```md-code__content
output = pyrevit.output.get_output()
for idx, elid in enumerate(element_ids):
    print('{}: {}'.format(idx+1, output.linkify(elid)))

```

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>648<br>649<br>650<br>651<br>652<br>653<br>654<br>655<br>656<br>657<br>658<br>659<br>660<br>661<br>662<br>663<br>664<br>665<br>666<br>667<br>668<br>669<br>670<br>671<br>``` | ````md-code__content<br>@staticmethod<br>def linkify(element_ids, title=None):<br>    """Create clickable link for the provided element ids.<br>    This method, creates the link but does not print it directly.<br>    Args:<br>        element_ids (ElementId | list[ElementId]): single or multiple ids<br>        title (str): tile of the link. defaults to list of element ids<br>    Returns:<br>        (str): clickable link<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        for idx, elid in enumerate(element_ids):<br>            print('{}: {}'.format(idx+1, output.linkify(elid)))<br>        ```<br>    """<br>    return coreutils.prepare_html_str(<br>        linkmaker.make_link(element_ids, contents=title)<br>        )<br>```` |

##### `make_chart(version=None)`

:obj: `PyRevitOutputChart`: Return chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>673<br>674<br>675<br>``` | ```md-code__content<br>def make_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return chart object."""<br>    return charts.PyRevitOutputChart(self, version=version)<br>``` |

##### `make_line_chart(version=None)`

:obj: `PyRevitOutputChart`: Return line chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>677<br>678<br>679<br>680<br>681<br>682<br>683<br>``` | ```md-code__content<br>def make_line_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return line chart object."""<br>    return charts.PyRevitOutputChart(<br>        self,<br>        chart_type=charts.LINE_CHART,<br>        version=version<br>        )<br>``` |

##### `make_stacked_chart(version=None)`

:obj: `PyRevitOutputChart`: Return stacked chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>685<br>686<br>687<br>688<br>689<br>690<br>691<br>692<br>693<br>``` | ```md-code__content<br>def make_stacked_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return stacked chart object."""<br>    chart = charts.PyRevitOutputChart(<br>        self,<br>        chart_type=charts.LINE_CHART,<br>        version=version<br>        )<br>    chart.options.scales = {'yAxes': [{'stacked': True, }]}<br>    return chart<br>``` |

##### `make_bar_chart(version=None)`

:obj: `PyRevitOutputChart`: Return bar chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>695<br>696<br>697<br>698<br>699<br>700<br>701<br>``` | ```md-code__content<br>def make_bar_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return bar chart object."""<br>    return charts.PyRevitOutputChart(<br>        self,<br>        chart_type=charts.BAR_CHART,<br>        version=version<br>        )<br>``` |

##### `make_radar_chart(version=None)`

:obj: `PyRevitOutputChart`: Return radar chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>703<br>704<br>705<br>706<br>707<br>708<br>709<br>``` | ```md-code__content<br>def make_radar_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return radar chart object."""<br>    return charts.PyRevitOutputChart(<br>        self,<br>        chart_type=charts.RADAR_CHART,<br>        version=version<br>        )<br>``` |

##### `make_polar_chart(version=None)`

:obj: `PyRevitOutputChart`: Return polar chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>711<br>712<br>713<br>714<br>715<br>716<br>717<br>``` | ```md-code__content<br>def make_polar_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return polar chart object."""<br>    return charts.PyRevitOutputChart(<br>        self,<br>        chart_type=charts.POLAR_CHART,<br>        version=version<br>        )<br>``` |

##### `make_pie_chart(version=None)`

:obj: `PyRevitOutputChart`: Return pie chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>719<br>720<br>721<br>722<br>723<br>724<br>725<br>``` | ```md-code__content<br>def make_pie_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return pie chart object."""<br>    return charts.PyRevitOutputChart(<br>        self,<br>        chart_type=charts.PIE_CHART,<br>        version=version<br>        )<br>``` |

##### `make_doughnut_chart(version=None)`

:obj: `PyRevitOutputChart`: Return dougnut chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>727<br>728<br>729<br>730<br>731<br>732<br>733<br>``` | ```md-code__content<br>def make_doughnut_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return dougnut chart object."""<br>    return charts.PyRevitOutputChart(<br>        self,<br>        chart_type=charts.DOUGHNUT_CHART,<br>        version=version<br>        )<br>``` |

##### `make_bubble_chart(version=None)`

:obj: `PyRevitOutputChart`: Return bubble chart object.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>735<br>736<br>737<br>738<br>739<br>740<br>741<br>``` | ```md-code__content<br>def make_bubble_chart(self, version=None):<br>    """:obj:`PyRevitOutputChart`: Return bubble chart object."""<br>    return charts.PyRevitOutputChart(<br>        self,<br>        chart_type=charts.BUBBLE_CHART,<br>        version=version<br>        )<br>``` |

## Functions

### `docclosing_eventhandler(sender, args)`

Close all output window on document closing.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>45<br>46<br>47<br>``` | ```md-code__content<br>def docclosing_eventhandler(sender, args):  #pylint: disable=W0613<br>    """Close all output window on document closing."""<br>    ScriptConsoleManager.CloseActiveOutputWindows()<br>``` |

### `setup_output_closer()`

Setup document closing event listener.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>50<br>51<br>52<br>53<br>54<br>55<br>``` | ```md-code__content<br>def setup_output_closer():<br>    """Setup document closing event listener."""<br>    HOST_APP.app.DocumentClosing += \<br>        framework.EventHandler[DB.Events.DocumentClosingEventArgs](<br>            docclosing_eventhandler<br>            )<br>``` |

### `set_stylesheet(stylesheet)`

Set active css stylesheet used by output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `stylesheet` | `str` | full path to stylesheet file | _required_ |

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>``` | ```md-code__content<br>def set_stylesheet(stylesheet):<br>    """Set active css stylesheet used by output window.<br>    Args:<br>        stylesheet (str): full path to stylesheet file<br>    """<br>    if op.isfile(stylesheet):<br>        envvars.set_pyrevit_env_var(envvars.OUTPUT_STYLESHEET_ENVVAR,<br>                                    stylesheet)<br>``` |

### `get_stylesheet()`

Return active css stylesheet used by output window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>72<br>73<br>74<br>``` | ```md-code__content<br>def get_stylesheet():<br>    """Return active css stylesheet used by output window."""<br>    return envvars.get_pyrevit_env_var(envvars.OUTPUT_STYLESHEET_ENVVAR)<br>``` |

### `get_default_stylesheet()`

Return default css stylesheet used by output window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>77<br>78<br>79<br>``` | ```md-code__content<br>def get_default_stylesheet():<br>    """Return default css stylesheet used by output window."""<br>    return op.join(op.dirname(__file__), DEFAULT_STYLESHEET_NAME)<br>``` |

### `reset_stylesheet()`

Reset active stylesheet to default.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>82<br>83<br>84<br>85<br>``` | ```md-code__content<br>def reset_stylesheet():<br>    """Reset active stylesheet to default."""<br>    envvars.set_pyrevit_env_var(envvars.OUTPUT_STYLESHEET_ENVVAR,<br>                                get_default_stylesheet())<br>``` |

### `get_output()`

:obj: `pyrevit.output.PyRevitOutputWindow` : Return output window.

Source code in `pyrevitlib/pyrevit/output/__init__.py`

|     |     |
| --- | --- |
| ```<br>744<br>745<br>746<br>``` | ```md-code__content<br>def get_output():<br>    """:obj:`pyrevit.output.PyRevitOutputWindow` : Return output window."""<br>    return PyRevitOutputWindow()<br>``` |

Back to top

## User Configuration Management
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/userconfig/#pyrevit.userconfig)

# userconfig

Handle reading and parsing, writing and saving of all user configurations.

This module handles the reading and writing of the pyRevit configuration files.
It's been used extensively by pyRevit sub-modules. user\_config is
set up automatically in the global scope by this module and can be imported
into scripts and other modules to access the default configurations.

All other modules use this module to query user config.

Examples:

```md-code__content
from pyrevit.userconfig import user_config
user_config.add_section('newsection')
user_config.newsection.property = value
user_config.newsection.get_option('property', default_value)
user_config.save_changes()

```

The user\_config object is also the destination for reading and writing
configuration by pyRevit scripts through :func: `get_config` of
:mod: `pyrevit.script` module. Here is the function source:

.. literalinclude:: ../../pyrevitlib/pyrevit/script.py
:pyobject: get\_config

Examples:

```md-code__content
from pyrevit import script
cfg = script.get_config()
cfg.property = value
cfg.get_option('property', default_value)
script.save_config()

```

## Attributes

### `DEFAULT_CSV_SEPARATOR = ','``module-attribute`

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `CONSTS = PyRevit.PyRevitConsts``module-attribute`

### `LOCAL_CONFIG_FILE = find_config_file(HOME_DIR)``module-attribute`

### `ADMIN_CONFIG_FILE = find_config_file(PYREVIT_ALLUSER_APP_DIR)``module-attribute`

### `USER_CONFIG_FILE = find_config_file(PYREVIT_APP_DIR)``module-attribute`

### `CONFIG_TYPE = 'Seed'``module-attribute`

### `CONFIG_FILE = find_config_file(PYREVIT_APP_DIR)``module-attribute`

### `user_config = PyRevitConfig(cfg_file_path=CONFIG_FILE, config_type=CONFIG_TYPE)``module-attribute`

## Classes

### `PyRevitConfig(cfg_file_path=None, config_type='Unknown')`

Bases: `PyRevitConfigParser`

Provide read/write access to pyRevit configuration.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cfg_file_path` | `str` | full path to config file to be used. | `None` |
| `config_type` | `str` | type of config file | `'Unknown'` |

Examples:

```md-code__content
cfg = PyRevitConfig(cfg_file_path)
cfg.add_section('sectionname')
cfg.sectionname.property = value
cfg.sectionname.get_option('property', default_value)
cfg.save_changes()

```

Load settings from provided config file and setup parser.

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>``` | ```md-code__content<br>def __init__(self, cfg_file_path=None, config_type='Unknown'):<br>    """Load settings from provided config file and setup parser."""<br>    # try opening and reading config file in order.<br>    super(PyRevitConfig, self).__init__(cfg_file_path=cfg_file_path)<br>    # set log mode on the logger module based on<br>    # user settings (overriding the defaults)<br>    self._update_env()<br>    self._admin = config_type == 'Admin'<br>    self.config_type = config_type<br>``` |

#### Attributes

##### `config_type = config_type``instance-attribute`

##### `config_file``property`

Current config file path.

##### `environment``property`

Environment section.

##### `core``property`

Core section.

##### `routes``property`

Routes section.

##### `telemetry``property`

Telemetry section.

##### `bin_cache``property``writable`

"Whether to use the cache for extensions.

##### `check_updates``property``writable`

Whether to check for updates.

##### `auto_update``property``writable`

Whether to automatically update pyRevit.

##### `rocket_mode``property``writable`

Whether to enable rocket mode.

##### `log_level``property``writable`

Logging level.

##### `file_logging``property``writable`

Whether to enable file logging.

##### `startuplog_timeout``property``writable`

Timeout for the startup log.

##### `required_host_build``property``writable`

Host build required to run the commands.

##### `min_host_drivefreespace``property``writable`

Minimum free space for running the commands.

##### `load_beta``property``writable`

Whether to load commands in beta.

##### `cpython_engine_version``property``writable`

CPython engine version to use.

##### `user_locale``property``writable`

User locale.

##### `output_stylesheet``property``writable`

Stylesheet used for output.

##### `routes_host``property``writable`

Routes API host.

##### `routes_port``property``writable`

API routes port.

##### `load_core_api``property``writable`

Whether to load pyRevit core api.

##### `telemetry_utc_timestamp``property``writable`

Whether to use UTC timestamps in telemetry.

##### `telemetry_status``property``writable`

Telemetry status.

##### `telemetry_file_dir``property``writable`

Telemetry file directory.

##### `telemetry_server_url``property``writable`

Telemetry server URL.

##### `telemetry_include_hooks``property``writable`

Whether to include hooks in telemetry.

##### `apptelemetry_status``property``writable`

Telemetry status.

##### `apptelemetry_server_url``property``writable`

App telemetry server URL.

##### `apptelemetry_event_flags``property``writable`

Telemetry event flags.

##### `user_can_update``property``writable`

Whether the user can update pyRevit repos.

##### `user_can_extend``property``writable`

Whether the user can manage pyRevit Extensions.

##### `user_can_config``property``writable`

Whether the user can access the configuration.

##### `colorize_docs``property``writable`

Whether to enable the document colorizer.

##### `tooltip_debug_info``property``writable`

Whether to append debug info on tooltips.

##### `routes_server``property``writable`

Whether the server routes are enabled.

##### `respect_language_direction``property``writable`

Whether the system respects the language direction.

##### `is_readonly``property`

bool: whether the config is read only.

#### Functions

##### `get_config_file_hash()`

Get calculated unique hash for this config.

Returns:

| Type | Description |
| --- | --- |
| `str` | hash of the config. |

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>``` | ```md-code__content<br>def get_config_file_hash(self):<br>    """Get calculated unique hash for this config.<br>    Returns:<br>        (str): hash of the config.<br>    """<br>    with codecs.open(self._cfg_file_path, 'r', 'utf-8') as cfg_file:<br>        cfg_hash = coreutils.get_str_hash(cfg_file.read())<br>    return cfg_hash<br>``` |

##### `has_section(section_name)`

Check if config contains given section.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>``` | ```md-code__content<br>def has_section(self, section_name):<br>    """Check if config contains given section."""<br>    try:<br>        self.get_section(section_name)<br>        return True<br>    except Exception:<br>        return False<br>``` |

##### `add_section(section_name)`

Add section with given name to config.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>189<br>190<br>191<br>192<br>``` | ```md-code__content<br>def add_section(self, section_name):<br>    """Add section with given name to config."""<br>    self._parser.add_section(section_name)<br>    return PyRevitConfigSectionParser(self._parser, section_name)<br>``` |

##### `get_section(section_name)`

Get section with given name.

Raises:

| Type | Description |
| --- | --- |
| `AttributeError` | if section is missing |

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>``` | ```md-code__content<br>def get_section(self, section_name):<br>    """Get section with given name.<br>    Raises:<br>        AttributeError: if section is missing<br>    """<br>    # check is section with full name is available<br>    if self._parser.has_section(section_name):<br>        return PyRevitConfigSectionParser(self._parser, section_name)<br>    # if not try to match with section_name.subsection<br>    # if there is a section_name.subsection defined, that should be<br>    # the sign that the section exists<br>    # section obj then supports getting all subsections<br>    for cfg_section_name in self._parser.sections():<br>        master_section = coreutils.get_canonical_parts(cfg_section_name)[0]<br>        if section_name == master_section:<br>            return PyRevitConfigSectionParser(self._parser,<br>                                              master_section)<br>    # if no match happened then raise exception<br>    raise AttributeError('Section does not exist in config file.')<br>``` |

##### `remove_section(section_name)`

Remove section from config.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>217<br>218<br>219<br>220<br>221<br>222<br>``` | ```md-code__content<br>def remove_section(self, section_name):<br>    """Remove section from config."""<br>    cfg_section = self.get_section(section_name)<br>    for cfg_subsection in cfg_section.get_subsections():<br>        self._parser.remove_section(cfg_subsection.header)<br>    self._parser.remove_section(cfg_section.header)<br>``` |

##### `reload(cfg_file_path=None)`

Reload config from original or given file.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>``` | ```md-code__content<br>def reload(self, cfg_file_path=None):<br>    """Reload config from original or given file."""<br>    try:<br>        with codecs.open(cfg_file_path \<br>                or self._cfg_file_path, 'r', 'utf-8') as cfg_file:<br>            try:<br>                self._parser.readfp(cfg_file)<br>            except AttributeError:<br>                self._parser.read_file(cfg_file)<br>    except (OSError, IOError):<br>        raise PyRevitIOError()<br>``` |

##### `save(cfg_file_path=None)`

Save config to original or given file.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>``` | ```md-code__content<br>def save(self, cfg_file_path=None):<br>    """Save config to original or given file."""<br>    try:<br>        with codecs.open(cfg_file_path \<br>                or self._cfg_file_path, 'w', 'utf-8') as cfg_file:<br>            self._parser.write(cfg_file)<br>    except (OSError, IOError):<br>        raise PyRevitIOError()<br>``` |

##### `get_config_version()`

Return version of config file used for change detection.

Returns:

| Type | Description |
| --- | --- |
| `str` | hash of the config file |

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>617<br>618<br>619<br>620<br>621<br>622<br>623<br>``` | ```md-code__content<br>def get_config_version(self):<br>    """Return version of config file used for change detection.<br>    Returns:<br>        (str): hash of the config file<br>    """<br>    return self.get_config_file_hash()<br>``` |

##### `get_thirdparty_ext_root_dirs(include_default=True)`

Return a list of external extension directories set by the user.

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | External user extension directories. |

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>625<br>626<br>627<br>628<br>629<br>630<br>631<br>632<br>633<br>634<br>635<br>636<br>637<br>638<br>639<br>640<br>641<br>642<br>643<br>644<br>645<br>646<br>``` | ```md-code__content<br>def get_thirdparty_ext_root_dirs(self, include_default=True):<br>    """Return a list of external extension directories set by the user.<br>    Returns:<br>        (list[str]): External user extension directories.<br>    """<br>    dir_list = set()<br>    if include_default:<br>        # add default ext path<br>        dir_list.add(THIRDPARTY_EXTENSIONS_DEFAULT_DIR)<br>    try:<br>        dir_list.update([<br>            op.expandvars(op.normpath(x))<br>            for x in self.core.get_option(<br>                CONSTS.ConfigsUserExtensionsKey,<br>                default_value=[]<br>            )])<br>    except Exception as read_err:<br>        mlogger.error('Error reading list of user extension folders. | %s',<br>                      read_err)<br>    return [x for x in dir_list if op.exists(x)]<br>``` |

##### `get_ext_root_dirs()`

Return a list of all extension directories.

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | user extension directories. |

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>648<br>649<br>650<br>651<br>652<br>653<br>654<br>655<br>656<br>657<br>658<br>659<br>``` | ```md-code__content<br>def get_ext_root_dirs(self):<br>    """Return a list of all extension directories.<br>    Returns:<br>        (list[str]): user extension directories.<br>    """<br>    dir_list = set()<br>    if op.exists(EXTENSIONS_DEFAULT_DIR):<br>        dir_list.add(EXTENSIONS_DEFAULT_DIR)<br>    dir_list.update(self.get_thirdparty_ext_root_dirs())<br>    return list(dir_list)<br>``` |

##### `get_ext_sources()`

Return a list of extension definition source files.

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>661<br>662<br>663<br>664<br>665<br>666<br>667<br>``` | ```md-code__content<br>def get_ext_sources(self):<br>    """Return a list of extension definition source files."""<br>    ext_sources = self.environment.get_option(<br>        CONSTS.EnvConfigsExtensionLookupSourcesKey,<br>        default_value=[],<br>    )<br>    return list(set(ext_sources))<br>``` |

##### `set_thirdparty_ext_root_dirs(path_list)`

Updates list of external extension directories in config file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `path_list` | `list[str]` | list of external extension paths | _required_ |

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>669<br>670<br>671<br>672<br>673<br>674<br>675<br>676<br>677<br>678<br>679<br>680<br>681<br>682<br>683<br>684<br>``` | ```md-code__content<br>def set_thirdparty_ext_root_dirs(self, path_list):<br>    """Updates list of external extension directories in config file.<br>    Args:<br>        path_list (list[str]): list of external extension paths<br>    """<br>    for ext_path in path_list:<br>        if not op.exists(ext_path):<br>            raise PyRevitException("Path \"%s\" does not exist." % ext_path)<br>    try:<br>        self.core.userextensions = \<br>            [op.normpath(x) for x in path_list]<br>    except Exception as write_err:<br>        mlogger.error('Error setting list of user extension folders. | %s',<br>                      write_err)<br>``` |

##### `get_current_attachment()`

Return current pyRevit attachment.

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>686<br>687<br>688<br>689<br>690<br>691<br>``` | ```md-code__content<br>def get_current_attachment(self):<br>    """Return current pyRevit attachment."""<br>    try:<br>        return PyRevit.PyRevitAttachments.GetAttached(int(HOST_APP.version))<br>    except PyRevitException as ex:<br>        mlogger.error('Error getting current attachment. | %s', ex)<br>``` |

##### `get_active_cpython_engine()`

Return active cpython engine.

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>693<br>694<br>695<br>696<br>697<br>698<br>699<br>700<br>701<br>702<br>703<br>704<br>705<br>706<br>707<br>708<br>709<br>710<br>711<br>712<br>713<br>714<br>715<br>716<br>717<br>718<br>719<br>720<br>721<br>722<br>723<br>724<br>725<br>726<br>727<br>``` | ```md-code__content<br>def get_active_cpython_engine(self):<br>    """Return active cpython engine."""<br>    # try to find attachment and get engines from the clone<br>    attachment = self.get_current_attachment()<br>    if attachment and attachment.Clone:<br>        clone = attachment.Clone<br>    else:<br>        # if can not find attachment, instantiate a temp clone<br>        try:<br>            clone = PyRevit.PyRevitClone(clonePath=HOME_DIR)<br>        except Exception as cEx:<br>            mlogger.debug('Can not create clone from path: %s', str(cEx))<br>            clone = None<br>    # find cpython engines<br>    engines = clone.GetCPythonEngines() if clone else []<br>    cpy_engines_dict = {x.Version: x for x in engines}<br>    mlogger.debug('cpython engines dict: %s', cpy_engines_dict)<br>    if not cpy_engines_dict:<br>        mlogger.error(<br>            'Can not determine cpython engines for current attachment: %s',<br>            attachment<br>        )<br>        return None<br>    # grab cpython engine configured to be used by user<br>    try:<br>        cpyengine_ver = int(self.cpython_engine_version)<br>    except (ValueError, TypeError):<br>        cpyengine_ver = 000<br>    try:<br>        return cpy_engines_dict[cpyengine_ver]<br>    except KeyError:<br>        # return the latest cpython engine<br>        return max(cpy_engines_dict.values(), key=lambda x: x.Version.Version)<br>``` |

##### `set_active_cpython_engine(pyrevit_engine)`

Set the active CPython engine.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrevit_engine` | `PyRevitEngine` | python engine to set as active | _required_ |

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>729<br>730<br>731<br>732<br>733<br>734<br>735<br>``` | ```md-code__content<br>def set_active_cpython_engine(self, pyrevit_engine):<br>    """Set the active CPython engine.<br>    Args:<br>        pyrevit_engine (PyRevitEngine): python engine to set as active<br>    """<br>    self.cpython_engine_version = pyrevit_engine.Version<br>``` |

##### `save_changes()`

Save user config into associated config file.

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>742<br>743<br>744<br>745<br>746<br>747<br>748<br>749<br>750<br>751<br>752<br>753<br>754<br>``` | ```md-code__content<br>def save_changes(self):<br>    """Save user config into associated config file."""<br>    if not self._admin and self.config_file:<br>        try:<br>            super(PyRevitConfig, self).save()<br>        except Exception as save_err:<br>            mlogger.error('Can not save user config to: %s | %s',<br>                          self.config_file, save_err)<br>        # adjust environment per user configurations<br>        self._update_env()<br>    else:<br>        mlogger.debug('Config is in admin mode. Skipping save.')<br>``` |

##### `get_list_separator()``staticmethod`

Get list separator defined in user os regional settings.

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>756<br>757<br>758<br>759<br>760<br>761<br>762<br>763<br>764<br>765<br>``` | ```md-code__content<br>@staticmethod<br>def get_list_separator():<br>    """Get list separator defined in user os regional settings."""<br>    intkey = coreutils.get_reg_key(wr.HKEY_CURRENT_USER,<br>                                   r'Control Panel\International')<br>    if intkey:<br>        try:<br>            return wr.QueryValueEx(intkey, 'sList')[0]<br>        except Exception:<br>            return DEFAULT_CSV_SEPARATOR<br>``` |

## Functions

### `find_config_file(target_path)`

Find config file in target path.

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>768<br>769<br>770<br>``` | ```md-code__content<br>def find_config_file(target_path):<br>    """Find config file in target path."""<br>    return PyRevit.PyRevitConsts.FindConfigFileInDirectory(target_path)<br>``` |

### `verify_configs(config_file_path=None)`

Create a user settings file.

if config\_file\_path is not provided, configs will be in memory only

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `config_file_path` | `str` | config file full name and path | `None` |

Returns:

| Type | Description |
| --- | --- |
| `PyRevitConfig` | pyRevit config file handler |

Source code in `pyrevitlib/pyrevit/userconfig.py`

|     |     |
| --- | --- |
| ```<br>773<br>774<br>775<br>776<br>777<br>778<br>779<br>780<br>781<br>782<br>783<br>784<br>785<br>786<br>787<br>788<br>789<br>790<br>791<br>792<br>793<br>794<br>795<br>796<br>``` | ```md-code__content<br>def verify_configs(config_file_path=None):<br>    """Create a user settings file.<br>    if config_file_path is not provided, configs will be in memory only<br>    Args:<br>        config_file_path (str, optional): config file full name and path<br>    Returns:<br>        (pyrevit.userconfig.PyRevitConfig): pyRevit config file handler<br>    """<br>    if config_file_path:<br>        mlogger.debug('Creating default config file at: %s', config_file_path)<br>        coreutils.touch(config_file_path)<br>    try:<br>        parser = PyRevitConfig(cfg_file_path=config_file_path)<br>    except Exception as read_err:<br>        # can not create default user config file under appdata folder<br>        mlogger.warning('Can not create config file under: %s | %s',<br>                        config_file_path, read_err)<br>        parser = PyRevitConfig()<br>    return parser<br>``` |

Back to top

## pyRevit Architecture Guide
[Skip to content](https://docs.pyrevitlabs.io/architecture/#understanding-pyrevit-architecture)

# Understanding pyRevit Architecture

This guide provides an overview of pyRevit’s architecture to help new contributors understand how the software works.

Whether you want to create tools, troubleshoot issues, or contribute code, understanding these components will help you navigate the project.

## Components of pyRevit

1. **pyRevit Add-In (pyRevitLoader)**
   - A small piece of C# code that starts pyRevit inside Revit.
   - It loads a Python script using the IronPython engine, which handles the rest of pyRevit’s functionality.
2. **pyRevit python Libraries (pyrevitlibs)**
   - Python packages that simplify working with the .NET Revit API.
   - Provide tools to create ribbon buttons, run scripts, and more.
3. **Extensions**
   - These are the tools and features users see inside Revit.
   - They are mostly written in python, but can also be C#/VB.NET scripts, dynamo projects, and so on
   - Bundled extensions appear in the "pyRevit" tab, offering many tools.
   - Users can add extensions by:
     - Enabling listed extensions in `dev/extensions/extensions.json` via the “Extensions” button in pyRevit.
     - Creating custom extensions and adding their paths to the configuration.
4. **pyRevit Command-Line Interface (CLI)**
   - A tool for managing configurations, running scripts in bulk, and troubleshooting.
   - Useful for corporate setups and advanced users.
5. **Telemetry Server**
   - A small server (written in Go) that tracks usage data of pyRevit tools.
   - Stores data in MongoDB or PostgreSQL for business intelligence.

## How pyRevit Loads in Revit

TL;DR:

- Revit reads the `.addin` manifest in the Addins folders
- The `.addin` manifest points to `pyRevitLoader.dll`
- `pyRevitLoader.dll` launches `pyrevitloader.py` inside an IronPython environment
- `pyrevitloader.py` calls functions from the `pyrevit` python package to build the UI and the buttons commands.

### .addin Manifest

- The installer creates a file with `.addin` extension, called manifest, in the Revit Addins folder, instructing Revit to load pyRevit when it starts.
- The Addins folder can be located in one of these paths, depending on pyRevit installation:
  - `C:\ProgramData\Autodesk\Revit\Addins` (for all users)
  - `%APPDATA%\Autodesk\Revit\Addins` (for the current user only)
- The manifest points to `pyRevitLoader.dll`, which acts as the entry point for pyRevit.

### pyRevitLoader.dll

The `pyRevitLoader.dll` file is a small C# program that:

- Ensures required .NET assemblies are loaded.
- Loads the IronPython engine and runs pyRevit’s Python startup script ( `pyrevitloader.py`).

Info

the source code is in `PyRevitLoaderApplication.cs` and it is an implementation of the Revit API `IExternalApplication` _interface_ (the standard way to create a plugin for Revit).

There are multiple versions of `pyRevitLoader.dll` to support:

- different Revit versions:
  - One for Revit 2025 and newer, built with .NET 8.
  - Another for older Revit versions, built with the .NET Framework.
- different IronPython versions; to this date:
  - version 2.7.12, the default one
  - version 3.4.0, more recent but not fully tested.

They share the same source code, but are _compiled against_ the different .net runtimes and IronPython versions.

Note

Since we cannot have multiple IronPython engines running at the same time, if the user switches the engine in the configuration, pyRevit will change the `.addin` manifest mentioned above to point to the correct dll path.
It may be that sometimes the addin is not created correctly or points to the wrong path, and this is why most of the times the `pyrevit attach` command solves the installation issues.

### Startup Script: `pyrevitloader.py`

This Python script is the first code executed by pyRevit inside Revit. It:

- Sets up environment variables.
- Initializes the logging system and prepares the script console
- Checks for updates if enabled, pulling changes for pyRevit and extensions.
- Loads extensions and creates UI elements like ribbons and buttons (see [below](https://docs.pyrevitlabs.io/architecture/#extensions-discovery)).
- Activates hooks, which enable features like event-driven scripts.
- Initializes API routes and Telemetry, if enabled

Info

`pyrevitloader.py` is a small script that just calls the [pyrevit.loader.sessionmgr.load\_session](https://docs.pyrevitlabs.io/reference/pyrevit/loader/sessionmgr/#pyrevit.loader.sessionmgr.load_session "load_session()") function.
That function is responsible to do all the things mentioned above.

### Extensions discovery

- pyRevit scans known paths and user defined folders to find extensions.
- For each extension, it builds a .net assembly to create buttons, tabs, and other UI elements.

Info

Extensions directories are detected by [pyrevit.userconfig.PyRevitConfig.get\_ext\_root\_dirs](https://docs.pyrevitlabs.io/reference/pyrevit/userconfig/#pyrevit.userconfig.PyRevitConfig.get_ext_root_dirs "get_ext_root_dirs()").
Extension components discovery is performed by [pyrevit.extensions.extensionmgr.get\_installed\_ui\_extensions](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/extensionmgr/#pyrevit.extensions.extensionmgr.get_installed_ui_extensions "get_installed_ui_extensions()").
Assemblies are generated by [pyrevit.loader.asmmaker](https://docs.pyrevitlabs.io/reference/pyrevit/loader/asmmaker/#pyrevit.loader.asmmaker) with types from [pyrevit.runtime.create\_type](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/#pyrevit.runtime.create_type "create_type(modulebuilder, type_class, class_name, custom_attr_list, *args)").

## How pyRevit Commands run

TL;DR:

Command execution is handled by the c# project `pyRevitLabs.Pyrevit.Runtime`

Each button generated by the [Extension discovery](https://docs.pyrevitlabs.io/architecture/#extensions-discovery) is bound to a command derived by the `ScriptCommand.cs` source code.

This code deals with:

- detecting the modifier keys hold while clicking the button, and change the behavior accordingly
- calling `ScriptExcecutor.ExcecuteScript` passing the python script (or any other supportesd script) for the command

Info

The `ScriptCommand` class implements Revit’s `IExternalCommand` interface.
The `Execute` method is the one called when you click the Ribbon button.

In turn, the code in `ScriptExecutor.cs` calls the appropriate script engine based on the type of (IronPython, CPython, .NET, and so on).

Info

You can find the code of the engines in the files that end `Engine.cs`.

Back to top

## Security Policy
[Skip to content](https://docs.pyrevitlabs.io/SECURITY/#security-policy)

# Security Policy

> Note that the most up to date code is located in the develop branch. Every 6 months to 12 months, the develop branch is merged to the master branch and new releases are integrated.

## Reporting a Vulnerability

**Please do not report security vulnerabilities through public pyRevit GitHub issues, discussions, or pull requests.**

Instead, please send an email to eirannejad+pyrevitsecurity\[@\]gmail.com .

Please include as much of the information listed below as you can to help us better understand and resolve the issue:

- The type of issue (e.g., buffer overflow, SQL injection, or cross-site scripting)
- Full paths of source file(s) related to the manifestation of the issue
- The location of the affected source code (tag/branch/commit or direct URL)
- Any special configuration required to reproduce the issue
- Step-by-step instructions to reproduce the issue
- Proof-of-concept or exploit code (if possible)
- Impact of the issue, including how an attacker might exploit the issue

This information will help us triage your report more quickly.

Back to top

## Contributing to pyRevit
# Contributing

[See Contributing to pyRevit Source on pyRevit Wiki](https://pyrevitlabs.notion.site/Contributing-to-pyRevit-Source-6d25a5ac62c44bd9a0e9aefb8debefa2?pvs=4)

Back to top

## Code of Conduct
[Skip to content](https://docs.pyrevitlabs.io/CODE_OF_CONDUCT/#contributor-covenant-code-of-conduct)

# Contributor Covenant Code of Conduct

## Our Pledge

In the interest of fostering an open and welcoming environment, we as
contributors and maintainers pledge to making participation in our project and
our community a harassment-free experience for everyone, regardless of age, body
size, disability, ethnicity, sex characteristics, gender identity and expression,
level of experience, education, socio-economic status, nationality, personal
appearance, race, religion, or sexual identity and orientation.

## Our Standards

Examples of behavior that contributes to creating a positive environment
include:

- Using welcoming and inclusive language
- Being respectful of differing viewpoints and experiences
- Gracefully accepting constructive criticism
- Focusing on what is best for the community
- Showing empathy towards other community members

Examples of unacceptable behavior by participants include:

- The use of sexualized language or imagery and unwelcome sexual attention or
advances
- Trolling, insulting/derogatory comments, and personal or political attacks
- Public or private harassment
- Publishing others' private information, such as a physical or electronic
address, without explicit permission
- Other conduct which could reasonably be considered inappropriate in a
professional setting

## Our Responsibilities

Project maintainers are responsible for clarifying the standards of acceptable
behavior and are expected to take appropriate and fair corrective action in
response to any instances of unacceptable behavior.

Project maintainers have the right and responsibility to remove, edit, or
reject comments, commits, code, wiki edits, issues, and other contributions
that are not aligned to this Code of Conduct, or to ban temporarily or
permanently any contributor for other behaviors that they deem inappropriate,
threatening, offensive, or harmful.

## Scope

This Code of Conduct applies both within project spaces and in public spaces
when an individual is representing the project or its community. Examples of
representing a project or community include using an official project e-mail
address, posting via an official social media account, or acting as an appointed
representative at an online or offline event. Representation of a project may be
further defined and clarified by project maintainers.

## Enforcement

Instances of abusive, harassing, or otherwise unacceptable behavior may be
reported by contacting the project team at hello@pyrevitlabs.io. All
complaints will be reviewed and investigated and will result in a response that
is deemed necessary and appropriate to the circumstances. The project team is
obligated to maintain confidentiality with regard to the reporter of an incident.
Further details of specific enforcement policies may be posted separately.

Project maintainers who do not follow or enforce the Code of Conduct in good
faith may face temporary or permanent repercussions as determined by other
members of the project's leadership.

## Attribution

This Code of Conduct is adapted from the [Contributor Covenant](https://www.contributor-covenant.org/), version 1.4,
available at https://www.contributor-covenant.org/version/1/4/code-of-conduct.html

For answers to common questions about this code of conduct, see
https://www.contributor-covenant.org/faq

Back to top

## pyRevit Repository Structure
[Skip to content](https://docs.pyrevitlabs.io/repo-organization/#repository-organization)

# Repository organization

The pyRevit repository is organized in the following folders:

- `bin` contains the binaries (dll and other support files) for pyRevit; usually a source repository doesn't have these, but it was made like this to be able to switch pyRevit versions using clones. This may change in the future and we could get rid of most content of this folder. Note that in this folder there also are the python envrionments (for example the CPython dlls and core packages).
- `dev` is where the c# code resides.
- `docs` is for the automatic generation of the [documentation website](https://docs.pyrevitlabs.io/)
- `extensions` holds the various pyRevit extensions; the pyRevitCore.extension is the one that build the `pyRevit` ribbon tab, the others can be enabled via the Extension button inside pyRevit itself. `pyRevitDevTools` is quite handy to run tests and check if pyRevit (and the modifications you'll do) is running fine.
- `extras` are… extra files that can come in handy (icons and the dark mode generator are there to this date).
- `licenses` contains all the licenses of the included third party projects.
- `pyrevitlib` contains pyRevit and other related project's python libraries. It is usually the library that gets imported in the user scripts to ease the Revit API development.
- `release` contains static assets needed to build the final product (pyrevit and pyrevit cli installers).
- `site-packages` is the collection of third-party python packaces that are made available by pyRevit to the user. Given that the main python engine is IronPython 2.7.12, packages in that folder needs to be compatible with it.
- `static` are assets for the website, youtube channels and so on, you can ignore it.

Back to top

## pyRevit Developer Guide
[Skip to content](https://docs.pyrevitlabs.io/dev-guide/#pyrevit-developers-guide)

# pyRevit Developer's Guide

This guide is designed to help new contributors set up their development environment, get familiar with the codebase, and start contributing to the project.

Note

This guide is for people that wants to get their hands dirty in the core pyRevit code, the part written in C#.

It is not for the development of the python side.

## Requirements

Before you begin, you'll need to set up your development environment with the following tools:

### Visual Studio

Install Visual Studio 2022 and select:

- under **workloads**, enable **.NET desktop development**
- under ¨ **Individual components** make sure the following are selected:
  - .NET 8.0 Runtime (Long Term Support)
  - .NET Framework 4.7.2 Targeting Pack
  - .NET Framework 4.8 SDK
  - .NET Framework 4.8 Targeting Pack
  - .NET 3.1 Runtime (MahApps.Metro)
  - NuGet package manager
  - MSBuild

### Python 3

Make sure Python 3 is installed on your system.

Download it from the [Python official website](https://www.python.org/downloads/).

### Pipenv

This tool manages Python environments and dependencies.

You can install Pipenv by running:

```md-code__content
pip install pipenv

```

## Git Setup

To contribute to pyRevit, you'll need to set up your Git environment as follows:

### Fork the Repository

Go to the [pyrevitlabs/pyrevit](https://github.com/pyrevitlabs/pyrevit) GitHub page and click on the "Fork" button to create your own copy of the repository.

Make sure to uncheck the "Copy the master branch only" option, since we mostly use the develop branch to make changes.

### Clone Your Fork

if you already have a copy of pyRevit or pyRevit CLI installed, you can use the command

```md-code__content
pyrevit clone <name-of-your-choice> --source <url-of-you-repo> --dest <destination-directory> --branch develop

```

As an example, I choose to call the clone "dev" and put it in "C:\\pyrevit", so my command becomes

```md-code__content
pyrevit clone dev --source https:/gitlab.com/sanzoghenzo/pyrevit.git --dest c:\pyrevit --branch=develop

```

Note

I will use the `dev` name in the following steps, make sure to replace it with the name of your choice.

If you don't have pyrevit cli installed, or prefer to do things in the canonical way, follow these steps:

1. **Clone Your Fork**: Clone your forked repository to your local machine:



```md-code__content
git clone <your-fork-url>

```

2. **Enter pyRevit folder**:



```md-code__content
cd pyrevit

```

3. **Checkout the Develop Branch**: This is where active development happens, so make sure you're working on this branch:



```md-code__content
git checkout develop

```


### Set Upstream Remote

Add the original pyrevitlabs repository as an "upstream" remote to keep your fork in sync:

```md-code__content
git remote add upstream https://github.com/pyrevitlabs/pyrevit.git

```

You can choose any name for the remote, but "upstream" is a common convention.

### Retrieve the submodules

At this time of writing, the pyRevit repository uses git submodules (stored in the `dev\modules` folder) to get some of its dependencies.
Initialize and fetch them with the following commands:

```md-code__content
git submodule update --init --recursive

```

Note

you may have to repeat the `git submodule update` command when you switch to another existing branch, or when new commits in the develop branch update the dependencies.

## Initialize the pipenv environment

This will create a python environment for running the toolchain scripts to build the various pyrevit components.

```md-code__content
pipenv install

```

## IDE Setup

You have a couple of options for setting up your development environment:

1. **Visual Studio Code**: You can open the entire pyRevit directory in Visual Studio Code. This setup works well for Python development, but may lack some C#/.NET language support.

2. Recommended extensions: C#, Python, and GitLens.

3. **Visual Studio**: For full C#/.NET support, it's better to open a specific solution file ( `.sln`) in Visual Studio. This gives you access to language checks, autocompletion, and suggestions.

4. Open the solution that corresponds to the area of the project you're working on.


But you can of course use your IDE of choice, such as Rider for .NET and pyCharm for python.

## Revit Setup

To run and test your changes in Revit, follow these steps:

1. **Create a Clone**: If you cloned the git repository without the pyRevit CLI, you need to use it now to create a clone of your git directory:

```md-code__content
pyrevit clones add dev <path-to-your-git-directory>

```

1. **Attach the Clone**: Attach your clone to the default Revit installation:

```md-code__content
pyrevit attach dev default --installed

```

Note

the pyRevit dll paths have changed with pyrevit 5 (current WIP version), so you need to use the pyrevit CLI from a WIP installer for this to work.
If you don't have it already, you can build the CLI from sources and run it with

```md-code__content
pipenv run pyrevit build labs
copy .\release\.pyrevitargs .
.\bin\pyrevit.exe attach dev default --installed

```

## Debugging Code

Currently, you cannot use Visual Studio's "Run" button to debug pyRevit because of some build issues. Instead, follow this approach:

1. **Build the Project**: Open a command prompt or PowerShell, navigate to your git directory, and build the project in Debug mode:

```md-code__content
pipenv run pyrevit build products Debug

```

1. **Open the Solution in Visual Studio**: Once the DLLs are built, open the `pyRevitLabs.PyRevit.Runtime` solution in Visual Studio.

2. **Attach the Debugger**: Attach the Visual Studio debugger to the `revit.exe` process to start debugging:

3. Go to `Debug` \> `Attach to Process...` and select `revit.exe` from the list.

## Conclusion

You're now ready to start contributing to pyRevit! Whether you're fixing bugs, adding new features, or improving documentation, your contributions are valuable. If you have any questions, feel free to reach out to the community through GitHub or other communication channels.

Happy coding!

Back to top

## pyRevit Configuration Guide
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/#pyrevit)

# pyrevit

pyRevit root level config for all pyrevit sub-modules.

Examples:

```md-code__content
from pyrevit import DB, UI
from pyrevit import PyRevitException, PyRevitIOError

# pyrevit module has global instance of the
# _HostAppPostableCommand and _ExecutorParams classes already created
# import and use them like below
from pyrevit import HOST_APP
from pyrevit import EXEC_PARAMS

```

## Attributes

### `PYREVIT_ADDON_NAME = 'pyRevit'``module-attribute`

### `PYREVIT_CLI_NAME = 'pyrevit.exe'``module-attribute`

### `VERSION_STRING = version_file.read()``module-attribute`

### `matches = re.findall('(\\d+)\\.(\\d+)\\.(\\d+)\\.?(.+)?', VERSION_STRING)[0]``module-attribute`

### `BUILD_METADATA = ''``module-attribute`

### `VERSION_MAJOR = int(VERSION_MAJOR)``module-attribute`

### `VERSION_MINOR = int(VERSION_MINOR)``module-attribute`

### `VERSION_PATCH = int(VERSION_PATCH)``module-attribute`

### `HOME_DIR = op.dirname(op.dirname(op.dirname(__file__)))``module-attribute`

### `DOTNET_RUNTIME_ID = 'netcore' if compat.NETCORE else 'netfx'``module-attribute`

### `ROOT_BIN_DIR = op.join(HOME_DIR, 'bin')``module-attribute`

### `BIN_DIR = op.join(ROOT_BIN_DIR, DOTNET_RUNTIME_ID)``module-attribute`

### `MAIN_LIB_DIR = op.join(HOME_DIR, 'pyrevitlib')``module-attribute`

### `MISC_LIB_DIR = op.join(HOME_DIR, 'site-packages')``module-attribute`

### `MODULE_DIR = op.join(MAIN_LIB_DIR, 'pyrevit')``module-attribute`

### `LOADER_DIR = op.join(MODULE_DIR, 'loader')``module-attribute`

### `RUNTIME_DIR = op.join(MODULE_DIR, 'runtime')``module-attribute`

### `ADDIN_DIR = op.join(LOADER_DIR, 'addin')``module-attribute`

### `ENGINES_DIR = op.join(BIN_DIR, 'engines', eng.EngineVersion)``module-attribute`

### `PYREVIT_CLI_PATH = op.join(HOME_DIR, 'bin', PYREVIT_CLI_NAME)``module-attribute`

### `TRACEBACK_TITLE = 'Traceback:'``module-attribute`

### `HOST_APP = _HostApplication()``module-attribute`

### `EXEC_PARAMS = _ExecutorParams()``module-attribute`

### `DOCS = _DocsGetter()``module-attribute`

### `ALLUSER_PROGRAMDATA = os.getenv('programdata')``module-attribute`

### `USER_ROAMING_DIR = os.getenv('appdata')``module-attribute`

### `USER_SYS_TEMP = os.getenv('temp')``module-attribute`

### `USER_DESKTOP = op.expandvars('%userprofile%\\desktop')``module-attribute`

### `EXTENSIONS_DEFAULT_DIR = op.join(HOME_DIR, 'extensions')``module-attribute`

### `THIRDPARTY_EXTENSIONS_DEFAULT_DIR = op.join(USER_ROAMING_DIR, PYREVIT_ADDON_NAME, 'Extensions')``module-attribute`

### `PYREVIT_ALLUSER_APP_DIR = op.join(ALLUSER_PROGRAMDATA, PYREVIT_ADDON_NAME)``module-attribute`

### `PYREVIT_APP_DIR = op.join(USER_ROAMING_DIR, PYREVIT_ADDON_NAME)``module-attribute`

### `PYREVIT_VERSION_APP_DIR = op.join(PYREVIT_APP_DIR, HOST_APP.version)``module-attribute`

### `PYREVIT_FILE_PREFIX_UNIVERSAL = '{}_'.format(PYREVIT_ADDON_NAME)``module-attribute`

### `PYREVIT_FILE_PREFIX_UNIVERSAL_REGEX = '^' + PYREVIT_ADDON_NAME + '_(?P<fname>.+)'``module-attribute`

### `PYREVIT_FILE_PREFIX = '{}_{}_'.format(PYREVIT_ADDON_NAME, HOST_APP.version)``module-attribute`

### `PYREVIT_FILE_PREFIX_REGEX = '^' + PYREVIT_ADDON_NAME + '_(?P<version>\\d{4})_(?P<fname>.+)'``module-attribute`

### `PYREVIT_FILE_PREFIX_STAMPED = '{}_{}_{}_'.format(PYREVIT_ADDON_NAME, HOST_APP.version, HOST_APP.proc_id)``module-attribute`

### `PYREVIT_FILE_PREFIX_STAMPED_REGEX = '^' + PYREVIT_ADDON_NAME + '_(?P<version>\\d{4})_(?P<pid>\\d+)_(?P<fname>.+)'``module-attribute`

### `PYREVIT_FILE_PREFIX_UNIVERSAL_USER = '{}_{}_'.format(PYREVIT_ADDON_NAME, HOST_APP.username)``module-attribute`

### `PYREVIT_FILE_PREFIX_UNIVERSAL_USER_REGEX = '^' + PYREVIT_ADDON_NAME + '_(?P<user>.+)_(?P<fname>.+)'``module-attribute`

### `PYREVIT_FILE_PREFIX_USER = '{}_{}_{}_'.format(PYREVIT_ADDON_NAME, HOST_APP.version, HOST_APP.username)``module-attribute`

### `PYREVIT_FILE_PREFIX_USER_REGEX = '^' + PYREVIT_ADDON_NAME + '_(?P<version>\\d{4})_(?P<user>.+)_(?P<fname>.+)'``module-attribute`

### `PYREVIT_FILE_PREFIX_STAMPED_USER = '{}_{}_{}_{}_'.format(PYREVIT_ADDON_NAME, HOST_APP.version, HOST_APP.username, HOST_APP.proc_id)``module-attribute`

### `PYREVIT_FILE_PREFIX_STAMPED_USER_REGEX = '^' + PYREVIT_ADDON_NAME + '_(?P<version>\\d{4})_(?P<user>.+)_(?P<pid>\\d+)_(?P<fname>.+)'``module-attribute`

## Classes

### `PyRevitException`

Bases: `Exception`

Common base class for all pyRevit exceptions.

Parameters args and message are derived from Exception class.

#### Attributes

##### `msg``property`

Return exception message.

### `PyRevitIOError`

Bases: `PyRevitException`

Common base class for all pyRevit io-related exceptions.

#### Attributes

##### `msg``property`

Return exception message.

### `PyRevitCPythonNotSupported(feature_name)`

Bases: `PyRevitException`

Exception for features not supported under CPython.

Source code in `pyrevitlib/pyrevit/__init__.py`

|     |     |
| --- | --- |
| ```<br>153<br>154<br>155<br>``` | ```md-code__content<br>def __init__(self, feature_name):<br>    super(PyRevitCPythonNotSupported, self).__init__()<br>    self.feature_name = feature_name<br>``` |

#### Attributes

##### `feature_name = feature_name``instance-attribute`

##### `msg``property`

Return exception message.

### `_HostApplication()`

Bases: `object`

Private Wrapper for Current Instance of Revit.

Provides version info and comparison functionality, alongside providing
info on the active screen, active document and ui-document, available
postable commands, and other functionality.

Examples:

```md-code__content
hostapp = _HostApplication()
hostapp.is_newer_than(2017)

```

Source code in `pyrevitlib/pyrevit/__init__.py`

|     |     |
| --- | --- |
| ```<br>197<br>198<br>``` | ```md-code__content<br>def __init__(self):<br>    self._postable_cmds = []<br>``` |

#### Attributes

##### `uiapp``property`

Return UIApplication provided to the running command.

##### `app``property`

Return Application provided to the running command.

##### `addin_id``property`

Return active addin id.

##### `has_api_context``property`

Determine if host application is in API context.

##### `uidoc``property`

Return active UIDocument.

##### `doc``property`

Return active Document.

##### `active_view``property``writable`

Return view that is active (UIDocument.ActiveView).

##### `docs``property`

Return :obj: `list` of open :obj: `Document` objects.

##### `available_servers``property`

Return :obj: `list` of available Revit server names.

##### `version``property`

str: Return version number (e.g. '2018').

##### `subversion``property`

str: Return subversion number (e.g. '2018.3').

##### `version_name``property`

str: Return version name (e.g. 'Autodesk Revit 2018').

##### `build``property`

str: Return build number (e.g. '20170927\_1515(x64)').

##### `serial_no``property`

str: Return serial number number (e.g. '569-09704828').

##### `pretty_name``property`

Returns the pretty name of the host.

Examples:

Autodesk Revit 2019.2 build: 20190808\_0900(x64)

Returns:

| Type | Description |
| --- | --- |
| `str` | Pretty name of the host |

##### `is_demo``property`

bool: Determine if product is using demo license.

##### `language``property`

str: Return language type (e.g. 'LanguageType.English\_USA').

##### `username``property`

str: Return the username from Revit API (Application.Username).

##### `proc``property`

System.Diagnostics.Process: Return current process object.

##### `proc_id``property`

int: Return current process id.

##### `proc_name``property`

str: Return current process name.

##### `proc_path``property`

str: Return file path for the current process main module.

##### `proc_window``property`

`intptr`: Return handle to current process window.

##### `proc_screen``property`

`intptr`: Return handle to screen hosting current process.

##### `proc_screen_workarea``property`

`System.Drawing.Rectangle`: Return screen working area.

##### `proc_screen_scalefactor``property`

float: Return scaling for screen hosting current process.

#### Functions

##### `is_newer_than(version, or_equal=False)`

bool: Return True if host app is newer than provided version.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `version` | `str or int` | version to check against. | _required_ |
| `or_equal` | `bool` | Whether to include `version` in the comparison | `False` |

Source code in `pyrevitlib/pyrevit/__init__.py`

|     |     |
| --- | --- |
| ```<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>``` | ```md-code__content<br>def is_newer_than(self, version, or_equal=False):<br>    """bool: Return True if host app is newer than provided version.<br>    Args:<br>        version (str or int): version to check against.<br>        or_equal (bool): Whether to include `version` in the comparison<br>    """<br>    if or_equal:<br>        return int(self.version) >= int(version)<br>    else:<br>        return int(self.version) > int(version)<br>``` |

##### `is_older_than(version)`

bool: Return True if host app is older than provided version.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `version` | `str or int` | version to check against. | _required_ |

Source code in `pyrevitlib/pyrevit/__init__.py`

|     |     |
| --- | --- |
| ```<br>381<br>382<br>383<br>384<br>385<br>386<br>387<br>``` | ```md-code__content<br>def is_older_than(self, version):<br>    """bool: Return True if host app is older than provided version.<br>    Args:<br>        version (str or int): version to check against.<br>    """<br>    return int(self.version) < int(version)<br>``` |

##### `is_exactly(version)`

bool: Return True if host app is equal to provided version.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `version` | `str or int` | version to check against. | _required_ |

Source code in `pyrevitlib/pyrevit/__init__.py`

|     |     |
| --- | --- |
| ```<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>``` | ```md-code__content<br>def is_exactly(self, version):<br>    """bool: Return True if host app is equal to provided version.<br>    Args:<br>        version (str or int): version to check against.<br>    """<br>    return int(self.version) == int(version)<br>``` |

##### `get_postable_commands()`

Return list of postable commands.

Returns:

| Type | Description |
| --- | --- |
| `list[_HostAppPostableCommand]` | postable commands. |

Source code in `pyrevitlib/pyrevit/__init__.py`

|     |     |
| --- | --- |
| ```<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>``` | ```md-code__content<br>def get_postable_commands(self):<br>    """Return list of postable commands.<br>    Returns:<br>        (list[_HostAppPostableCommand]): postable commands.<br>    """<br>    # if list of postable commands is _not_ already created<br>    # make the list and store in instance parameter<br>    if not self._postable_cmds:<br>        for pc in UI.PostableCommand.GetValues(UI.PostableCommand):<br>            try:<br>                rcid = UI.RevitCommandId.LookupPostableCommandId(pc)<br>                self._postable_cmds.append(<br>                    # wrap postable command info in custom namedtuple<br>                    _HostAppPostableCommand(name=safe_strtype(pc),<br>                                            key=rcid.Name,<br>                                            id=rcid.Id,<br>                                            rvtobj=rcid)<br>                    )<br>            except Exception:<br>                # if any error occured when querying postable command<br>                # or its info, pass silently<br>                pass<br>    return self._postable_cmds<br>``` |

##### `post_command(command_id)`

Request Revit to run a command.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `command_id` | `str` | command identifier e.g. ID\_REVIT\_SAVE\_AS\_TEMPLATE | _required_ |

Source code in `pyrevitlib/pyrevit/__init__.py`

|     |     |
| --- | --- |
| ```<br>423<br>424<br>425<br>426<br>427<br>428<br>429<br>430<br>``` | ```md-code__content<br>def post_command(self, command_id):<br>    """Request Revit to run a command.<br>    Args:<br>        command_id (str): command identifier e.g. ID_REVIT_SAVE_AS_TEMPLATE<br>    """<br>    command_id = UI.RevitCommandId.LookupCommandId(command_id)<br>    self.uiapp.PostCommand(command_id)<br>``` |

Back to top

## PyRevit Extensions Module
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/#pyrevit.extensions)

# extensions

Base module for handling extensions parsing.

## Attributes

### `LIB_EXTENSION_POSTFIX = '.lib'``module-attribute`

### `UI_EXTENSION_POSTFIX = '.extension'``module-attribute`

### `PYTHON_LANG = 'python'``module-attribute`

### `CSHARP_LANG = 'csharp'``module-attribute`

### `VB_LANG = 'visualbasic'``module-attribute`

### `RUBY_LANG = 'ruby'``module-attribute`

### `DYNAMO_LANG = 'dynamobim'``module-attribute`

### `GRASSHOPPER_LANG = 'grasshopper'``module-attribute`

### `CPYTHON_HASHBANG = '\#! python3'``module-attribute`

### `PYTHON_SCRIPT_FILE_FORMAT = '.py'``module-attribute`

### `CSHARP_SCRIPT_FILE_FORMAT = '.cs'``module-attribute`

### `VB_SCRIPT_FILE_FORMAT = '.vb'``module-attribute`

### `RUBY_SCRIPT_FILE_FORMAT = '.rb'``module-attribute`

### `DYNAMO_SCRIPT_FILE_FORMAT = '.dyn'``module-attribute`

### `GRASSHOPPER_SCRIPT_FILE_FORMAT = '.gh'``module-attribute`

### `GRASSHOPPERX_SCRIPT_FILE_FORMAT = '.ghx'``module-attribute`

### `CONTENT_FILE_FORMAT = '.rfa'``module-attribute`

### `EXT_STARTUP_NAME = 'startup'``module-attribute`

### `PYTHON_EXT_STARTUP_FILE = EXT_STARTUP_NAME + PYTHON_SCRIPT_FILE_FORMAT``module-attribute`

### `CSHARP_EXT_STARTUP_FILE = EXT_STARTUP_NAME + CSHARP_SCRIPT_FILE_FORMAT``module-attribute`

### `VB_EXT_STARTUP_FILE = EXT_STARTUP_NAME + VB_SCRIPT_FILE_FORMAT``module-attribute`

### `RUBY_EXT_STARTUP_FILE = EXT_STARTUP_NAME + RUBY_SCRIPT_FILE_FORMAT``module-attribute`

### `YAML_FILE_FORMAT = '.yaml'``module-attribute`

### `JSON_FILE_FORMAT = '.json'``module-attribute`

### `EXT_MANIFEST_NAME = 'extension'``module-attribute`

### `EXT_MANIFEST_FILE = EXT_MANIFEST_NAME + JSON_FILE_FORMAT``module-attribute`

### `DEFAULT_BUNDLEMATA_NAME = 'bundle'``module-attribute`

### `BUNDLEMATA_POSTFIX = DEFAULT_BUNDLEMATA_NAME + YAML_FILE_FORMAT``module-attribute`

### `MDATA_UI_TITLE = 'title'``module-attribute`

### `MDATA_TOOLTIP = 'tooltip'``module-attribute`

### `MDATA_AUTHOR = 'author'``module-attribute`

### `MDATA_AUTHORS = 'authors'``module-attribute`

### `MDATA_LAYOUT = 'layout'``module-attribute`

### `MDATA_COMMAND_HELP_URL = 'help_url'``module-attribute`

### `MDATA_COMMAND_CONTEXT = 'context'``module-attribute`

### `MDATA_COMMAND_CONTEXT_TYPE = 'type'``module-attribute`

### `MDATA_COMMAND_CONTEXT_NOT = 'not_'``module-attribute`

### `MDATA_COMMAND_CONTEXT_ANY = 'any'``module-attribute`

### `MDATA_COMMAND_CONTEXT_ALL = 'all'``module-attribute`

### `MDATA_COMMAND_CONTEXT_EXACT = 'exact'``module-attribute`

### `MDATA_COMMAND_CONTEXT_NOTANY = MDATA_COMMAND_CONTEXT_NOT + MDATA_COMMAND_CONTEXT_ANY``module-attribute`

### `MDATA_COMMAND_CONTEXT_NOTALL = MDATA_COMMAND_CONTEXT_NOT + MDATA_COMMAND_CONTEXT_ALL``module-attribute`

### `MDATA_COMMAND_CONTEXT_NOTEXACT = MDATA_COMMAND_CONTEXT_NOT + MDATA_COMMAND_CONTEXT_EXACT``module-attribute`

### `MDATA_COMMAND_CONTEXT_ANY_SEP = '|'``module-attribute`

### `MDATA_COMMAND_CONTEXT_ALL_SEP = '&'``module-attribute`

### `MDATA_COMMAND_CONTEXT_EXACT_SEP = ';'``module-attribute`

### `MDATA_COMMAND_CONTEXT_RULE = '({rule})'``module-attribute`

### `MDATA_MIN_REVIT_VERSION = 'min_revit_version'``module-attribute`

### `MDATA_MAX_REVIT_VERSION = 'max_revit_version'``module-attribute`

### `MDATA_BETA_SCRIPT = 'is_beta'``module-attribute`

### `MDATA_ENGINE = 'engine'``module-attribute`

### `MDATA_ENGINE_CLEAN = 'clean'``module-attribute`

### `MDATA_ENGINE_FULLFRAME = 'full_frame'``module-attribute`

### `MDATA_ENGINE_PERSISTENT = 'persistent'``module-attribute`

### `MDATA_ENGINE_MAINTHREAD = 'mainthread'``module-attribute`

### `MDATA_LINK_BUTTON_MODULES = 'modules'``module-attribute`

### `MDATA_LINK_BUTTON_ASSEMBLY = 'assembly'``module-attribute`

### `MDATA_LINK_BUTTON_COMMAND_CLASS = 'command_class'``module-attribute`

### `MDATA_LINK_BUTTON_AVAIL_COMMAND_CLASS = 'availability_class'``module-attribute`

### `MDATA_URL_BUTTON_HYPERLINK = 'hyperlink'``module-attribute`

### `MDATA_TEMPLATES_KEY = 'templates'``module-attribute`

### `MDATA_BACKGROUND_KEY = 'background'``module-attribute`

### `MDATA_BACKGROUND_PANEL_KEY = 'panel'``module-attribute`

### `MDATA_BACKGROUND_TITLE_KEY = 'title'``module-attribute`

### `MDATA_BACKGROUND_SLIDEOUT_KEY = 'slideout'``module-attribute`

### `MDATA_HIGHLIGHT_KEY = 'highlight'``module-attribute`

### `MDATA_HIGHLIGHT_TYPE_NEW = 'new'``module-attribute`

### `MDATA_HIGHLIGHT_TYPE_UPDATED = 'updated'``module-attribute`

### `MDATA_COLLAPSED_KEY = 'collapsed'``module-attribute`

### `MDATA_ENGINE_DYNAMO_AUTOMATE = 'automate'``module-attribute`

### `MDATA_ENGINE_DYNAMO_PATH = 'dynamo_path'``module-attribute`

### `MDATA_ENGINE_DYNAMO_PATH_CHECK_EXIST = 'dynamo_path_check_existing'``module-attribute`

### `MDATA_ENGINE_DYNAMO_FORCE_MANUAL_RUN = 'dynamo_force_manual_run'``module-attribute`

### `MDATA_ENGINE_DYNAMO_MODEL_NODES_INFO = 'dynamo_model_nodes_info'``module-attribute`

### `UI_TITLE_PARAM = '__title__'``module-attribute`

### `DOCSTRING_PARAM = '__doc__'``module-attribute`

### `AUTHOR_PARAM = '__author__'``module-attribute`

### `AUTHORS_PARAM = '__authors__'``module-attribute`

### `COMMAND_HELP_URL_PARAM = '__helpurl__'``module-attribute`

### `COMMAND_CONTEXT_PARAM = '__context__'``module-attribute`

### `MIN_REVIT_VERSION_PARAM = '__min_revit_ver__'``module-attribute`

### `MAX_REVIT_VERSION_PARAM = '__max_revit_ver__'``module-attribute`

### `SHIFT_CLICK_PARAM = '__shiftclick__'``module-attribute`

### `BETA_SCRIPT_PARAM = '__beta__'``module-attribute`

### `HIGHLIGHT_SCRIPT_PARAM = '__highlight__'``module-attribute`

### `CLEAN_ENGINE_SCRIPT_PARAM = '__cleanengine__'``module-attribute`

### `FULLFRAME_ENGINE_PARAM = '__fullframeengine__'``module-attribute`

### `PERSISTENT_ENGINE_PARAM = '__persistentengine__'``module-attribute`

### `TAB_POSTFIX = '.tab'``module-attribute`

### `PANEL_POSTFIX = '.panel'``module-attribute`

### `LINK_BUTTON_POSTFIX = '.linkbutton'``module-attribute`

### `INVOKE_BUTTON_POSTFIX = '.invokebutton'``module-attribute`

### `PUSH_BUTTON_POSTFIX = '.pushbutton'``module-attribute`

### `SMART_BUTTON_POSTFIX = '.smartbutton'``module-attribute`

### `PULLDOWN_BUTTON_POSTFIX = '.pulldown'``module-attribute`

### `STACK_BUTTON_POSTFIX = '.stack'``module-attribute`

### `SPLIT_BUTTON_POSTFIX = '.splitbutton'``module-attribute`

### `SPLITPUSH_BUTTON_POSTFIX = '.splitpushbutton'``module-attribute`

### `PANEL_PUSH_BUTTON_POSTFIX = '.panelbutton'``module-attribute`

### `NOGUI_COMMAND_POSTFIX = '.nobutton'``module-attribute`

### `CONTENT_BUTTON_POSTFIX = '.content'``module-attribute`

### `URL_BUTTON_POSTFIX = '.urlbutton'``module-attribute`

### `COMP_LIBRARY_DIR_NAME = 'lib'``module-attribute`

### `COMP_BIN_DIR_NAME = 'bin'``module-attribute`

### `COMP_HOOKS_DIR_NAME = 'hooks'``module-attribute`

### `COMP_CHECKS_DIR_NAME = 'checks'``module-attribute`

### `UNIQUE_ID_SEPARATOR = '-'``module-attribute`

### `SEPARATOR_IDENTIFIER = '---'``module-attribute`

### `SLIDEOUT_IDENTIFIER = '>>>'``module-attribute`

### `ICON_FILE_FORMAT = '.png'``module-attribute`

### `ICON_DARK_SUFFIX = '.dark'``module-attribute`

### `DEFAULT_ICON_FILE = 'icon' + ICON_FILE_FORMAT``module-attribute`

### `DEFAULT_ON_ICON_FILE = 'on' + ICON_FILE_FORMAT``module-attribute`

### `DEFAULT_OFF_ICON_FILE = 'off' + ICON_FILE_FORMAT``module-attribute`

### `DEFAULT_MEDIA_FILENAME = 'tooltip'``module-attribute`

### `DEFAULT_SCRIPT_NAME = 'script'``module-attribute`

### `DEFAULT_CONFIG_NAME = 'config'``module-attribute`

### `PYTHON_SCRIPT_POSTFIX = DEFAULT_SCRIPT_NAME + PYTHON_SCRIPT_FILE_FORMAT``module-attribute`

### `PYTHON_CONFIG_SCRIPT_POSTFIX = DEFAULT_CONFIG_NAME + PYTHON_SCRIPT_FILE_FORMAT``module-attribute`

### `CSHARP_SCRIPT_POSTFIX = DEFAULT_SCRIPT_NAME + CSHARP_SCRIPT_FILE_FORMAT``module-attribute`

### `CSHARP_CONFIG_SCRIPT_POSTFIX = DEFAULT_CONFIG_NAME + CSHARP_SCRIPT_FILE_FORMAT``module-attribute`

### `VB_SCRIPT_POSTFIX = DEFAULT_SCRIPT_NAME + VB_SCRIPT_FILE_FORMAT``module-attribute`

### `VB_CONFIG_SCRIPT_POSTFIX = DEFAULT_CONFIG_NAME + VB_SCRIPT_FILE_FORMAT``module-attribute`

### `RUBY_SCRIPT_POSTFIX = DEFAULT_SCRIPT_NAME + RUBY_SCRIPT_FILE_FORMAT``module-attribute`

### `RUBY_CONFIG_SCRIPT_POSTFIX = DEFAULT_CONFIG_NAME + RUBY_SCRIPT_FILE_FORMAT``module-attribute`

### `DYNAMO_SCRIPT_POSTFIX = DEFAULT_SCRIPT_NAME + DYNAMO_SCRIPT_FILE_FORMAT``module-attribute`

### `DYNAMO_CONFIG_SCRIPT_POSTFIX = DEFAULT_CONFIG_NAME + DYNAMO_SCRIPT_FILE_FORMAT``module-attribute`

### `GRASSHOPPER_SCRIPT_POSTFIX = DEFAULT_SCRIPT_NAME + GRASSHOPPER_SCRIPT_FILE_FORMAT``module-attribute`

### `GRASSHOPPER_CONFIG_SCRIPT_POSTFIX = DEFAULT_CONFIG_NAME + GRASSHOPPER_SCRIPT_FILE_FORMAT``module-attribute`

### `GRASSHOPPERX_SCRIPT_POSTFIX = DEFAULT_SCRIPT_NAME + GRASSHOPPERX_SCRIPT_FILE_FORMAT``module-attribute`

### `GRASSHOPPERX_CONFIG_SCRIPT_POSTFIX = DEFAULT_CONFIG_NAME + GRASSHOPPERX_SCRIPT_FILE_FORMAT``module-attribute`

### `DEFAULT_CONTENT_NAME = 'content'``module-attribute`

### `DEFAULT_ALT_CONTENT_NAME = 'other'``module-attribute`

### `CONTENT_POSTFIX = DEFAULT_CONTENT_NAME + CONTENT_FILE_FORMAT``module-attribute`

### `CONTENT_VERSION_POSTFIX = DEFAULT_CONTENT_NAME + '_{version}' + CONTENT_FILE_FORMAT``module-attribute`

### `ALT_CONTENT_POSTFIX = DEFAULT_ALT_CONTENT_NAME + CONTENT_FILE_FORMAT``module-attribute`

### `ALT_CONTENT_VERSION_POSTFIX = DEFAULT_ALT_CONTENT_NAME + '_{version}' + CONTENT_FILE_FORMAT``module-attribute`

### `HELP_FILE_PATTERN = '.*help\\..+'``module-attribute`

### `CTX_SELETION = 'selection'``module-attribute`

### `CTX_ZERODOC = 'zero-doc'``module-attribute`

## Classes

### `UIExtensionType`

UI extension type.

#### Attributes

##### `ID = 'extension'``class-attribute``instance-attribute`

##### `POSTFIX = '.extension'``class-attribute``instance-attribute`

### `LIBExtensionType`

Library extension type.

#### Attributes

##### `ID = 'lib'``class-attribute``instance-attribute`

##### `POSTFIX = '.lib'``class-attribute``instance-attribute`

### `ExtensionTypes`

Extension types.

#### Attributes

##### `UI_EXTENSION = UIExtensionType``class-attribute``instance-attribute`

##### `LIB_EXTENSION = LIBExtensionType``class-attribute``instance-attribute`

#### Functions

##### `get_ext_types()``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/__init__.py`

|     |     |
| --- | --- |
| ```<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>``` | ```md-code__content<br>@classmethod<br>def get_ext_types(cls):<br>    ext_types = set()<br>    for attr in dir(cls):<br>        if attr.endswith('_EXTENSION'):<br>            ext_types.add(getattr(cls, attr))<br>    return ext_types<br>``` |

Back to top

## Revit API Reference
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/api/#pyrevit.api)

# api

Provide access to Revit API.

Examples:

```md-code__content
from pyrevit.api import AdWindows

```

## Functions

### `get_product_serial_number()`

Return serial number of running host instance.

Returns:

| Type | Description |
| --- | --- |
| `str` | Serial number |

Source code in `pyrevitlib/pyrevit/api.py`

|     |     |
| --- | --- |
| ```<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>``` | ```md-code__content<br>def get_product_serial_number():<br>    """Return serial number of running host instance.<br>    Returns:<br>        (str): Serial number<br>    """<br>    return UIFrameworkServices.InfoCenterService.ProductSerialNumber<br>``` |

### `is_product_demo()`

Determine if product is using demo license.

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if product is using demo license |

Source code in `pyrevitlib/pyrevit/api.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>def is_product_demo():<br>    """Determine if product is using demo license.<br>    Returns:<br>        (bool): True if product is using demo license<br>    """<br>    return get_product_serial_number() == '000-00000000'<br>``` |

### `is_api_object(data_type)`

Check if given object belongs to Revit API.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `data_type` | `object` | Object to check | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if object belongs to Revit API |

Source code in `pyrevitlib/pyrevit/api.py`

|     |     |
| --- | --- |
| ```<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>``` | ```md-code__content<br>def is_api_object(data_type):<br>    """Check if given object belongs to Revit API.<br>    Args:<br>        data_type (object): Object to check<br>    Returns:<br>        (bool): True if object belongs to Revit API<br>    """<br>    if hasattr(data_type, 'GetType'):<br>        return 'Autodesk.Revit.' in data_type.GetType().Namespace<br>``` |

Back to top

## DotNet Framework Access
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/framework/#pyrevit.framework)

# framework

Provide access to DotNet Framework.

Examples:

```md-code__content
from pyrevit.framework import Assembly, Windows

```

## Attributes

### `ASSEMBLY_FILE_TYPE = 'dll'``module-attribute`

### `ASSEMBLY_FILE_EXT = '.dll'``module-attribute`

### `ipy_assmname = '{prefix}IronPython'.format(prefix=eng.EnginePrefix)``module-attribute`

### `ipy_dllpath = op.join(eng.EnginePath, ipy_assmname + ASSEMBLY_FILE_EXT)``module-attribute`

### `wpf_assmname = '{prefix}IronPython.Wpf'.format(prefix=eng.EnginePrefix)``module-attribute`

### `wpf_dllpath = op.join(eng.EnginePath, wpf_assmname + ASSEMBLY_FILE_EXT)``module-attribute`

### `sqlite3_assmname = '{prefix}IronPython.SQLite'.format(prefix=eng.EnginePrefix)``module-attribute`

### `sqlite3_dllpath = op.join(eng.EnginePath, sqlite3_assmname + ASSEMBLY_FILE_EXT)``module-attribute`

## Functions

### `get_type(fw_object)`

Return CLR type of an object.

Source code in `pyrevitlib/pyrevit/framework.py`

|     |     |
| --- | --- |
| ```<br>156<br>157<br>158<br>``` | ```md-code__content<br>def get_type(fw_object):<br>    """Return CLR type of an object."""<br>    return clr.GetClrType(fw_object)<br>``` |

### `get_dll_file(assembly_name)`

Return path to given assembly name.

Source code in `pyrevitlib/pyrevit/framework.py`

|     |     |
| --- | --- |
| ```<br>161<br>162<br>163<br>164<br>165<br>``` | ```md-code__content<br>def get_dll_file(assembly_name):<br>    """Return path to given assembly name."""<br>    addin_file = op.join(BIN_DIR, assembly_name + '.dll')<br>    if op.exists(addin_file):<br>        return addin_file<br>``` |

### `get_current_thread_id()`

Return manageed thread id of current thread.

Source code in `pyrevitlib/pyrevit/framework.py`

|     |     |
| --- | --- |
| ```<br>168<br>169<br>170<br>``` | ```md-code__content<br>def get_current_thread_id():<br>    """Return manageed thread id of current thread."""<br>    return System.Threading.Thread.CurrentThread.ManagedThreadId<br>``` |

Back to top

## pyRevit Version Management
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/versionmgr/#pyrevit.versionmgr)

# versionmgr

Utility functions for managing pyRevit versions.

Examples:

```md-code__content
from pyrevit import versionmgr
v = versionmgr.get_pyrevit_version()
v.get_formatted()

```

'4.10-beta2'

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Functions

### `get_pyrevit_repo()`

Return pyRevit repository.

Returns:

| Type | Description |
| --- | --- |
| `RepoInfo` | repo wrapper object |

Source code in `pyrevitlib/pyrevit/versionmgr/__init__.py`

|     |     |
| --- | --- |
| ```<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>``` | ```md-code__content<br>def get_pyrevit_repo():<br>    """Return pyRevit repository.<br>    Returns:<br>        (pyrevit.coreutils.git.RepoInfo): repo wrapper object<br>    """<br>    try:<br>        return git.get_repo(HOME_DIR)<br>    except Exception as repo_err:<br>        mlogger.debug('Can not create repo from directory: %s | %s',<br>                      HOME_DIR, repo_err)<br>``` |

### `get_pyrevit_version()`

Return information about active pyRevit version.

Returns:

| Type | Description |
| --- | --- |
| `_PyRevitVersion` | version wrapper object |

Source code in `pyrevitlib/pyrevit/versionmgr/__init__.py`

|     |     |
| --- | --- |
| ```<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>94<br>95<br>96<br>97<br>``` | ```md-code__content<br>def get_pyrevit_version():<br>    """Return information about active pyRevit version.<br>    Returns:<br>        (_PyRevitVersion): version wrapper object<br>    """<br>    try:<br>        return _PyRevitVersion(get_pyrevit_repo().last_commit_hash)<br>    except Exception as ver_err:<br>        mlogger.debug('Can not get pyRevit patch number. | %s', ver_err)<br>        return _PyRevitVersion('')<br>``` |

### `get_pyrevit_cli_version()`

Return version of shipped pyRevit CLI utility.

Returns:

| Type | Description |
| --- | --- |
| `str` | version string of pyRevit CLI utility binary |

Source code in `pyrevitlib/pyrevit/versionmgr/__init__.py`

|     |     |
| --- | --- |
| ```<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>``` | ```md-code__content<br>def get_pyrevit_cli_version():<br>    """Return version of shipped pyRevit CLI utility.<br>    Returns:<br>        (str): version string of pyRevit CLI utility binary<br>    """<br>    return coreutils.get_exe_version(PYREVIT_CLI_PATH)<br>``` |

Back to top

## Python Compatibility Module
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/compat/#pyrevit.compat)

# compat

python engine compatibility module.

Examples:

```md-code__content
from pyrevit.compat import IRONPY2711
from pyrevit.compat import safe_strtype

```

## Attributes

### `PY2 = sys.version_info[0] == 2``module-attribute`

### `PY3 = sys.version_info[0] == 3``module-attribute`

### `IRONPY = '.net' in sys.version.lower()``module-attribute`

### `IRONPY2 = PY2 and IRONPY``module-attribute`

### `IRONPY3 = PY3 and IRONPY``module-attribute`

### `NETCORE = System.Environment.Version.Major >= 8``module-attribute`

### `NETFRAMEWORK = not NETCORE``module-attribute`

### `NO_REVIT = -1``module-attribute`

### `REVIT_NETCORE_VERSION = 2025``module-attribute`

### `safe_strtype = str``module-attribute`

## Functions

### `get_elementid_value_func()`

Returns the ElementId value extraction function based on the Revit version.

Follows API changes in Revit 2024.

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `function` |  | A function returns the value of an ElementId. |

Examples:

```md-code__content
get_elementid_value = get_elementid_value_func()
sheet_revids = {get_elementid_value(x) for x in self.revit_sheet.GetAllRevisionIds()}
add_sheet_revids = {get_elementid_value(x) x in self.revit_sheet.GetAdditionalRevisionIds()}

```

Source code in `pyrevitlib/pyrevit/compat.py`

|     |     |
| --- | --- |
| ```<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>``` | ````md-code__content<br>def get_elementid_value_func():<br>    """Returns the ElementId value extraction function based on the Revit version.<br>    Follows API changes in Revit 2024.<br>    Returns:<br>        function: A function returns the value of an ElementId.<br>    Examples:<br>        ```python<br>        get_elementid_value = get_elementid_value_func()<br>        sheet_revids = {get_elementid_value(x) for x in self.revit_sheet.GetAllRevisionIds()}<br>        add_sheet_revids = {get_elementid_value(x) x in self.revit_sheet.GetAdditionalRevisionIds()}<br>        ```<br>    """<br>    def get_value_post2024(item):<br>        return item.Value<br>    def get_value_pre2024(item):<br>        return item.IntegerValue<br>    return get_value_post2024 if _get_revit_version() > 2023 else get_value_pre2024<br>```` |

### `urlopen(url)`

Urlopen wrapper.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `url` | `str` | request url | _required_ |

Source code in `pyrevitlib/pyrevit/compat.py`

|     |     |
| --- | --- |
| ```<br>90<br>91<br>92<br>93<br>94<br>95<br>96<br>97<br>98<br>``` | ```md-code__content<br>def urlopen(url):<br>    """Urlopen wrapper.<br>    Args:<br>        url (str): request url<br>    """<br>    if PY3:<br>        return urllib.request.urlopen(url)<br>    return urllib2.urlopen(url)<br>``` |

### `make_request(url, headers, data)`

Urlopen wrapper to create and send a request.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `url` | `str` | request url | _required_ |
| `headers` | `dict[str, str]` | headers | _required_ |
| `data` | `bytes | None` | request data | _required_ |

Source code in `pyrevitlib/pyrevit/compat.py`

|     |     |
| --- | --- |
| ```<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>``` | ```md-code__content<br>def make_request(url, headers, data):<br>    """Urlopen wrapper to create and send a request.<br>    Args:<br>        url (str): request url<br>        headers (dict[str, str]): headers<br>        data (bytes | None): request data<br>    """<br>    if PY3:<br>        req = urllib.request.Request(url, headers, data)<br>        urllib.request.urlopen(req).close()<br>        return<br>    req = urllib2.Request(url, headers, data)<br>    urllib2.urlopen(req).close()<br>``` |

Back to top

## pyRevit Telemetry
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/telemetry/#pyrevit.telemetry)

# telemetry

This module manages the telemetry system.

This function is used to setup the telemetry system on pyRevit startup

```md-code__content
setup_telemetry()

```

These functions are used to query information about the logging system

```md-code__content
get_telemetry_state()

```

```md-code__content
get_apptelemetry_state()

```

This module also provides a wrapper class around the command results
dictionary that is included with the telemetry record.

Scripts should use the instance of this class provided by the
script module. See `script.get_results()` for examples

## Attributes

### `FILE_LOG_EXT = 'json'``module-attribute`

### `FILE_LOG_FILENAME_TEMPLATE = '{}_{}_telemetry.{}'``module-attribute`

### `mlogger = get_logger(__name__)``module-attribute`

### `consts = PyRevit.PyRevitConsts``module-attribute`

## Functions

### `get_default_telemetry_filepath()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>53<br>54<br>``` | ```md-code__content<br>def get_default_telemetry_filepath():<br>    return PYREVIT_VERSION_APP_DIR<br>``` |

### `get_telemetry_state()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>57<br>58<br>``` | ```md-code__content<br>def get_telemetry_state():<br>    return envvars.get_pyrevit_env_var(envvars.TELEMETRYSTATE_ENVVAR)<br>``` |

### `get_telemetry_utc_timestamp()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>61<br>62<br>``` | ```md-code__content<br>def get_telemetry_utc_timestamp():<br>    return envvars.get_pyrevit_env_var(envvars.TELEMETRYUTCTIMESTAMPS_ENVVAR)<br>``` |

### `get_telemetry_file_dir()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>65<br>66<br>``` | ```md-code__content<br>def get_telemetry_file_dir():<br>    return envvars.get_pyrevit_env_var(envvars.TELEMETRYDIR_ENVVAR)<br>``` |

### `get_telemetry_file_path()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>69<br>70<br>``` | ```md-code__content<br>def get_telemetry_file_path():<br>    return envvars.get_pyrevit_env_var(envvars.TELEMETRYFILE_ENVVAR)<br>``` |

### `get_telemetry_server_url()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>73<br>74<br>``` | ```md-code__content<br>def get_telemetry_server_url():<br>    return envvars.get_pyrevit_env_var(envvars.TELEMETRYSERVER_ENVVAR)<br>``` |

### `get_telemetry_include_hooks()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>77<br>78<br>``` | ```md-code__content<br>def get_telemetry_include_hooks():<br>    return envvars.get_pyrevit_env_var(envvars.TELEMETRYINCLUDEHOOKS_ENVVAR)<br>``` |

### `set_telemetry_state(state)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>81<br>82<br>83<br>``` | ```md-code__content<br>def set_telemetry_state(state):<br>    envvars.set_pyrevit_env_var(envvars.TELEMETRYSTATE_ENVVAR, state)<br>    user_config.telemetry_status = state<br>``` |

### `set_telemetry_utc_timestamp(state)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>86<br>87<br>88<br>``` | ```md-code__content<br>def set_telemetry_utc_timestamp(state):<br>    envvars.set_pyrevit_env_var(envvars.TELEMETRYUTCTIMESTAMPS_ENVVAR, state)<br>    user_config.telemetry_utc_timestamp = state<br>``` |

### `set_telemetry_file_dir(file_dir)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>91<br>92<br>93<br>94<br>95<br>``` | ```md-code__content<br>def set_telemetry_file_dir(file_dir):<br>    if not file_dir or not op.isdir(file_dir):<br>        disable_telemetry_to_file()<br>    envvars.set_pyrevit_env_var(envvars.TELEMETRYDIR_ENVVAR, file_dir)<br>    user_config.telemetry_file_dir = file_dir<br>``` |

### `set_telemetry_file_path(file_path)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>98<br>99<br>``` | ```md-code__content<br>def set_telemetry_file_path(file_path):<br>    envvars.set_pyrevit_env_var(envvars.TELEMETRYFILE_ENVVAR, file_path)<br>``` |

### `set_telemetry_server_url(server_url)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>102<br>103<br>104<br>``` | ```md-code__content<br>def set_telemetry_server_url(server_url):<br>    envvars.set_pyrevit_env_var(envvars.TELEMETRYSERVER_ENVVAR, server_url)<br>    user_config.telemetry_server_url = server_url<br>``` |

### `set_telemetry_include_hooks(state)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>107<br>108<br>109<br>``` | ```md-code__content<br>def set_telemetry_include_hooks(state):<br>    envvars.set_pyrevit_env_var(envvars.TELEMETRYINCLUDEHOOKS_ENVVAR, state)<br>    user_config.telemetry_include_hooks = state<br>``` |

### `disable_telemetry()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>112<br>113<br>``` | ```md-code__content<br>def disable_telemetry():<br>    set_telemetry_state(False)<br>``` |

### `disable_telemetry_to_file()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>116<br>117<br>``` | ```md-code__content<br>def disable_telemetry_to_file():<br>    set_telemetry_file_path('')<br>``` |

### `disable_telemetry_to_server()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>120<br>121<br>``` | ```md-code__content<br>def disable_telemetry_to_server():<br>    set_telemetry_server_url('')<br>``` |

### `get_apptelemetry_state()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>124<br>125<br>``` | ```md-code__content<br>def get_apptelemetry_state():<br>    return envvars.get_pyrevit_env_var(envvars.APPTELEMETRYSTATE_ENVVAR)<br>``` |

### `set_apptelemetry_state(state)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>128<br>129<br>130<br>``` | ```md-code__content<br>def set_apptelemetry_state(state):<br>    envvars.set_pyrevit_env_var(envvars.APPTELEMETRYSTATE_ENVVAR, state)<br>    user_config.apptelemetry_status = state<br>``` |

### `get_apptelemetry_handler()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>133<br>134<br>``` | ```md-code__content<br>def get_apptelemetry_handler():<br>    return envvars.get_pyrevit_env_var(envvars.APPTELEMETRYHANDLER_ENVVAR)<br>``` |

### `set_apptelemetry_handler(handler)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>137<br>138<br>``` | ```md-code__content<br>def set_apptelemetry_handler(handler):<br>    envvars.set_pyrevit_env_var(envvars.APPTELEMETRYHANDLER_ENVVAR, handler)<br>``` |

### `get_apptelemetry_server_url()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>141<br>142<br>``` | ```md-code__content<br>def get_apptelemetry_server_url():<br>    return envvars.get_pyrevit_env_var(envvars.APPTELEMETRYSERVER_ENVVAR)<br>``` |

### `get_apptelemetry_event_flags()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>145<br>146<br>147<br>148<br>149<br>``` | ```md-code__content<br>def get_apptelemetry_event_flags():<br>    # default value is 16 bytes of 0<br>    flags_hex = \<br>        user_config.apptelemetry_event_flags or '0x00000000000000000000000000000000'<br>    return coreutils.hex2int_long(flags_hex)<br>``` |

### `set_apptelemetry_server_url(server_url)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>152<br>153<br>154<br>``` | ```md-code__content<br>def set_apptelemetry_server_url(server_url):<br>    envvars.set_pyrevit_env_var(envvars.APPTELEMETRYSERVER_ENVVAR, server_url)<br>    user_config.apptelemetry_server_url = server_url<br>``` |

### `set_apptelemetry_event_flags(event_flags)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>157<br>158<br>159<br>160<br>161<br>``` | ```md-code__content<br>def set_apptelemetry_event_flags(event_flags):<br>    flags_hex = coreutils.int2hex_long(event_flags)<br>    user_config.apptelemetry_event_flags = flags_hex<br>    envvars.set_pyrevit_env_var(<br>        envvars.APPTELEMETRYEVENTFLAGS_ENVVAR, flags_hex)<br>``` |

### `disable_apptelemetry()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>164<br>165<br>``` | ```md-code__content<br>def disable_apptelemetry():<br>    set_apptelemetry_state(False)<br>``` |

### `disable_apptelemetry_to_server()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>168<br>169<br>``` | ```md-code__content<br>def disable_apptelemetry_to_server():<br>    set_apptelemetry_server_url('')<br>``` |

### `get_apptelemetry_event_types()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>172<br>173<br>``` | ```md-code__content<br>def get_apptelemetry_event_types():<br>    return list(coreutils.get_enum_values(EventType))<br>``` |

### `get_apptelemetry_event_state(flags, event_type)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>176<br>177<br>178<br>``` | ```md-code__content<br>def get_apptelemetry_event_state(flags, event_type):<br>    event_idx = get_apptelemetry_event_types().index(event_type)<br>    return flags & (1<<event_idx)<br>``` |

### `set_apptelemetry_event_state(flags, event_type)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>181<br>182<br>``` | ```md-code__content<br>def set_apptelemetry_event_state(flags, event_type):<br>    return flags | (1<<int(event_type))<br>``` |

### `unset_apptelemetry_event_state(flags, event_type)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>185<br>186<br>``` | ```md-code__content<br>def unset_apptelemetry_event_state(flags, event_type):<br>    return flags & ~(1<<int(event_type))<br>``` |

### `get_status_from_url(server_url)`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>``` | ```md-code__content<br>def get_status_from_url(server_url):<br>    server_url = server_url.lower()<br>    if server_url.endswith('scripts/'):<br>        server_url = server_url.replace('scripts/', 'status')<br>    elif server_url.endswith('events/'):<br>        server_url = server_url.replace('events/', 'status')<br>    try:<br>        return json.loads(urlopen(server_url).read())<br>    except Exception:<br>        return None<br>``` |

### `get_status()`

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>210<br>211<br>212<br>213<br>214<br>``` | ```md-code__content<br>def get_status():<br>    return get_status_from_url(<br>        get_telemetry_server_url()<br>        or get_apptelemetry_server_url()<br>        )<br>``` |

### `setup_telemetry(session_id=None)`

Sets up the telemetry default config and environment values.

Source code in `pyrevitlib/pyrevit/telemetry/__init__.py`

|     |     |
| --- | --- |
| ```<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>``` | ```md-code__content<br>def setup_telemetry(session_id=None):<br>    """Sets up the telemetry default config and environment values."""<br>    # make sure session id is availabe<br>    if not session_id:<br>        session_id = sessioninfo.get_session_uuid()<br>    # PYREVIT TELEMETRY -------------------------------------------------------<br>    # utc timestamp<br>    telemetry_utc_timestamp = user_config.telemetry_utc_timestamp<br>    set_telemetry_utc_timestamp(telemetry_utc_timestamp)<br>    # global telemetry toggle<br>    telemetry_state = user_config.telemetry_status<br>    set_telemetry_state(telemetry_state)<br>    # read or setup default values for file telemetry<br>    # default file path and name for telemetry<br>    telemetry_file_dir = user_config.telemetry_file_dir<br>    set_telemetry_file_dir(telemetry_file_dir)<br>    # check file telemetry config and setup destination<br>    if not telemetry_file_dir or coreutils.is_blank(telemetry_file_dir):<br>        # if no config is provided, disable output<br>        disable_telemetry_to_file()<br>    # if config exists, create new telemetry file under the same address<br>    elif telemetry_state:<br>        if op.isdir(telemetry_file_dir):<br>            telemetry_file_name = \<br>                FILE_LOG_FILENAME_TEMPLATE.format(PYREVIT_FILE_PREFIX,<br>                                                  session_id,<br>                                                  FILE_LOG_EXT)<br>            # if directory is valid<br>            telemetry_fullfilepath = \<br>                op.join(telemetry_file_dir, telemetry_file_name)<br>            set_telemetry_file_path(telemetry_fullfilepath)<br>            # setup telemetry file or disable if failed<br>            try:<br>                _setup_default_logfile(telemetry_fullfilepath)<br>            except Exception as write_err:<br>                mlogger.error('Telemetry is active but log file location '<br>                              'is not accessible. | %s', write_err)<br>                disable_telemetry_to_file()<br>        else:<br>            # if not, show error and disable telemetry<br>            mlogger.error('Provided telemetry address does not exits or is '<br>                          'not a directory. Telemetry disabled.')<br>            disable_telemetry_to_file()<br>    # read or setup default values for server telemetry<br>    telemetry_server_url = user_config.telemetry_server_url<br>    # check server telemetry config and setup destination<br>    if not telemetry_server_url or coreutils.is_blank(telemetry_server_url):<br>        # if no config is provided, disable output<br>        disable_telemetry_to_server()<br>    else:<br>        # if config exists, setup server logging<br>        set_telemetry_server_url(telemetry_server_url)<br>    # set telemetry script types<br>    set_telemetry_include_hooks(user_config.telemetry_include_hooks)<br>    # APP TELEMETRY ------------------------------------------------------------<br>    # setup default value for telemetry global switch<br>    apptelemetry_state = user_config.apptelemetry_status<br>    set_apptelemetry_state(apptelemetry_state)<br>    # read or setup default values for server telemetry<br>    apptelemetry_server_url = user_config.apptelemetry_server_url<br>    # check server telemetry config and setup destination<br>    if not apptelemetry_server_url \<br>            or coreutils.is_blank(apptelemetry_server_url):<br>        # if no config is provided, disable output<br>        disable_apptelemetry_to_server()<br>    else:<br>        # if config exists, setup server logging<br>        set_apptelemetry_server_url(apptelemetry_server_url)<br>    # setup events<br>    new_telemetry_handler = EventTelemetry(session_id, HOST_APP.username)<br>    telemetry_handler = get_apptelemetry_handler()<br>    if telemetry_handler:<br>        # clear existing<br>        telemetry_events.unregister_all_event_telemetries(telemetry_handler)<br>    set_apptelemetry_handler(new_telemetry_handler)<br>    # register handlers only if telemetry system is active<br>    if apptelemetry_state:<br>        apptelemetry_event_flags = get_apptelemetry_event_flags()<br>        # re-register events with new telemetry_handler<br>        telemetry_events.register_event_telemetry(<br>            new_telemetry_handler,<br>            apptelemetry_event_flags<br>        )<br>    user_config.save_changes()<br>``` |

Back to top

## PyRevit Revit Wrapper
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/#pyrevit.revit)

# revit

Revit application wrapper.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Classes

### `BaseWrapper(obj=None)`

Bases: `object`

Base revit databse object wrapper.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>``` | ```md-code__content<br>def __init__(self, obj=None):<br>    self._wrapped = obj<br>``` |

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

### `ElementWrapper(element)`

Bases: `BaseWrapper`

Revit element wrapper.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>62<br>63<br>64<br>65<br>66<br>``` | ```md-code__content<br>def __init__(self, element):<br>    super(ElementWrapper, self).__init__(element)<br>    if not isinstance(self._wrapped, DB.Element):<br>        raise PyRevitException('Can not wrap object that are not '<br>                               'derived from Element.')<br>``` |

#### Attributes

##### `assoc_doc``property`

##### `name``property`

##### `symbol_name``property`

##### `family_name``property`

##### `id``property`

##### `unique_id``property`

##### `workset_id``property`

##### `mark``property`

##### `location``property`

##### `x``property`

##### `y``property`

##### `z``property`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

##### `get_param(param_name)`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>126<br>127<br>``` | ```md-code__content<br>def get_param(self, param_name):<br>    return self._wrapped.LookupParameter(param_name)<br>``` |

##### `safe_get_param(param_name, default=None)`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>129<br>130<br>131<br>132<br>133<br>``` | ```md-code__content<br>def safe_get_param(self, param_name, default=None):<br>    try:<br>        return self._wrapped.LookupParameter(param_name)<br>    except Exception:<br>        return default<br>``` |

### `ExternalRef(link, extref)`

Bases: `ElementWrapper`

External reference wraper.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>138<br>139<br>140<br>``` | ```md-code__content<br>def __init__(self, link, extref):<br>    super(ExternalRef, self).__init__(link)<br>    self._extref = extref<br>``` |

#### Attributes

##### `assoc_doc``property`

##### `symbol_name``property`

##### `family_name``property`

##### `id``property`

##### `unique_id``property`

##### `workset_id``property`

##### `mark``property`

##### `location``property`

##### `x``property`

##### `y``property`

##### `z``property`

##### `name``property`

##### `link``property`

##### `linktype``property`

##### `path``property`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

##### `get_param(param_name)`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>126<br>127<br>``` | ```md-code__content<br>def get_param(self, param_name):<br>    return self._wrapped.LookupParameter(param_name)<br>``` |

##### `safe_get_param(param_name, default=None)`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>129<br>130<br>131<br>132<br>133<br>``` | ```md-code__content<br>def safe_get_param(self, param_name, default=None):<br>    try:<br>        return self._wrapped.LookupParameter(param_name)<br>    except Exception:<br>        return default<br>``` |

##### `reload()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>159<br>160<br>``` | ```md-code__content<br>def reload(self):<br>    return self._wrapped.Reload()<br>``` |

### `ProjectParameter(param_def, param_binding=None, param_ext_def=False)`

Bases: `BaseWrapper`

Project parameter wrapper.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>``` | ```md-code__content<br>def __init__(self, param_def, param_binding=None, param_ext_def=False):<br>    super(ProjectParameter, self).__init__()<br>    self.param_def = param_def<br>    self.param_binding = param_binding<br>    self.param_binding_type = self._determine_binding_type()<br>    self.shared = False<br>    self.param_ext_def = None<br>    self.param_guid = ''<br>    if param_ext_def:<br>        self.shared = True<br>        self.param_ext_def = param_ext_def<br>        self.param_guid = self.param_ext_def.GUID.ToString()<br>    self.name = self.param_def.Name<br>    # Revit <2017 does not have the Id parameter<br>    self.param_id = getattr(self.param_def, 'Id', None)<br>    if HOST_APP.is_exactly(2021):<br>        # Revit >2021 does not have the UnitType property<br>        self.unit_type = self.param_def.GetSpecTypeId()<br>        self.param_type = self.param_def.ParameterType<br>        self.param_group = self.param_def.ParameterGroup<br>    elif HOST_APP.is_newer_than(2022, or_equal=True):<br>        # GetSpecTypeId() Removed in Revit 2022<br>        self.unit_type = self.param_def.GetDataType()<br>        # Revit >2022 does not have the ParameterType property<br>        self.param_type = self.param_def.GetDataType()<br>        # ParameterGroup deprecated<br>        self.param_group = self.param_def.GetGroupTypeId().TypeId<br>    else:<br>        self.unit_type = self.param_def.UnitType<br>        self.param_type = self.param_def.ParameterType<br>        self.param_group = self.param_def.ParameterGroup<br>``` |

#### Attributes

##### `param_def = param_def``instance-attribute`

##### `param_binding = param_binding``instance-attribute`

##### `param_binding_type = self._determine_binding_type()``instance-attribute`

##### `shared = False``instance-attribute`

##### `param_ext_def = None``instance-attribute`

##### `param_guid = ''``instance-attribute`

##### `name = self.param_def.Name``instance-attribute`

##### `param_id = getattr(self.param_def, 'Id', None)``instance-attribute`

##### `unit_type = self.param_def.GetSpecTypeId()``instance-attribute`

##### `param_type = self.param_def.ParameterType``instance-attribute`

##### `param_group = self.param_def.ParameterGroup``instance-attribute`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

### `ProjectInfo(doc)`

Bases: `BaseWrapper`

Project information.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>221<br>222<br>223<br>``` | ```md-code__content<br>def __init__(self, doc):<br>    super(ProjectInfo, self).__init__()<br>    self._doc = doc<br>``` |

#### Attributes

##### `name``property`

##### `number``property`

##### `address``property`

##### `author``property`

##### `building_name``property`

##### `client_name``property`

##### `issue_date``property`

##### `org_name``property`

##### `org_desc``property`

##### `status``property`

##### `location``property`

##### `path``property`

##### `filename``property`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

### `XYZPoint(obj=None)`

Bases: `BaseWrapper`

Wrapper for XYZ point.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>``` | ```md-code__content<br>def __init__(self, obj=None):<br>    self._wrapped = obj<br>``` |

#### Attributes

##### `x``property`

##### `y``property`

##### `z``property`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

### `Transaction(name=None, doc=None, clear_after_rollback=False, show_error_dialog=False, swallow_errors=False, log_errors=True, nested=False)`

Adds a context manager around Revit Transaction object.

Runs `Transaction.Start()` and `Transaction.Commit()`
before and after the context.
Automatically rolls back if exception is raised.

\`\`\`python
with Transaction('Move Wall'):
wall.DoSomething()

````
with Transaction('Move Wall', doc, clear_after_rollback=False, show_error_dialog=False, swallow_errors=False, log_errors=True, nested=False)) as action:
    wall.DoSomething()
    assert action.status == ActionStatus.Started  # True
    assert action.status == ActionStatus.Committed    # True
```

````

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>``` | ```md-code__content<br>def __init__(self, name=None,<br>             doc=None,<br>             clear_after_rollback=False,<br>             show_error_dialog=False,<br>             swallow_errors=False,<br>             log_errors=True,<br>             nested=False):<br>    doc = doc or DOCS.doc<br>    # create nested transaction if one is already open<br>    if doc.IsModifiable or nested:<br>        self._rvtxn = \<br>            DB.SubTransaction(doc)<br>    else:<br>        self._rvtxn = \<br>            DB.Transaction(doc, name if name else DEFAULT_TRANSACTION_NAME)<br>        self._fhndlr_ops = self._rvtxn.GetFailureHandlingOptions()<br>        self._fhndlr_ops = \<br>            self._fhndlr_ops.SetClearAfterRollback(clear_after_rollback)<br>        self._fhndlr_ops = \<br>            self._fhndlr_ops.SetForcedModalHandling(show_error_dialog)<br>        if swallow_errors:<br>            self._fhndlr_ops = \<br>                self._fhndlr_ops.SetFailuresPreprocessor(<br>                    failure.FailureSwallower()<br>                    )<br>        self._rvtxn.SetFailureHandlingOptions(self._fhndlr_ops)<br>    self._logerror = log_errors<br>``` |

#### Attributes

##### `name``property``writable`

##### `status``property`

#### Functions

##### `has_started()`

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br> 99<br>100<br>``` | ```md-code__content<br>def has_started(self):<br>    return self._rvtxn.HasStarted()<br>``` |

##### `has_ended()`

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br>102<br>103<br>``` | ```md-code__content<br>def has_ended(self):<br>    return self._rvtxn.HasEnded()<br>``` |

### `DryTransaction(name=None, doc=None, clear_after_rollback=False, show_error_dialog=False, swallow_errors=False, log_errors=True, nested=False)`

Bases: `Transaction`

Wrapper to a transaction that doesn't commit anything (dry-run).

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>``` | ```md-code__content<br>def __init__(self, name=None,<br>             doc=None,<br>             clear_after_rollback=False,<br>             show_error_dialog=False,<br>             swallow_errors=False,<br>             log_errors=True,<br>             nested=False):<br>    doc = doc or DOCS.doc<br>    # create nested transaction if one is already open<br>    if doc.IsModifiable or nested:<br>        self._rvtxn = \<br>            DB.SubTransaction(doc)<br>    else:<br>        self._rvtxn = \<br>            DB.Transaction(doc, name if name else DEFAULT_TRANSACTION_NAME)<br>        self._fhndlr_ops = self._rvtxn.GetFailureHandlingOptions()<br>        self._fhndlr_ops = \<br>            self._fhndlr_ops.SetClearAfterRollback(clear_after_rollback)<br>        self._fhndlr_ops = \<br>            self._fhndlr_ops.SetForcedModalHandling(show_error_dialog)<br>        if swallow_errors:<br>            self._fhndlr_ops = \<br>                self._fhndlr_ops.SetFailuresPreprocessor(<br>                    failure.FailureSwallower()<br>                    )<br>        self._rvtxn.SetFailureHandlingOptions(self._fhndlr_ops)<br>    self._logerror = log_errors<br>``` |

#### Attributes

##### `name``property``writable`

##### `status``property`

#### Functions

##### `has_started()`

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br> 99<br>100<br>``` | ```md-code__content<br>def has_started(self):<br>    return self._rvtxn.HasStarted()<br>``` |

##### `has_ended()`

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br>102<br>103<br>``` | ```md-code__content<br>def has_ended(self):<br>    return self._rvtxn.HasEnded()<br>``` |

### `TransactionGroup(name=None, doc=None, assimilate=True, log_errors=True)`

Transactions group with context manager.

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br>115<br>116<br>117<br>118<br>119<br>120<br>``` | ```md-code__content<br>def __init__(self, name=None, doc=None, assimilate=True, log_errors=True):<br>    self._rvtxn_grp = \<br>        DB.TransactionGroup(doc or DOCS.doc,<br>                            name if name else DEFAULT_TRANSACTION_NAME)<br>    self.assimilate = assimilate<br>    self._logerror = log_errors<br>``` |

#### Attributes

##### `assimilate = assimilate``instance-attribute`

##### `name``property``writable`

##### `status``property`

#### Functions

##### `has_started()`

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br>158<br>159<br>``` | ```md-code__content<br>def has_started(self):<br>    return self._rvtxn_grp.HasStarted()<br>``` |

##### `has_ended()`

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br>161<br>162<br>``` | ```md-code__content<br>def has_ended(self):<br>    return self._rvtxn_grp.HasEnded()<br>``` |

### `RevitWrapper()`

Bases: `ModuleType`

Revit application wrapper.

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>55<br>56<br>``` | ```md-code__content<br>def __init__(self):<br>    pass<br>``` |

#### Attributes

##### `uidoc``property`

Active UI Document.

##### `doc``property`

Active document.

##### `docs``property`

Active documents.

##### `active_view``property``writable`

Active view.

##### `active_ui_view``property`

Active UI view.

##### `servers``property`

Available revit server names.

#### Functions

##### `open_doc(doc_path)``staticmethod`

Open document at given path.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc_path` | `str` | document file path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Document` | opened document |

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>``` | ```md-code__content<br>@staticmethod<br>def open_doc(doc_path):<br>    """Open document at given path.<br>    Args:<br>        doc_path (str): document file path<br>    Returns:<br>        (DB.Document): opened document<br>    """<br>    return HOST_APP.app.OpenDocumentFile(doc_path)<br>``` |

##### `close_doc(doc)``staticmethod`

Close given document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | document | _required_ |

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>``` | ```md-code__content<br>@staticmethod<br>def close_doc(doc):<br>    """Close given document.<br>    Args:<br>        doc (DB.Document): document<br>    """<br>    return doc.Close()<br>``` |

##### `post_command(command_id)``staticmethod`

Request Revit to run a command.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `command_id` | `str` | command identifier e.g. ID\_REVIT\_SAVE\_AS\_TEMPLATE | _required_ |

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>``` | ```md-code__content<br>@staticmethod<br>def post_command(command_id):<br>    """Request Revit to run a command.<br>    Args:<br>        command_id (str): command identifier e.g. ID_REVIT_SAVE_AS_TEMPLATE<br>    """<br>    HOST_APP.post_command(command_id)<br>``` |

### `ErrorSwallower(log_errors=True)`

Suppresses warnings during script execution.

Examples:

```md-code__content
with ErrorSwallower() as swallower:
    for fam in families:
        revit.doc.EditFamily(fam)
        if swallower.get_swallowed():
            logger.warn("Warnings swallowed")

```

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>150<br>151<br>152<br>``` | ```md-code__content<br>def __init__(self, log_errors=True):<br>    self._fswallower = failure.FailureSwallower()<br>    self._logerror = log_errors<br>``` |

#### Functions

##### `on_failure_processing(_, event_args)`

Failure processing event handler.

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>``` | ```md-code__content<br>def on_failure_processing(self, _, event_args):<br>    """Failure processing event handler."""<br>    try:<br>        failure_accesssor = event_args.GetFailuresAccessor()<br>        mlogger.debug('request for failure processing...')<br>        result = event_args.GetProcessingResult()<br>        mlogger.debug('current failure processing result: %s', result)<br>        result = self._fswallower.preprocess_failures(failure_accesssor)<br>        mlogger.debug('setting failure processing results to: %s', result)<br>        event_args.SetProcessingResult(result)<br>    except Exception as fpex:<br>        mlogger.error('Error occured while processing failures. | %s', fpex)<br>``` |

##### `get_swallowed_errors()`

Return swallowed errors.

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>167<br>168<br>169<br>``` | ```md-code__content<br>def get_swallowed_errors(self):<br>    """Return swallowed errors."""<br>    return self._fswallower.get_swallowed_failures()<br>``` |

##### `reset()`

Reset swallowed errors.

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>171<br>172<br>173<br>``` | ```md-code__content<br>def reset(self):<br>    """Reset swallowed errors."""<br>    self._fswallower.reset()<br>``` |

## Functions

### `carryout(name, doc=None)`

Transaction Decorator.

Decorate any function with `@doc.carryout('Txn name')`
and the funciton will run within an Transaction context.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `name` | `str` | Name of the Transaction | _required_ |
| `doc` | `Document` | Revit document | `None` |

```md-code__content
@doc.carryout('Do Something')
def set_some_parameter(wall, value):
    wall.parameters['Comments'].value = value

set_some_parameter(wall, value)

```

Source code in `pyrevitlib/pyrevit/revit/db/transaction.py`

|     |     |
| --- | --- |
| ```<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>``` | ````md-code__content<br>def carryout(name, doc=None):<br>    """Transaction Decorator.<br>    Decorate any function with ``@doc.carryout('Txn name')``<br>    and the funciton will run within an Transaction context.<br>    Args:<br>        name (str): Name of the Transaction<br>        doc (Document): Revit document<br>    ```python<br>    @doc.carryout('Do Something')<br>    def set_some_parameter(wall, value):<br>        wall.parameters['Comments'].value = value<br>    set_some_parameter(wall, value)<br>    ```<br>    """<br>    from functools import wraps<br>    def wrap(f):<br>        @wraps(f)<br>        def wrapped_f(*args, **kwargs):<br>            with Transaction(name, doc=doc):<br>                return_value = f(*args, **kwargs)<br>            return return_value<br>        return wrapped_f<br>    return wrap<br>```` |

### `serialize(api_object)`

Source code in `pyrevitlib/pyrevit/revit/db/pickling.py`

|     |     |
| --- | --- |
| ```<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>``` | ```md-code__content<br>def serialize(api_object):<br>    mlogger.debug('Attemping to serialize: %s', api_object)<br>    # wrap none in a none serializer for none values<br>    if api_object is None:<br>        return NoneSerializer()<br>    # make sure given type is a Revit API type<br>    if not api.is_api_object(api_object):<br>        raise PyRevitException("Only Revit API types are supported.")<br>    # get available serializers<br>    serializers = coreutils.get_all_subclasses(<br>        [Serializable, EnumSerializable]<br>        )<br>    # pick the compatible serializer<br>    try:<br>        compatible_serializer = \<br>            next(<br>                x for x in serializers<br>                if x.api_types and isinstance(api_object, x.api_types)<br>                )<br>        mlogger.debug('Serializer found for: %s', api_object)<br>        return compatible_serializer(api_object)<br>    except StopIteration:<br>        mlogger.debug('Serializer not found for: %s', api_object)<br>        # if no deserializer found,<br>        # see if given data is iterable<br>        # NOTE: commented this out since .serialize should only get api objects<br>        # if isinstance(api_object, Iterable):<br>        #     mlogger.debug('Iterating over: %s', api_object)<br>        #     return _serialize_items(api_object)<br>        # otherwise throw an exception<br>        raise PyRevitException(<br>            "No serializers have been implemented for \"%s\"" % repr(api_object)<br>            )<br>``` |

### `deserialize(python_object)`

Source code in `pyrevitlib/pyrevit/revit/db/pickling.py`

|     |     |
| --- | --- |
| ```<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>``` | ```md-code__content<br>def deserialize(python_object):<br>    if isinstance(python_object, Iterable):<br>        result_list = []<br>        for python_item in python_object:<br>            result_list.append(deserialize(python_item))<br>        return result_list<br>    if isinstance(python_object, Serializable):<br>        return python_object.deserialize()<br>``` |

### `get_journals_folder()`

Source code in `pyrevitlib/pyrevit/revit/journals.py`

|     |     |
| --- | --- |
| ```<br>12<br>13<br>``` | ```md-code__content<br>def get_journals_folder():<br>    return op.dirname(HOST_APP.app.RecordingJournalFilename)<br>``` |

### `get_current_journal_file()`

Source code in `pyrevitlib/pyrevit/revit/journals.py`

|     |     |
| --- | --- |
| ```<br>16<br>17<br>``` | ```md-code__content<br>def get_current_journal_file():<br>    return HOST_APP.app.RecordingJournalFilename<br>``` |

### `get_current_session_id()`

Source code in `pyrevitlib/pyrevit/revit/journals.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>``` | ```md-code__content<br>def get_current_session_id():<br>    re_finder = re.compile(r'.*>Session\s+(\$.{8}).*')<br>    journal_file = get_current_journal_file()<br>    with open(journal_file, "r") as jfile:<br>        for jline in reversed(jfile.readlines()):<br>            match = re_finder.match(jline)<br>            if match:<br>                return match.groups()[0]<br>``` |

### `pick_element(message='')`

Asks the user to pick an element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | An optional message to display. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `Element` | element selected by the user. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>``` | ```md-code__content<br>def pick_element(message=''):<br>    """Asks the user to pick an element.<br>    Args:<br>        message (str): An optional message to display.<br>    Returns:<br>        (Element): element selected by the user.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Element,<br>                     message)<br>``` |

### `pick_element_by_category(cat_name_or_builtin, message='')`

Returns the element of the specified category picked by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_builtin` | `str` | name or built-in category of the element<br>to pick. | _required_ |
| `message` | `str` | message to display on selection.<br>Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `Element` | picked element. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If no category matches the specified name or builtin. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>``` | ```md-code__content<br>def pick_element_by_category(cat_name_or_builtin, message=''):<br>    """Returns the element of the specified category picked by the user.<br>    Args:<br>        cat_name_or_builtin (str): name or built-in category of the element<br>            to pick.<br>        message (str, optional): message to display on selection.<br>            Defaults to ''.<br>    Returns:<br>        (Element): picked element.<br>    Raises:<br>        PyRevitException: If no category matches the specified name or builtin.<br>    """<br>    category = query.get_category(cat_name_or_builtin)<br>    if category:<br>        pick_filter = PickByCategorySelectionFilter(category.Id)<br>        return _pick_obj(UI.Selection.ObjectType.Element,<br>                         message,<br>                         selection_filter=pick_filter)<br>    else:<br>        raise PyRevitException("Can not determine category id from: {}"<br>                               .format(cat_name_or_builtin))<br>``` |

### `pick_elementpoint(message='', world=False)`

Returns the element point selected by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | message to display. Defaults to ''. | `''` |
| `world` | `bool` | whether to use world coordinates. Defaults to False. | `False` |

Returns:

| Type | Description |
| --- | --- |
| `PointOnElement` | The selected point. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>``` | ```md-code__content<br>def pick_elementpoint(message='', world=False):<br>    """Returns the element point selected by the user.<br>    Args:<br>        message (str, optional): message to display. Defaults to ''.<br>        world (bool, optional): whether to use world coordinates. Defaults to False.<br>    Returns:<br>        (PointOnElement): The selected point.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.PointOnElement,<br>                     message,<br>                     world=world)<br>``` |

### `pick_edge(message='')`

Returns the edge selected by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | message to display. Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `Edge` | The selected edge. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def pick_edge(message=''):<br>    """Returns the edge selected by the user.<br>    Args:<br>        message (str, optional): message to display. Defaults to ''.<br>    Returns:<br>        (Edge): The selected edge.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Edge,<br>                     message)<br>``` |

### `pick_face(message='')`

Returns the face selected by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | message to display. Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `Face` | The selected face. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>``` | ```md-code__content<br>def pick_face(message=''):<br>    """Returns the face selected by the user.<br>    Args:<br>        message (str, optional): message to display. Defaults to ''.<br>    Returns:<br>        (Face): The selected face.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Face,<br>                     message)<br>``` |

### `pick_linked(message='')`

Returns the linked element selected by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | message to display. Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `LinkedElement` | The selected linked element. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>``` | ```md-code__content<br>def pick_linked(message=''):<br>    """Returns the linked element selected by the user.<br>    Args:<br>        message (str, optional): message to display. Defaults to ''.<br>    Returns:<br>        (LinkedElement): The selected linked element.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.LinkedElement,<br>                     message)<br>``` |

### `pick_elements(message='')`

Asks the user to pick multiple elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | An optional message to display. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[Element]` | elements selected by the user. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>``` | ```md-code__content<br>def pick_elements(message=''):<br>    """Asks the user to pick multiple elements.<br>    Args:<br>        message (str): An optional message to display.<br>    Returns:<br>        (list[Element]): elements selected by the user.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Element,<br>                     message,<br>                     multiple=True)<br>``` |

### `pick_elements_by_category(cat_name_or_builtin, message='')`

Returns the elements of the specified category picked by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_builtin` | `str` | name or built-in category of the elements<br>to pick. | _required_ |
| `message` | `str` | message to display on selection.<br>Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[Element]` | picked elements. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If no category matches the specified name or builtin. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>``` | ```md-code__content<br>def pick_elements_by_category(cat_name_or_builtin, message=''):<br>    """Returns the elements of the specified category picked by the user.<br>    Args:<br>        cat_name_or_builtin (str): name or built-in category of the elements<br>            to pick.<br>        message (str, optional): message to display on selection.<br>            Defaults to ''.<br>    Returns:<br>        (list[Element]): picked elements.<br>    Raises:<br>        PyRevitException: If no category matches the specified name or builtin.<br>    """<br>    category = query.get_category(cat_name_or_builtin)<br>    if category:<br>        pick_filter = PickByCategorySelectionFilter(category.Id)<br>        return _pick_obj(UI.Selection.ObjectType.Element,<br>                         message,<br>                         multiple=True,<br>                         selection_filter=pick_filter)<br>    else:<br>        raise PyRevitException("Can not determine category id from: {}"<br>                               .format(cat_name_or_builtin))<br>``` |

### `get_picked_elements(message='')`

Allows the user to pick multple elements, one at a time.

It keeps asking the user to pick an element until no elements are selected.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display. Defaults to ''. | `''` |

Yields:

| Type | Description |
| --- | --- |
| `Element` | selected element |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>``` | ```md-code__content<br>def get_picked_elements(message=''):<br>    """Allows the user to pick multple elements, one at a time.<br>    It keeps asking the user to pick an element until no elements are selected.<br>    Args:<br>        message (str, optional): The message to display. Defaults to ''.<br>    Yields:<br>        (DB.Element): selected element<br>    """<br>    picked_element = True<br>    while picked_element:<br>        picked_element = pick_element(message=message)<br>        if not picked_element:<br>            break<br>        yield picked_element<br>``` |

### `get_picked_elements_by_category(cat_name_or_builtin, message='')`

Pick elements by category.

Keeps asking the user to pick an element until no elements are selected.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_builtin` | `str` | category name or built-in category. | _required_ |
| `message` | `str` | message to display while picking elements. | `''` |

Yields:

| Type | Description |
| --- | --- |
| `Element` | The picked elements from the specified category. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>``` | ```md-code__content<br>def get_picked_elements_by_category(cat_name_or_builtin, message=''):<br>    """Pick elements by category.<br>    Keeps asking the user to pick an element until no elements are selected.<br>    Args:<br>        cat_name_or_builtin (str): category name or built-in category.<br>        message (str, optional): message to display while picking elements.<br>    Yields:<br>        (DB.Element): The picked elements from the specified category.<br>    """<br>    picked_element = True<br>    while picked_element:<br>        picked_element = pick_element_by_category(cat_name_or_builtin,<br>                                                  message=message)<br>        if not picked_element:<br>            break<br>        yield picked_element<br>``` |

### `pick_elementpoints(message='', world=False)`

Selects element points.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display when selecting element points. | `''` |
| `world` | `bool` | Select points in world coordinates. Defaults to False. | `False` |

Returns:

| Type | Description |
| --- | --- |
| `list[PointOnElement]` | selected element points. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>383<br>384<br>``` | ```md-code__content<br>def pick_elementpoints(message='', world=False):<br>    """Selects element points.<br>    Args:<br>        message (str): The message to display when selecting element points.<br>        world (bool, optional): Select points in world coordinates. Defaults to False.<br>    Returns:<br>        (list[PointOnElement]): selected element points.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.PointOnElement,<br>                     message,<br>                     multiple=True, world=world)<br>``` |

### `pick_edges(message='')`

Selects edges.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display when selecting edges. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[Edge]` | selected edges. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>387<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>``` | ```md-code__content<br>def pick_edges(message=''):<br>    """Selects edges.<br>    Args:<br>        message (str): The message to display when selecting edges.<br>    Returns:<br>        (list[Edge]): selected edges.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Edge,<br>                     message,<br>                     multiple=True)<br>``` |

### `pick_faces(message='')`

Selects faces.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display when selecting the faces. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[Face]` | selected faces. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>``` | ```md-code__content<br>def pick_faces(message=''):<br>    """Selects faces.<br>    Args:<br>        message (str): The message to display when selecting the faces.<br>    Returns:<br>        (list[Face]): selected faces.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Face,<br>                     message,<br>                     multiple=True)<br>``` |

### `pick_linkeds(message='')`

Selects linked elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display when selecting linked elements. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[LinkedElement]` | selected linked elements. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>def pick_linkeds(message=''):<br>    """Selects linked elements.<br>    Args:<br>        message (str): The message to display when selecting linked elements.<br>    Returns:<br>        (list[LinkedElement]): selected linked elements.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.LinkedElement,<br>                     message,<br>                     multiple=True)<br>``` |

### `pick_point(message='')`

Pick a point from the user interface.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | A message to display when prompting for the point. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `tuple or None` | A tuple representing the picked point as (x, y, z)<br>coordinates, or None if no point was picked or an error occurred. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>``` | ```md-code__content<br>def pick_point(message=''):<br>    """Pick a point from the user interface.<br>    Args:<br>        message (str): A message to display when prompting for the point.<br>    Returns:<br>        (tuple or None): A tuple representing the picked point as (x, y, z)<br>            coordinates, or None if no point was picked or an error occurred.<br>    """<br>    try:<br>        return HOST_APP.uidoc.Selection.PickPoint(message)<br>    except Exception:<br>        return None<br>``` |

### `pick_rectangle(message='', pick_filter=None)`

Picks elements from the user interface by specifying a rectangular area.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | A custom message to display when prompting<br>the user to pick elements. Default is an empty string. | `''` |
| `pick_filter` | `object` | An object specifying the filter to apply<br>when picking elements. Default is None. | `None` |

Returns:

| Type | Description |
| --- | --- |
| `list[ElementId]` | The selected elements. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>456<br>457<br>458<br>459<br>460<br>461<br>``` | ```md-code__content<br>def pick_rectangle(message='', pick_filter=None):<br>    """Picks elements from the user interface by specifying a rectangular area.<br>    Args:<br>        message (str, optional): A custom message to display when prompting<br>            the user to pick elements. Default is an empty string.<br>        pick_filter (object, optional): An object specifying the filter to apply<br>            when picking elements. Default is None.<br>    Returns:<br>        (list[DB.ElementId]): The selected elements.<br>    """<br>    if pick_filter:<br>        return HOST_APP.uidoc.Selection.PickElementsByRectangle(pick_filter,<br>                                                                message)<br>    else:<br>        return HOST_APP.uidoc.Selection.PickElementsByRectangle(message)<br>``` |

### `get_selection_category_set()`

Returns a CategorySet with the categories of the selected elements.

Returns:

| Type | Description |
| --- | --- |
| `CategorySet` | categories of the selected elements. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>472<br>473<br>474<br>``` | ```md-code__content<br>def get_selection_category_set():<br>    """Returns a CategorySet with the categories of the selected elements.<br>    Returns:<br>        (CategorySet): categories of the selected elements.<br>    """<br>    selection = ElementSelection()<br>    cset = DB.CategorySet()<br>    for element in selection:<br>        cset.Insert(element.Category)<br>    return cset<br>``` |

### `get_selection()`

Returns the current selected items.

Returns:

| Type | Description |
| --- | --- |
| `ElementSelection` | the current selected items |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>``` | ```md-code__content<br>def get_selection():<br>    """Returns the current selected items.<br>    Returns:<br>        (ElementSelection): the current selected items<br>    """<br>    return ElementSelection()<br>``` |

### `get_imported_symbol(symbol_name)`

Geth an imported symbol by its name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `symbol_name` | `str` | symbol name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Any` | imported symbol, if found, None otherwise. |

Source code in `pyrevitlib/pyrevit/revit/__init__.py`

|     |     |
| --- | --- |
| ```<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>``` | ```md-code__content<br>def get_imported_symbol(symbol_name):<br>    """Geth an imported symbol by its name.<br>    Args:<br>        symbol_name (str): symbol name<br>    Returns:<br>        (Any): imported symbol, if found, None otherwise.<br>    """<br>    return globals().get(symbol_name, None)<br>``` |

 Back to top

## PyRevit Runtime Module
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/#pyrevit.runtime)

# runtime

Module that compiles the base DLL on load.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `INTERFACE_TYPES_DIR = RUNTIME_DIR``module-attribute`

### `DOTNET_DIR = op.join(os.getenv('windir'), 'Microsoft.NET', 'Framework')``module-attribute`

### `DOTNET64_DIR = op.join(os.getenv('windir'), 'Microsoft.NET', 'Framework64')``module-attribute`

### `DOTNET_SDK_DIR = op.join(os.getenv('programfiles(x86)'), 'Reference Assemblies', 'Microsoft', 'Framework', '.NETFramework')``module-attribute`

### `DOTNET_FRAMEWORK_DIRS = sorted([x for x in os.listdir(DOTNET_DIR) if x.startswith('v4.') and 'X' not in x], reverse=True)``module-attribute`

### `DOTNET64_FRAMEWORK_DIRS = sorted([x for x in os.listdir(DOTNET64_DIR) if x.startswith('v4.') and 'X' not in x], reverse=True)``module-attribute`

### `DOTNET_TARGETPACK_DIRS = sorted([x for x in os.listdir(DOTNET_SDK_DIR) if x.startswith('v4.') and 'X' not in x], reverse=True)``module-attribute`

### `RUNTIME_NAMESPACE = 'PyRevitLabs.PyRevit.Runtime'``module-attribute`

### `CMD_EXECUTOR_TYPE_NAME = '{}.{}'.format(RUNTIME_NAMESPACE, 'ScriptCommand')``module-attribute`

### `CMD_AVAIL_TYPE_NAME_EXTENDED = coreutils.make_canonical_name(RUNTIME_NAMESPACE, 'ScriptCommandExtendedAvail')``module-attribute`

### `CMD_AVAIL_TYPE_NAME_SELECTION = coreutils.make_canonical_name(RUNTIME_NAMESPACE, 'ScriptCommandSelectionAvail')``module-attribute`

### `CMD_AVAIL_TYPE_NAME_ZERODOC = coreutils.make_canonical_name(RUNTIME_NAMESPACE, 'ScriptCommandZeroDocAvail')``module-attribute`

### `CMD_AVAIL_NAME_POSTFIX = '-avail'``module-attribute`

### `SOURCE_FILE_EXT = '.cs'``module-attribute`

### `SOURCE_FILE_FILTER = '(\\.cs)'``module-attribute`

### `CPYTHON_ENGINE = user_config.get_active_cpython_engine()``module-attribute`

### `BASE_TYPES_DIR_HASH = coreutils.get_str_hash(coreutils.calculate_dir_hash(INTERFACE_TYPES_DIR, '', SOURCE_FILE_FILTER) + EXEC_PARAMS.engine_ver + str(CPYTHON_ENGINE.Version) if CPYTHON_ENGINE else '0')[:HASH_CUTOFF_LENGTH]``module-attribute`

### `RUNTIME_ASSM_FILE_ID = '{}_{}'.format(BASE_TYPES_DIR_HASH, RUNTIME_NAMESPACE)``module-attribute`

### `RUNTIME_ASSM_FILE = op.join(BIN_DIR, 'pyRevitLabs.PyRevit.Runtime.{}.dll'.format(HOST_APP.version))``module-attribute`

### `RUNTIME_ASSM_NAME = op.splitext(op.basename(RUNTIME_ASSM_FILE))[0]``module-attribute`

### `RUNTIME_ASSM = None``module-attribute`

### `assm_list = assmutils.find_loaded_asm(RUNTIME_ASSM_NAME)``module-attribute`

### `CMD_EXECUTOR_TYPE = assmutils.find_type_by_name(RUNTIME_ASSM, CMD_EXECUTOR_TYPE_NAME)``module-attribute`

### `CMD_AVAIL_TYPE_EXTENDED = assmutils.find_type_by_name(RUNTIME_ASSM, CMD_AVAIL_TYPE_NAME_EXTENDED)``module-attribute`

### `CMD_AVAIL_TYPE_SELECTION = assmutils.find_type_by_name(RUNTIME_ASSM, CMD_AVAIL_TYPE_NAME_SELECTION)``module-attribute`

### `CMD_AVAIL_TYPE_ZERODOC = assmutils.find_type_by_name(RUNTIME_ASSM, CMD_AVAIL_TYPE_NAME_ZERODOC)``module-attribute`

## Classes

## Functions

### `get_references()`

Get list of all referenced assemblies.

Returns:

| Type | Description |
| --- | --- |
| `list` | referenced assemblies |

Source code in `pyrevitlib/pyrevit/runtime/__init__.py`

|     |     |
| --- | --- |
| ```<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>``` | ```md-code__content<br>def get_references():<br>    """Get list of all referenced assemblies.<br>    Returns:<br>        (list): referenced assemblies<br>    """<br>    ref_list = [<br>        # system stuff<br>        'System', 'System.Core', 'System.Runtime', 'System.Linq', 'System.Collections',<br>        'System.Collections.Immutable', 'System.Console',<br>        'System.Xaml', 'System.Web', 'System.Xml', 'System.Numerics',<br>        'System.Drawing', 'System.Windows.Forms',<br>        'System.ComponentModel.Primitives', 'System.ComponentModel.TypeConverter',<br>        'PresentationCore', 'PresentationFramework',<br>        'WindowsBase', 'WindowsFormsIntegration',<br>        # legacy csharp/vb.net compiler<br>        'Microsoft.CSharp',<br>        # iron python engine<br>        '{prefix}Microsoft.Dynamic'.format(prefix=eng.EnginePrefix),<br>        '{prefix}Microsoft.Scripting'.format(prefix=eng.EnginePrefix),<br>        '{prefix}IronPython'.format(prefix=eng.EnginePrefix),<br>        '{prefix}IronPython.Modules'.format(prefix=eng.EnginePrefix),<br>        # revit api<br>        'RevitAPI', 'RevitAPIUI', 'AdWindows', 'UIFramework',<br>        # pyrevit loader assembly<br>        'pyRevitLoader',<br>        # pyrevit labs<br>        'pyRevitLabs.Common', 'pyRevitLabs.CommonWPF',<br>        'pyRevitLabs.MahAppsMetro',<br>        'pyRevitLabs.NLog',<br>        'pyRevitLabs.Json',<br>        'pyRevitLabs.Emojis',<br>        'pyRevitLabs.TargetApps.Revit',<br>        'pyRevitLabs.PyRevit',<br>        'pyRevitLabs.PyRevit.Runtime.Shared',<br>    ]<br>    # netcore depends<br>    if NETCORE:<br>        ref_list.extend(['System.Drawing.Common',<br>                         'System.Diagnostics.Process',<br>                         'System.Diagnostics.FileVersionInfo',<br>                         'System.Text.RegularExpressions'])<br>    # another revit api<br>    if HOST_APP.is_newer_than(2018):<br>        ref_list.extend(['Xceed.Wpf.AvalonDock'])<br>    refs = (_get_reference_file(ref_name) for ref_name in ref_list)<br>    return [r for r in refs if r]<br>``` |

### `create_ipyengine_configs(clean=False, full_frame=False, persistent=False)`

Return the configuration for ipython engine.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `clean` | `bool` | Engine should be clean. Defaults to False. | `False` |
| `full_frame` | `bool` | Engine shoul be full frame. Defaults to False. | `False` |
| `persistent` | `bool` | Engine should persist. Defaults to False. | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | Configuration |

Source code in `pyrevitlib/pyrevit/runtime/__init__.py`

|     |     |
| --- | --- |
| ```<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>``` | ```md-code__content<br>def create_ipyengine_configs(clean=False, full_frame=False, persistent=False):<br>    """Return the configuration for ipython engine.<br>    Args:<br>        clean (bool, optional): Engine should be clean. Defaults to False.<br>        full_frame (bool, optional): Engine shoul be full frame. Defaults to False.<br>        persistent (bool, optional): Engine should persist. Defaults to False.<br>    Returns:<br>        (str): Configuration<br>    """<br>    return json.dumps({<br>        exts.MDATA_ENGINE_CLEAN: clean,<br>        exts.MDATA_ENGINE_FULLFRAME: full_frame,<br>        exts.MDATA_ENGINE_PERSISTENT: persistent,<br>    })<br>``` |

### `create_ext_command_attrs()`

Create dotnet attributes for Revit external commands.

This method is used in creating custom dotnet types for pyRevit commands
and compiling them into a DLL assembly. Current implementation sets
`RegenerationOption.Manual` and `TransactionMode.Manual`

Returns:

| Type | Description |
| --- | --- |
| `list[CustomAttributeBuilder]` | object for `RegenerationOption` <br>and `TransactionMode` attributes. |

Source code in `pyrevitlib/pyrevit/runtime/__init__.py`

|     |     |
| --- | --- |
| ```<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>350<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>359<br>``` | ```md-code__content<br>def create_ext_command_attrs():<br>    """Create dotnet attributes for Revit external commands.<br>    This method is used in creating custom dotnet types for pyRevit commands<br>    and compiling them into a DLL assembly. Current implementation sets<br>    ``RegenerationOption.Manual`` and ``TransactionMode.Manual``<br>    Returns:<br>        (list[CustomAttributeBuilder]): object for `RegenerationOption` <br>            and `TransactionMode` attributes.<br>    """<br>    regen_const_info = \<br>        framework.clr.GetClrType(api.Attributes.RegenerationAttribute) \<br>        .GetConstructor(<br>            framework.Array[framework.Type](<br>                (api.Attributes.RegenerationOption,)<br>                ))<br>    regen_attr_builder = \<br>        framework.CustomAttributeBuilder(<br>            regen_const_info,<br>            framework.Array[object](<br>                (api.Attributes.RegenerationOption.Manual,)<br>                ))<br>    # add TransactionAttribute to framework.Type<br>    trans_constructor_info = \<br>        framework.clr.GetClrType(api.Attributes.TransactionAttribute) \<br>        .GetConstructor(<br>            framework.Array[framework.Type](<br>                (api.Attributes.TransactionMode,)<br>                )<br>            )<br>    trans_attrib_builder = \<br>        framework.CustomAttributeBuilder(<br>            trans_constructor_info,<br>            framework.Array[object](<br>                (api.Attributes.TransactionMode.Manual,)<br>                )<br>            )<br>    return [regen_attr_builder, trans_attrib_builder]<br>``` |

### `create_type(modulebuilder, type_class, class_name, custom_attr_list, *args)`

Create a dotnet type for a pyRevit command.

See `baseclasses.cs` code for the template pyRevit command dotnet type
and its constructor default arguments that must be provided here.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `modulebuilder` |  | obj: `ModuleBuilder`): dotnet module builder | _required_ |
| `type_class` | `type` | source dotnet type for the command | _required_ |
| `class_name` | `str` | name for the new type | _required_ |
| `custom_attr_list` |  | obj: `list`): list of dotnet attributes for the type | _required_ |
| `*args` | `Any` | list of arguments to be used with type constructor | `()` |

Returns:

| Type | Description |
| --- | --- |
| `type` | returns created dotnet type |

Examples:

```md-code__content
asm_builder = AppDomain.CurrentDomain.DefineDynamicAssembly(
win_asm_name, AssemblyBuilderAccess.RunAndSave, filepath
)
module_builder = asm_builder.DefineDynamicModule(
ext_asm_file_name, ext_asm_full_file_name
)
create_type(
    module_builder,
    runtime.ScriptCommand,
    "PyRevitSomeCommandUniqueName",
    runtime.create_ext_command_attrs(),
    [scriptpath, atlscriptpath, searchpath, helpurl, name,\
    bundle, extension, uniquename, False, False])

```

Source code in `pyrevitlib/pyrevit/runtime/__init__.py`

|     |     |
| --- | --- |
| ```<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>387<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>427<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>``` | ````md-code__content<br>def create_type(modulebuilder, type_class, class_name, custom_attr_list, *args):<br>    """Create a dotnet type for a pyRevit command.<br>    See ``baseclasses.cs`` code for the template pyRevit command dotnet type<br>    and its constructor default arguments that must be provided here.<br>    Args:<br>        modulebuilder (:obj:`ModuleBuilder`): dotnet module builder<br>        type_class (type): source dotnet type for the command<br>        class_name (str): name for the new type<br>        custom_attr_list (:obj:`list`): list of dotnet attributes for the type<br>        *args (Any): list of arguments to be used with type constructor<br>    Returns:<br>        (type): returns created dotnet type<br>    Examples:<br>        ```python<br>        asm_builder = AppDomain.CurrentDomain.DefineDynamicAssembly(<br>        win_asm_name, AssemblyBuilderAccess.RunAndSave, filepath<br>        )<br>        module_builder = asm_builder.DefineDynamicModule(<br>        ext_asm_file_name, ext_asm_full_file_name<br>        )<br>        create_type(<br>            module_builder,<br>            runtime.ScriptCommand,<br>            "PyRevitSomeCommandUniqueName",<br>            runtime.create_ext_command_attrs(),<br>            [scriptpath, atlscriptpath, searchpath, helpurl, name,<br>            bundle, extension, uniquename, False, False])<br>        ```<br>        <type PyRevitSomeCommandUniqueName><br>    """<br>    # create type builder<br>    type_builder = \<br>        modulebuilder.DefineType(<br>            class_name,<br>            framework.TypeAttributes.Class | framework.TypeAttributes.Public,<br>            type_class<br>            )<br>    for custom_attr in custom_attr_list:<br>        type_builder.SetCustomAttribute(custom_attr)<br>    # prepare a list of input param types to find the matching constructor<br>    type_list = []<br>    param_list = []<br>    for param in args:<br>        if isinstance(param, str) \<br>                or isinstance(param, int):<br>            type_list.append(type(param))<br>            param_list.append(param)<br>    # call base constructor<br>    constructor = \<br>        type_class.GetConstructor(framework.Array[framework.Type](type_list))<br>    # create class constructor builder<br>    const_builder = \<br>        type_builder.DefineConstructor(framework.MethodAttributes.Public,<br>                                       framework.CallingConventions.Standard,<br>                                       framework.Array[framework.Type](()))<br>    # add constructor parameters to stack<br>    gen = const_builder.GetILGenerator()<br>    gen.Emit(framework.OpCodes.Ldarg_0)  # Load "this" onto eval stack<br>    # add constructor input params to the stack<br>    for param_type, param in zip(type_list, param_list):<br>        if param_type == str:<br>            gen.Emit(framework.OpCodes.Ldstr, param)<br>        elif param_type == int:<br>            gen.Emit(framework.OpCodes.Ldc_I4, param)<br>    # call base constructor (consumes "this" and the created stack)<br>    gen.Emit(framework.OpCodes.Call, constructor)<br>    # Fill some space - this is how it is generated for equivalent C# code<br>    gen.Emit(framework.OpCodes.Nop)<br>    gen.Emit(framework.OpCodes.Nop)<br>    gen.Emit(framework.OpCodes.Nop)<br>    gen.Emit(framework.OpCodes.Ret)<br>    return type_builder.CreateType()<br>```` |

Back to top

## pyRevit Script Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/script/#pyrevit.script)

# script

Provide basic utilities for pyRevit scripts.

Examples:

```md-code__content
from pyrevit import script
script.clipboard_copy('some text')
data = script.journal_read('data-key')
script.exit()

```

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `DATAFEXT = 'pym'``module-attribute`

### `ICON_SMALL = 16``module-attribute`

### `ICON_MEDIUM = 24``module-attribute`

### `ICON_LARGE = 32``module-attribute`

## Classes

## Functions

### `get_info()`

Return info on current pyRevit command.

Returns:

| Type | Description |
| --- | --- |
| `GenericUICommand` | Command info object |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>``` | ```md-code__content<br>def get_info():<br>    """Return info on current pyRevit command.<br>    Returns:<br>        (pyrevit.extensions.genericcomps.GenericUICommand):<br>            Command info object<br>    """<br>    return get_command_from_path(EXEC_PARAMS.command_path)<br>``` |

### `get_command_from_path(comp_path)`

Returns a pyRevit command object from the given bundle directory.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `comp_path` | `str` | Full directory address of the command bundle | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `GenericUICommand` | A subclass of pyRevit command object. |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>``` | ```md-code__content<br>def get_command_from_path(comp_path):<br>    """Returns a pyRevit command object from the given bundle directory.<br>    Args:<br>        comp_path (str): Full directory address of the command bundle<br>    Returns:<br>        (genericcomps.GenericUICommand): A subclass of pyRevit command object.<br>    """<br>    cmds = parse_comp_dir(comp_path, GenericUICommand)<br>    if cmds:<br>        return cmds[0]<br>    return None<br>``` |

### `get_script_path()`

Return script path of the current pyRevit command.

Returns:

| Type | Description |
| --- | --- |
| `str` | script path |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>``` | ```md-code__content<br>def get_script_path():<br>    """Return script path of the current pyRevit command.<br>    Returns:<br>        (str): script path<br>    """<br>    return EXEC_PARAMS.command_path<br>``` |

### `get_alt_script_path()`

Return config script path of the current pyRevit command.

Returns:

| Type | Description |
| --- | --- |
| `str` | config script path |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>``` | ```md-code__content<br>def get_alt_script_path():<br>    """Return config script path of the current pyRevit command.<br>    Returns:<br>        (str): config script path<br>    """<br>    return EXEC_PARAMS.command_config_path<br>``` |

### `get_bundle_name()`

Return bundle name of the current pyRevit command.

Returns:

| Type | Description |
| --- | --- |
| `str` | bundle name (e.g. MyButton.pushbutton) |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>``` | ```md-code__content<br>def get_bundle_name():<br>    """Return bundle name of the current pyRevit command.<br>    Returns:<br>        (str): bundle name (e.g. MyButton.pushbutton)<br>    """<br>    return EXEC_PARAMS.command_bundle<br>``` |

### `get_extension_name()`

Return extension name of the current pyRevit command.

Returns:

| Type | Description |
| --- | --- |
| `str` | extension name (e.g. MyExtension.extension) |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>``` | ```md-code__content<br>def get_extension_name():<br>    """Return extension name of the current pyRevit command.<br>    Returns:<br>        (str): extension name (e.g. MyExtension.extension)<br>    """<br>    return EXEC_PARAMS.command_extension<br>``` |

### `get_unique_id()`

Return unique id of the current pyRevit command.

Returns:

| Type | Description |
| --- | --- |
| `str` | command unique id |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>``` | ```md-code__content<br>def get_unique_id():<br>    """Return unique id of the current pyRevit command.<br>    Returns:<br>        (str): command unique id<br>    """<br>    return EXEC_PARAMS.command_uniqueid<br>``` |

### `get_results()`

Return command results dictionary for logging.

Returns:

| Type | Description |
| --- | --- |
| `CommandCustomResults` | Command results dict |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>``` | ```md-code__content<br>def get_results():<br>    """Return command results dictionary for logging.<br>    Returns:<br>        (pyrevit.telemetry.record.CommandCustomResults):<br>            Command results dict<br>    """<br>    from pyrevit.telemetry.record import CommandCustomResults<br>    return CommandCustomResults()<br>``` |

### `get_pyrevit_version()`

Return pyRevit version.

Returns:

| Type | Description |
| --- | --- |
| `_PyRevitVersion` | pyRevit version provider |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>``` | ```md-code__content<br>def get_pyrevit_version():<br>    """Return pyRevit version.<br>    Returns:<br>        (pyrevit.versionmgr._PyRevitVersion): pyRevit version provider<br>    """<br>    return versionmgr.get_pyrevit_version()<br>``` |

### `get_logger()`

Create and return logger named for current script.

Returns:

| Type | Description |
| --- | --- |
| `LoggerWrapper` | Logger object |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>``` | ```md-code__content<br>def get_logger():<br>    """Create and return logger named for current script.<br>    Returns:<br>        (pyrevit.coreutils.logger.LoggerWrapper): Logger object<br>    """<br>    return logger.get_logger(EXEC_PARAMS.command_name)<br>``` |

### `get_output()`

Return object wrapping output window for current script.

Returns:

| Type | Description |
| --- | --- |
| `PyRevitOutputWindow` | Output wrapper object |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>``` | ```md-code__content<br>def get_output():<br>    """Return object wrapping output window for current script.<br>    Returns:<br>        (pyrevit.output.PyRevitOutputWindow): Output wrapper object<br>    """<br>    return output.get_output()<br>``` |

### `get_config(section=None)`

Create and return config section parser object for current script.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `section` | `str` | config section name. If not provided,<br>it will default to the command name plus the 'config' suffix. | `None` |

Returns:

| Type | Description |
| --- | --- |
| `PyRevitConfigSectionParser` | Config section parser object |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>``` | ```md-code__content<br>def get_config(section=None):<br>    """Create and return config section parser object for current script.<br>    Args:<br>        section (str, optional): config section name. If not provided,<br>            it will default to the command name plus the 'config' suffix.<br>    Returns:<br>        (pyrevit.coreutils.configparser.PyRevitConfigSectionParser):<br>            Config section parser object<br>    """<br>    from pyrevit.userconfig import user_config<br>    if not section:<br>        script_cfg_postfix = 'config'<br>        section = EXEC_PARAMS.command_name + script_cfg_postfix<br>    try:<br>        return user_config.get_section(section)<br>    except AttributeError:<br>        return user_config.add_section(section)<br>``` |

### `save_config()`

Save pyRevit config.

Scripts should call this to save any changes they have done to their
config section object received from script.get\_config() method.

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>``` | ```md-code__content<br>def save_config():<br>    """Save pyRevit config.<br>    Scripts should call this to save any changes they have done to their<br>    config section object received from script.get_config() method.<br>    """<br>    from pyrevit.userconfig import user_config<br>    user_config.save_changes()<br>``` |

### `reset_config(section=None)`

Reset pyRevit config.

Script should call this to reset any save configuration by removing
section related to current script.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `section` | `str` | config section name | `None` |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>``` | ```md-code__content<br>def reset_config(section=None):<br>    """Reset pyRevit config.<br>    Script should call this to reset any save configuration by removing<br>    section related to current script.<br>    Args:<br>        section (str, optional): config section name<br>    """<br>    from pyrevit.userconfig import user_config<br>    if not section:<br>        script_cfg_postfix = 'config'<br>        section = EXEC_PARAMS.command_name + script_cfg_postfix<br>    elif section in [PyRevit.PyRevitConsts.ConfigsCoreSection]:<br>        raise PyRevitException('Can not remove internal config section: {}'<br>                               .format(section))<br>    try:<br>        user_config.remove_section(section)<br>        user_config.save_changes()<br>    except Exception:<br>        mlogger.debug('Failed resetting config for %s (%s)',<br>                      EXEC_PARAMS.command_name, section)<br>``` |

### `get_universal_data_file(file_id, file_ext, add_cmd_name=False)`

Return filename to be used by a user script to store data.

File name is generated in this format:
`pyRevit_{file_id}.{file_ext}`

Examples:

```md-code__content
script.get_universal_data_file('mydata', 'data')

```

'/pyRevit\_mydata.data'

```md-code__content
script.get_universal_data_file('mydata', 'data', add_cmd_name=True)

```

'/pyRevit\_Command Name\_mydata.data'

Universal data files are not cleaned up at pyRevit startup.
Script should manage cleaning up these files.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_id` | `str` | unique id for the filename | _required_ |
| `file_ext` | `str` | file extension | _required_ |
| `add_cmd_name` | `bool` | add command name to file name | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | full file path |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>``` | ````md-code__content<br>def get_universal_data_file(file_id, file_ext, add_cmd_name=False):<br>    """Return filename to be used by a user script to store data.<br>    File name is generated in this format:<br>    ``pyRevit_{file_id}.{file_ext}``<br>    Examples:<br>        ```python<br>        script.get_universal_data_file('mydata', 'data')<br>        ```<br>        '/pyRevit_mydata.data'<br>        ```python<br>        script.get_universal_data_file('mydata', 'data', add_cmd_name=True)<br>        ```<br>        '/pyRevit_Command Name_mydata.data'<br>    Universal data files are not cleaned up at pyRevit startup.<br>    Script should manage cleaning up these files.<br>    Args:<br>        file_id (str): unique id for the filename<br>        file_ext (str): file extension<br>        add_cmd_name (bool, optional): add command name to file name<br>    Returns:<br>        (str): full file path<br>    """<br>    if add_cmd_name:<br>        script_file_id = '{}_{}'.format(EXEC_PARAMS.command_name, file_id)<br>    else:<br>        script_file_id = file_id<br>    return appdata.get_universal_data_file(script_file_id, file_ext)<br>```` |

### `get_data_file(file_id, file_ext, add_cmd_name=False)`

Return filename to be used by a user script to store data.

File name is generated in this format:
`pyRevit_{Revit Version}_{file_id}.{file_ext}`

Examples:

```md-code__content
script.get_data_file('mydata', 'data')

```

'/pyRevit\_2018\_mydata.data'

```md-code__content
script.get_data_file('mydata', 'data', add_cmd_name=True)

```

'/pyRevit\_2018\_Command Name\_mydata.data'

Data files are not cleaned up at pyRevit startup.
Script should manage cleaning up these files.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_id` | `str` | unique id for the filename | _required_ |
| `file_ext` | `str` | file extension | _required_ |
| `add_cmd_name` | `bool` | add command name to file name | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | full file path |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>``` | ````md-code__content<br>def get_data_file(file_id, file_ext, add_cmd_name=False):<br>    """Return filename to be used by a user script to store data.<br>    File name is generated in this format:<br>    ``pyRevit_{Revit Version}_{file_id}.{file_ext}``<br>    Examples:<br>        ```python<br>        script.get_data_file('mydata', 'data')<br>        ```<br>        '/pyRevit_2018_mydata.data'<br>        ```python<br>        script.get_data_file('mydata', 'data', add_cmd_name=True)<br>        ```<br>        '/pyRevit_2018_Command Name_mydata.data'<br>    Data files are not cleaned up at pyRevit startup.<br>    Script should manage cleaning up these files.<br>    Args:<br>        file_id (str): unique id for the filename<br>        file_ext (str): file extension<br>        add_cmd_name (bool, optional): add command name to file name<br>    Returns:<br>        (str): full file path<br>    """<br>    if add_cmd_name:<br>        script_file_id = '{}_{}'.format(EXEC_PARAMS.command_name, file_id)<br>    else:<br>        script_file_id = file_id<br>    return appdata.get_data_file(script_file_id, file_ext)<br>```` |

### `get_instance_data_file(file_id, add_cmd_name=False)`

Return filename to be used by a user script to store data.

File name is generated in this format:
`pyRevit_{Revit Version}_{Process Id}_{file_id}.{file_ext}`

Examples:

```md-code__content
script.get_instance_data_file('mydata')

```

'/pyRevit\_2018\_6684\_mydata.tmp'

```md-code__content
script.get_instance_data_file('mydata', add_cmd_name=True)

```

'/pyRevit\_2018\_6684\_Command Name\_mydata.tmp'

Instance data files are cleaned up at pyRevit startup.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_id` | `str` | unique id for the filename | _required_ |
| `add_cmd_name` | `bool` | add command name to file name | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | full file path |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>``` | ````md-code__content<br>def get_instance_data_file(file_id, add_cmd_name=False):<br>    """Return filename to be used by a user script to store data.<br>    File name is generated in this format:<br>    ``pyRevit_{Revit Version}_{Process Id}_{file_id}.{file_ext}``<br>    Examples:<br>        ```python<br>        script.get_instance_data_file('mydata')<br>        ```<br>        '/pyRevit_2018_6684_mydata.tmp'<br>        ```python<br>        script.get_instance_data_file('mydata', add_cmd_name=True)<br>        ```<br>        '/pyRevit_2018_6684_Command Name_mydata.tmp'<br>    Instance data files are cleaned up at pyRevit startup.<br>    Args:<br>        file_id (str): unique id for the filename<br>        add_cmd_name (bool, optional): add command name to file name<br>    Returns:<br>        (str): full file path<br>    """<br>    if add_cmd_name:<br>        script_file_id = '{}_{}'.format(EXEC_PARAMS.command_name, file_id)<br>    else:<br>        script_file_id = file_id<br>    return appdata.get_instance_data_file(script_file_id)<br>```` |

### `get_document_data_file(file_id, file_ext, add_cmd_name=False)`

Return filename to be used by a user script to store data.

File name is generated in this format:
`pyRevit_{Revit Version}_{file_id}_{Project Name}.{file_ext}`

Examples:

```md-code__content
script.get_document_data_file('mydata', 'data')

```

'/pyRevit\_2018\_mydata\_Project1.data'

```md-code__content
script.get_document_data_file('mydata', 'data', add_cmd_name=True)

```

'/pyRevit\_2018\_Command Name\_mydata\_Project1.data'

Document data files are not cleaned up at pyRevit startup.
Script should manage cleaning up these files.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_id` | `str` | unique id for the filename | _required_ |
| `file_ext` | `str` | file extension | _required_ |
| `add_cmd_name` | `bool` | add command name to file name | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | full file path |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>350<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>359<br>360<br>``` | ````md-code__content<br>def get_document_data_file(file_id, file_ext, add_cmd_name=False):<br>    """Return filename to be used by a user script to store data.<br>    File name is generated in this format:<br>    ``pyRevit_{Revit Version}_{file_id}_{Project Name}.{file_ext}``<br>    Examples:<br>        ```python<br>        script.get_document_data_file('mydata', 'data')<br>        ```<br>        '/pyRevit_2018_mydata_Project1.data'<br>        ```python<br>        script.get_document_data_file('mydata', 'data', add_cmd_name=True)<br>        ```<br>        '/pyRevit_2018_Command Name_mydata_Project1.data'<br>    Document data files are not cleaned up at pyRevit startup.<br>    Script should manage cleaning up these files.<br>    Args:<br>        file_id (str): unique id for the filename<br>        file_ext (str): file extension<br>        add_cmd_name (bool, optional): add command name to file name<br>    Returns:<br>        (str): full file path<br>    """<br>    proj_info = revit.query.get_project_info()<br>    if add_cmd_name:<br>        script_file_id = '{}_{}_{}'.format(EXEC_PARAMS.command_name,<br>                                           file_id,<br>                                           proj_info.filename<br>                                           or proj_info.name)<br>    else:<br>        script_file_id = '{}_{}'.format(file_id,<br>                                        proj_info.filename<br>                                        or proj_info.name)<br>    return appdata.get_data_file(script_file_id, file_ext)<br>```` |

### `remove_data_file(filepath)`

Remove given data file.

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>363<br>364<br>365<br>``` | ```md-code__content<br>def remove_data_file(filepath):<br>    """Remove given data file."""<br>    appdata.garbage_data_file(filepath)<br>``` |

### `get_bundle_file(file_name)`

Return full path to file under current script bundle.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_name` | `str` | bundle file name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | full bundle file path |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>``` | ```md-code__content<br>def get_bundle_file(file_name):<br>    """Return full path to file under current script bundle.<br>    Args:<br>        file_name (str): bundle file name<br>    Returns:<br>        (str): full bundle file path<br>    """<br>    return op.join(EXEC_PARAMS.command_path, file_name)<br>``` |

### `get_bundle_files(sub_path=None)`

Return full path to all file under current script bundle.

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | list of bundle file paths |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>387<br>388<br>389<br>390<br>``` | ```md-code__content<br>def get_bundle_files(sub_path=None):<br>    """Return full path to all file under current script bundle.<br>    Returns:<br>        (list[str]): list of bundle file paths<br>    """<br>    if sub_path:<br>        command_path = op.join(EXEC_PARAMS.command_path, sub_path)<br>    else:<br>        command_path = EXEC_PARAMS.command_path<br>    return [op.join(command_path, x) for x in os.listdir(command_path)]<br>``` |

### `journal_write(data_key, msg)`

Write key and value to active Revit journal for current command.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `data_key` | `str` | data key | _required_ |
| `msg` | `str` | data value string | _required_ |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>``` | ```md-code__content<br>def journal_write(data_key, msg):<br>    """Write key and value to active Revit journal for current command.<br>    Args:<br>        data_key (str): data key<br>        msg (str): data value string<br>    """<br>    # Get the StringStringMap class which can write data into.<br>    data_map = EXEC_PARAMS.command_data.JournalData<br>    data_map.Clear()<br>    # Begin to add the support data<br>    data_map.Add(data_key, msg)<br>``` |

### `journal_read(data_key)`

Read value for provided key from active Revit journal.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `data_key` | `str` | data key | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | data value string |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>``` | ```md-code__content<br>def journal_read(data_key):<br>    """Read value for provided key from active Revit journal.<br>    Args:<br>        data_key (str): data key<br>    Returns:<br>        (str): data value string<br>    """<br>    # Get the StringStringMap class which can write data into.<br>    data_map = EXEC_PARAMS.command_data.JournalData<br>    # Begin to get the support data<br>    return data_map[data_key]<br>``` |

### `get_button()`

Find and return current script ui button.

Returns:

| Type | Description |
| --- | --- |
| `_PyRevitRibbonButton` | ui button object |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>424<br>425<br>426<br>427<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>def get_button():<br>    """Find and return current script ui button.<br>    Returns:<br>        (pyrevit.coreutils.ribbon._PyRevitRibbonButton): ui button object<br>    """<br>    from pyrevit.coreutils.ribbon import get_current_ui<br>    pyrvt_tabs = get_current_ui().get_pyrevit_tabs()<br>    for tab in pyrvt_tabs:<br>        button = tab.find_child(EXEC_PARAMS.command_name)<br>        if button:<br>            return button<br>    return None<br>``` |

### `get_all_buttons()`

Find and return all ui buttons matching current script command name.

Sometimes tools are duplicated across extensions for user access control
so this would help smart buttons to find all the loaded buttons and make
icon adjustments.

Returns:

| Type | Description |
| --- | --- |
| `list[_PyRevitRibbonButton]` | list of ui button objects |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def get_all_buttons():<br>    """Find and return all ui buttons matching current script command name.<br>    Sometimes tools are duplicated across extensions for user access control<br>    so this would help smart buttons to find all the loaded buttons and make<br>    icon adjustments.<br>    Returns:<br>        (list[pyrevit.coreutils.ribbon._PyRevitRibbonButton]):<br>            list of ui button objects<br>    """<br>    from pyrevit.coreutils.ribbon import get_current_ui<br>    pyrvt_tabs = get_current_ui().get_pyrevit_tabs()<br>    buttons = []<br>    for tab in pyrvt_tabs:<br>        button = tab.find_child(EXEC_PARAMS.command_name)<br>        if button:<br>            buttons.append(button)<br>    return buttons<br>``` |

### `toggle_icon(new_state, on_icon_path=None, off_icon_path=None, icon_size=ICON_MEDIUM)`

Set the state of button icon (on or off).

This method expects on.png and off.png in command bundle for on and off
icon states, unless full path of icon states are provided.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `new_state` | `bool` | state of the ui button icon. | _required_ |
| `on_icon_path` | `str` | full path of icon for on state.<br>default='on.png' | `None` |
| `off_icon_path` | `str` | full path of icon for off state.<br>default='off.png' | `None` |
| `icon_size` | `int` | size of the icon. Defaults to medium (24x24) | `ICON_MEDIUM` |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>``` | ```md-code__content<br>def toggle_icon(new_state, on_icon_path=None, off_icon_path=None, icon_size=ICON_MEDIUM):<br>    """Set the state of button icon (on or off).<br>    This method expects on.png and off.png in command bundle for on and off<br>    icon states, unless full path of icon states are provided.<br>    Args:<br>        new_state (bool): state of the ui button icon.<br>        on_icon_path (str, optional): full path of icon for on state.<br>                                      default='on.png'<br>        off_icon_path (str, optional): full path of icon for off state.<br>                                       default='off.png'<br>        icon_size (int): size of the icon. Defaults to medium (24x24)<br>    """<br>    # find the ui button<br>    uibuttons = get_all_buttons()<br>    if not uibuttons:<br>        mlogger.debug('Can not find ui button.')<br>        return<br>    # get icon for on state<br>    if not on_icon_path:<br>        on_icon_path = ui.resolve_icon_file(EXEC_PARAMS.command_path, exts.DEFAULT_ON_ICON_FILE)<br>        if not on_icon_path:<br>            mlogger.debug('Script does not have icon for on state.')<br>            return<br>    # get icon for off state<br>    if not off_icon_path:<br>        off_icon_path = ui.resolve_icon_file(EXEC_PARAMS.command_path, exts.DEFAULT_OFF_ICON_FILE)<br>        if not off_icon_path:<br>            mlogger.debug('Script does not have icon for on state.')<br>            return<br>    icon_path = on_icon_path if new_state else off_icon_path<br>    mlogger.debug('Setting icon state to: %s (%s)',<br>                  new_state, icon_path)<br>    for uibutton in uibuttons:<br>        uibutton.set_icon(icon_path, icon_size)<br>``` |

### `exit()`

Stop the script execution and exit.

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>502<br>503<br>504<br>``` | ```md-code__content<br>def exit():     #pylint: disable=W0622<br>    """Stop the script execution and exit."""<br>    sys.exit()<br>``` |

### `show_file_in_explorer(file_path)`

Show file in Windows Explorer.

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>507<br>508<br>509<br>``` | ```md-code__content<br>def show_file_in_explorer(file_path):<br>    """Show file in Windows Explorer."""<br>    coreutils.show_entry_in_explorer(file_path)<br>``` |

### `show_folder_in_explorer(folder_path)`

Show folder in Windows Explorer.

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>512<br>513<br>514<br>``` | ```md-code__content<br>def show_folder_in_explorer(folder_path):<br>    """Show folder in Windows Explorer."""<br>    coreutils.open_folder_in_explorer(folder_path)<br>``` |

### `open_url(url)`

Open url in a new tab in default webbrowser.

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>517<br>518<br>519<br>520<br>521<br>522<br>523<br>``` | ```md-code__content<br>def open_url(url):<br>    """Open url in a new tab in default webbrowser."""<br>    import webbrowser<br>    if re.match('^https*://', url.lower()):<br>        webbrowser.open_new_tab(url)<br>    else:<br>        webbrowser.open_new_tab('http://' + url)<br>``` |

### `clipboard_copy(string_to_copy)`

Copy string to Windows Clipboard.

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>526<br>527<br>528<br>``` | ```md-code__content<br>def clipboard_copy(string_to_copy):<br>    """Copy string to Windows Clipboard."""<br>    framework.Clipboard.SetText(string_to_copy)<br>``` |

### `load_index(index_file='index.html')`

Load html file into output window.

This method expects index.html file in the current command bundle,
unless full path to an html file is provided.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `index_file` | `str` | full path of html file. | `'index.html'` |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>543<br>``` | ```md-code__content<br>def load_index(index_file='index.html'):<br>    """Load html file into output window.<br>    This method expects index.html file in the current command bundle,<br>    unless full path to an html file is provided.<br>    Args:<br>        index_file (str, optional): full path of html file.<br>    """<br>    outputwindow = get_output()<br>    if not op.isfile(index_file):<br>        index_file = get_bundle_file(index_file)<br>    outputwindow.open_page(index_file)<br>``` |

### `load_ui(ui_instance, ui_file='ui.xaml', handle_esc=True, set_owner=True)`

Load xaml file into given window instance.

If window instance defines a method named `setup` it
will be called after loading

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `ui_instance` | `WPFWindow` | ui form instance | _required_ |
| `ui_file` | `str` | name of ui xaml file. defaults to: 'ui.xaml' | `'ui.xaml'` |
| `handle_esc` | `bool` | handle escape and close window | `True` |
| `set_owner` | `bool` | set window owner to Revit window | `True` |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>546<br>547<br>548<br>549<br>550<br>551<br>552<br>553<br>554<br>555<br>556<br>557<br>558<br>559<br>560<br>561<br>562<br>563<br>564<br>565<br>566<br>567<br>568<br>569<br>570<br>``` | ```md-code__content<br>def load_ui(ui_instance, ui_file='ui.xaml', handle_esc=True, set_owner=True):<br>    """Load xaml file into given window instance.<br>    If window instance defines a method named `setup` it<br>    will be called after loading <br>    Args:<br>        ui_instance (forms.WPFWindow): ui form instance<br>        ui_file (str, optional): name of ui xaml file. defaults to: 'ui.xaml'<br>        handle_esc (bool, optional): handle escape and close window<br>        set_owner (bool, optional): set window owner to Revit window<br>    """<br>    ui_file = get_bundle_file(ui_file)<br>    if ui_file:<br>        ui_instance.load_xaml(<br>            ui_file,<br>            literal_string=False,<br>            handle_esc=handle_esc,<br>            set_owner=set_owner<br>            )<br>        if hasattr(ui_instance, 'setup'):<br>            ui_instance.setup()<br>        return ui_instance<br>    raise PyRevitException("Missing bundle ui file: {}".format(ui_file))<br>``` |

### `get_envvar(envvar)`

Return value of give pyRevit environment variable.

The environment variable system is used to retain small values in memory
between script runs (e.g. active/inactive state for toggle tools). Do not
store large objects in memory using this method. List of currently set
environment variables could be sees in pyRevit settings window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `envvar` | `str` | name of environment variable | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Any` | object stored in environment variable |

Examples:

```md-code__content
script.get_envvar('ToolActiveState')

```

True

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>573<br>574<br>575<br>576<br>577<br>578<br>579<br>580<br>581<br>582<br>583<br>584<br>585<br>586<br>587<br>588<br>589<br>590<br>591<br>592<br>593<br>``` | ````md-code__content<br>def get_envvar(envvar):<br>    """Return value of give pyRevit environment variable.<br>    The environment variable system is used to retain small values in memory<br>    between script runs (e.g. active/inactive state for toggle tools). Do not<br>    store large objects in memory using this method. List of currently set<br>    environment variables could be sees in pyRevit settings window.<br>    Args:<br>        envvar (str): name of environment variable<br>    Returns:<br>        (Any): object stored in environment variable<br>    Examples:<br>        ```python<br>        script.get_envvar('ToolActiveState')<br>        ```<br>        True<br>    """<br>    return envvars.get_pyrevit_env_var(envvar)<br>```` |

### `set_envvar(envvar, value)`

Set value of give pyRevit environment variable.

The environment variable system is used to retain small values in memory
between script runs (e.g. active/inactive state for toggle tools). Do not
store large objects in memory using this method. List of currently set
environment variables could be sees in pyRevit settings window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `envvar` | `str` | name of environment variable | _required_ |
| `value` | `any` | value of environment variable | _required_ |

Examples:

```md-code__content
script.set_envvar('ToolActiveState', False)
script.get_envvar('ToolActiveState')

```

False

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>596<br>597<br>598<br>599<br>600<br>601<br>602<br>603<br>604<br>605<br>606<br>607<br>608<br>609<br>610<br>611<br>612<br>613<br>614<br>615<br>``` | ````md-code__content<br>def set_envvar(envvar, value):<br>    """Set value of give pyRevit environment variable.<br>    The environment variable system is used to retain small values in memory<br>    between script runs (e.g. active/inactive state for toggle tools). Do not<br>    store large objects in memory using this method. List of currently set<br>    environment variables could be sees in pyRevit settings window.<br>    Args:<br>        envvar (str): name of environment variable<br>        value (any): value of environment variable<br>    Examples:<br>        ```python<br>        script.set_envvar('ToolActiveState', False)<br>        script.get_envvar('ToolActiveState')<br>        ```<br>        False<br>    """<br>    return envvars.set_pyrevit_env_var(envvar, value)<br>```` |

### `dump_json(data, filepath)`

Dumps given data into given json file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `data` | `object` | serializable data to be dumped | _required_ |
| `filepath` | `str` | json file path | _required_ |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>618<br>619<br>620<br>621<br>622<br>623<br>624<br>625<br>626<br>627<br>``` | ```md-code__content<br>def dump_json(data, filepath):<br>    """Dumps given data into given json file.<br>    Args:<br>        data (object): serializable data to be dumped<br>        filepath (str): json file path<br>    """<br>    json_repr = json.dumps(data, indent=4, ensure_ascii=False)<br>    with codecs.open(filepath, 'w', "utf-8") as json_file:<br>        json_file.write(json_repr)<br>``` |

### `load_json(filepath)`

Loads data from given json file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `filepath` | `str` | json file path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `object` | deserialized data |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>630<br>631<br>632<br>633<br>634<br>635<br>636<br>637<br>638<br>639<br>640<br>``` | ```md-code__content<br>def load_json(filepath):<br>    """Loads data from given json file.<br>    Args:<br>        filepath (str): json file path<br>    Returns:<br>        (object): deserialized data<br>    """<br>    with codecs.open(filepath, 'r', "utf-8") as json_file:<br>        return json.load(json_file)<br>``` |

### `dump_csv(data, filepath)`

Dumps given data into given csv file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `data` | `list[list[str]]` | data to be dumped | _required_ |
| `filepath` | `str` | csv file path | _required_ |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>643<br>644<br>645<br>646<br>647<br>648<br>649<br>650<br>651<br>652<br>``` | ```md-code__content<br>def dump_csv(data, filepath):<br>    """Dumps given data into given csv file.<br>    Args:<br>        data (list[list[str]]): data to be dumped<br>        filepath (str): csv file path<br>    """<br>    with codecs.open(filepath, 'wb', encoding='utf-8') as csvfile:<br>        writer = csv.writer(csvfile, delimiter=',', quotechar='\"')<br>        writer.writerows(data)<br>``` |

### `load_csv(filepath)`

Read lines from given csv file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `filepath` | `str` | csv file path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[list[str]]` | csv data |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>655<br>656<br>657<br>658<br>659<br>660<br>661<br>662<br>663<br>664<br>665<br>``` | ```md-code__content<br>def load_csv(filepath):<br>    """Read lines from given csv file.<br>    Args:<br>        filepath (str): csv file path<br>    Returns:<br>        (list[list[str]]): csv data<br>    """<br>    with codecs.open(filepath, 'rb', encoding='utf-8') as csvfile:<br>        return list(csv.reader(csvfile, delimiter=',', quotechar='\"'))<br>``` |

### `store_data(slot_name, data, this_project=True)`

Wraps python pickle.dump() to easily store data to pyRevit data files.

To store native Revit objects, use revit.serialize(). See Example

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `slot_name` | `type` | desc | _required_ |
| `data` | `obj` | any pickalable data | _required_ |
| `this_project` | `bool` | data belongs to this project only | `True` |

Examples:

```md-code__content
from pyrevit import revit
    from pyrevit import script

    class CustomData(object):
        def __init__(self, count, element_ids):
            self._count = count
            # serializes the Revit native objects
            self._elmnt_ids = [revit.serialize(x) for x in element_ids]

        @property
        def count(self):
            return self._count

        @property
        def element_ids(self):
            # de-serializes the Revit native objects
            return [x.deserialize() for x in self._elmnt_ids]

    mydata = CustomData(
        count=3,
        element_ids=[<DB.ElementId>, <DB.ElementId>, <DB.ElementId>]
    )

    script.store_data("Selected Elements", mydata)

```

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>668<br>669<br>670<br>671<br>672<br>673<br>674<br>675<br>676<br>677<br>678<br>679<br>680<br>681<br>682<br>683<br>684<br>685<br>686<br>687<br>688<br>689<br>690<br>691<br>692<br>693<br>694<br>695<br>696<br>697<br>698<br>699<br>700<br>701<br>702<br>703<br>704<br>705<br>706<br>707<br>708<br>709<br>710<br>711<br>712<br>713<br>714<br>715<br>716<br>717<br>718<br>719<br>720<br>721<br>``` | ````md-code__content<br>def store_data(slot_name, data, this_project=True):<br>    """Wraps python pickle.dump() to easily store data to pyRevit data files.<br>    To store native Revit objects, use revit.serialize(). See Example<br>    Args:<br>        slot_name (type): desc<br>        data (obj): any pickalable data<br>        this_project (bool): data belongs to this project only<br>    Examples:<br>        ```python<br>        from pyrevit import revit<br>            from pyrevit import script<br>            class CustomData(object):<br>                def __init__(self, count, element_ids):<br>                    self._count = count<br>                    # serializes the Revit native objects<br>                    self._elmnt_ids = [revit.serialize(x) for x in element_ids]<br>                @property<br>                def count(self):<br>                    return self._count<br>                @property<br>                def element_ids(self):<br>                    # de-serializes the Revit native objects<br>                    return [x.deserialize() for x in self._elmnt_ids]<br>            mydata = CustomData(<br>                count=3,<br>                element_ids=[<DB.ElementId>, <DB.ElementId>, <DB.ElementId>]<br>            )<br>            script.store_data("Selected Elements", mydata)<br>        ```<br>    """<br>    # for this specific project?<br>    if this_project:<br>        data_file = get_document_data_file(file_id=slot_name,<br>                                           file_ext=DATAFEXT,<br>                                           add_cmd_name=False)<br>    # for any project file<br>    else:<br>        data_file = get_data_file(file_id=slot_name,<br>                                  file_ext=DATAFEXT,<br>                                  add_cmd_name=False)<br>    with open(data_file, 'w') as dfile:<br>        pickle.dump(data, dfile)<br>```` |

### `load_data(slot_name, this_project=True)`

Wraps python pickle.load() to easily load data from pyRevit data files.

To recover native Revit objects, use revit.deserialize(). See Example

Similar to pickle module, the custom data types must be defined in the main
scope so the loader can create an instance and return original stored data

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `slot_name` | `type` | desc | _required_ |
| `this_project` | `bool` | data belongs to this project only | `True` |

Returns:

| Type | Description |
| --- | --- |
| `object` | stored data |

Examples:

```md-code__content
from pyrevit import revit
from pyrevit import script

    class CustomData(object):
        def __init__(self, count, element_ids):
            self._count = count
            # serializes the Revit native objects
            self._elmnt_ids = [revit.serialize(x) for x in element_ids]

        @property
        def count(self):
            return self._count

        @property
        def element_ids(self):
            # de-serializes the Revit native objects
            return [x.deserialize() for x in self._elmnt_ids]

    mydata = script.load_data("Selected Elements")
    mydata.element_ids

```

\[, , \]

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>724<br>725<br>726<br>727<br>728<br>729<br>730<br>731<br>732<br>733<br>734<br>735<br>736<br>737<br>738<br>739<br>740<br>741<br>742<br>743<br>744<br>745<br>746<br>747<br>748<br>749<br>750<br>751<br>752<br>753<br>754<br>755<br>756<br>757<br>758<br>759<br>760<br>761<br>762<br>763<br>764<br>765<br>766<br>767<br>768<br>769<br>770<br>771<br>772<br>773<br>774<br>775<br>776<br>777<br>778<br>``` | ````md-code__content<br>def load_data(slot_name, this_project=True):<br>    """Wraps python pickle.load() to easily load data from pyRevit data files.<br>    To recover native Revit objects, use revit.deserialize(). See Example<br>    Similar to pickle module, the custom data types must be defined in the main<br>    scope so the loader can create an instance and return original stored data<br>    Args:<br>        slot_name (type): desc<br>        this_project (bool): data belongs to this project only<br>    Returns:<br>        (object): stored data<br>    Examples:<br>        ```python<br>        from pyrevit import revit<br>        from pyrevit import script<br>            class CustomData(object):<br>                def __init__(self, count, element_ids):<br>                    self._count = count<br>                    # serializes the Revit native objects<br>                    self._elmnt_ids = [revit.serialize(x) for x in element_ids]<br>                @property<br>                def count(self):<br>                    return self._count<br>                @property<br>                def element_ids(self):<br>                    # de-serializes the Revit native objects<br>                    return [x.deserialize() for x in self._elmnt_ids]<br>            mydata = script.load_data("Selected Elements")<br>            mydata.element_ids<br>        ```<br>        [<DB.ElementId>, <DB.ElementId>, <DB.ElementId>]<br>    """<br>    # for this specific project?<br>    if this_project:<br>        data_file = get_document_data_file(file_id=slot_name,<br>                                           file_ext=DATAFEXT,<br>                                           add_cmd_name=False)<br>    # for any project file<br>    else:<br>        data_file = get_data_file(file_id=slot_name,<br>                                  file_ext=DATAFEXT,<br>                                  add_cmd_name=False)<br>    with open(data_file, 'r') as dfile:<br>        return pickle.load(dfile)<br>```` |

### `data_exists(slot_name, this_project=True)`

Checks if data file in a specified slot and for certain project exists.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `slot_name` | `type` | desc | _required_ |
| `this_project` | `bool` | data belongs to this project only | `True` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | true if the path exists |

Source code in `pyrevitlib/pyrevit/script.py`

|     |     |
| --- | --- |
| ```<br>781<br>782<br>783<br>784<br>785<br>786<br>787<br>788<br>789<br>790<br>791<br>792<br>793<br>794<br>795<br>796<br>797<br>798<br>799<br>800<br>801<br>``` | ```md-code__content<br>def data_exists(slot_name, this_project=True):<br>    """Checks if data file in a specified slot and for certain project exists.<br>    Args:<br>        slot_name (type): desc<br>        this_project (bool): data belongs to this project only<br>    Returns:<br>        (bool): true if the path exists<br>    """<br>    # for this specific project?<br>    if this_project:<br>        data_file = get_document_data_file(file_id=slot_name,<br>                                           file_ext=DATAFEXT,<br>                                           add_cmd_name=False)<br>    # for any project file<br>    else:<br>        data_file = get_data_file(file_id=slot_name,<br>                                  file_ext=DATAFEXT,<br>                                  add_cmd_name=False)<br>    return os.path.exists(data_file)<br>``` |

Back to top

## PyRevit Engine Reference
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/engine/#pyrevit.engine)

# engine

Access loading engine properties.

## Attributes

### `ScriptExecutor = PyRevitLoader.ScriptExecutor``module-attribute`

### `EnginePrefix = ScriptExecutor.EnginePrefix``module-attribute`

### `EngineVersion = ScriptExecutor.EngineVersion``module-attribute`

### `EnginePath = op.dirname(clr.GetClrType(ScriptExecutor).Assembly.Location)``module-attribute`

Back to top

## Interop Features Overview
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/#pyrevit.interop)

# interop

Interoperability with other applications.

Back to top

## Preflight Checks Framework
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/preflight/#pyrevit.preflight)

# preflight

Preflight checks framework.

This framework is designed to automate verification and quality control
checks that need to be completed before model is published. The framework works
very similarly to `unitchecks` module.

All preflight checks are subclassed from a base class and are recognized
automatically by the preflight module. Each test case, can perform `setUp()`,
`startTest()`, `tearDown()`, and `doCleanups()`.

## Classes

### `PreflightCheck(extension, check_type, script_path)`

Bases: `object`

Preflight Check.

Source code in `pyrevitlib/pyrevit/preflight/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>``` | ```md-code__content<br>def __init__(self, extension, check_type, script_path):<br>    self.check_case = check_type<br>    self.name = getattr(self.check_case, "name", None) \<br>        or _get_check_name(script_path)<br>    self.script_path = script_path<br>    self.extension = extension.name<br>    self.author = getattr(self.check_case, "author", None)<br>    if not self.author:<br>        self.author = "Unknown"<br>        extension_pkg = extpkg.get_ext_package_by_name(extension.name)<br>        if extension_pkg:<br>            self.author = extension_pkg.author<br>    desc_lines = getattr(self.check_case, "__doc__", "").strip().split('\n')<br>    if desc_lines:<br>        self.subtitle = desc_lines[0]<br>        self.description = '\n'.join([x.strip() for x in desc_lines[1:]])<br>``` |

#### Attributes

##### `check_case = check_type``instance-attribute`

##### `name = getattr(self.check_case, 'name', None) or _get_check_name(script_path)``instance-attribute`

##### `script_path = script_path``instance-attribute`

##### `extension = extension.name``instance-attribute`

##### `author = getattr(self.check_case, 'author', None)``instance-attribute`

##### `subtitle = desc_lines[0]``instance-attribute`

##### `description = '\n'.join([x.strip() for x in desc_lines[1:]])``instance-attribute`

## Functions

### `run_preflight_check(check, doc, output)`

Run a preflight check.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `check` | `PreflightCheck` | preflight test case object | _required_ |
| `doc` | `Document` | Revit document | _required_ |
| `output` | `PyRevitOutputWindow` | output window wrapper | _required_ |

Source code in `pyrevitlib/pyrevit/preflight/__init__.py`

|     |     |
| --- | --- |
| ```<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>``` | ```md-code__content<br>def run_preflight_check(check, doc, output):<br>    """Run a preflight check.<br>    Args:<br>        check (PreflightCheck): preflight test case object<br>        doc (Document): Revit document<br>        output (pyrevit.output.PyRevitOutputWindow): output window wrapper<br>    """<br>    check_case = check.check_case()<br>    check_case.setUp(doc=doc, output=output)<br>    check_case.startTest(doc=doc, output=output)<br>    check_case.tearDown(doc=doc, output=output)<br>    check_case.doCleanups(doc=doc, output=output)<br>``` |

### `get_all_preflight_checks()`

Find all the preflight checks in installed extensions.

Source code in `pyrevitlib/pyrevit/preflight/__init__.py`

|     |     |
| --- | --- |
| ```<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>``` | ```md-code__content<br>def get_all_preflight_checks():<br>    """Find all the preflight checks in installed extensions."""<br>    preflight_checks = []<br>    # get all installed ui extensions<br>    for ext in extensionmgr.get_installed_ui_extensions():<br>        # find the checks in the extension<br>        for check_script in ext.get_checks():<br>            # load the check source file so all the checks can be extracted<br>            check_mod = \<br>                imp.load_source(_get_check_name(check_script), check_script)<br>            # extract the checks and wrap<br>            for check_type in _grab_test_types(check_mod):<br>                preflight_checks.append(<br>                    PreflightCheck(ext, check_type, check_script)<br>                )<br>    return preflight_checks<br>``` |

Back to top

## pyRevit HTTP API
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/routes/#pyrevit.routes)

# routes

HTTP API framework similar to flask.

## Classes

### `Request(path='/', method='GET', data=None, params=None)`

Bases: `object`

Request wrapper object.

Source code in `pyrevitlib/pyrevit/routes/server/base.py`

|     |     |
| --- | --- |
| ```<br>22<br>23<br>24<br>25<br>26<br>27<br>``` | ```md-code__content<br>def __init__(self, path='/', method='GET', data=None, params=None):<br>    self.path = path<br>    self.method = method<br>    self.data = data<br>    self._headers = {}<br>    self._params = params or []<br>``` |

#### Attributes

##### `path = path``instance-attribute`

##### `method = method``instance-attribute`

##### `data = data``instance-attribute`

##### `headers``property`

Request headers dict.

##### `params``property`

Request parameters.

##### `callback_url``property`

Request callback url, if provided in payload.

#### Functions

##### `add_header(key, value)`

Add new header key:value.

Source code in `pyrevitlib/pyrevit/routes/server/base.py`

|     |     |
| --- | --- |
| ```<br>46<br>47<br>48<br>``` | ```md-code__content<br>def add_header(self, key, value):<br>    """Add new header key:value."""<br>    self._headers[key] = value<br>``` |

### `Response(status=200, data=None, headers=None)`

Bases: `object`

Response wrapper object.

Source code in `pyrevitlib/pyrevit/routes/server/base.py`

|     |     |
| --- | --- |
| ```<br>53<br>54<br>55<br>56<br>``` | ```md-code__content<br>def __init__(self, status=200, data=None, headers=None):<br>    self.status = status<br>    self.data = data<br>    self._headers = headers or {}<br>``` |

#### Attributes

##### `status = status``instance-attribute`

##### `data = data``instance-attribute`

##### `headers``property`

Response headers dict.

#### Functions

##### `add_header(key, value)`

Add new header key:value.

Source code in `pyrevitlib/pyrevit/routes/server/base.py`

|     |     |
| --- | --- |
| ```<br>63<br>64<br>65<br>``` | ```md-code__content<br>def add_header(self, key, value):<br>    """Add new header key:value."""<br>    self._headers[key] = value<br>``` |

### `API(name)`

Bases: `object`

API root object.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `name` | `str` | URL-safe unique root name of the API | _required_ |

Examples:

```md-code__content
from pyrevit import routes
api = routes.API("pyrevit-core")
@api.route('/sessions/', methods=['POST'])
def reload_pyrevit(uiapp):
    new_session_id = sessionmgr.reload_pyrevit()
    return {"session_id": new_session_id}

```

Source code in `pyrevitlib/pyrevit/routes/__init__.py`

|     |     |
| --- | --- |
| ```<br>24<br>25<br>``` | ```md-code__content<br>def __init__(self, name):<br>    self.name = name<br>``` |

#### Attributes

##### `name = name``instance-attribute`

#### Functions

##### `route(pattern, methods=['GET'])`

Define a new route on this API.

Source code in `pyrevitlib/pyrevit/routes/__init__.py`

|     |     |
| --- | --- |
| ```<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>``` | ```md-code__content<br>def route(self, pattern, methods=['GET']):<br>    """Define a new route on this API."""<br>    def __func_wrapper__(f):<br>        for method in methods:<br>            add_route(<br>                api_name=self.name,<br>                pattern=pattern,<br>                method=method,<br>                handler_func=f<br>                )<br>        return f<br>    return __func_wrapper__<br>``` |

## Functions

### `init()`

Initialize routes. Reset all registered routes and shutdown servers.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>32<br>33<br>34<br>35<br>36<br>37<br>``` | ```md-code__content<br>def init():<br>    """Initialize routes. Reset all registered routes and shutdown servers."""<br>    # clear all routes<br>    router.reset_routes()<br>    # stop existing server<br>    deactivate_server()<br>``` |

### `activate_server()`

Activate routes server for this host instance.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>``` | ```md-code__content<br>def activate_server():<br>    """Activate routes server for this host instance."""<br>    routes_server = envvars.get_pyrevit_env_var(envvars.ROUTES_SERVER)<br>    if not routes_server:<br>        try:<br>            rsinfo = serverinfo.register()<br>            routes_server = \<br>                server.RoutesServer(<br>                    host=rsinfo.server_host,<br>                    port=rsinfo.server_port<br>                    )<br>            routes_server.start()<br>            envvars.set_pyrevit_env_var(envvars.ROUTES_SERVER, routes_server)<br>            return routes_server<br>        except Exception as rs_ex:<br>            serverinfo.unregister()<br>            mlogger.error("Error starting Routes server | %s", str(rs_ex))<br>``` |

### `deactivate_server()`

Deactivate the active routes server for this host instance.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>``` | ```md-code__content<br>def deactivate_server():<br>    """Deactivate the active routes server for this host instance."""<br>    routes_server = envvars.get_pyrevit_env_var(envvars.ROUTES_SERVER)<br>    if routes_server:<br>        try:<br>            routes_server.stop()<br>            envvars.set_pyrevit_env_var(envvars.ROUTES_SERVER, None)<br>            serverinfo.unregister()<br>        except Exception as rs_ex:<br>            mlogger.error("Error stopping Routes server | %s", str(rs_ex))<br>``` |

### `get_active_server()`

Get active routes server for this host instance.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>71<br>72<br>73<br>``` | ```md-code__content<br>def get_active_server():<br>    """Get active routes server for this host instance."""<br>    return envvars.get_pyrevit_env_var(envvars.ROUTES_SERVER)<br>``` |

### `make_response(data, status=OK, headers=None)`

Create Reponse object with.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>76<br>77<br>78<br>79<br>80<br>81<br>``` | ```md-code__content<br>def make_response(data, status=OK, headers=None):<br>    """Create Reponse object with."""<br>    res = Response(status=status, data=data)<br>    for key, value in (headers or {}).items():<br>        res.add_header(key, value)<br>    return res<br>``` |

### `get_routes(api_name)`

Get all registered routes for given API name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `api_name` | `str` | unique name of the api | _required_ |

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>``` | ```md-code__content<br>def get_routes(api_name):<br>    """Get all registered routes for given API name.<br>    Args:<br>        api_name (str): unique name of the api<br>    """<br>    return router.get_routes(api_name)<br>``` |

### `add_route(api_name, pattern, method, handler_func)`

Add new route for given API name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `api_name` | `str` | unique name of the api | _required_ |
| `pattern` | `str` | route pattern | _required_ |
| `method` | `str` | method name | _required_ |
| `handler_func` | `function` | route handler function | _required_ |

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>``` | ```md-code__content<br>def add_route(api_name, pattern, method, handler_func):<br>    """Add new route for given API name.<br>    Args:<br>        api_name (str): unique name of the api<br>        pattern (str): route pattern<br>        method (str): method name<br>        handler_func (function): route handler function<br>    """<br>    return router.add_route(api_name, pattern, method, handler_func)<br>``` |

### `remove_route(api_name, pattern, method)`

Remove previously registered route for given API name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `api_name` | `str` | unique name of the api | _required_ |
| `pattern` | `str` | route pattern | _required_ |
| `method` | `str` | method name | _required_ |

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>``` | ```md-code__content<br>def remove_route(api_name, pattern, method):<br>    """Remove previously registered route for given API name.<br>    Args:<br>        api_name (str): unique name of the api<br>        pattern (str): route pattern<br>        method (str): method name<br>    """<br>    return router.remove_route(api_name, pattern, method)<br>``` |

### `active_routes_api()`

Activates routes API.

Source code in `pyrevitlib/pyrevit/routes/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>``` | ```md-code__content<br>def active_routes_api():<br>    """Activates routes API."""<br>    from pyrevit.routes import api<br>``` |

Back to top

## pyRevit Core Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/#pyrevit.coreutils)

# coreutils

Misc Helper functions for pyRevit.

Examples:

```md-code__content
from pyrevit import coreutils
coreutils.cleanup_string('some string')

```

## Attributes

### `DEFAULT_SEPARATOR = ';'``module-attribute`

### `UNICODE_NONPRINTABLE_CHARS = ['\u2000', '\u2001', '\u2002', '\u2003', '\u2004', '\u2005', '\u2006', '\u2007', '\u2008', '\u2009', '\u200a', '\u200b', '\u200c', '\u200d', '\u200e', '\u200f', '\u2028', '\u2029', '\u202a', '\u202b', '\u202c', '\u202d', '\u202e', '\u202f', '\u205f', '\u2060', '\u2066', '\u2067', '\u2068', '\u2069', '\u206a', '\u206b', '\u206c\u206d', '\u206e', '\u206f']``module-attribute`

### `SPECIAL_CHARS = {' ': '', '~': '', '!': 'EXCLAM', '@': 'AT', '\#': 'SHARP', '$': 'DOLLAR', '%': 'PERCENT', '^': '', '&': 'AND', '*': 'STAR', '+': 'PLUS', ';': '', ':': '', ',': '', '"': '', '{': '', '}': '', '[': '', ']': '', '\\(': '', '\\)': '', '-': 'MINUS', '=': 'EQUALS', '<': '', '>': '', '?': 'QMARK', '.': 'DOT', '_': 'UNDERS', '|': 'VERT', '\\/': '', '\\': ''}``module-attribute`

## Classes

### `Timer()`

Bases: `object`

Timer class using python native time module.

Examples:

```md-code__content
timer = Timer()
timer.get_time()

```

12

Initialize and Start Timer.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>64<br>65<br>66<br>``` | ```md-code__content<br>def __init__(self):<br>    """Initialize and Start Timer."""<br>    self.start = time.time()<br>``` |

#### Attributes

##### `start = time.time()``instance-attribute`

#### Functions

##### `restart()`

Restart Timer.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>68<br>69<br>70<br>``` | ```md-code__content<br>def restart(self):<br>    """Restart Timer."""<br>    self.start = time.time()<br>``` |

##### `get_time()`

Get Elapsed Time.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>72<br>73<br>74<br>``` | ```md-code__content<br>def get_time(self):<br>    """Get Elapsed Time."""<br>    return time.time() - self.start<br>``` |

### `ScriptFileParser(file_address)`

Bases: `object`

Parse python script to extract variables and docstrings.

Primarily designed to assist pyRevit in determining script configurations
but can work for any python script.

Examples:

```md-code__content
finder = ScriptFileParser('/path/to/coreutils/__init__.py')
finder.docstring()

```

"Misc Helper functions for pyRevit."

```md-code__content
finder.extract_param('SomeValue', [])

```

\[\]

Initialize and read provided python script.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_address` | `str` | python script file path | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>``` | ```md-code__content<br>def __init__(self, file_address):<br>    """Initialize and read provided python script.<br>    Args:<br>        file_address (str): python script file path<br>    """<br>    self.ast_tree = None<br>    self.file_addr = file_address<br>    with codecs.open(file_address, 'r', 'utf-8') as source_file:<br>        contents = source_file.read()<br>        if contents:<br>            self.ast_tree = ast.parse(contents)<br>``` |

#### Attributes

##### `ast_tree = None``instance-attribute`

##### `file_addr = file_address``instance-attribute`

#### Functions

##### `extract_node_value(node)`

Manual extraction of values from node.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>``` | ```md-code__content<br>def extract_node_value(self, node):<br>    """Manual extraction of values from node."""<br>    if isinstance(node, ast.Assign):<br>        node_value = node.value<br>    else:<br>        node_value = node<br>    if isinstance(node_value, ast.Num):<br>        return node_value.n<br>    elif PY2 and isinstance(node_value, ast.Name):<br>        return node_value.id<br>    elif PY3 and isinstance(node_value, ast.NameConstant):<br>        return node_value.value<br>    elif isinstance(node_value, ast.Str):<br>        return node_value.s<br>    elif isinstance(node_value, ast.List):<br>        return node_value.elts<br>    elif isinstance(node_value, ast.Dict):<br>        return {self.extract_node_value(k):self.extract_node_value(v)<br>                for k, v in zip(node_value.keys, node_value.values)}<br>``` |

##### `get_docstring()`

Get global docstring.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>129<br>130<br>131<br>132<br>133<br>134<br>``` | ```md-code__content<br>def get_docstring(self):<br>    """Get global docstring."""<br>    if self.ast_tree:<br>        doc_str = ast.get_docstring(self.ast_tree)<br>        if doc_str:<br>            return doc_str.decode('utf-8')<br>``` |

##### `extract_param(param_name, default_value=None)`

Find variable and extract its value.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | variable name | _required_ |
| `default_value` | `any` | default value to be returned if variable does not exist | `None` |

Returns:

| Type | Description |
| --- | --- |
| `Any` | value of the variable or None |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>``` | ```md-code__content<br>def extract_param(self, param_name, default_value=None):<br>    """Find variable and extract its value.<br>    Args:<br>        param_name (str): variable name<br>        default_value (any):<br>            default value to be returned if variable does not exist<br>    Returns:<br>        (Any): value of the variable or None<br>    """<br>    if self.ast_tree:<br>        try:<br>            for node in ast.iter_child_nodes(self.ast_tree):<br>                if isinstance(node, ast.Assign):<br>                    for target in node.targets:<br>                        if hasattr(target, 'id') \<br>                                and target.id == param_name:<br>                            return ast.literal_eval(node.value)<br>        except Exception as err:<br>            raise PyRevitException('Error parsing parameter: {} '<br>                                   'in script file for : {} | {}'<br>                                   .format(param_name, self.file_addr, err))<br>    return default_value<br>``` |

### `FileWatcher(filepath)`

Bases: `object`

Simple file version watcher.

This is a simple utility class to look for changes in a file based on
its timestamp.

Examples:

```md-code__content
watcher = FileWatcher('/path/to/file.ext')
watcher.has_changed

```

True

Initialize and read timestamp of provided file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `filepath` | `str` | file path | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>``` | ```md-code__content<br>def __init__(self, filepath):<br>    """Initialize and read timestamp of provided file.<br>    Args:<br>        filepath (str): file path<br>    """<br>    self._cached_stamp = 0<br>    self._filepath = filepath<br>    self.update_tstamp()<br>``` |

#### Attributes

##### `has_changed``property`

Compare current file timestamp to the cached timestamp.

#### Functions

##### `update_tstamp()`

Update the cached timestamp for later comparison.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>186<br>187<br>188<br>``` | ```md-code__content<br>def update_tstamp(self):<br>    """Update the cached timestamp for later comparison."""<br>    self._cached_stamp = os.stat(self._filepath).st_mtime<br>``` |

### `SafeDict`

Bases: `dict`

Dictionary that does not fail on any key.

This is a dictionary subclass to help with string formatting with unknown
key values.

Examples:

```md-code__content
string = '{target} {attr} is {color}.'
safedict = SafeDict({'target': 'Apple',
                     'attr':   'Color'})
string.format(safedict)  # will not fail with missing 'color' key

```

'Apple Color is {color}.'

## Functions

### `get_all_subclasses(parent_classes)`

Return all subclasses of a python class.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `parent_classes` | `list` | list of python classes | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list` | list of python subclasses |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>``` | ```md-code__content<br>def get_all_subclasses(parent_classes):<br>    """Return all subclasses of a python class.<br>    Args:<br>        parent_classes (list): list of python classes<br>    Returns:<br>        (list): list of python subclasses<br>    """<br>    sub_classes = []<br>    # if super-class, get a list of sub-classes.<br>    # Otherwise use component_class to create objects.<br>    for parent_class in parent_classes:<br>        try:<br>            derived_classes = parent_class.__subclasses__()<br>            if not derived_classes:<br>                sub_classes.append(parent_class)<br>            else:<br>                sub_classes.extend(derived_classes)<br>        except AttributeError:<br>            sub_classes.append(parent_class)<br>    return sub_classes<br>``` |

### `get_sub_folders(search_folder)`

Get a list of all subfolders directly inside provided folder.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `search_folder` | `str` | folder path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | list of subfolder names |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>252<br>253<br>``` | ```md-code__content<br>def get_sub_folders(search_folder):<br>    """Get a list of all subfolders directly inside provided folder.<br>    Args:<br>        search_folder (str): folder path<br>    Returns:<br>        (list[str]): list of subfolder names<br>    """<br>    sub_folders = []<br>    for sub_folder in os.listdir(search_folder):<br>        if op.isdir(op.join(search_folder, sub_folder)):<br>            sub_folders.append(sub_folder)<br>    return sub_folders<br>``` |

### `verify_directory(folder)`

Check if the folder exists and if not create the folder.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `folder` | `str` | path of folder to verify | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | path of verified folder, equals to provided folder |

Raises:

| Type | Description |
| --- | --- |
| `OSError` | on folder creation error. |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>``` | ```md-code__content<br>def verify_directory(folder):<br>    """Check if the folder exists and if not create the folder.<br>    Args:<br>        folder (str): path of folder to verify<br>    Returns:<br>        (str): path of verified folder, equals to provided folder<br>    Raises:<br>        OSError: on folder creation error.<br>    """<br>    if not op.exists(folder):<br>        try:<br>            os.makedirs(folder)<br>        except OSError as err:<br>            raise err<br>    return folder<br>``` |

### `join_strings(str_list, separator=DEFAULT_SEPARATOR)`

Join strings using provided separator.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `str_list` | `list` | list of string values | _required_ |
| `separator` | `str` | single separator character,<br>defaults to DEFAULT\_SEPARATOR | `DEFAULT_SEPARATOR` |

Returns:

| Type | Description |
| --- | --- |
| `str` | joined string |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>``` | ```md-code__content<br>def join_strings(str_list, separator=DEFAULT_SEPARATOR):<br>    """Join strings using provided separator.<br>    Args:<br>        str_list (list): list of string values<br>        separator (str): single separator character,<br>            defaults to DEFAULT_SEPARATOR<br>    Returns:<br>        (str): joined string<br>    """<br>    if str_list:<br>        if any(not isinstance(x, str) for x in str_list):<br>            str_list = [str(x) for x in str_list]<br>        return separator.join(str_list)<br>    return ''<br>``` |

### `cleanup_string(input_str, skip=None)`

Replace special characters in string with another string.

This function was created to help cleanup pyRevit command unique names from
any special characters so C# class names can be created based on those
unique names.

`coreutils.SPECIAL_CHARS` is the conversion table for this function.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_str` | `str` | input string to be cleaned | _required_ |
| `skip` | `Container[str]` | special characters to keep | `None` |

Examples:

```md-code__content
src_str = 'TEST@Some*<value>'
cleanup_string(src_str)

```

"TESTATSomeSTARvalue"

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>``` | ````md-code__content<br>def cleanup_string(input_str, skip=None):<br>    """Replace special characters in string with another string.<br>    This function was created to help cleanup pyRevit command unique names from<br>    any special characters so C# class names can be created based on those<br>    unique names.<br>    ``coreutils.SPECIAL_CHARS`` is the conversion table for this function.<br>    Args:<br>        input_str (str): input string to be cleaned<br>        skip (Container[str]): special characters to keep<br>    Examples:<br>        ```python<br>        src_str = 'TEST@Some*<value>'<br>        cleanup_string(src_str)<br>        ```<br>        "TESTATSomeSTARvalue"<br>    """<br>    # remove spaces and special characters from strings<br>    for char, repl in SPECIAL_CHARS.items():<br>        if skip and char in skip:<br>            continue<br>        input_str = input_str.replace(char, repl)<br>    return input_str<br>```` |

### `get_revit_instance_count()`

Return number of open host app instances.

Returns:

| Type | Description |
| --- | --- |
| `int` | number of open host app instances. |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>347<br>348<br>349<br>350<br>351<br>352<br>353<br>``` | ```md-code__content<br>def get_revit_instance_count():<br>    """Return number of open host app instances.<br>    Returns:<br>        (int): number of open host app instances.<br>    """<br>    return len(list(framework.Process.GetProcessesByName(HOST_APP.proc_name)))<br>``` |

### `run_process(proc, cwd='C:')`

Run shell process silently.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `proc` | `str` | process executive name | _required_ |
| `cwd` | `str` | current working directory | `'C:'` |

Exmaple

```md-code__content
run_process('notepad.exe', 'c:/')

```

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>356<br>357<br>358<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>``` | ````md-code__content<br>def run_process(proc, cwd='C:'):<br>    """Run shell process silently.<br>    Args:<br>        proc (str): process executive name<br>        cwd (str): current working directory<br>    Exmaple:<br>        ```python<br>        run_process('notepad.exe', 'c:/')<br>        ```<br>    """<br>    import subprocess<br>    return subprocess.Popen(proc,<br>                            stdout=subprocess.PIPE, stderr=subprocess.PIPE,<br>                            cwd=cwd, shell=True)<br>```` |

### `inspect_calling_scope_local_var(variable_name)`

Trace back the stack to find the variable in the caller local stack.

PyRevitLoader defines **revit** in builtins and **window** in locals.
Thus, modules have access to **revit** but not to **window**.
This function is used to find **window** in the caller stack.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `variable_name` | `str` | variable name to look up in caller local scope | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>387<br>388<br>389<br>390<br>391<br>``` | ```md-code__content<br>def inspect_calling_scope_local_var(variable_name):<br>    """Trace back the stack to find the variable in the caller local stack.<br>    PyRevitLoader defines __revit__ in builtins and __window__ in locals.<br>    Thus, modules have access to __revit__ but not to __window__.<br>    This function is used to find __window__ in the caller stack.<br>    Args:<br>        variable_name (str): variable name to look up in caller local scope<br>    """<br>    import inspect<br>    frame = inspect.stack()[1][0]<br>    while variable_name not in frame.f_locals:<br>        frame = frame.f_back<br>        if frame is None:<br>            return None<br>    return frame.f_locals[variable_name]<br>``` |

### `inspect_calling_scope_global_var(variable_name)`

Trace back the stack to find the variable in the caller global stack.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `variable_name` | `str` | variable name to look up in caller global scope | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>``` | ```md-code__content<br>def inspect_calling_scope_global_var(variable_name):<br>    """Trace back the stack to find the variable in the caller global stack.<br>    Args:<br>        variable_name (str): variable name to look up in caller global scope<br>    """<br>    import inspect<br>    frame = inspect.stack()[1][0]<br>    while variable_name not in frame.f_globals:<br>        frame = frame.f_back<br>        if frame is None:<br>            return None<br>    return frame.f_locals[variable_name]<br>``` |

### `make_canonical_name(*args)`

Join arguments with dot creating a unique id.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*args` | `str` | Variable length argument list | `()` |

Returns:

| Type | Description |
| --- | --- |
| `str` | dot separated unique name |

Examples:

```md-code__content
make_canonical_name('somename', 'someid', 'txt')

```

"somename.someid.txt"

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>``` | ````md-code__content<br>def make_canonical_name(*args):<br>    """Join arguments with dot creating a unique id.<br>    Args:<br>        *args (str): Variable length argument list<br>    Returns:<br>        (str): dot separated unique name<br>    Examples:<br>        ```python<br>        make_canonical_name('somename', 'someid', 'txt')<br>        ```<br>        "somename.someid.txt"<br>    """<br>    return '.'.join(args)<br>```` |

### `get_canonical_parts(canonical_string)`

Splots argument using dot, returning all composing parts.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `canonical_string` | `str` | Source string e.g. "Config.SubConfig" | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | list of composing parts |

Examples:

```md-code__content
get_canonical_parts("Config.SubConfig")

```

\['Config', 'SubConfig'\]

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>``` | ````md-code__content<br>def get_canonical_parts(canonical_string):<br>    """Splots argument using dot, returning all composing parts.<br>    Args:<br>        canonical_string (str): Source string e.g. "Config.SubConfig"<br>    Returns:<br>        (list[str]): list of composing parts<br>    Examples:<br>        ```python<br>        get_canonical_parts("Config.SubConfig")<br>        ```<br>        ['Config', 'SubConfig']<br>    """<br>    return canonical_string.split('.')<br>```` |

### `get_file_name(file_path)`

Return file basename of the given file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_path` | `str` | file path | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>``` | ```md-code__content<br>def get_file_name(file_path):<br>    """Return file basename of the given file.<br>    Args:<br>        file_path (str): file path<br>    """<br>    return op.splitext(op.basename(file_path))[0]<br>``` |

### `get_str_hash(source_str)`

Calculate hash value of given string.

Current implementation uses :func: `hashlib.md5` hash function.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `source_str` | `str` | source str | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | hash value as string |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>455<br>456<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>``` | ```md-code__content<br>def get_str_hash(source_str):<br>    """Calculate hash value of given string.<br>    Current implementation uses :func:`hashlib.md5` hash function.<br>    Args:<br>        source_str (str): source str<br>    Returns:<br>        (str): hash value as string<br>    """<br>    return hashlib.md5(source_str.encode('utf-8', 'ignore')).hexdigest()<br>``` |

### `calculate_dir_hash(dir_path, dir_filter, file_filter)`

Create a unique hash to represent state of directory.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `dir_path` | `str` | target directory | _required_ |
| `dir_filter` | `str` | exclude directories matching this regex | _required_ |
| `file_filter` | `str` | exclude files matching this regex | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | hash value as string |

Examples:

```md-code__content
calculate_dir_hash(source_path, '\.extension', '\.json')

```

"1a885a0cae99f53d6088b9f7cee3bf4d"

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>``` | ````md-code__content<br>def calculate_dir_hash(dir_path, dir_filter, file_filter):<br>    r"""Create a unique hash to represent state of directory.<br>    Args:<br>        dir_path (str): target directory<br>        dir_filter (str): exclude directories matching this regex<br>        file_filter (str): exclude files matching this regex<br>    Returns:<br>        (str): hash value as string<br>    Examples:<br>        ```python<br>        calculate_dir_hash(source_path, '\.extension', '\.json')<br>        ```<br>        "1a885a0cae99f53d6088b9f7cee3bf4d"<br>    """<br>    mtime_sum = 0<br>    for root, dirs, files in os.walk(dir_path): #pylint: disable=W0612<br>        if re.search(dir_filter, op.basename(root), flags=re.IGNORECASE):<br>            mtime_sum += op.getmtime(root)<br>            for filename in files:<br>                if re.search(file_filter, filename, flags=re.IGNORECASE):<br>                    modtime = op.getmtime(op.join(root, filename))<br>                    mtime_sum += modtime<br>    return get_str_hash(safe_strtype(mtime_sum))<br>```` |

### `prepare_html_str(input_string)`

Reformat html string and prepare for pyRevit output window.

pyRevit output window renders html content. But this means that < and >
characters in outputs from python (e.g. ) will be treated
as html tags. To avoid this, all <> characters that are defining
html content need to be replaced with special phrases. pyRevit output
later translates these phrases back in to < and >. That is how pyRevit
distinquishes between <> printed from python and <> that define html.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_string` | `str` | input html string | _required_ |

Examples:

```md-code__content
prepare_html_str('<p>Some text</p>')

```

"&clt;p&cgt;Some text&clt;/p&cgt;"

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>509<br>510<br>511<br>512<br>513<br>514<br>515<br>516<br>``` | ````md-code__content<br>def prepare_html_str(input_string):<br>    """Reformat html string and prepare for pyRevit output window.<br>    pyRevit output window renders html content. But this means that < and ><br>    characters in outputs from python (e.g. <class at xxx>) will be treated<br>    as html tags. To avoid this, all <> characters that are defining<br>    html content need to be replaced with special phrases. pyRevit output<br>    later translates these phrases back in to < and >. That is how pyRevit<br>    distinquishes between <> printed from python and <> that define html.<br>    Args:<br>        input_string (str): input html string<br>    Examples:<br>        ```python<br>        prepare_html_str('<p>Some text</p>')<br>        ```<br>        "&clt;p&cgt;Some text&clt;/p&cgt;"<br>    """<br>    return input_string.replace('<', '&clt;').replace('>', '&cgt;')<br>```` |

### `reverse_html(input_html)`

Reformat codified pyRevit output html string back to normal html.

pyRevit output window renders html content. But this means that < and >
characters in outputs from python (e.g. ) will be treated
as html tags. To avoid this, all <> characters that are defining
html content need to be replaced with special phrases. pyRevit output
later translates these phrases back in to < and >. That is how pyRevit
distinquishes between <> printed from python and <> that define html.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_html` | `str` | input codified html string | _required_ |

Examples:

```md-code__content
prepare_html_str('&clt;p&cgt;Some text&clt;/p&cgt;')

```

"

Some text

"

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>519<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>``` | ````md-code__content<br>def reverse_html(input_html):<br>    """Reformat codified pyRevit output html string back to normal html.<br>    pyRevit output window renders html content. But this means that < and ><br>    characters in outputs from python (e.g. <class at xxx>) will be treated<br>    as html tags. To avoid this, all <> characters that are defining<br>    html content need to be replaced with special phrases. pyRevit output<br>    later translates these phrases back in to < and >. That is how pyRevit<br>    distinquishes between <> printed from python and <> that define html.<br>    Args:<br>        input_html (str): input codified html string<br>    Examples:<br>        ```python<br>        prepare_html_str('&clt;p&cgt;Some text&clt;/p&cgt;')<br>        ```<br>        "<p>Some text</p>"<br>    """<br>    return input_html.replace('&clt;', '<').replace('&cgt;', '>')<br>```` |

### `escape_for_html(input_string)`

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>541<br>542<br>``` | ```md-code__content<br>def escape_for_html(input_string):<br>    return input_string.replace('<', '&lt;').replace('>', '&gt;')<br>``` |

### `read_url(url_to_open)`

Get the url and return response.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `url_to_open` | `str` | url to check access for | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>545<br>546<br>547<br>548<br>549<br>550<br>551<br>552<br>``` | ```md-code__content<br>def read_url(url_to_open):<br>    """Get the url and return response.<br>    Args:<br>        url_to_open (str): url to check access for<br>    """<br>    client = framework.WebClient()<br>    return client.DownloadString(url_to_open)<br>``` |

### `touch(fname, times=None)`

Update the timestamp on the given file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `fname` | `str` | target file path | _required_ |
| `times` | `int` | number of times to touch the file | `None` |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>555<br>556<br>557<br>558<br>559<br>560<br>561<br>562<br>563<br>``` | ```md-code__content<br>def touch(fname, times=None):<br>    """Update the timestamp on the given file.<br>    Args:<br>        fname (str): target file path<br>        times (int): number of times to touch the file<br>    """<br>    with open(fname, 'a'):<br>        os.utime(fname, times)<br>``` |

### `read_source_file(source_file_path)`

Read text file and return contents.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `source_file_path` | `str` | target file path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | file contents |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | on read error |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>566<br>567<br>568<br>569<br>570<br>571<br>572<br>573<br>574<br>575<br>576<br>577<br>578<br>579<br>580<br>581<br>582<br>583<br>``` | ```md-code__content<br>def read_source_file(source_file_path):<br>    """Read text file and return contents.<br>    Args:<br>        source_file_path (str): target file path<br>    Returns:<br>        (str): file contents<br>    Raises:<br>        PyRevitException: on read error<br>    """<br>    try:<br>        with open(source_file_path, 'r') as code_file:<br>            return code_file.read()<br>    except Exception as read_err:<br>        raise PyRevitException('Error reading source file: {} | {}'<br>                               .format(source_file_path, read_err))<br>``` |

### `open_folder_in_explorer(folder_path)`

Open given folder in Windows Explorer.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `folder_path` | `str` | directory path | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>586<br>587<br>588<br>589<br>590<br>591<br>592<br>593<br>594<br>``` | ```md-code__content<br>def open_folder_in_explorer(folder_path):<br>    """Open given folder in Windows Explorer.<br>    Args:<br>        folder_path (str): directory path<br>    """<br>    import subprocess<br>    subprocess.Popen(r'explorer /open,"{}"'<br>                     .format(os.path.normpath(folder_path)))<br>``` |

### `show_entry_in_explorer(entry_path)`

Show given entry in Windows Explorer.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `entry_path` | `str` | directory or file path | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>597<br>598<br>599<br>600<br>601<br>602<br>603<br>604<br>605<br>``` | ```md-code__content<br>def show_entry_in_explorer(entry_path):<br>    """Show given entry in Windows Explorer.<br>    Args:<br>        entry_path (str): directory or file path<br>    """<br>    import subprocess<br>    subprocess.Popen(r'explorer /select,"{}"'<br>                     .format(os.path.normpath(entry_path)))<br>``` |

### `fully_remove_dir(dir_path)`

Remove directory recursively.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `dir_path` | `str` | directory path | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>608<br>609<br>610<br>611<br>612<br>613<br>614<br>615<br>616<br>617<br>618<br>619<br>``` | ```md-code__content<br>def fully_remove_dir(dir_path):<br>    """Remove directory recursively.<br>    Args:<br>        dir_path (str): directory path<br>    """<br>    def del_rw(action, name, exc):   #pylint: disable=W0613<br>        """Force delete entry."""<br>        os.chmod(name, stat.S_IWRITE)<br>        os.remove(name)<br>    shutil.rmtree(dir_path, onerror=del_rw)<br>``` |

### `cleanup_filename(file_name, windows_safe=False)`

Cleanup file name from special characters.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_name` | `str` | file name | _required_ |
| `windows_safe` | `bool` | whether to use windows safe characters | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | cleaned up file name |

Examples:

```md-code__content
cleanup_filename('Myfile-(3).txt')

```

"Myfile(3).txt"

```md-code__content
cleanup_filename('Perforations 1/8" (New)')

```

"Perforations 18 (New).txt"

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>622<br>623<br>624<br>625<br>626<br>627<br>628<br>629<br>630<br>631<br>632<br>633<br>634<br>635<br>636<br>637<br>638<br>639<br>640<br>641<br>642<br>643<br>644<br>645<br>646<br>``` | ````md-code__content<br>def cleanup_filename(file_name, windows_safe=False):<br>    """Cleanup file name from special characters.<br>    Args:<br>        file_name (str): file name<br>        windows_safe (bool): whether to use windows safe characters<br>    Returns:<br>        (str): cleaned up file name<br>    Examples:<br>        ```python<br>        cleanup_filename('Myfile-(3).txt')<br>        ```<br>        "Myfile(3).txt"<br>        ```python<br>        cleanup_filename('Perforations 1/8" (New)')<br>        ```<br>        "Perforations 18 (New).txt"<br>    """<br>    if windows_safe:<br>        return re.sub(r'[\/:*?"<>|]', '', file_name)<br>    else:<br>        return re.sub(r'[^\w_.() -#]|["]', '', file_name)<br>```` |

### `increment_str(input_str, step=1, expand=False)`

Incremenet identifier.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_str` | `str` | identifier e.g. A310a | _required_ |
| `step` | `int` | number of steps to change the identifier | `1` |
| `expand` | `bool` | removes leading zeroes and duplicate letters | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | modified identifier |

Examples:

```md-code__content
increment_str('A319z')

```

'A320a'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>754<br>755<br>756<br>757<br>758<br>759<br>760<br>761<br>762<br>763<br>764<br>765<br>766<br>767<br>768<br>769<br>770<br>771<br>``` | ````md-code__content<br>def increment_str(input_str, step=1, expand=False):<br>    """Incremenet identifier.<br>    Args:<br>        input_str (str): identifier e.g. A310a<br>        step (int): number of steps to change the identifier<br>        expand (bool): removes leading zeroes and duplicate letters<br>    Returns:<br>        (str): modified identifier<br>    Examples:<br>        ```python<br>        increment_str('A319z')<br>        ```<br>        'A320a'<br>    """<br>    return _inc_or_dec_string(input_str, abs(step), refit=expand)<br>```` |

### `decrement_str(input_str, step=1, shrink=False)`

Decrement identifier.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_str` | `str` | identifier e.g. A310a | _required_ |
| `step` | `int` | number of steps to change the identifier | `1` |
| `shrink` | `bool` | removes leading zeroes or duplicate letters | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | modified identifier |

Examples:

```md-code__content
decrement_str('A310a')

```

'A309z'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>774<br>775<br>776<br>777<br>778<br>779<br>780<br>781<br>782<br>783<br>784<br>785<br>786<br>787<br>788<br>789<br>790<br>791<br>``` | ````md-code__content<br>def decrement_str(input_str, step=1, shrink=False):<br>    """Decrement identifier.<br>    Args:<br>        input_str (str): identifier e.g. A310a<br>        step (int): number of steps to change the identifier<br>        shrink (bool): removes leading zeroes or duplicate letters <br>    Returns:<br>        (str): modified identifier<br>    Examples:<br>        ```python<br>        decrement_str('A310a')<br>        ```<br>        'A309z'<br>    """<br>    return _inc_or_dec_string(input_str, -abs(step), refit=shrink)<br>```` |

### `extend_counter(input_str, upper=True, use_zero=False)`

Add a new level to identifier. e.g. A310 -> A310A.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_str` | `str` | identifier e.g. A310 | _required_ |
| `upper` | `bool` | use UPPERCASE characters for extension | `True` |
| `use_zero` | `bool` | start from 0 for numeric extension | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | extended identifier |

Examples:

```md-code__content
extend_counter('A310')

```

'A310A'

```md-code__content
extend_counter('A310A', use_zero=True)

```

'A310A0'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>794<br>795<br>796<br>797<br>798<br>799<br>800<br>801<br>802<br>803<br>804<br>805<br>806<br>807<br>808<br>809<br>810<br>811<br>812<br>813<br>814<br>815<br>816<br>817<br>818<br>``` | ````md-code__content<br>def extend_counter(input_str, upper=True, use_zero=False):<br>    """Add a new level to identifier. e.g. A310 -> A310A.<br>    Args:<br>        input_str (str): identifier e.g. A310<br>        upper (bool): use UPPERCASE characters for extension<br>        use_zero (bool): start from 0 for numeric extension<br>    Returns:<br>        (str): extended identifier<br>    Examples:<br>        ```python<br>        extend_counter('A310')<br>        ```<br>        'A310A'<br>        ```python<br>        extend_counter('A310A', use_zero=True)<br>        ```<br>        'A310A0'<br>    """<br>    if input_str[-1].isdigit():<br>        return input_str + ("A" if upper else "a")<br>    else:<br>        return input_str + ("0" if use_zero else "1")<br>```` |

### `filter_null_items(src_list)`

Remove None items in the given list.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `src_list` | `list[Any]` | list of any items | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[Any]` | cleaned list |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>821<br>822<br>823<br>824<br>825<br>826<br>827<br>828<br>829<br>830<br>``` | ```md-code__content<br>def filter_null_items(src_list):<br>    """Remove None items in the given list.<br>    Args:<br>        src_list (list[Any]): list of any items<br>    Returns:<br>        (list[Any]): cleaned list<br>    """<br>    return list(filter(bool, src_list))<br>``` |

### `reverse_dict(input_dict)`

Reverse the key, value pairs.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_dict` | `dict` | source ordered dict | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `defaultdict` | reversed dictionary |

Examples:

```md-code__content
reverse_dict({1: 2, 3: 4})

```

defaultdict(, {2: \[1\], 4: \[3\]})

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>833<br>834<br>835<br>836<br>837<br>838<br>839<br>840<br>841<br>842<br>843<br>844<br>845<br>846<br>847<br>848<br>849<br>850<br>851<br>``` | ````md-code__content<br>def reverse_dict(input_dict):<br>    """Reverse the key, value pairs.<br>    Args:<br>        input_dict (dict): source ordered dict<br>    Returns:<br>        (defaultdict): reversed dictionary<br>    Examples:<br>        ```python<br>        reverse_dict({1: 2, 3: 4})<br>        ```<br>        defaultdict(<type 'list'>, {2: [1], 4: [3]})<br>    """<br>    output_dict = defaultdict(list)<br>    for key, value in input_dict.items():<br>        output_dict[value].append(key)<br>    return output_dict<br>```` |

### `timestamp()`

Return timestamp for current time.

Returns:

| Type | Description |
| --- | --- |
| `str` | timestamp in string format |

Examples:

```md-code__content
timestamp()

```

'01003075032506808'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>854<br>855<br>856<br>857<br>858<br>859<br>860<br>861<br>862<br>863<br>864<br>865<br>866<br>``` | ````md-code__content<br>def timestamp():<br>    """Return timestamp for current time.<br>    Returns:<br>        (str): timestamp in string format<br>    Examples:<br>        ```python<br>        timestamp()<br>        ```<br>        '01003075032506808'<br>    """<br>    return datetime.datetime.now().strftime("%m%j%H%M%S%f")<br>```` |

### `current_time()`

Return formatted current time.

Current implementation uses %H:%M:%S to format time.

Returns:

| Type | Description |
| --- | --- |
| `str` | formatted current time. |

Examples:

```md-code__content
current_time()

```

'07:50:53'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>869<br>870<br>871<br>872<br>873<br>874<br>875<br>876<br>877<br>878<br>879<br>880<br>881<br>882<br>883<br>``` | ````md-code__content<br>def current_time():<br>    """Return formatted current time.<br>    Current implementation uses %H:%M:%S to format time.<br>    Returns:<br>        (str): formatted current time.<br>    Examples:<br>        ```python<br>        current_time()<br>        ```<br>        '07:50:53'<br>    """<br>    return datetime.datetime.now().strftime("%H:%M:%S")<br>```` |

### `current_date()`

Return formatted current date.

Current implementation uses %Y-%m-%d to format date.

Returns:

| Type | Description |
| --- | --- |
| `str` | formatted current date. |

Examples:

```md-code__content
current_date()

```

'2018-01-03'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>886<br>887<br>888<br>889<br>890<br>891<br>892<br>893<br>894<br>895<br>896<br>897<br>898<br>899<br>900<br>``` | ````md-code__content<br>def current_date():<br>    """Return formatted current date.<br>    Current implementation uses %Y-%m-%d to format date.<br>    Returns:<br>        (str): formatted current date.<br>    Examples:<br>        ```python<br>        current_date()<br>        ```<br>        '2018-01-03'<br>    """<br>    return datetime.datetime.now().strftime("%Y-%m-%d")<br>```` |

### `is_blank(input_string)`

Check if input string is blank (multiple white spaces is blank).

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_string` | `str` | input string | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if string is blank |

Examples:

```md-code__content
is_blank('   ')

```

True

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>903<br>904<br>905<br>906<br>907<br>908<br>909<br>910<br>911<br>912<br>913<br>914<br>915<br>916<br>917<br>918<br>919<br>920<br>``` | ````md-code__content<br>def is_blank(input_string):<br>    """Check if input string is blank (multiple white spaces is blank).<br>    Args:<br>        input_string (str): input string<br>    Returns:<br>        (bool): True if string is blank<br>    Examples:<br>        ```python<br>        is_blank('   ')<br>        ```<br>        True<br>    """<br>    if input_string and input_string.strip():<br>        return False<br>    return True<br>```` |

### `is_url_valid(url_string)`

Check if given URL is in valid format.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `url_string` | `str` | URL string | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if URL is in valid format |

Examples:

```md-code__content
is_url_valid('https://www.google.com')

```

True

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>923<br>924<br>925<br>926<br>927<br>928<br>929<br>930<br>931<br>932<br>933<br>934<br>935<br>936<br>937<br>938<br>939<br>940<br>941<br>942<br>943<br>944<br>945<br>946<br>947<br>``` | ````md-code__content<br>def is_url_valid(url_string):<br>    """Check if given URL is in valid format.<br>    Args:<br>        url_string (str): URL string<br>    Returns:<br>        (bool): True if URL is in valid format<br>    Examples:<br>        ```python<br>        is_url_valid('https://www.google.com')<br>        ```<br>        True<br>    """<br>    regex = re.compile(<br>        r'^(?:http|ftp)s?://'                   # http:// or https://<br>        r'(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\.)+'<br>        r'(?:[A-Z]{2,6}\.?|[A-Z0-9-]{2,}\.?)|'  # domain...<br>        r'localhost|'                           # localhost...<br>        r'\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})'  # ...or ip<br>        r'(?::\d+)?'                            # optional port<br>        r'(?:/?|[/?]\S+)$', re.IGNORECASE)<br>    return regex.match(url_string)<br>```` |

### `reformat_string(orig_str, orig_format, new_format)`

Reformat a string into a new format.

Extracts information from a string based on a given pattern,
and recreates a new string based on the given new pattern.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `orig_str` | `str` | Original string to be reformatted | _required_ |
| `orig_format` | `str` | Pattern of the original str (data to be extracted) | _required_ |
| `new_format` | `str` | New pattern (how to recompose the data) | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | Reformatted string |

Examples:

```md-code__content
reformat_string('150 - FLOOR/CEILING - WD - 1 HR - FLOOR ASSEMBLY',
                    '{section} - {loc} - {mat} - {rating} - {name}',
                    '{section}:{mat}:{rating} - {name} ({loc})'))

```

'150:WD:1 HR - FLOOR ASSEMBLY (FLOOR/CEILING)'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>950<br>951<br>952<br>953<br>954<br>955<br>956<br>957<br>958<br>959<br>960<br>961<br>962<br>963<br>964<br>965<br>966<br>967<br>968<br>969<br>970<br>971<br>972<br>973<br>974<br>975<br>976<br>977<br>978<br>979<br>980<br>981<br>982<br>983<br>984<br>985<br>986<br>987<br>988<br>989<br>990<br>991<br>``` | ````md-code__content<br>def reformat_string(orig_str, orig_format, new_format):<br>    """Reformat a string into a new format.<br>    Extracts information from a string based on a given pattern,<br>    and recreates a new string based on the given new pattern.<br>    Args:<br>        orig_str (str): Original string to be reformatted<br>        orig_format (str): Pattern of the original str (data to be extracted)<br>        new_format (str): New pattern (how to recompose the data)<br>    Returns:<br>        (str): Reformatted string<br>    Examples:<br>        ```python<br>        reformat_string('150 - FLOOR/CEILING - WD - 1 HR - FLOOR ASSEMBLY',<br>                            '{section} - {loc} - {mat} - {rating} - {name}',<br>                            '{section}:{mat}:{rating} - {name} ({loc})'))<br>        ```<br>        '150:WD:1 HR - FLOOR ASSEMBLY (FLOOR/CEILING)'<br>    """<br>    # find the tags<br>    tag_extractor = re.compile('{(.+?)}')<br>    tags = tag_extractor.findall(orig_format)<br>    # replace the tags with regex patterns<br>    # to create a regex pattern that finds values<br>    tag_replacer = re.compile('{.+?}')<br>    value_extractor_pattern = tag_replacer.sub('(.+)', orig_format)<br>    # find all values<br>    value_extractor = re.compile(value_extractor_pattern)<br>    match = value_extractor.match(orig_str)<br>    values = match.groups()<br>    # create a dictionary of tags and values<br>    reformat_dict = {}<br>    for key, value in zip(tags, values):<br>        reformat_dict[key] = value<br>    # use dictionary to reformat the string into new<br>    return new_format.format(**reformat_dict)<br>```` |

### `get_mapped_drives_dict()`

Return a dictionary of currently mapped network drives.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br> 994<br> 995<br> 996<br> 997<br> 998<br> 999<br>1000<br>1001<br>``` | ```md-code__content<br>def get_mapped_drives_dict():<br>    """Return a dictionary of currently mapped network drives."""<br>    searcher = framework.ManagementObjectSearcher(<br>        "root\\CIMV2",<br>        "SELECT * FROM Win32_MappedLogicalDisk"<br>        )<br>    return {x['DeviceID']: x['ProviderName'] for x in searcher.Get()}<br>``` |

### `dletter_to_unc(dletter_path)`

Convert drive letter path into UNC path of that drive.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `dletter_path` | `str` | drive letter path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | UNC path |

Examples:

```md-code__content
# assuming J: is mapped to //filestore/server/jdrive
dletter_to_unc('J:/somefile.txt')

```

'//filestore/server/jdrive/somefile.txt'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1004<br>1005<br>1006<br>1007<br>1008<br>1009<br>1010<br>1011<br>1012<br>1013<br>1014<br>1015<br>1016<br>1017<br>1018<br>1019<br>1020<br>1021<br>1022<br>1023<br>1024<br>``` | ````md-code__content<br>def dletter_to_unc(dletter_path):<br>    """Convert drive letter path into UNC path of that drive.<br>    Args:<br>        dletter_path (str): drive letter path<br>    Returns:<br>        (str): UNC path<br>    Examples:<br>        ```python<br>        # assuming J: is mapped to //filestore/server/jdrive<br>        dletter_to_unc('J:/somefile.txt')<br>        ```<br>        '//filestore/server/jdrive/somefile.txt'<br>    """<br>    drives = get_mapped_drives_dict()<br>    dletter = dletter_path[:2]<br>    for mapped_drive, server_path in drives.items():<br>        if dletter.lower() == mapped_drive.lower():<br>            return dletter_path.replace(dletter, server_path)<br>```` |

### `unc_to_dletter(unc_path)`

Convert UNC path into drive letter path.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `unc_path` | `str` | UNC path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | drive letter path |

Examples:

```md-code__content
# assuming J: is mapped to //filestore/server/jdrive
unc_to_dletter('//filestore/server/jdrive/somefile.txt')

```

'J:/somefile.txt'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1027<br>1028<br>1029<br>1030<br>1031<br>1032<br>1033<br>1034<br>1035<br>1036<br>1037<br>1038<br>1039<br>1040<br>1041<br>1042<br>1043<br>1044<br>1045<br>1046<br>``` | ````md-code__content<br>def unc_to_dletter(unc_path):<br>    """Convert UNC path into drive letter path.<br>    Args:<br>        unc_path (str): UNC path<br>    Returns:<br>        (str): drive letter path<br>    Examples:<br>        ```python<br>        # assuming J: is mapped to //filestore/server/jdrive<br>        unc_to_dletter('//filestore/server/jdrive/somefile.txt')<br>        ```<br>        'J:/somefile.txt'<br>    """<br>    drives = get_mapped_drives_dict()<br>    for mapped_drive, server_path in drives.items():<br>        if server_path in unc_path:<br>            return unc_path.replace(server_path, mapped_drive)<br>```` |

### `random_color()`

Return a random color channel value (between 0 and 255).

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1049<br>1050<br>1051<br>``` | ```md-code__content<br>def random_color():<br>    """Return a random color channel value (between 0 and 255)."""<br>    return random.randint(0, 255)<br>``` |

### `random_alpha()`

Return a random alpha value (between 0 and 1.00).

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1054<br>1055<br>1056<br>``` | ```md-code__content<br>def random_alpha():<br>    """Return a random alpha value (between 0 and 1.00)."""<br>    return round(random.random(), 2)<br>``` |

### `random_hex_color()`

Return a random color in hex format.

Examples:

```md-code__content
random_hex_color()

```

'#FF0000'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1059<br>1060<br>1061<br>1062<br>1063<br>1064<br>1065<br>1066<br>1067<br>1068<br>1069<br>1070<br>``` | ````md-code__content<br>def random_hex_color():<br>    """Return a random color in hex format.<br>    Examples:<br>        ```python<br>        random_hex_color()<br>        ```<br>        '#FF0000'<br>    """<br>    return '#%02X%02X%02X' % (random_color(),<br>                              random_color(),<br>                              random_color())<br>```` |

### `random_rgb_color()`

Return a random color in rgb format.

Examples:

```md-code__content
random_rgb_color()

```

'rgb(255, 0, 0)'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1073<br>1074<br>1075<br>1076<br>1077<br>1078<br>1079<br>1080<br>1081<br>1082<br>1083<br>1084<br>``` | ````md-code__content<br>def random_rgb_color():<br>    """Return a random color in rgb format.<br>    Examples:<br>        ```python<br>        random_rgb_color()<br>        ```<br>        'rgb(255, 0, 0)'<br>    """<br>    return 'rgb(%d, %d, %d)' % (random_color(),<br>                                random_color(),<br>                                random_color())<br>```` |

### `random_rgba_color()`

Return a random color in rgba format.

Examples:

```md-code__content
random_rgba_color()

```

'rgba(255, 0, 0, 0.5)'

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1087<br>1088<br>1089<br>1090<br>1091<br>1092<br>1093<br>1094<br>1095<br>1096<br>1097<br>1098<br>1099<br>``` | ````md-code__content<br>def random_rgba_color():<br>    """Return a random color in rgba format.<br>    Examples:<br>        ```python<br>        random_rgba_color()<br>        ```<br>        'rgba(255, 0, 0, 0.5)'<br>    """<br>    return 'rgba(%d, %d, %d, %.2f)' % (random_color(),<br>                                       random_color(),<br>                                       random_color(),<br>                                       random_alpha())<br>```` |

### `extract_range(formatted_str, max_range=500)`

Extract range from formatted string.

String must be formatted as below
A103 No range
A103-A106 A103 to A106
A103:A106 A103 to A106
A103,A105a A103 and A105a
A103;A105a A103 and A105a

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `formatted_str` | `str` | string specifying range | _required_ |
| `max_range` | `int` | maximum number of items to create. | `500` |

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | names in the specified range |

Examples:

```md-code__content
exract_range('A103:A106')

```

\['A103', 'A104', 'A105', 'A106'\]

```md-code__content
exract_range('S203-S206')

```

\['S203', 'S204', 'S205', 'S206'\]

```md-code__content
exract_range('M00A,M00B')

```

\['M00A', 'M00B'\]

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1102<br>1103<br>1104<br>1105<br>1106<br>1107<br>1108<br>1109<br>1110<br>1111<br>1112<br>1113<br>1114<br>1115<br>1116<br>1117<br>1118<br>1119<br>1120<br>1121<br>1122<br>1123<br>1124<br>1125<br>1126<br>1127<br>1128<br>1129<br>1130<br>1131<br>1132<br>1133<br>1134<br>1135<br>1136<br>1137<br>1138<br>1139<br>1140<br>1141<br>1142<br>1143<br>1144<br>1145<br>1146<br>1147<br>1148<br>1149<br>1150<br>1151<br>1152<br>1153<br>1154<br>``` | ````md-code__content<br>def extract_range(formatted_str, max_range=500):<br>    """Extract range from formatted string.<br>    String must be formatted as below<br>    A103            No range<br>    A103-A106       A103 to A106<br>    A103:A106       A103 to A106<br>    A103,A105a      A103 and A105a<br>    A103;A105a      A103 and A105a<br>    Args:<br>        formatted_str (str): string specifying range<br>        max_range (int): maximum number of items to create.<br>    Returns:<br>        (list[str]): names in the specified range<br>    Examples:<br>        ```python<br>        exract_range('A103:A106')<br>        ```<br>        ['A103', 'A104', 'A105', 'A106']<br>        ```python<br>        exract_range('S203-S206')<br>        ```<br>        ['S203', 'S204', 'S205', 'S206']<br>        ```python<br>        exract_range('M00A,M00B')<br>        ```<br>        ['M00A', 'M00B']<br>    """<br>    for rchar, rchartype in {'::': 'range', '--': 'range',<br>                             ',': 'list', ';': 'list'}.items():<br>        if rchar in formatted_str:<br>            if rchartype == 'range' \<br>                    and formatted_str.count(rchar) == 1:<br>                items = []<br>                start, end = formatted_str.split(rchar)<br>                assert len(start) == len(end), \<br>                    'Range start and end must have same length'<br>                items.append(start)<br>                item = increment_str(start, 1)<br>                safe_counter = 0<br>                while item != end:<br>                    items.append(item)<br>                    item = increment_str(item, 1)<br>                    safe_counter += 1<br>                    assert safe_counter < max_range, 'Max range reached.'<br>                items.append(end)<br>                return items<br>            elif rchartype == 'list':<br>                return [x.strip() for x in formatted_str.split(rchar)]<br>    return [formatted_str]<br>```` |

### `check_encoding_bom(filename, bom_bytes=codecs.BOM_UTF8)`

Check if given file contains the given BOM bytes at the start.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `filename` | `str` | file path | _required_ |
| `bom_bytes` | `bytes` | BOM bytes to check | `BOM_UTF8` |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1157<br>1158<br>1159<br>1160<br>1161<br>1162<br>1163<br>1164<br>1165<br>``` | ```md-code__content<br>def check_encoding_bom(filename, bom_bytes=codecs.BOM_UTF8):<br>    """Check if given file contains the given BOM bytes at the start.<br>    Args:<br>        filename (str): file path<br>        bom_bytes (bytes, optional): BOM bytes to check<br>    """<br>    with open(filename, 'rb') as rtfile:<br>        return rtfile.read()[:len(bom_bytes)] == bom_bytes<br>``` |

### `has_nonprintable(input_str)`

Check input string for non-printable characters.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_str` | `str` | input string | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if contains non-printable characters |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1168<br>1169<br>1170<br>1171<br>1172<br>1173<br>1174<br>1175<br>1176<br>1177<br>``` | ```md-code__content<br>def has_nonprintable(input_str):<br>    """Check input string for non-printable characters.<br>    Args:<br>        input_str (str): input string<br>    Returns:<br>        (bool): True if contains non-printable characters<br>    """<br>    return any([x in input_str for x in UNICODE_NONPRINTABLE_CHARS])<br>``` |

### `get_enum_values(enum_type)`

Returns enum values.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1180<br>1181<br>1182<br>``` | ```md-code__content<br>def get_enum_values(enum_type):<br>    """Returns enum values."""<br>    return framework.Enum.GetValues(enum_type)<br>``` |

### `get_enum_value(enum_type, value_string)`

Return enum value matching given value string (case insensitive).

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1185<br>1186<br>1187<br>1188<br>1189<br>``` | ```md-code__content<br>def get_enum_value(enum_type, value_string):<br>    """Return enum value matching given value string (case insensitive)."""<br>    for ftype in get_enum_values(enum_type):<br>        if str(ftype).lower() == value_string.lower():<br>            return ftype<br>``` |

### `get_enum_none(enum_type)`

Returns the None value in given Enum.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1192<br>1193<br>1194<br>1195<br>1196<br>``` | ```md-code__content<br>def get_enum_none(enum_type):<br>    """Returns the None value in given Enum."""<br>    for val in get_enum_values(enum_type):<br>        if str(val) == 'None':<br>            return val<br>``` |

### `extract_guid(source_str)`

Extract GUID number from a string.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1199<br>1200<br>1201<br>1202<br>1203<br>1204<br>1205<br>1206<br>1207<br>``` | ```md-code__content<br>def extract_guid(source_str):<br>    """Extract GUID number from a string."""<br>    guid_match = re.match(".*([0-9A-Fa-f]{8}"<br>                          "[-][0-9A-Fa-f]{4}"<br>                          "[-][0-9A-Fa-f]{4}"<br>                          "[-][0-9A-Fa-f]{4}"<br>                          "[-][0-9A-Fa-f]{12}).*", source_str)<br>    if guid_match:<br>        return guid_match.groups()[0]<br>``` |

### `format_hex_rgb(rgb_value)`

Formats rgb value as #RGB value string.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1210<br>1211<br>1212<br>1213<br>1214<br>1215<br>1216<br>1217<br>1218<br>``` | ```md-code__content<br>def format_hex_rgb(rgb_value):<br>    """Formats rgb value as #RGB value string."""<br>    if isinstance(rgb_value, str):<br>        if not rgb_value.startswith('#'):<br>            return '#%s' % rgb_value<br>        else:<br>            return rgb_value<br>    elif isinstance(rgb_value, int):<br>        return '#%x' % rgb_value<br>``` |

### `new_uuid()`

Create a new UUID (using dotnet Guid.NewGuid).

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1221<br>1222<br>1223<br>1224<br>1225<br>``` | ```md-code__content<br>def new_uuid():<br>    """Create a new UUID (using dotnet Guid.NewGuid)."""<br>    # RE: https://github.com/pyrevitlabs/pyRevit/issues/413<br>    # return uuid.uuid1()<br>    return str(Guid.NewGuid())<br>``` |

### `is_box_visible_on_screens(left, top, width, height)`

Check if given box is visible on any screen.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1228<br>1229<br>1230<br>1231<br>1232<br>1233<br>1234<br>1235<br>1236<br>1237<br>1238<br>1239<br>1240<br>``` | ```md-code__content<br>def is_box_visible_on_screens(left, top, width, height):<br>    """Check if given box is visible on any screen."""<br>    bounds = \<br>        framework.Drawing.Rectangle(<br>            framework.Convert.ToInt32(0 if math.isnan(left) else left),<br>            framework.Convert.ToInt32(0 if math.isnan(top) else top),<br>            framework.Convert.ToInt32(0 if math.isnan(width) else width),<br>            framework.Convert.ToInt32(0 if math.isnan(height) else height)<br>            )<br>    for scr in framework.Forms.Screen.AllScreens:<br>        if bounds.IntersectsWith(scr.Bounds):<br>            return True<br>    return False<br>``` |

### `fuzzy_search_ratio(target_string, sfilter, regex=False)`

Match target string against the filter and return a match ratio.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `target_string` | `str` | target string | _required_ |
| `sfilter` | `str` | search term | _required_ |
| `regex` | `bool` | treat the sfilter as regular expression pattern | `False` |

Returns:

| Type | Description |
| --- | --- |
| `int` | integer between 0 to 100, with 100 being the exact match |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1243<br>1244<br>1245<br>1246<br>1247<br>1248<br>1249<br>1250<br>1251<br>1252<br>1253<br>1254<br>1255<br>1256<br>1257<br>1258<br>1259<br>1260<br>1261<br>1262<br>1263<br>1264<br>1265<br>1266<br>1267<br>1268<br>1269<br>1270<br>1271<br>1272<br>1273<br>1274<br>1275<br>1276<br>1277<br>1278<br>1279<br>1280<br>1281<br>1282<br>1283<br>1284<br>1285<br>1286<br>1287<br>1288<br>1289<br>1290<br>1291<br>1292<br>1293<br>1294<br>1295<br>1296<br>1297<br>1298<br>1299<br>1300<br>1301<br>1302<br>1303<br>1304<br>1305<br>1306<br>1307<br>1308<br>1309<br>1310<br>1311<br>1312<br>1313<br>1314<br>1315<br>1316<br>1317<br>1318<br>1319<br>1320<br>1321<br>1322<br>1323<br>1324<br>1325<br>1326<br>1327<br>1328<br>1329<br>1330<br>1331<br>``` | ```md-code__content<br>def fuzzy_search_ratio(target_string, sfilter, regex=False):<br>    """Match target string against the filter and return a match ratio.<br>    Args:<br>        target_string (str): target string<br>        sfilter (str): search term<br>        regex (bool): treat the sfilter as regular expression pattern<br>    Returns:<br>        (int): integer between 0 to 100, with 100 being the exact match<br>    """<br>    tstring = target_string<br>    # process regex here. It's a yes no situation (100 or 0)<br>    if regex:<br>        try:<br>            if re.search(sfilter, tstring):<br>                return 100<br>        except Exception:<br>            pass<br>        return 0<br>    # 100 for identical matches<br>    if sfilter == tstring:<br>        return 100<br>    # 98 to 99 reserved (2 scores)<br>    # 97 for identical non-case-sensitive matches<br>    lower_tstring = tstring.lower()<br>    lower_sfilter_str = sfilter.lower()<br>    if lower_sfilter_str == lower_tstring:<br>        return 97<br>    # 95  to 96 reserved (2 scores)<br>    # 93 to 94 for inclusion matches<br>    if sfilter in tstring:<br>        return 94<br>    if lower_sfilter_str in lower_tstring:<br>        return 93<br>    # 91  to 92 reserved (2 scores)<br>    ## 80 to 90 for parts matches<br>    tstring_parts = tstring.split()<br>    sfilter_parts = sfilter.split()<br>    if all(x in tstring_parts for x in sfilter_parts):<br>        return 90<br>    # 88 to 89 reserved (2 scores)<br>    lower_tstring_parts = [x.lower() for x in tstring_parts]<br>    lower_sfilter_parts = [x.lower() for x in sfilter_parts]<br>    # exclude override<br>    if any(x[0] == '!' for x in sfilter_parts):<br>        exclude_indices = [<br>            lower_sfilter_parts.index(i) for i in lower_sfilter_parts<br>            if i[0] == '!'<br>        ]<br>        exclude_indices.reverse()<br>        exclude_list = [<br>            lower_sfilter_parts.pop(i) for i in exclude_indices<br>        ]<br>        for e in exclude_list:<br>            # doesn't contain<br>            if len(e) > 1:<br>                exclude_string = e[1:]<br>                if any(<br>                        [exclude_string in<br>                        part for part in lower_tstring_parts]<br>                ):<br>                    return 0<br>    if all(x in lower_tstring_parts for x in lower_sfilter_parts):<br>        return 87<br>    # 85 to 86 reserved (2 scores)<br>    if all(x in tstring for x in sfilter_parts):<br>        return 84<br>    # 82 to 83 reserved (2 scores)<br>    if all(x in lower_tstring for x in lower_sfilter_parts):<br>        return 81<br>    # 80 reserved<br>    return 0<br>``` |

### `get_exe_version(exepath)`

Extract Product Version value from EXE file.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1334<br>1335<br>1336<br>1337<br>``` | ```md-code__content<br>def get_exe_version(exepath):<br>    """Extract Product Version value from EXE file."""<br>    version_info = framework.Diagnostics.FileVersionInfo.GetVersionInfo(exepath)<br>    return version_info.ProductVersion<br>``` |

### `get_reg_key(key, subkey)`

Get value of the given Windows registry key and subkey.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `key` | `PyHKEY` | parent registry key | _required_ |
| `subkey` | `str` | subkey path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `PyHKEY` | registry key if found, None if not found |

Examples:

```md-code__content
get_reg_key(wr.HKEY_CURRENT_USER, 'Control Panel/International')

```

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1340<br>1341<br>1342<br>1343<br>1344<br>1345<br>1346<br>1347<br>1348<br>1349<br>1350<br>1351<br>1352<br>1353<br>1354<br>1355<br>1356<br>1357<br>1358<br>1359<br>``` | ````md-code__content<br>def get_reg_key(key, subkey):<br>    """Get value of the given Windows registry key and subkey.<br>    Args:<br>        key (PyHKEY): parent registry key<br>        subkey (str): subkey path<br>    Returns:<br>        (PyHKEY): registry key if found, None if not found<br>    Examples:<br>        ```python<br>        get_reg_key(wr.HKEY_CURRENT_USER, 'Control Panel/International')<br>        ```<br>        <PyHKEY at 0x...><br>    """<br>    try:<br>        return wr.OpenKey(key, subkey, 0, wr.KEY_READ)<br>    except Exception:<br>        return None<br>```` |

### `kill_tasks(task_name)`

Kill running tasks matching task\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `task_name` | `str` | task name | _required_ |

Examples:

```md-code__content
kill_tasks('Revit.exe')

```

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1362<br>1363<br>1364<br>1365<br>1366<br>1367<br>1368<br>1369<br>1370<br>1371<br>1372<br>1373<br>``` | ````md-code__content<br>def kill_tasks(task_name):<br>    """Kill running tasks matching task_name.<br>    Args:<br>        task_name (str): task name<br>    Examples:<br>        ```python<br>        kill_tasks('Revit.exe')<br>        ```<br>    """<br>    os.system("taskkill /f /im %s" % task_name)<br>```` |

### `int2hex_long(number)`

Integer to hexadecimal string.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1376<br>1377<br>1378<br>1379<br>``` | ```md-code__content<br>def int2hex_long(number):<br>    """Integer to hexadecimal string."""<br>    # python 2 fix of addin 'L' to long integers<br>    return hex(number).replace('L', '')<br>``` |

### `hex2int_long(hex_string)`

Hexadecimal string to Integer.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1382<br>1383<br>1384<br>1385<br>1386<br>``` | ```md-code__content<br>def hex2int_long(hex_string):<br>    """Hexadecimal string to Integer."""<br>    # python 2 fix of addin 'L' to long integers<br>    hex_string.replace('L', '')<br>    return int(hex_string, 16)<br>``` |

### `split_words(input_string)`

Splits given string by uppercase characters.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input_string` | `str` | input string | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | split string |

Examples:

```md-code__content
split_words("UIApplication_ApplicationClosing")

```

\['UIApplication', 'Application', 'Closing'\]

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1389<br>1390<br>1391<br>1392<br>1393<br>1394<br>1395<br>1396<br>1397<br>1398<br>1399<br>1400<br>1401<br>1402<br>1403<br>1404<br>1405<br>1406<br>1407<br>1408<br>1409<br>1410<br>1411<br>1412<br>1413<br>1414<br>1415<br>``` | ````md-code__content<br>def split_words(input_string):<br>    """Splits given string by uppercase characters.<br>    Args:<br>        input_string (str): input string<br>    Returns:<br>        (list[str]): split string<br>    Examples:<br>        ```python<br>        split_words("UIApplication_ApplicationClosing")<br>        ```<br>        ['UIApplication', 'Application', 'Closing']<br>    """<br>    parts = []<br>    part = ""<br>    for c in input_string:<br>        if c.isalpha():<br>            if c.isupper() and part and part[-1].islower():<br>                if part:<br>                    parts.append(part.strip())<br>                part = c<br>            else:<br>                part += c<br>    parts.append(part)<br>    return parts<br>```` |

### `get_paper_sizes(printer_name=None)`

Get paper sizes defined on this system.

Returns:

| Type | Description |
| --- | --- |
| `list[]` | list of papersize instances |

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1418<br>1419<br>1420<br>1421<br>1422<br>1423<br>1424<br>1425<br>1426<br>1427<br>``` | ```md-code__content<br>def get_paper_sizes(printer_name=None):<br>    """Get paper sizes defined on this system.<br>    Returns:<br>        (list[]): list of papersize instances<br>    """<br>    print_settings = framework.Drawing.Printing.PrinterSettings()<br>    if printer_name:<br>        print_settings.PrinterName = printer_name<br>    return list(print_settings.PaperSizes)<br>``` |

### `get_integer_length(number)`

Return digit length of given number.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1430<br>1431<br>1432<br>``` | ```md-code__content<br>def get_integer_length(number):<br>    """Return digit length of given number."""<br>    return 1 if number == 0 else (math.floor(math.log10(number)) + 1)<br>``` |

### `get_my_ip()`

Return local ip address of this machine.

Source code in `pyrevitlib/pyrevit/coreutils/__init__.py`

|     |     |
| --- | --- |
| ```<br>1435<br>1436<br>1437<br>``` | ```md-code__content<br>def get_my_ip():<br>    """Return local ip address of this machine."""<br>    return socket.gethostbyname(socket.gethostname())<br>``` |

Back to top

## pyRevit Labs Module
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/labs/#pyrevit.labs)

# labs

Wrapper module for pyRevitLabs functionality.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `config = NLog.Config.LoggingConfiguration()``module-attribute`

### `target = PyRevitOutputTarget()``module-attribute`

### `nlog_mlogger = NLog.LogManager.GetLogger(__name__)``module-attribute`

## Classes

### `PyRevitOutputTarget`

Bases: `TargetWithLayout`

NLog target to direct log messages to pyRevit output window.

#### Functions

##### `Write(asyncLogEvent)`

Write event handler.

Source code in `pyrevitlib/pyrevit/labs.py`

|     |     |
| --- | --- |
| ```<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>``` | ```md-code__content<br>def Write(self, asyncLogEvent):<br>    """Write event handler."""<br>    try:<br>        event = asyncLogEvent.LogEvent<br>        level = self.convert_level(event.Level)<br>        if mlogger.is_enabled_for(level):<br>            print(self.Layout.Render(event))    #pylint: disable=E1101<br>    except Exception as e:<br>        print(e)<br>``` |

##### `convert_level(nlog_level)`

Convert Nlog levels to pything logging levels.

Source code in `pyrevitlib/pyrevit/labs.py`

|     |     |
| --- | --- |
| ```<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>``` | ```md-code__content<br>def convert_level(self, nlog_level):<br>    """Convert Nlog levels to pything logging levels."""<br>    if nlog_level == NLog.LogLevel.Fatal:<br>        return logging.CRITICAL<br>    elif nlog_level == NLog.LogLevel.Error:<br>        return logging.ERROR<br>    elif nlog_level == NLog.LogLevel.Info:<br>        return logging.INFO<br>    elif nlog_level == NLog.LogLevel.Debug:<br>        return logging.DEBUG<br>    elif nlog_level == NLog.LogLevel.Off:<br>        return logging.DEBUG<br>    elif nlog_level == NLog.LogLevel.Trace:<br>        return logging.DEBUG<br>    elif nlog_level == NLog.LogLevel.Warn:<br>        return logging.WARNING<br>``` |

## Functions

### `extract_build_from_exe(proc_path)`

Extract build number from host .exe file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `proc_path` | `str` | full path of the host .exe file | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | build number (e.g. '20170927\_1515(x64)') |

Source code in `pyrevitlib/pyrevit/labs.py`

|     |     |
| --- | --- |
| ```<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>``` | ```md-code__content<br>def extract_build_from_exe(proc_path):<br>    """Extract build number from host .exe file.<br>    Args:<br>        proc_path (str): full path of the host .exe file<br>    Returns:<br>        (str): build number (e.g. '20170927_1515(x64)')<br>    """<br>    # Revit 2021 has a bug on .VersionBuild<br>    ## it reports identical value as .VersionNumber<br>    pinfo = TargetApps.Revit.RevitProductData.GetBinaryProductInfo(proc_path)<br>    return "{}({})".format(pinfo.build, pinfo.target) \<br>        if pinfo.build else "20000101_0000(x64)"<br>``` |

Back to top

## pyRevit Forms Reference
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/forms/#pyrevit.forms)

# forms

Reusable WPF forms for pyRevit.

Examples:

```md-code__content
from pyrevit.forms import WPFWindow

```

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `DEFAULT_CMDSWITCHWND_WIDTH = 600``module-attribute`

### `DEFAULT_SEARCHWND_WIDTH = 600``module-attribute`

### `DEFAULT_SEARCHWND_HEIGHT = 100``module-attribute`

### `DEFAULT_INPUTWINDOW_WIDTH = 500``module-attribute`

### `DEFAULT_INPUTWINDOW_HEIGHT = 600``module-attribute`

### `DEFAULT_RECOGNIZE_ACCESS_KEY = False``module-attribute`

### `WPF_HIDDEN = framework.Windows.Visibility.Hidden``module-attribute`

### `WPF_COLLAPSED = framework.Windows.Visibility.Collapsed``module-attribute`

### `WPF_VISIBLE = framework.Windows.Visibility.Visible``module-attribute`

### `XAML_FILES_DIR = op.dirname(__file__)``module-attribute`

### `ParamDef = namedtuple('ParamDef', ['name', 'istype', 'definition', 'isreadonly'])``module-attribute`

Parameter definition tuple.

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `name` | `str` | parameter name |
| `istype` | `bool` | true if type parameter, otherwise false |
| `definition` | `Definition` | parameter definition object |
| `isreadonly` | `bool` | true if the parameter value can't be edited |

## Classes

### `reactive(getter)`

Bases: `property`

Decorator for WPF bound properties.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>``` | ```md-code__content<br>def __init__(self, getter):<br>    def newgetter(ui_control):<br>        try:<br>            return getter(ui_control)<br>        except AttributeError:<br>            return None<br>    super(reactive, self).__init__(newgetter)<br>``` |

#### Functions

##### `setter(setter)`

Property setter.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>``` | ```md-code__content<br>def setter(self, setter):<br>    """Property setter."""<br>    def newsetter(ui_control, newvalue):<br>        oldvalue = self.fget(ui_control)<br>        if oldvalue != newvalue:<br>            setter(ui_control, newvalue)<br>            ui_control.OnPropertyChanged(setter.__name__)<br>    return property(<br>        fget=self.fget,<br>        fset=newsetter,<br>        fdel=self.fdel,<br>        doc=self.__doc__)<br>``` |

### `Reactive`

Bases: `INotifyPropertyChanged`

WPF property updator base mixin.

#### Functions

##### `add_PropertyChanged(value)`

Called when a property is added to the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>113<br>114<br>115<br>``` | ```md-code__content<br>def add_PropertyChanged(self, value):<br>    """Called when a property is added to the object."""<br>    self.PropertyChanged += value<br>``` |

##### `remove_PropertyChanged(value)`

Called when a property is removed from the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>``` | ```md-code__content<br>def remove_PropertyChanged(self, value):<br>    """Called when a property is removed from the object."""<br>    self.PropertyChanged -= value<br>``` |

##### `OnPropertyChanged(prop_name)`

Called when a property is changed.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `prop_name` | `str` | property name | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def OnPropertyChanged(self, prop_name):<br>    """Called when a property is changed.<br>    Args:<br>        prop_name (str): property name<br>    """<br>    if self._propertyChangedCaller:<br>        args = ComponentModel.PropertyChangedEventArgs(prop_name)<br>        self._propertyChangedCaller(self, args)<br>``` |

### `WindowToggler(window)`

Bases: `object`

Context manager to toggle window visibility.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>134<br>135<br>``` | ```md-code__content<br>def __init__(self, window):<br>    self._window = window<br>``` |

### `WPFWindow(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Bases: `Window`

WPF Window base class for all pyRevit forms.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml source filepath or xaml content | _required_ |
| `literal_string` | `bool` | xaml\_source contains xaml content, not filepath | `False` |
| `handle_esc` | `bool` | handle Escape button and close the window | `True` |
| `set_owner` | `bool` | set the owner of window to host app window | `True` |

Examples:

```md-code__content
from pyrevit import forms
layout = '<Window ' \
         'xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" ' \
         'xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" ' \
         'ShowInTaskbar="False" ResizeMode="NoResize" ' \
         'WindowStartupLocation="CenterScreen" ' \
         'HorizontalContentAlignment="Center">' \
         '</Window>'
w = forms.WPFWindow(layout, literal_string=True)
w.show()

```

Initialize WPF window and resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>``` | ```md-code__content<br>def __init__(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Initialize WPF window and resources."""<br>    # load xaml<br>    self.load_xaml(<br>        xaml_source,<br>        literal_string=literal_string,<br>        handle_esc=handle_esc,<br>        set_owner=set_owner<br>        )<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard input and close the window on Escape.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>306<br>307<br>308<br>309<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input and close the window on Escape."""<br>    if args.Key == Input.Key.Escape:<br>        self.Close()<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show(modal=False)`

Show window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>323<br>324<br>325<br>326<br>327<br>328<br>``` | ```md-code__content<br>def show(self, modal=False):<br>    """Show window."""<br>    if modal:<br>        return self.ShowDialog()<br>    # else open non-modal<br>    self.Show()<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

### `WPFPanel()`

Bases: `Page`

WPF panel base class for all pyRevit dockable panels.

panel\_id (str) must be set on the type to dockable panel uuid
panel\_source (str): xaml source filepath

Examples:

```md-code__content
from pyrevit import forms
class MyPanel(forms.WPFPanel):
    panel_id = "181e05a4-28f6-4311-8a9f-d2aa528c8755"
    panel_source = "MyPanel.xaml"

forms.register_dockable_panel(MyPanel)
# then from the button that needs to open the panel
forms.open_dockable_panel("181e05a4-28f6-4311-8a9f-d2aa528c8755")

```

Initialize WPF panel and resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>``` | ```md-code__content<br>def __init__(self):<br>    """Initialize WPF panel and resources."""<br>    if not self.panel_id:<br>        raise PyRevitException("\"panel_id\" property is not set")<br>    if not self.panel_source:<br>        raise PyRevitException("\"panel_source\" property is not set")<br>    if not op.exists(self.panel_source):<br>        wpf.LoadComponent(self,<br>                          os.path.join(EXEC_PARAMS.command_path,<br>                          self.panel_source))<br>    else:<br>        wpf.LoadComponent(self, self.panel_source)<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    WPFWindow.setup_resources(self)<br>``` |

#### Attributes

##### `panel_id = None``class-attribute``instance-attribute`

##### `panel_source = None``class-attribute``instance-attribute`

##### `thread_id = framework.get_current_thread_id()``instance-attribute`

#### Functions

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>509<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    WPFPanel.hide_element(*wpf_elements)<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>511<br>512<br>513<br>514<br>515<br>516<br>517<br>518<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    WPFPanel.show_element(*wpf_elements)<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    WPFPanel.toggle_element(*wpf_elements)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    WPFPanel.disable_element(*wpf_elements)<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>538<br>539<br>540<br>541<br>542<br>543<br>544<br>545<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list): WPF framework elements to be enabled<br>    """<br>    WPFPanel.enable_element(*wpf_elements)<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>547<br>548<br>549<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

### `TemplateUserInputWindow(context, title, width, height, **kwargs)`

Bases: `WPFWindow`

Base class for pyRevit user input standard forms.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `context` | `any` | window context element(s) | _required_ |
| `title` | `str` | window title | _required_ |
| `width` | `int` | window width | _required_ |
| `height` | `int` | window height | _required_ |
| `**kwargs` | `Any` | other arguments to be passed to :func: `_setup` | `{}` |

Initialize user input window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>665<br>666<br>667<br>668<br>669<br>670<br>671<br>672<br>673<br>674<br>675<br>676<br>677<br>678<br>679<br>680<br>681<br>682<br>683<br>684<br>685<br>``` | ```md-code__content<br>def __init__(self, context, title, width, height, **kwargs):<br>    """Initialize user input window."""<br>    WPFWindow.__init__(self,<br>                       op.join(XAML_FILES_DIR, self.xaml_source),<br>                       handle_esc=True)<br>    self.Title = title or 'pyRevit'<br>    self.Width = width<br>    self.Height = height<br>    self._context = context<br>    self.response = None<br>    # parent window?<br>    owner = kwargs.get('owner', None)<br>    if owner:<br>        # set wpf windows directly<br>        self.Owner = owner<br>        self.WindowStartupLocation = \<br>            framework.Windows.WindowStartupLocation.CenterOwner<br>    self._setup(**kwargs)<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

##### `xaml_source = 'BaseWindow.xaml'``class-attribute``instance-attribute`

##### `Title = title or 'pyRevit'``instance-attribute`

##### `Width = width``instance-attribute`

##### `Height = height``instance-attribute`

##### `response = None``instance-attribute`

##### `Owner = owner``instance-attribute`

##### `WindowStartupLocation = framework.Windows.WindowStartupLocation.CenterOwner``instance-attribute`

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard input and close the window on Escape.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>306<br>307<br>308<br>309<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input and close the window on Escape."""<br>    if args.Key == Input.Key.Escape:<br>        self.Close()<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

##### `show(context, title='User Input', width=DEFAULT_INPUTWINDOW_WIDTH, height=DEFAULT_INPUTWINDOW_HEIGHT, **kwargs)``classmethod`

Show user input window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `context` | `any` | window context element(s) | _required_ |
| `title` | `str` | window title | `'User Input'` |
| `width` | `int` | window width | `DEFAULT_INPUTWINDOW_WIDTH` |
| `height` | `int` | window height | `DEFAULT_INPUTWINDOW_HEIGHT` |
| `**kwargs` | `any` | other arguments to be passed to window | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>691<br>692<br>693<br>694<br>695<br>696<br>697<br>698<br>699<br>700<br>701<br>702<br>703<br>704<br>705<br>706<br>707<br>``` | ```md-code__content<br>@classmethod<br>def show(cls, context,  #pylint: disable=W0221<br>         title='User Input',<br>         width=DEFAULT_INPUTWINDOW_WIDTH,<br>         height=DEFAULT_INPUTWINDOW_HEIGHT, **kwargs):<br>    """Show user input window.<br>    Args:<br>        context (any): window context element(s)<br>        title (str): window title<br>        width (int): window width<br>        height (int): window height<br>        **kwargs (any): other arguments to be passed to window<br>    """<br>    dlg = cls(context, title, width, height, **kwargs)<br>    dlg.ShowDialog()<br>    return dlg.response<br>``` |

### `TemplateListItem(orig_item, checked=False, checkable=True, name_attr=None)`

Bases: `Reactive`

Base class for checkbox option wrapping another object.

Initialize the checkbox option and wrap given obj.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `orig_item` | `any` | Object to wrap (must have name property<br>or be convertable to string with str() | _required_ |
| `checked` | `bool` | Initial state. Defaults to False | `False` |
| `checkable` | `bool` | Use checkbox for items | `True` |
| `name_attr` | `str` | Get this attribute of wrapped object as name | `None` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>713<br>714<br>715<br>716<br>717<br>718<br>719<br>720<br>721<br>722<br>723<br>724<br>725<br>726<br>727<br>728<br>``` | ```md-code__content<br>def __init__(self, orig_item,<br>             checked=False, checkable=True, name_attr=None):<br>    """Initialize the checkbox option and wrap given obj.<br>    Args:<br>        orig_item (any): Object to wrap (must have name property<br>                         or be convertable to string with str()<br>        checked (bool): Initial state. Defaults to False<br>        checkable (bool): Use checkbox for items<br>        name_attr (str): Get this attribute of wrapped object as name<br>    """<br>    super(TemplateListItem, self).__init__()<br>    self.item = orig_item<br>    self.state = checked<br>    self._nameattr = name_attr<br>    self._checkable = checkable<br>``` |

#### Attributes

##### `item = orig_item``instance-attribute`

##### `state = checked``instance-attribute`

##### `name``property`

Name property.

##### `checkable``property``writable`

List Item CheckBox Visibility.

#### Functions

##### `add_PropertyChanged(value)`

Called when a property is added to the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>113<br>114<br>115<br>``` | ```md-code__content<br>def add_PropertyChanged(self, value):<br>    """Called when a property is added to the object."""<br>    self.PropertyChanged += value<br>``` |

##### `remove_PropertyChanged(value)`

Called when a property is removed from the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>``` | ```md-code__content<br>def remove_PropertyChanged(self, value):<br>    """Called when a property is removed from the object."""<br>    self.PropertyChanged -= value<br>``` |

##### `OnPropertyChanged(prop_name)`

Called when a property is changed.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `prop_name` | `str` | property name | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def OnPropertyChanged(self, prop_name):<br>    """Called when a property is changed.<br>    Args:<br>        prop_name (str): property name<br>    """<br>    if self._propertyChangedCaller:<br>        args = ComponentModel.PropertyChangedEventArgs(prop_name)<br>        self._propertyChangedCaller(self, args)<br>``` |

##### `unwrap()`

Unwrap and return wrapped object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>753<br>754<br>755<br>``` | ```md-code__content<br>def unwrap(self):<br>    """Unwrap and return wrapped object."""<br>    return self.item<br>``` |

##### `checked(value)`

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>762<br>763<br>764<br>``` | ```md-code__content<br>@checked.setter<br>def checked(self, value):<br>    self.state = value<br>``` |

### `SelectFromList(context, title, width, height, **kwargs)`

Bases: `TemplateUserInputWindow`

Standard form to select from a list of items.

Any object can be passed in a list to the `context` argument. This class
wraps the objects passed to context, in `TemplateListItem`.
This class provides the necessary mechanism to make this form work both
for selecting items from a list, and from a list of checkboxes. See the
list of arguments below for additional options and features.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `context` | `list[str] or dict[list[str]]` | list of items to be selected from<br>OR<br>dict of list of items to be selected from.<br>use dict when input items need to be grouped<br>e.g. List of sheets grouped by sheet set. | _required_ |
| `title` | `str` | window title. see super class for defaults. | _required_ |
| `width` | `int` | window width. see super class for defaults. | _required_ |
| `height` | `int` | window height. see super class for defaults. | _required_ |

Other Parameters:

| Name | Type | Description |
| --- | --- | --- |
| `button_name` | `str` | name of select button. defaults to 'Select' |
| `name_attr` | `str` | object attribute that should be read as item name. |
| `multiselect` | `bool` | allow multi-selection (uses check boxes). defaults to False |
| `info_panel` | `bool` | show information panel and fill with .description property of item |
| `return_all` | `bool` | return all items. This is handly when some input items have states<br>and the script needs to check the state changes on all items.<br>This options works in multiselect mode only. defaults to False |
| `filterfunc` | `function` | filter function to be applied to context items. |
| `resetfunc` | `function` | reset function to be called when user clicks on Reset button |
| `group_selector_title` | `str` | title for list group selector. defaults to 'List Group' |
| `default_group` | `str` | name of defautl group to be selected |
| `sort_groups` | `str` | Determines the sorting type applied to the list groups. This attribute can take one of the following values:<br>'sorted': This will sort the groups in standard alphabetical order<br>'natural': This will sort the groups in a manner that is more intuitive for human perception, especially when there are numbers involved.<br>'unsorted': The groups will maintain the original order in which they were provided, without any reordering.<br>Defaults to 'sorted'. |

Examples:

```md-code__content
from pyrevit import forms
items = ['item1', 'item2', 'item3']
forms.SelectFromList.show(items, button_name='Select Item')
['item1']

```

```md-code__content
from pyrevit import forms
ops = [viewsheet1, viewsheet2, viewsheet3]
res = forms.SelectFromList.show(ops,
                                multiselect=False,
                                name_attr='Name',
                                button_name='Select Sheet')

```

```md-code__content
from pyrevit import forms
ops = {'Sheet Set A': [viewsheet1, viewsheet2, viewsheet3],
       'Sheet Set B': [viewsheet4, viewsheet5, viewsheet6]}
res = forms.SelectFromList.show(ops,
                                multiselect=True,
                                name_attr='Name',
                                group_selector_title='Sheet Sets',
                                button_name='Select Sheets',
                                sort_groups='sorted')

```

This module also provides a wrapper base class :obj: `TemplateListItem`
for when the checkbox option is wrapping another element,
e.g. a Revit ViewSheet. Derive from this base class and define the
name property to customize how the checkbox is named on the dialog.

```md-code__content
from pyrevit import forms
class MyOption(forms.TemplateListItem):
   @property
   def name(self):
       return '{} - {}{}'.format(self.item.SheetNumber,
                                 self.item.SheetNumber)
ops = [MyOption('op1'), MyOption('op2', True), MyOption('op3')]
res = forms.SelectFromList.show(ops,
                                multiselect=True,
                                button_name='Select Item')
[bool(x) for x in res]  # or [x.state for x in res]
[True, False, True]

```

Initialize user input window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>665<br>666<br>667<br>668<br>669<br>670<br>671<br>672<br>673<br>674<br>675<br>676<br>677<br>678<br>679<br>680<br>681<br>682<br>683<br>684<br>685<br>``` | ```md-code__content<br>def __init__(self, context, title, width, height, **kwargs):<br>    """Initialize user input window."""<br>    WPFWindow.__init__(self,<br>                       op.join(XAML_FILES_DIR, self.xaml_source),<br>                       handle_esc=True)<br>    self.Title = title or 'pyRevit'<br>    self.Width = width<br>    self.Height = height<br>    self._context = context<br>    self.response = None<br>    # parent window?<br>    owner = kwargs.get('owner', None)<br>    if owner:<br>        # set wpf windows directly<br>        self.Owner = owner<br>        self.WindowStartupLocation = \<br>            framework.Windows.WindowStartupLocation.CenterOwner<br>    self._setup(**kwargs)<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

##### `Title = title or 'pyRevit'``instance-attribute`

##### `Width = width``instance-attribute`

##### `Height = height``instance-attribute`

##### `response = None``instance-attribute`

##### `Owner = owner``instance-attribute`

##### `WindowStartupLocation = framework.Windows.WindowStartupLocation.CenterOwner``instance-attribute`

##### `in_check = False``class-attribute``instance-attribute`

##### `in_uncheck = False``class-attribute``instance-attribute`

##### `xaml_source = 'SelectFromList.xaml'``class-attribute``instance-attribute`

##### `use_regex``property`

Is using regex?

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard input and close the window on Escape.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>306<br>307<br>308<br>309<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input and close the window on Escape."""<br>    if args.Key == Input.Key.Escape:<br>        self.Close()<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show(context, title='User Input', width=DEFAULT_INPUTWINDOW_WIDTH, height=DEFAULT_INPUTWINDOW_HEIGHT, **kwargs)``classmethod`

Show user input window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `context` | `any` | window context element(s) | _required_ |
| `title` | `str` | window title | `'User Input'` |
| `width` | `int` | window width | `DEFAULT_INPUTWINDOW_WIDTH` |
| `height` | `int` | window height | `DEFAULT_INPUTWINDOW_HEIGHT` |
| `**kwargs` | `any` | other arguments to be passed to window | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>691<br>692<br>693<br>694<br>695<br>696<br>697<br>698<br>699<br>700<br>701<br>702<br>703<br>704<br>705<br>706<br>707<br>``` | ```md-code__content<br>@classmethod<br>def show(cls, context,  #pylint: disable=W0221<br>         title='User Input',<br>         width=DEFAULT_INPUTWINDOW_WIDTH,<br>         height=DEFAULT_INPUTWINDOW_HEIGHT, **kwargs):<br>    """Show user input window.<br>    Args:<br>        context (any): window context element(s)<br>        title (str): window title<br>        width (int): window width<br>        height (int): window height<br>        **kwargs (any): other arguments to be passed to window<br>    """<br>    dlg = cls(context, title, width, height, **kwargs)<br>    dlg.ShowDialog()<br>    return dlg.response<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

##### `toggle_all(sender, args)`

Handle toggle all button to toggle state of all check boxes.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1091<br>1092<br>1093<br>``` | ```md-code__content<br>def toggle_all(self, sender, args):    #pylint: disable=W0613<br>    """Handle toggle all button to toggle state of all check boxes."""<br>    self._set_states(flip=True)<br>``` |

##### `check_all(sender, args)`

Handle check all button to mark all check boxes as checked.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1095<br>1096<br>1097<br>``` | ```md-code__content<br>def check_all(self, sender, args):    #pylint: disable=W0613<br>    """Handle check all button to mark all check boxes as checked."""<br>    self._set_states(state=True)<br>``` |

##### `uncheck_all(sender, args)`

Handle uncheck all button to mark all check boxes as un-checked.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1099<br>1100<br>1101<br>``` | ```md-code__content<br>def uncheck_all(self, sender, args):    #pylint: disable=W0613<br>    """Handle uncheck all button to mark all check boxes as un-checked."""<br>    self._set_states(state=False)<br>``` |

##### `check_selected(sender, args)`

Mark selected checkboxes as checked.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1103<br>1104<br>1105<br>1106<br>1107<br>1108<br>1109<br>1110<br>``` | ```md-code__content<br>def check_selected(self, sender, args):    #pylint: disable=W0613<br>    """Mark selected checkboxes as checked."""<br>    if not self.in_check:<br>        try:<br>            self.in_check = True<br>            self._set_states(state=True, selected=True)<br>        finally:<br>            self.in_check = False<br>``` |

##### `uncheck_selected(sender, args)`

Mark selected checkboxes as unchecked.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1112<br>1113<br>1114<br>1115<br>1116<br>1117<br>1118<br>1119<br>``` | ```md-code__content<br>def uncheck_selected(self, sender, args):    #pylint: disable=W0613<br>    """Mark selected checkboxes as unchecked."""<br>    if not self.in_uncheck:<br>        try:<br>            self.in_uncheck = True<br>            self._set_states(state=False, selected=True)<br>        finally:<br>            self.in_uncheck = False<br>``` |

##### `button_reset(sender, args)`

Handle reset button click.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1121<br>1122<br>1123<br>1124<br>1125<br>``` | ```md-code__content<br>def button_reset(self, sender, args):#pylint: disable=W0613<br>    """Handle reset button click."""<br>    if self.reset_func:<br>        all_items = self.list_lb.ItemsSource<br>        self.reset_func(all_items)<br>``` |

##### `button_select(sender, args)`

Handle select button click.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1127<br>1128<br>1129<br>1130<br>``` | ```md-code__content<br>def button_select(self, sender, args):    #pylint: disable=W0613<br>    """Handle select button click."""<br>    self.response = self._get_options()<br>    self.Close()<br>``` |

##### `search_txt_changed(sender, args)`

Handle text change in search box.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1132<br>1133<br>1134<br>1135<br>1136<br>1137<br>1138<br>1139<br>1140<br>1141<br>1142<br>``` | ```md-code__content<br>def search_txt_changed(self, sender, args):    #pylint: disable=W0613<br>    """Handle text change in search box."""<br>    if self.info_panel:<br>        self._toggle_info_panel(state=False)<br>    if self.search_tb.Text == '':<br>        self.hide_element(self.clrsearch_b)<br>    else:<br>        self.show_element(self.clrsearch_b)<br>    self._list_options(option_filter=self.search_tb.Text)<br>``` |

##### `selection_changed(sender, args)`

Handle selection change.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1144<br>1145<br>1146<br>1147<br>1148<br>1149<br>``` | ```md-code__content<br>def selection_changed(self, sender, args):<br>    """Handle selection change."""<br>    if self.info_panel:<br>        self._toggle_info_panel(state=False)<br>    self._list_options(option_filter=self.search_tb.Text)<br>``` |

##### `selected_item_changed(sender, args)`

Handle selected item change.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1151<br>1152<br>1153<br>1154<br>1155<br>1156<br>``` | ```md-code__content<br>def selected_item_changed(self, sender, args):<br>    """Handle selected item change."""<br>    if self.info_panel and self.list_lb.SelectedItem is not None:<br>        self._toggle_info_panel(state=True)<br>        self.infoData.Text = \<br>            getattr(self.list_lb.SelectedItem, 'description', '')<br>``` |

##### `toggle_regex(sender, args)`

Activate regex in search.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1158<br>1159<br>1160<br>1161<br>1162<br>1163<br>1164<br>``` | ```md-code__content<br>def toggle_regex(self, sender, args):<br>    """Activate regex in search."""<br>    self.regexToggle_b.Content = \<br>        self.Resources['regexIcon'] if self.use_regex \<br>            else self.Resources['filterIcon']<br>    self.search_txt_changed(sender, args)<br>    self.search_tb.Focus()<br>``` |

##### `clear_search(sender, args)`

Clear search box.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1166<br>1167<br>1168<br>1169<br>1170<br>``` | ```md-code__content<br>def clear_search(self, sender, args):    #pylint: disable=W0613<br>    """Clear search box."""<br>    self.search_tb.Text = ' '<br>    self.search_tb.Clear()<br>    self.search_tb.Focus()<br>``` |

### `CommandSwitchWindow(context, title, width, height, **kwargs)`

Bases: `TemplateUserInputWindow`

Standard form to select from a list of command options.

Other Parameters:

| Name | Type | Description |
| --- | --- | --- |
| `context` | `list[str]` | list of command options to choose from |
| `switches` | `list[str]` | list of on/off switches |
| `message` | `str` | window title message |
| `config` | `dict` | dictionary of config dicts for options or switches |
| `recognize_access_key` | `bool` | recognize '\_' as mark of access key |

Returns:

| Type | Description |
| --- | --- |
| `str | tuple[str, dict]` | name of selected option.<br>if `switches` option is used, returns a tuple<br>of selection option name and dict of switches |

Examples:

This is an example with series of command options:

```md-code__content
from pyrevit import forms
ops = ['option1', 'option2', 'option3', 'option4']
forms.CommandSwitchWindow.show(ops, message='Select Option')
'option2'

```

A more advanced example of combining command options, on/off switches,
and option or switch configuration options:

```md-code__content
from pyrevit import forms
ops = ['option1', 'option2', 'option3', 'option4']
switches = ['switch1', 'switch2']
cfgs = {'option1': { 'background': '0xFF55FF'}}
rops, rswitches = forms.CommandSwitchWindow.show(
    ops,
    switches=switches
    message='Select Option',
    config=cfgs,
    recognize_access_key=False
    )
rops
'option2'
rswitches
{'switch1': False, 'switch2': True}

```

Initialize user input window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>665<br>666<br>667<br>668<br>669<br>670<br>671<br>672<br>673<br>674<br>675<br>676<br>677<br>678<br>679<br>680<br>681<br>682<br>683<br>684<br>685<br>``` | ```md-code__content<br>def __init__(self, context, title, width, height, **kwargs):<br>    """Initialize user input window."""<br>    WPFWindow.__init__(self,<br>                       op.join(XAML_FILES_DIR, self.xaml_source),<br>                       handle_esc=True)<br>    self.Title = title or 'pyRevit'<br>    self.Width = width<br>    self.Height = height<br>    self._context = context<br>    self.response = None<br>    # parent window?<br>    owner = kwargs.get('owner', None)<br>    if owner:<br>        # set wpf windows directly<br>        self.Owner = owner<br>        self.WindowStartupLocation = \<br>            framework.Windows.WindowStartupLocation.CenterOwner<br>    self._setup(**kwargs)<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

##### `Title = title or 'pyRevit'``instance-attribute`

##### `Width = width``instance-attribute`

##### `Height = height``instance-attribute`

##### `response = None``instance-attribute`

##### `Owner = owner``instance-attribute`

##### `WindowStartupLocation = framework.Windows.WindowStartupLocation.CenterOwner``instance-attribute`

##### `xaml_source = 'CommandSwitchWindow.xaml'``class-attribute``instance-attribute`

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show(context, title='User Input', width=DEFAULT_INPUTWINDOW_WIDTH, height=DEFAULT_INPUTWINDOW_HEIGHT, **kwargs)``classmethod`

Show user input window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `context` | `any` | window context element(s) | _required_ |
| `title` | `str` | window title | `'User Input'` |
| `width` | `int` | window width | `DEFAULT_INPUTWINDOW_WIDTH` |
| `height` | `int` | window height | `DEFAULT_INPUTWINDOW_HEIGHT` |
| `**kwargs` | `any` | other arguments to be passed to window | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>691<br>692<br>693<br>694<br>695<br>696<br>697<br>698<br>699<br>700<br>701<br>702<br>703<br>704<br>705<br>706<br>707<br>``` | ```md-code__content<br>@classmethod<br>def show(cls, context,  #pylint: disable=W0221<br>         title='User Input',<br>         width=DEFAULT_INPUTWINDOW_WIDTH,<br>         height=DEFAULT_INPUTWINDOW_HEIGHT, **kwargs):<br>    """Show user input window.<br>    Args:<br>        context (any): window context element(s)<br>        title (str): window title<br>        width (int): window width<br>        height (int): window height<br>        **kwargs (any): other arguments to be passed to window<br>    """<br>    dlg = cls(context, title, width, height, **kwargs)<br>    dlg.ShowDialog()<br>    return dlg.response<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

##### `handle_click(sender, args)`

Handle mouse click.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1304<br>1305<br>1306<br>``` | ```md-code__content<br>def handle_click(self, sender, args):    #pylint: disable=W0613<br>    """Handle mouse click."""<br>    self.Close()<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard inputs.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1308<br>1309<br>1310<br>1311<br>1312<br>1313<br>1314<br>1315<br>1316<br>1317<br>1318<br>1319<br>1320<br>1321<br>1322<br>1323<br>1324<br>1325<br>1326<br>1327<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):<br>    """Handle keyboard inputs."""<br>    if args.Key == Input.Key.Escape:<br>        if self.search_tb.Text:<br>            self.search_tb.Text = ''<br>        else:<br>            self.Close()<br>    elif args.Key == Input.Key.Enter:<br>        active_button = self._get_active_button()<br>        if active_button:<br>            if isinstance(active_button,<br>                          framework.Controls.Primitives.ToggleButton):<br>                return<br>            self.process_option(active_button, None)<br>            args.Handled = True<br>    elif args.Key != Input.Key.Tab \<br>            and args.Key != Input.Key.Space\<br>            and args.Key != Input.Key.LeftShift\<br>            and args.Key != Input.Key.RightShift:<br>        self.search_tb.Focus()<br>``` |

##### `search_txt_changed(sender, args)`

Handle text change in search box.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1329<br>1330<br>1331<br>``` | ```md-code__content<br>def search_txt_changed(self, sender, args):    #pylint: disable=W0613<br>    """Handle text change in search box."""<br>    self._filter_options(option_filter=self.search_tb.Text)<br>``` |

##### `process_option(sender, args)`

Handle click on command option button.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1333<br>1334<br>1335<br>1336<br>1337<br>``` | ```md-code__content<br>def process_option(self, sender, args):    #pylint: disable=W0613<br>    """Handle click on command option button."""<br>    self.Close()<br>    if sender:<br>        self._setup_response(response=sender.Content)<br>``` |

### `GetValueWindow(context, title, width, height, **kwargs)`

Bases: `TemplateUserInputWindow`

Standard form to get simple values from user.

Examples:

```md-code__content
from pyrevit import forms
items = ['item1', 'item2', 'item3']
forms.SelectFromList.show(items, button_name='Select Item')
['item1']

```

Initialize user input window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>665<br>666<br>667<br>668<br>669<br>670<br>671<br>672<br>673<br>674<br>675<br>676<br>677<br>678<br>679<br>680<br>681<br>682<br>683<br>684<br>685<br>``` | ```md-code__content<br>def __init__(self, context, title, width, height, **kwargs):<br>    """Initialize user input window."""<br>    WPFWindow.__init__(self,<br>                       op.join(XAML_FILES_DIR, self.xaml_source),<br>                       handle_esc=True)<br>    self.Title = title or 'pyRevit'<br>    self.Width = width<br>    self.Height = height<br>    self._context = context<br>    self.response = None<br>    # parent window?<br>    owner = kwargs.get('owner', None)<br>    if owner:<br>        # set wpf windows directly<br>        self.Owner = owner<br>        self.WindowStartupLocation = \<br>            framework.Windows.WindowStartupLocation.CenterOwner<br>    self._setup(**kwargs)<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

##### `Title = title or 'pyRevit'``instance-attribute`

##### `Width = width``instance-attribute`

##### `Height = height``instance-attribute`

##### `response = None``instance-attribute`

##### `Owner = owner``instance-attribute`

##### `WindowStartupLocation = framework.Windows.WindowStartupLocation.CenterOwner``instance-attribute`

##### `xaml_source = 'GetValueWindow.xaml'``class-attribute``instance-attribute`

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard input and close the window on Escape.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>306<br>307<br>308<br>309<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input and close the window on Escape."""<br>    if args.Key == Input.Key.Escape:<br>        self.Close()<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show(context, title='User Input', width=DEFAULT_INPUTWINDOW_WIDTH, height=DEFAULT_INPUTWINDOW_HEIGHT, **kwargs)``classmethod`

Show user input window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `context` | `any` | window context element(s) | _required_ |
| `title` | `str` | window title | `'User Input'` |
| `width` | `int` | window width | `DEFAULT_INPUTWINDOW_WIDTH` |
| `height` | `int` | window height | `DEFAULT_INPUTWINDOW_HEIGHT` |
| `**kwargs` | `any` | other arguments to be passed to window | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>691<br>692<br>693<br>694<br>695<br>696<br>697<br>698<br>699<br>700<br>701<br>702<br>703<br>704<br>705<br>706<br>707<br>``` | ```md-code__content<br>@classmethod<br>def show(cls, context,  #pylint: disable=W0221<br>         title='User Input',<br>         width=DEFAULT_INPUTWINDOW_WIDTH,<br>         height=DEFAULT_INPUTWINDOW_HEIGHT, **kwargs):<br>    """Show user input window.<br>    Args:<br>        context (any): window context element(s)<br>        title (str): window title<br>        width (int): window width<br>        height (int): window height<br>        **kwargs (any): other arguments to be passed to window<br>    """<br>    dlg = cls(context, title, width, height, **kwargs)<br>    dlg.ShowDialog()<br>    return dlg.response<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

##### `string_value_changed(sender, args)`

Handle string vlaue update event.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1393<br>1394<br>1395<br>1396<br>1397<br>1398<br>1399<br>1400<br>1401<br>1402<br>1403<br>1404<br>1405<br>1406<br>1407<br>1408<br>1409<br>1410<br>1411<br>``` | ```md-code__content<br>def string_value_changed(self, sender, args): #pylint: disable=unused-argument<br>    """Handle string vlaue update event."""<br>    filtered_rvalues = \<br>        sorted([x for x in self.reserved_values<br>                if self.stringValue_tb.Text == str(x)])<br>    similar_rvalues = \<br>        sorted([x for x in self.reserved_values<br>                if self.stringValue_tb.Text in str(x)],<br>               reverse=True)<br>    filtered_rvalues.extend(similar_rvalues)<br>    if filtered_rvalues:<br>        self.reservedValuesList.ItemsSource = filtered_rvalues<br>        self.show_element(self.reservedValuesListPanel)<br>        self.okayButton.IsEnabled = \<br>            self.stringValue_tb.Text not in filtered_rvalues<br>    else:<br>        self.reservedValuesList.ItemsSource = []<br>        self.hide_element(self.reservedValuesListPanel)<br>        self.okayButton.IsEnabled = True<br>``` |

##### `select(sender, args)`

Process input data and set the response.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1413<br>1414<br>1415<br>1416<br>1417<br>1418<br>1419<br>1420<br>1421<br>1422<br>1423<br>1424<br>1425<br>1426<br>1427<br>``` | ```md-code__content<br>def select(self, sender, args):    #pylint: disable=W0613<br>    """Process input data and set the response."""<br>    self.Close()<br>    if self.value_type == 'string':<br>        self.response = self.stringValue_tb.Text<br>    elif self.value_type == 'dropdown':<br>        self.response = self.dropdown_cb.SelectedItem<br>    elif self.value_type == 'date':<br>        if self.datePicker.SelectedDate:<br>            datestr = self.datePicker.SelectedDate.ToString("MM/dd/yyyy")<br>            self.response = datetime.datetime.strptime(datestr, r'%m/%d/%Y')<br>        else:<br>            self.response = None<br>    elif self.value_type == 'slider':<br>        self.response = self.numberPicker.Value<br>``` |

### `TemplatePromptBar(height=32, **kwargs)`

Bases: `WPFWindow`

Template context-manager class for creating prompt bars.

Prompt bars are show at the top of the active Revit window and are
designed for better prompt visibility.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `height` | `int` | window height | `32` |
| `**kwargs` | `Any` | other arguments to be passed to :func: `_setup` | `{}` |

Initialize user prompt window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1443<br>1444<br>1445<br>1446<br>1447<br>1448<br>1449<br>1450<br>``` | ```md-code__content<br>def __init__(self, height=32, **kwargs):<br>    """Initialize user prompt window."""<br>    WPFWindow.__init__(self,<br>                       op.join(XAML_FILES_DIR, self.xaml_source))<br>    self.user_height = height<br>    self.update_window()<br>    self._setup(**kwargs)<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

##### `xaml_source = 'TemplatePromptBar.xaml'``class-attribute``instance-attribute`

##### `user_height = height``instance-attribute`

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard input and close the window on Escape.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>306<br>307<br>308<br>309<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input and close the window on Escape."""<br>    if args.Key == Input.Key.Escape:<br>        self.Close()<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show(modal=False)`

Show window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>323<br>324<br>325<br>326<br>327<br>328<br>``` | ```md-code__content<br>def show(self, modal=False):<br>    """Show window."""<br>    if modal:<br>        return self.ShowDialog()<br>    # else open non-modal<br>    self.Show()<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

##### `update_window()`

Update the prompt bar to match Revit window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1452<br>1453<br>1454<br>1455<br>1456<br>1457<br>1458<br>1459<br>1460<br>1461<br>1462<br>1463<br>1464<br>1465<br>1466<br>1467<br>1468<br>1469<br>1470<br>1471<br>1472<br>1473<br>1474<br>1475<br>1476<br>1477<br>1478<br>1479<br>1480<br>1481<br>1482<br>1483<br>1484<br>1485<br>1486<br>1487<br>``` | ```md-code__content<br>def update_window(self):<br>    """Update the prompt bar to match Revit window."""<br>    screen_area = HOST_APP.proc_screen_workarea<br>    scale_factor = 1.0 / HOST_APP.proc_screen_scalefactor<br>    top = left = width = height = 0<br>    window_rect = revit.ui.get_window_rectangle()<br>    # set width and height<br>    width = window_rect.Right - window_rect.Left<br>    height = self.user_height<br>    top = window_rect.Top<br>    # in maximized window, the top might be off the active screen<br>    # due to windows thicker window frames<br>    # lets cut the height and re-adjust the top<br>    top_diff = abs(screen_area.Top - top)<br>    if 10 > top_diff > 0 and top_diff < height:<br>        height -= top_diff<br>        top = screen_area.Top<br>    left = window_rect.Left<br>    # in maximized window, Left also might be off the active screen<br>    # due to windows thicker window frames<br>    # let's fix the width to accomodate the extra pixels as well<br>    left_diff = abs(screen_area.Left - left)<br>    if 10 > left_diff > 0 and left_diff < width:<br>        # deduct two times the left negative offset since this extra<br>        # offset happens on both left and right side<br>        width -= left_diff * 2<br>        left = screen_area.Left<br>    self.Top = top * scale_factor<br>    self.Left = left * scale_factor<br>    self.Width = width * scale_factor<br>    self.Height = height<br>``` |

### `WarningBar(height=32, **kwargs)`

Bases: `TemplatePromptBar`

Show warning bar at the top of Revit window.

Other Parameters:

| Name | Type | Description |
| --- | --- | --- |
| `title` | `string` | warning bar text |

Examples:

```md-code__content
with WarningBar(title='my warning'):
   # do stuff

```

Initialize user prompt window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1443<br>1444<br>1445<br>1446<br>1447<br>1448<br>1449<br>1450<br>``` | ```md-code__content<br>def __init__(self, height=32, **kwargs):<br>    """Initialize user prompt window."""<br>    WPFWindow.__init__(self,<br>                       op.join(XAML_FILES_DIR, self.xaml_source))<br>    self.user_height = height<br>    self.update_window()<br>    self._setup(**kwargs)<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

##### `user_height = height``instance-attribute`

##### `xaml_source = 'WarningBar.xaml'``class-attribute``instance-attribute`

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard input and close the window on Escape.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>306<br>307<br>308<br>309<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input and close the window on Escape."""<br>    if args.Key == Input.Key.Escape:<br>        self.Close()<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show(modal=False)`

Show window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>323<br>324<br>325<br>326<br>327<br>328<br>``` | ```md-code__content<br>def show(self, modal=False):<br>    """Show window."""<br>    if modal:<br>        return self.ShowDialog()<br>    # else open non-modal<br>    self.Show()<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

##### `update_window()`

Update the prompt bar to match Revit window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1452<br>1453<br>1454<br>1455<br>1456<br>1457<br>1458<br>1459<br>1460<br>1461<br>1462<br>1463<br>1464<br>1465<br>1466<br>1467<br>1468<br>1469<br>1470<br>1471<br>1472<br>1473<br>1474<br>1475<br>1476<br>1477<br>1478<br>1479<br>1480<br>1481<br>1482<br>1483<br>1484<br>1485<br>1486<br>1487<br>``` | ```md-code__content<br>def update_window(self):<br>    """Update the prompt bar to match Revit window."""<br>    screen_area = HOST_APP.proc_screen_workarea<br>    scale_factor = 1.0 / HOST_APP.proc_screen_scalefactor<br>    top = left = width = height = 0<br>    window_rect = revit.ui.get_window_rectangle()<br>    # set width and height<br>    width = window_rect.Right - window_rect.Left<br>    height = self.user_height<br>    top = window_rect.Top<br>    # in maximized window, the top might be off the active screen<br>    # due to windows thicker window frames<br>    # lets cut the height and re-adjust the top<br>    top_diff = abs(screen_area.Top - top)<br>    if 10 > top_diff > 0 and top_diff < height:<br>        height -= top_diff<br>        top = screen_area.Top<br>    left = window_rect.Left<br>    # in maximized window, Left also might be off the active screen<br>    # due to windows thicker window frames<br>    # let's fix the width to accomodate the extra pixels as well<br>    left_diff = abs(screen_area.Left - left)<br>    if 10 > left_diff > 0 and left_diff < width:<br>        # deduct two times the left negative offset since this extra<br>        # offset happens on both left and right side<br>        width -= left_diff * 2<br>        left = screen_area.Left<br>    self.Top = top * scale_factor<br>    self.Left = left * scale_factor<br>    self.Width = width * scale_factor<br>    self.Height = height<br>``` |

### `ProgressBar(height=32, **kwargs)`

Bases: `TemplatePromptBar`

Show progress bar at the top of Revit window.

Other Parameters:

| Name | Type | Description |
| --- | --- | --- |
| `title` | `string` | progress bar text, defaults to 0/100 progress format |
| `indeterminate` | `bool` | create indeterminate progress bar |
| `cancellable` | `bool` | add cancel button to progress bar |
| `step` | `int` | update progress intervals |

Examples:

```md-code__content
from pyrevit import forms
count = 1
with forms.ProgressBar(title='my command progress message') as pb:
   # do stuff
   pb.update_progress(count, 100)
   count += 1

```

Progress bar title could also be customized to show the current and
total progress values. In example below, the progress bar message
will be in format "0 of 100"

```md-code__content
with forms.ProgressBar(title='{value} of {max_value}') as pb:

```

By default progress bar updates the progress every time the
.update\_progress method is called. For operations with a large number
of max steps, the gui update process time will have a significate
effect on the overall execution time of the command. In these cases,
set the value of step argument to something larger than 1. In example
below, the progress bar updates once per every 10 units of progress.

```md-code__content
with forms.ProgressBar(title='message', steps=10):

```

Progress bar could also be set to indeterminate for operations of
unknown length. In this case, the progress bar will show an infinitely
running ribbon:

```md-code__content
with forms.ProgressBar(title='message', indeterminate=True):

```

if cancellable is set on the object, a cancel button will show on the
progress bar and .cancelled attribute will be set on the ProgressBar
instance if users clicks on cancel button:

```md-code__content
with forms.ProgressBar(title='message',
                       cancellable=True) as pb:
   # do stuff
   if pb.cancelled:
       # wrap up and cancel operation

```

Initialize user prompt window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1443<br>1444<br>1445<br>1446<br>1447<br>1448<br>1449<br>1450<br>``` | ```md-code__content<br>def __init__(self, height=32, **kwargs):<br>    """Initialize user prompt window."""<br>    WPFWindow.__init__(self,<br>                       op.join(XAML_FILES_DIR, self.xaml_source))<br>    self.user_height = height<br>    self.update_window()<br>    self._setup(**kwargs)<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

##### `user_height = height``instance-attribute`

##### `xaml_source = 'ProgressBar.xaml'``class-attribute``instance-attribute`

##### `title``property``writable`

Progress bar title.

##### `indeterminate``property``writable`

Progress bar indeterminate state.

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard input and close the window on Escape.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>306<br>307<br>308<br>309<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input and close the window on Escape."""<br>    if args.Key == Input.Key.Escape:<br>        self.Close()<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show(modal=False)`

Show window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>323<br>324<br>325<br>326<br>327<br>328<br>``` | ```md-code__content<br>def show(self, modal=False):<br>    """Show window."""<br>    if modal:<br>        return self.ShowDialog()<br>    # else open non-modal<br>    self.Show()<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

##### `update_window()`

Update the prompt bar to match Revit window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1452<br>1453<br>1454<br>1455<br>1456<br>1457<br>1458<br>1459<br>1460<br>1461<br>1462<br>1463<br>1464<br>1465<br>1466<br>1467<br>1468<br>1469<br>1470<br>1471<br>1472<br>1473<br>1474<br>1475<br>1476<br>1477<br>1478<br>1479<br>1480<br>1481<br>1482<br>1483<br>1484<br>1485<br>1486<br>1487<br>``` | ```md-code__content<br>def update_window(self):<br>    """Update the prompt bar to match Revit window."""<br>    screen_area = HOST_APP.proc_screen_workarea<br>    scale_factor = 1.0 / HOST_APP.proc_screen_scalefactor<br>    top = left = width = height = 0<br>    window_rect = revit.ui.get_window_rectangle()<br>    # set width and height<br>    width = window_rect.Right - window_rect.Left<br>    height = self.user_height<br>    top = window_rect.Top<br>    # in maximized window, the top might be off the active screen<br>    # due to windows thicker window frames<br>    # lets cut the height and re-adjust the top<br>    top_diff = abs(screen_area.Top - top)<br>    if 10 > top_diff > 0 and top_diff < height:<br>        height -= top_diff<br>        top = screen_area.Top<br>    left = window_rect.Left<br>    # in maximized window, Left also might be off the active screen<br>    # due to windows thicker window frames<br>    # let's fix the width to accomodate the extra pixels as well<br>    left_diff = abs(screen_area.Left - left)<br>    if 10 > left_diff > 0 and left_diff < width:<br>        # deduct two times the left negative offset since this extra<br>        # offset happens on both left and right side<br>        width -= left_diff * 2<br>        left = screen_area.Left<br>    self.Top = top * scale_factor<br>    self.Left = left * scale_factor<br>    self.Width = width * scale_factor<br>    self.Height = height<br>``` |

##### `clicked_cancel(sender, args)`

Handler for cancel button clicked event.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1674<br>1675<br>1676<br>1677<br>``` | ```md-code__content<br>def clicked_cancel(self, sender, args):    #pylint: disable=W0613<br>    """Handler for cancel button clicked event."""<br>    self.cancel_b.Content = 'Cancelling...'<br>    self.cancelled = True    #pylint: disable=W0201<br>``` |

##### `reset()`

Reset progress value to 0.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1679<br>1680<br>1681<br>``` | ```md-code__content<br>def reset(self):<br>    """Reset progress value to 0."""<br>    self.update_progress(0, 1)<br>``` |

##### `update_progress(new_value, max_value=1)`

Update progress bar state with given min, max values.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `new_value` | `float` | current progress value | _required_ |
| `max_value` | `float` | total progress value | `1` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1683<br>1684<br>1685<br>1686<br>1687<br>1688<br>1689<br>1690<br>1691<br>1692<br>1693<br>1694<br>1695<br>1696<br>1697<br>1698<br>``` | ```md-code__content<br>def update_progress(self, new_value, max_value=1):<br>    """Update progress bar state with given min, max values.<br>    Args:<br>        new_value (float): current progress value<br>        max_value (float): total progress value<br>    """<br>    self.max_value = max_value    #pylint: disable=W0201<br>    self.new_value = new_value    #pylint: disable=W0201<br>    if self.new_value == 0:<br>        self._dispatch_updater()<br>    elif self.step > 0:<br>        if self.new_value % self.step == 0:<br>            self._dispatch_updater()<br>    else:<br>        self._dispatch_updater()<br>``` |

### `SearchPrompt(search_db, width, height, **kwargs)`

Bases: `WPFWindow`

Standard prompt for pyRevit search.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `search_db` | `list` | list of possible search targets | _required_ |
| `width` | `int` | width of search prompt window | _required_ |
| `height` | `int` | height of search prompt window | _required_ |

Other Parameters:

| Name | Type | Description |
| --- | --- | --- |
| `search_tip` | `str` | text to show in grayscale when search box is empty |
| `switches` | `str` | list of switches |

Returns:

| Type | Description |
| --- | --- |
| `tuple[str, dict] | str` | matched string if switches are not provided,<br>matched strings, and dict of switches otherwise. |

Examples:

```md-code__content
from pyrevit import forms
# assume search input of '/switch1 target1'
matched_str, args, switches = forms.SearchPrompt.show(
    search_db=['target1', 'target2', 'target3', 'target4'],
    switches=['/switch1', '/switch2'],
    search_tip='pyRevit Search'
    )
matched_str
'target1'
args
['--help', '--branch', 'branchname']
switches
{'/switch1': True, '/switch2': False}

```

Initialize search prompt window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1734<br>1735<br>1736<br>1737<br>1738<br>1739<br>1740<br>1741<br>1742<br>1743<br>1744<br>1745<br>1746<br>1747<br>1748<br>1749<br>1750<br>1751<br>1752<br>1753<br>1754<br>1755<br>1756<br>1757<br>1758<br>1759<br>1760<br>1761<br>``` | ```md-code__content<br>def __init__(self, search_db, width, height, **kwargs):<br>    """Initialize search prompt window."""<br>    WPFWindow.__init__(self,<br>                       op.join(XAML_FILES_DIR, 'SearchPrompt.xaml'))<br>    self.Width = width<br>    self.MinWidth = self.Width<br>    self.Height = height<br>    self.search_tip = kwargs.get('search_tip', '')<br>    if isinstance(search_db, list):<br>        self._search_db = None<br>        self._search_db_keys = search_db<br>    elif isinstance(search_db, dict):<br>        self._search_db = search_db<br>        self._search_db_keys = sorted(self._search_db.keys())<br>    else:<br>        raise PyRevitException("Unknown search database type")<br>    self._search_res = None<br>    self._switches = kwargs.get('switches', [])<br>    self._setup_response()<br>    self.search_tb.Focus()<br>    self.hide_element(self.tab_icon)<br>    self.hide_element(self.return_icon)<br>    self.search_tb.Text = ''<br>    self.set_search_results()<br>``` |

#### Attributes

##### `pyrevit_version``property`

Active pyRevit formatted version e.g. '4.9-beta'.

##### `Width = width``instance-attribute`

##### `MinWidth = self.Width``instance-attribute`

##### `Height = height``instance-attribute`

##### `search_tip = kwargs.get('search_tip', '')``instance-attribute`

##### `search_input``property``writable`

Current search input.

##### `search_input_parts``property`

Current cleaned up search term.

##### `search_term``property`

Current cleaned up search term.

##### `search_term_switches``property`

Find matching switches in search term.

##### `search_term_args``property`

Find arguments in search term.

##### `search_term_main``property`

Current cleaned up search term without the listed switches.

##### `search_matches``property`

List of matches for the given search term.

#### Functions

##### `load_xaml(xaml_source, literal_string=False, handle_esc=True, set_owner=True)`

Load the window XAML file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | The XAML content or file path to load. | _required_ |
| `literal_string` | `bool` | True if `xaml_source` is content,<br>False if it is a path. Defaults to False. | `False` |
| `handle_esc` | `bool` | Whether the ESC key should be handled.<br>Defaults to True. | `True` |
| `set_owner` | `bool` | Whether to se the window owner.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>``` | ```md-code__content<br>def load_xaml(self, xaml_source, literal_string=False, handle_esc=True, set_owner=True):<br>    """Load the window XAML file.<br>    Args:<br>        xaml_source (str): The XAML content or file path to load.<br>        literal_string (bool, optional): True if `xaml_source` is content,<br>            False if it is a path. Defaults to False.<br>        handle_esc (bool, optional): Whether the ESC key should be handled.<br>            Defaults to True.<br>        set_owner (bool, optional): Whether to se the window owner.<br>            Defaults to True.<br>    """<br>    # create new id for this window<br>    self.window_id = coreutils.new_uuid()<br>    if not literal_string:<br>        wpf.LoadComponent(self, self._determine_xaml(xaml_source))<br>    else:<br>        wpf.LoadComponent(self, framework.StringReader(xaml_source))<br>    # set properties<br>    self.thread_id = framework.get_current_thread_id()<br>    if set_owner:<br>        self.setup_owner()<br>    self.setup_icon()<br>    WPFWindow.setup_resources(self)<br>    if handle_esc:<br>        self.setup_default_handlers()<br>``` |

##### `merge_resource_dict(xaml_source)`

Merge a ResourceDictionary xaml file with this window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_source` | `str` | xaml file with the resource dictionary | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>``` | ```md-code__content<br>def merge_resource_dict(self, xaml_source):<br>    """Merge a ResourceDictionary xaml file with this window.<br>    Args:<br>        xaml_source (str): xaml file with the resource dictionary<br>    """<br>    lang_dictionary = ResourceDictionary()<br>    lang_dictionary.Source = Uri(xaml_source, UriKind.Absolute)<br>    self.Resources.MergedDictionaries.Add(lang_dictionary)<br>``` |

##### `get_locale_string(string_name)`

Get localized string.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_name` | `str` | string name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | localized string |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def get_locale_string(self, string_name):<br>    """Get localized string.<br>    Args:<br>        string_name (str): string name<br>    Returns:<br>        (str): localized string<br>    """<br>    return self.FindResource(string_name)<br>``` |

##### `setup_owner()`

Set the window owner.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>264<br>265<br>266<br>267<br>``` | ```md-code__content<br>def setup_owner(self):<br>    """Set the window owner."""<br>    wih = Interop.WindowInteropHelper(self)<br>    wih.Owner = AdWindows.ComponentManager.ApplicationWindow<br>``` |

##### `setup_resources(wpf_ctrl)``staticmethod`

Sets the WPF resources.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>@staticmethod<br>def setup_resources(wpf_ctrl):<br>    """Sets the WPF resources."""<br>    #2c3e50<br>    wpf_ctrl.Resources['pyRevitDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x2c, 0x3e, 0x50)<br>    #23303d<br>    wpf_ctrl.Resources['pyRevitDarkerDarkColor'] = \<br>        Media.Color.FromArgb(0xFF, 0x23, 0x30, 0x3d)<br>    #ffffff<br>    wpf_ctrl.Resources['pyRevitButtonColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xff, 0xff, 0xff)<br>    #f39c12<br>    wpf_ctrl.Resources['pyRevitAccentColor'] = \<br>        Media.Color.FromArgb(0xFF, 0xf3, 0x9c, 0x12)<br>    wpf_ctrl.Resources['pyRevitDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkColor'])<br>    wpf_ctrl.Resources['pyRevitAccentBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitAccentColor'])<br>    wpf_ctrl.Resources['pyRevitDarkerDarkBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitDarkerDarkColor'])<br>    wpf_ctrl.Resources['pyRevitButtonForgroundBrush'] = \<br>        Media.SolidColorBrush(wpf_ctrl.Resources['pyRevitButtonColor'])<br>    wpf_ctrl.Resources['pyRevitRecognizesAccessKey'] = \<br>        DEFAULT_RECOGNIZE_ACCESS_KEY<br>``` |

##### `setup_default_handlers()`

Set the default handlers.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>``` | ```md-code__content<br>def setup_default_handlers(self):<br>    """Set the default handlers."""<br>    self.PreviewKeyDown += self.handle_input_key    #pylint: disable=E1101<br>``` |

##### `handle_input_key(sender, args)`

Handle keyboard input and close the window on Escape.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>306<br>307<br>308<br>309<br>``` | ```md-code__content<br>def handle_input_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input and close the window on Escape."""<br>    if args.Key == Input.Key.Escape:<br>        self.Close()<br>``` |

##### `set_icon(icon_path)`

Set window icon to given icon path.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>311<br>312<br>313<br>``` | ```md-code__content<br>def set_icon(self, icon_path):<br>    """Set window icon to given icon path."""<br>    self.Icon = utils.bitmap_from_file(icon_path)<br>``` |

##### `setup_icon()`

Setup default window icon.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>``` | ```md-code__content<br>def setup_icon(self):<br>    """Setup default window icon."""<br>    self.set_icon(op.join(BIN_DIR, 'pyrevit_settings.png'))<br>``` |

##### `hide()`

Hide window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>319<br>320<br>321<br>``` | ```md-code__content<br>def hide(self):<br>    """Hide window."""<br>    self.Hide()<br>``` |

##### `show_dialog()`

Show modal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>``` | ```md-code__content<br>def show_dialog(self):<br>    """Show modal window."""<br>    return self.ShowDialog()<br>``` |

##### `set_image_source_file(wpf_element, image_file)``staticmethod`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>@staticmethod<br>def set_image_source_file(wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    if not op.exists(image_file):<br>        wpf_element.Source = \<br>            utils.bitmap_from_file(<br>                os.path.join(EXEC_PARAMS.command_path,<br>                             image_file)<br>                )<br>    else:<br>        wpf_element.Source = utils.bitmap_from_file(image_file)<br>``` |

##### `set_image_source(wpf_element, image_file)`

Set source file for image element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `wpf_element` | `Image` | xaml image element | _required_ |
| `image_file` | `str` | image file path | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def set_image_source(self, wpf_element, image_file):<br>    """Set source file for image element.<br>    Args:<br>        wpf_element (System.Windows.Controls.Image): xaml image element<br>        image_file (str): image file path<br>    """<br>    WPFWindow.set_image_source_file(wpf_element, image_file)<br>``` |

##### `dispatch(func, *args, **kwargs)`

Runs the function in a new thread.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `Callable` | function to run | _required_ |
| `*args` | `Any` | positional arguments to pass to func | `()` |
| `**kwargs` | `Any` | keyword arguments to pass to func | `{}` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>``` | ```md-code__content<br>def dispatch(self, func, *args, **kwargs):<br>    """Runs the function in a new thread.<br>    Args:<br>        func (Callable): function to run<br>        *args (Any): positional arguments to pass to func<br>        **kwargs (Any): keyword arguments to pass to func<br>    """<br>    if framework.get_current_thread_id() == self.thread_id:<br>        t = threading.Thread(<br>            target=func,<br>            args=args,<br>            kwargs=kwargs<br>            )<br>        t.start()<br>    else:<br>        # ask ui thread to call the func with args and kwargs<br>        self.Dispatcher.Invoke(<br>            System.Action(<br>                lambda: func(*args, **kwargs)<br>                ),<br>            Threading.DispatcherPriority.Background<br>            )<br>``` |

##### `conceal()`

Conceal window.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>384<br>385<br>386<br>``` | ```md-code__content<br>def conceal(self):<br>    """Conceal window."""<br>    return WindowToggler(self)<br>``` |

##### `hide_element(*wpf_elements)``staticmethod`

Collapse elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be collaped | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>``` | ```md-code__content<br>@staticmethod<br>def hide_element(*wpf_elements):<br>    """Collapse elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be collaped<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_COLLAPSED<br>``` |

##### `show_element(*wpf_elements)``staticmethod`

Show collapsed elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be set to visible. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>@staticmethod<br>def show_element(*wpf_elements):<br>    """Show collapsed elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be set to visible.<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.Visibility = WPF_VISIBLE<br>``` |

##### `toggle_element(*wpf_elements)``staticmethod`

Toggle visibility of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be toggled. | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>@staticmethod<br>def toggle_element(*wpf_elements):<br>    """Toggle visibility of elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be toggled.<br>    """<br>    for wpfel in wpf_elements:<br>        if wpfel.Visibility == WPF_VISIBLE:<br>            WPFWindow.hide_element(wpfel)<br>        elif wpfel.Visibility == WPF_COLLAPSED:<br>            WPFWindow.show_element(wpfel)<br>``` |

##### `disable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>@staticmethod<br>def disable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = False<br>``` |

##### `enable_element(*wpf_elements)``staticmethod`

Enable elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*wpf_elements` | `list[UIElement]` | WPF framework elements to be enabled | `()` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>@staticmethod<br>def enable_element(*wpf_elements):<br>    """Enable elements.<br>    Args:<br>        *wpf_elements (list[UIElement]): WPF framework elements to be enabled<br>    """<br>    for wpfel in wpf_elements:<br>        wpfel.IsEnabled = True<br>``` |

##### `handle_url_click(sender, args)`

Callback for handling click on package website url.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>``` | ```md-code__content<br>def handle_url_click(self, sender, args): #pylint: disable=unused-argument<br>    """Callback for handling click on package website url."""<br>    return webbrowser.open_new_tab(sender.NavigateUri.AbsoluteUri)<br>``` |

##### `update_results_display(fill_match=False)`

Update search prompt results based on current input text.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1828<br>1829<br>1830<br>1831<br>1832<br>1833<br>1834<br>1835<br>1836<br>1837<br>1838<br>1839<br>1840<br>1841<br>1842<br>1843<br>1844<br>1845<br>1846<br>1847<br>1848<br>1849<br>1850<br>1851<br>1852<br>1853<br>1854<br>1855<br>1856<br>1857<br>1858<br>1859<br>1860<br>1861<br>1862<br>1863<br>1864<br>1865<br>1866<br>1867<br>1868<br>1869<br>1870<br>1871<br>1872<br>1873<br>1874<br>1875<br>1876<br>1877<br>1878<br>1879<br>1880<br>1881<br>1882<br>1883<br>``` | ```md-code__content<br>def update_results_display(self, fill_match=False):<br>    """Update search prompt results based on current input text."""<br>    self.directmatch_tb.Text = ''<br>    self.wordsmatch_tb.Text = ''<br>    results = self.search_matches<br>    res_cout = len(results)<br>    mlogger.debug('unique results count: %s', res_cout)<br>    mlogger.debug('unique results: %s', results)<br>    if res_cout > 1:<br>        self.show_element(self.tab_icon)<br>        self.hide_element(self.return_icon)<br>    elif res_cout == 1:<br>        self.hide_element(self.tab_icon)<br>        self.show_element(self.return_icon)<br>    else:<br>        self.hide_element(self.tab_icon)<br>        self.hide_element(self.return_icon)<br>    if self._result_index >= res_cout:<br>        self._result_index = 0   #pylint: disable=W0201<br>    if self._result_index < 0:<br>        self._result_index = res_cout - 1   #pylint: disable=W0201<br>    if not self.search_input:<br>        self.directmatch_tb.Text = self.search_tip<br>        return<br>    if results:<br>        input_term = self.search_term<br>        cur_res = results[self._result_index]<br>        mlogger.debug('current result: %s', cur_res)<br>        if fill_match:<br>            self.search_input = cur_res<br>        else:<br>            if cur_res.lower().startswith(input_term):<br>                self.directmatch_tb.Text = \<br>                    self.search_input + cur_res[len(input_term):]<br>                mlogger.debug('directmatch_tb.Text: %s',<br>                              self.directmatch_tb.Text)<br>            else:<br>                self.wordsmatch_tb.Text = '- {}'.format(cur_res)<br>                mlogger.debug('wordsmatch_tb.Text: %s',<br>                              self.wordsmatch_tb.Text)<br>        tooltip = self._search_db.get(cur_res, None)<br>        if tooltip:<br>            self.tooltip_tb.Text = tooltip<br>            self.show_element(self.tooltip_tb)<br>        else:<br>            self.hide_element(self.tooltip_tb)<br>        self._search_res = cur_res<br>        return True<br>    return False<br>``` |

##### `set_search_results(*args)`

Set search results for returning.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1885<br>1886<br>1887<br>1888<br>1889<br>1890<br>1891<br>1892<br>1893<br>1894<br>1895<br>1896<br>1897<br>1898<br>1899<br>1900<br>1901<br>``` | ```md-code__content<br>def set_search_results(self, *args):<br>    """Set search results for returning."""<br>    self._result_index = 0<br>    self._search_results = []<br>    mlogger.debug('search input: %s', self.search_input)<br>    mlogger.debug('search term: %s', self.search_term)<br>    mlogger.debug('search term (main): %s', self.search_term_main)<br>    mlogger.debug('search term (parts): %s', self.search_input_parts)<br>    mlogger.debug('search term (args): %s', self.search_term_args)<br>    mlogger.debug('search term (switches): %s', self.search_term_switches)<br>    for resultset in args:<br>        mlogger.debug('result set: %s}', resultset)<br>        self._search_results.extend(sorted(resultset))<br>    mlogger.debug('results: %s', self._search_results)<br>``` |

##### `find_direct_match(input_text)`

Find direct text matches in search term.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1903<br>1904<br>1905<br>1906<br>1907<br>1908<br>1909<br>1910<br>1911<br>``` | ```md-code__content<br>def find_direct_match(self, input_text):<br>    """Find direct text matches in search term."""<br>    results = []<br>    if input_text:<br>        for cmd_name in self._search_db_keys:<br>            if cmd_name.lower().startswith(input_text):<br>                results.append(cmd_name)<br>    return results<br>``` |

##### `find_word_match(input_text)`

Find direct word matches in search term.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1913<br>1914<br>1915<br>1916<br>1917<br>1918<br>1919<br>1920<br>1921<br>1922<br>``` | ```md-code__content<br>def find_word_match(self, input_text):<br>    """Find direct word matches in search term."""<br>    results = []<br>    if input_text:<br>        cur_words = input_text.split(' ')<br>        for cmd_name in self._search_db_keys:<br>            if all([x in cmd_name.lower() for x in cur_words]):<br>                results.append(cmd_name)<br>    return results<br>``` |

##### `search_txt_changed(sender, args)`

Handle text changed event.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1924<br>1925<br>1926<br>1927<br>1928<br>1929<br>1930<br>``` | ```md-code__content<br>def search_txt_changed(self, sender, args):    #pylint: disable=W0613<br>    """Handle text changed event."""<br>    input_term = self.search_term_main<br>    dmresults = self.find_direct_match(input_term)<br>    wordresults = self.find_word_match(input_term)<br>    self.set_search_results(dmresults, wordresults)<br>    self.update_results_display()<br>``` |

##### `handle_kb_key(sender, args)`

Handle keyboard input event.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1932<br>1933<br>1934<br>1935<br>1936<br>1937<br>1938<br>1939<br>1940<br>1941<br>1942<br>1943<br>1944<br>1945<br>1946<br>1947<br>1948<br>1949<br>1950<br>1951<br>1952<br>1953<br>1954<br>1955<br>1956<br>1957<br>1958<br>1959<br>1960<br>1961<br>1962<br>1963<br>``` | ```md-code__content<br>def handle_kb_key(self, sender, args):    #pylint: disable=W0613<br>    """Handle keyboard input event."""<br>    shiftdown = Input.Keyboard.IsKeyDown(Input.Key.LeftShift) \<br>        or Input.Keyboard.IsKeyDown(Input.Key.RightShift)<br>    # Escape: set response to none and close<br>    if args.Key == Input.Key.Escape:<br>        self._setup_response()<br>        self.Close()<br>    # Enter: close, returns matched response automatically<br>    elif args.Key == Input.Key.Enter:<br>        if self.search_tb.Text != '':<br>            self._setup_response(response=self._search_res)<br>            args.Handled = True<br>            self.Close()<br>    # Shift+Tab, Tab: Cycle through matches<br>    elif args.Key == Input.Key.Tab and shiftdown:<br>        self._result_index -= 1<br>        self.update_results_display()<br>    elif args.Key == Input.Key.Tab:<br>        self._result_index += 1<br>        self.update_results_display()<br>    # Up, Down: Cycle through matches<br>    elif args.Key == Input.Key.Up:<br>        self._result_index -= 1<br>        self.update_results_display()<br>    elif args.Key == Input.Key.Down:<br>        self._result_index += 1<br>        self.update_results_display()<br>    # Right, End: Autocomplete with displayed match<br>    elif args.Key in [Input.Key.Right,<br>                      Input.Key.End]:<br>        self.update_results_display(fill_match=True)<br>``` |

##### `show(search_db, width=DEFAULT_SEARCHWND_WIDTH, height=DEFAULT_SEARCHWND_HEIGHT, **kwargs)``classmethod`

Show search prompt.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1965<br>1966<br>1967<br>1968<br>1969<br>1970<br>1971<br>1972<br>``` | ```md-code__content<br>@classmethod<br>def show(cls, search_db,    #pylint: disable=W0221<br>         width=DEFAULT_SEARCHWND_WIDTH,<br>         height=DEFAULT_SEARCHWND_HEIGHT, **kwargs):<br>    """Show search prompt."""<br>    dlg = cls(search_db, width, height, **kwargs)<br>    dlg.ShowDialog()<br>    return dlg.response<br>``` |

### `RevisionOption(revision_element)`

Bases: `TemplateListItem`

Revision wrapper for :func: `select_revisions`.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1977<br>1978<br>``` | ```md-code__content<br>def __init__(self, revision_element):<br>    super(RevisionOption, self).__init__(revision_element)<br>``` |

#### Attributes

##### `item = orig_item``instance-attribute`

##### `state = checked``instance-attribute`

##### `checkable``property``writable`

List Item CheckBox Visibility.

##### `name``property`

Revision name (description).

#### Functions

##### `add_PropertyChanged(value)`

Called when a property is added to the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>113<br>114<br>115<br>``` | ```md-code__content<br>def add_PropertyChanged(self, value):<br>    """Called when a property is added to the object."""<br>    self.PropertyChanged += value<br>``` |

##### `remove_PropertyChanged(value)`

Called when a property is removed from the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>``` | ```md-code__content<br>def remove_PropertyChanged(self, value):<br>    """Called when a property is removed from the object."""<br>    self.PropertyChanged -= value<br>``` |

##### `OnPropertyChanged(prop_name)`

Called when a property is changed.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `prop_name` | `str` | property name | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def OnPropertyChanged(self, prop_name):<br>    """Called when a property is changed.<br>    Args:<br>        prop_name (str): property name<br>    """<br>    if self._propertyChangedCaller:<br>        args = ComponentModel.PropertyChangedEventArgs(prop_name)<br>        self._propertyChangedCaller(self, args)<br>``` |

##### `unwrap()`

Unwrap and return wrapped object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>753<br>754<br>755<br>``` | ```md-code__content<br>def unwrap(self):<br>    """Unwrap and return wrapped object."""<br>    return self.item<br>``` |

##### `checked(value)`

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>762<br>763<br>764<br>``` | ```md-code__content<br>@checked.setter<br>def checked(self, value):<br>    self.state = value<br>``` |

### `SheetOption(sheet_element)`

Bases: `TemplateListItem`

Sheet wrapper for :func: `select_sheets`.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>1996<br>1997<br>``` | ```md-code__content<br>def __init__(self, sheet_element):<br>    super(SheetOption, self).__init__(sheet_element)<br>``` |

#### Attributes

##### `item = orig_item``instance-attribute`

##### `state = checked``instance-attribute`

##### `checkable``property``writable`

List Item CheckBox Visibility.

##### `name``property`

Sheet name.

##### `number``property`

Sheet number.

#### Functions

##### `add_PropertyChanged(value)`

Called when a property is added to the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>113<br>114<br>115<br>``` | ```md-code__content<br>def add_PropertyChanged(self, value):<br>    """Called when a property is added to the object."""<br>    self.PropertyChanged += value<br>``` |

##### `remove_PropertyChanged(value)`

Called when a property is removed from the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>``` | ```md-code__content<br>def remove_PropertyChanged(self, value):<br>    """Called when a property is removed from the object."""<br>    self.PropertyChanged -= value<br>``` |

##### `OnPropertyChanged(prop_name)`

Called when a property is changed.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `prop_name` | `str` | property name | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def OnPropertyChanged(self, prop_name):<br>    """Called when a property is changed.<br>    Args:<br>        prop_name (str): property name<br>    """<br>    if self._propertyChangedCaller:<br>        args = ComponentModel.PropertyChangedEventArgs(prop_name)<br>        self._propertyChangedCaller(self, args)<br>``` |

##### `unwrap()`

Unwrap and return wrapped object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>753<br>754<br>755<br>``` | ```md-code__content<br>def unwrap(self):<br>    """Unwrap and return wrapped object."""<br>    return self.item<br>``` |

##### `checked(value)`

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>762<br>763<br>764<br>``` | ```md-code__content<br>@checked.setter<br>def checked(self, value):<br>    self.state = value<br>``` |

### `ViewOption(view_element)`

Bases: `TemplateListItem`

View wrapper for :func: `select_views`.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2015<br>2016<br>``` | ```md-code__content<br>def __init__(self, view_element):<br>    super(ViewOption, self).__init__(view_element)<br>``` |

#### Attributes

##### `item = orig_item``instance-attribute`

##### `state = checked``instance-attribute`

##### `checkable``property``writable`

List Item CheckBox Visibility.

##### `name``property`

View name.

#### Functions

##### `add_PropertyChanged(value)`

Called when a property is added to the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>113<br>114<br>115<br>``` | ```md-code__content<br>def add_PropertyChanged(self, value):<br>    """Called when a property is added to the object."""<br>    self.PropertyChanged += value<br>``` |

##### `remove_PropertyChanged(value)`

Called when a property is removed from the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>``` | ```md-code__content<br>def remove_PropertyChanged(self, value):<br>    """Called when a property is removed from the object."""<br>    self.PropertyChanged -= value<br>``` |

##### `OnPropertyChanged(prop_name)`

Called when a property is changed.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `prop_name` | `str` | property name | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def OnPropertyChanged(self, prop_name):<br>    """Called when a property is changed.<br>    Args:<br>        prop_name (str): property name<br>    """<br>    if self._propertyChangedCaller:<br>        args = ComponentModel.PropertyChangedEventArgs(prop_name)<br>        self._propertyChangedCaller(self, args)<br>``` |

##### `unwrap()`

Unwrap and return wrapped object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>753<br>754<br>755<br>``` | ```md-code__content<br>def unwrap(self):<br>    """Unwrap and return wrapped object."""<br>    return self.item<br>``` |

##### `checked(value)`

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>762<br>763<br>764<br>``` | ```md-code__content<br>@checked.setter<br>def checked(self, value):<br>    self.state = value<br>``` |

### `LevelOption(level_element)`

Bases: `TemplateListItem`

Level wrapper for :func: `select_levels`.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2027<br>2028<br>``` | ```md-code__content<br>def __init__(self, level_element):<br>    super(LevelOption, self).__init__(level_element)<br>``` |

#### Attributes

##### `item = orig_item``instance-attribute`

##### `state = checked``instance-attribute`

##### `checkable``property``writable`

List Item CheckBox Visibility.

##### `name``property`

Level name.

#### Functions

##### `add_PropertyChanged(value)`

Called when a property is added to the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>113<br>114<br>115<br>``` | ```md-code__content<br>def add_PropertyChanged(self, value):<br>    """Called when a property is added to the object."""<br>    self.PropertyChanged += value<br>``` |

##### `remove_PropertyChanged(value)`

Called when a property is removed from the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>``` | ```md-code__content<br>def remove_PropertyChanged(self, value):<br>    """Called when a property is removed from the object."""<br>    self.PropertyChanged -= value<br>``` |

##### `OnPropertyChanged(prop_name)`

Called when a property is changed.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `prop_name` | `str` | property name | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def OnPropertyChanged(self, prop_name):<br>    """Called when a property is changed.<br>    Args:<br>        prop_name (str): property name<br>    """<br>    if self._propertyChangedCaller:<br>        args = ComponentModel.PropertyChangedEventArgs(prop_name)<br>        self._propertyChangedCaller(self, args)<br>``` |

##### `unwrap()`

Unwrap and return wrapped object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>753<br>754<br>755<br>``` | ```md-code__content<br>def unwrap(self):<br>    """Unwrap and return wrapped object."""<br>    return self.item<br>``` |

##### `checked(value)`

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>762<br>763<br>764<br>``` | ```md-code__content<br>@checked.setter<br>def checked(self, value):<br>    self.state = value<br>``` |

### `FamilyParamOption(fparam, builtin=False, labeled=False)`

Bases: `TemplateListItem`

Level wrapper for :func: `select_family_parameters`.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2038<br>2039<br>2040<br>2041<br>``` | ```md-code__content<br>def __init__(self, fparam, builtin=False, labeled=False):<br>    super(FamilyParamOption, self).__init__(fparam)<br>    self.isbuiltin = builtin<br>    self.islabeled = labeled<br>``` |

#### Attributes

##### `item = orig_item``instance-attribute`

##### `state = checked``instance-attribute`

##### `checkable``property``writable`

List Item CheckBox Visibility.

##### `isbuiltin = builtin``instance-attribute`

##### `islabeled = labeled``instance-attribute`

##### `name``property`

Family Parameter name.

##### `istype``property`

Is type parameter.

#### Functions

##### `add_PropertyChanged(value)`

Called when a property is added to the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>113<br>114<br>115<br>``` | ```md-code__content<br>def add_PropertyChanged(self, value):<br>    """Called when a property is added to the object."""<br>    self.PropertyChanged += value<br>``` |

##### `remove_PropertyChanged(value)`

Called when a property is removed from the object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>``` | ```md-code__content<br>def remove_PropertyChanged(self, value):<br>    """Called when a property is removed from the object."""<br>    self.PropertyChanged -= value<br>``` |

##### `OnPropertyChanged(prop_name)`

Called when a property is changed.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `prop_name` | `str` | property name | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def OnPropertyChanged(self, prop_name):<br>    """Called when a property is changed.<br>    Args:<br>        prop_name (str): property name<br>    """<br>    if self._propertyChangedCaller:<br>        args = ComponentModel.PropertyChangedEventArgs(prop_name)<br>        self._propertyChangedCaller(self, args)<br>``` |

##### `unwrap()`

Unwrap and return wrapped object.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>753<br>754<br>755<br>``` | ```md-code__content<br>def unwrap(self):<br>    """Unwrap and return wrapped object."""<br>    return self.item<br>``` |

##### `checked(value)`

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>762<br>763<br>764<br>``` | ```md-code__content<br>@checked.setter<br>def checked(self, value):<br>    self.state = value<br>``` |

## Functions

### `is_registered_dockable_panel(panel_type)`

Check if dockable panel is already registered.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `panel_type` | `WPFPanel` | dockable panel type | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>568<br>569<br>570<br>571<br>572<br>573<br>574<br>575<br>576<br>``` | ```md-code__content<br>def is_registered_dockable_panel(panel_type):<br>    """Check if dockable panel is already registered.<br>    Args:<br>        panel_type (forms.WPFPanel): dockable panel type<br>    """<br>    panel_uuid = coreutils.Guid.Parse(panel_type.panel_id)<br>    dockable_panel_id = UI.DockablePaneId(panel_uuid)<br>    return UI.DockablePane.PaneExists(dockable_panel_id)<br>``` |

### `register_dockable_panel(panel_type, default_visible=True)`

Register dockable panel.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `panel_type` | `WPFPanel` | dockable panel type | _required_ |
| `default_visible` | `bool` | whether panel should be visible by default | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>579<br>580<br>581<br>582<br>583<br>584<br>585<br>586<br>587<br>588<br>589<br>590<br>591<br>592<br>593<br>594<br>595<br>596<br>597<br>598<br>599<br>600<br>601<br>``` | ```md-code__content<br>def register_dockable_panel(panel_type, default_visible=True):<br>    """Register dockable panel.<br>    Args:<br>        panel_type (forms.WPFPanel): dockable panel type<br>        default_visible (bool, optional):<br>            whether panel should be visible by default<br>    """<br>    if not issubclass(panel_type, WPFPanel):<br>        raise PyRevitException(<br>            "Dockable pane must be a subclass of forms.WPFPanel"<br>            )<br>    panel_uuid = coreutils.Guid.Parse(panel_type.panel_id)<br>    dockable_panel_id = UI.DockablePaneId(panel_uuid)<br>    panel_provider = _WPFPanelProvider(panel_type, default_visible)<br>    HOST_APP.uiapp.RegisterDockablePane(<br>        dockable_panel_id,<br>        panel_type.panel_title,<br>        panel_provider<br>    )<br>    return panel_provider.panel<br>``` |

### `open_dockable_panel(panel_type_or_id)`

Open previously registered dockable panel.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `panel_type_or_id` | `(WPFPanel, str)` | panel type or id | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>604<br>605<br>606<br>607<br>608<br>609<br>610<br>``` | ```md-code__content<br>def open_dockable_panel(panel_type_or_id):<br>    """Open previously registered dockable panel.<br>    Args:<br>        panel_type_or_id (forms.WPFPanel, str): panel type or id<br>    """<br>    toggle_dockable_panel(panel_type_or_id, True)<br>``` |

### `close_dockable_panel(panel_type_or_id)`

Close previously registered dockable panel.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `panel_type_or_id` | `(WPFPanel, str)` | panel type or id | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>613<br>614<br>615<br>616<br>617<br>618<br>619<br>``` | ```md-code__content<br>def close_dockable_panel(panel_type_or_id):<br>    """Close previously registered dockable panel.<br>    Args:<br>        panel_type_or_id (forms.WPFPanel, str): panel type or id<br>    """<br>    toggle_dockable_panel(panel_type_or_id, False)<br>``` |

### `toggle_dockable_panel(panel_type_or_id, state)`

Toggle previously registered dockable panel.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `panel_type_or_id` | `WPFPanel | str` | panel type or id | _required_ |
| `state` | `bool` | True to show the panel, False to hide it. | _required_ |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>622<br>623<br>624<br>625<br>626<br>627<br>628<br>629<br>630<br>631<br>632<br>633<br>634<br>635<br>636<br>637<br>638<br>639<br>640<br>641<br>642<br>643<br>644<br>645<br>646<br>647<br>648<br>649<br>``` | ```md-code__content<br>def toggle_dockable_panel(panel_type_or_id, state):<br>    """Toggle previously registered dockable panel.<br>    Args:<br>        panel_type_or_id (forms.WPFPanel | str): panel type or id<br>        state (bool): True to show the panel, False to hide it.<br>    """<br>    dpanel_id = None<br>    if isinstance(panel_type_or_id, str):<br>        panel_id = coreutils.Guid.Parse(panel_type_or_id)<br>        dpanel_id = UI.DockablePaneId(panel_id)<br>    elif issubclass(panel_type_or_id, WPFPanel):<br>        panel_id = coreutils.Guid.Parse(panel_type_or_id.panel_id)<br>        dpanel_id = UI.DockablePaneId(panel_id)<br>    else:<br>        raise PyRevitException("Given type is not a forms.WPFPanel")<br>    if dpanel_id:<br>        if UI.DockablePane.PaneIsRegistered(dpanel_id):<br>            dockable_panel = HOST_APP.uiapp.GetDockablePane(dpanel_id)<br>            if state:<br>                dockable_panel.Show()<br>            else:<br>                dockable_panel.Hide()<br>        else:<br>            raise PyRevitException(<br>                "Panel with id \"%s\" is not registered" % panel_type_or_id<br>                )<br>``` |

### `select_revisions(title='Select Revision', button_name='Select', width=DEFAULT_INPUTWINDOW_WIDTH, multiple=True, filterfunc=None, doc=None)`

Standard form for selecting revisions.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | list window title | `'Select Revision'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `width` | `int` | width of list window | `DEFAULT_INPUTWINDOW_WIDTH` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `doc` | `Document` | source document for revisions; defaults to active document | `None` |

Returns:

| Type | Description |
| --- | --- |
| `list[Revision]` | list of selected revisions |

Examples:

```md-code__content
from pyrevit import forms
forms.select_revisions()
[<Autodesk.Revit.DB.Revision object>,\
 <Autodesk.Revit.DB.Revision object>]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2054<br>2055<br>2056<br>2057<br>2058<br>2059<br>2060<br>2061<br>2062<br>2063<br>2064<br>2065<br>2066<br>2067<br>2068<br>2069<br>2070<br>2071<br>2072<br>2073<br>2074<br>2075<br>2076<br>2077<br>2078<br>2079<br>2080<br>2081<br>2082<br>2083<br>2084<br>2085<br>2086<br>2087<br>2088<br>2089<br>2090<br>2091<br>2092<br>2093<br>2094<br>2095<br>2096<br>2097<br>2098<br>2099<br>2100<br>2101<br>``` | ````md-code__content<br>def select_revisions(title='Select Revision',<br>                     button_name='Select',<br>                     width=DEFAULT_INPUTWINDOW_WIDTH,<br>                     multiple=True,<br>                     filterfunc=None,<br>                     doc=None):<br>    """Standard form for selecting revisions.<br>    Args:<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        width (int, optional): width of list window<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        doc (DB.Document, optional):<br>            source document for revisions; defaults to active document<br>    Returns:<br>        (list[DB.Revision]): list of selected revisions<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_revisions()<br>        [<Autodesk.Revit.DB.Revision object>,<br>         <Autodesk.Revit.DB.Revision object>]<br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    revisions = sorted(revit.query.get_revisions(doc=doc),<br>                       key=lambda x: x.SequenceNumber)<br>    if filterfunc:<br>        revisions = filter(filterfunc, revisions)<br>    # ask user for revisions<br>    selected_revs = SelectFromList.show(<br>        [RevisionOption(x) for x in revisions],<br>        title=title,<br>        button_name=button_name,<br>        width=width,<br>        multiselect=multiple,<br>        checked_only=True<br>        )<br>    return selected_revs<br>```` |

### `select_sheets(title='Select Sheets', button_name='Select', width=DEFAULT_INPUTWINDOW_WIDTH, multiple=True, filterfunc=None, doc=None, include_placeholder=True, use_selection=False)`

Standard form for selecting sheets.

Sheets are grouped into sheet sets and sheet set can be selected from
a drop down box at the top of window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | list window title | `'Select Sheets'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `width` | `int` | width of list window | `DEFAULT_INPUTWINDOW_WIDTH` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `doc` | `Document` | source document for sheets; defaults to active document | `None` |
| `include_placeholder` | `bool` | include a placeholder.<br>Defaults to True | `True` |
| `use_selection` | `bool` | ask if user wants to use currently selected sheets. | `False` |

Returns:

| Type | Description |
| --- | --- |
| `list[ViewSheet]` | list of selected sheets |

Examples:

```md-code__content
from pyrevit import forms
forms.select_sheets()
[<Autodesk.Revit.DB.ViewSheet object>,\
 <Autodesk.Revit.DB.ViewSheet object>]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2104<br>2105<br>2106<br>2107<br>2108<br>2109<br>2110<br>2111<br>2112<br>2113<br>2114<br>2115<br>2116<br>2117<br>2118<br>2119<br>2120<br>2121<br>2122<br>2123<br>2124<br>2125<br>2126<br>2127<br>2128<br>2129<br>2130<br>2131<br>2132<br>2133<br>2134<br>2135<br>2136<br>2137<br>2138<br>2139<br>2140<br>2141<br>2142<br>2143<br>2144<br>2145<br>2146<br>2147<br>2148<br>2149<br>2150<br>2151<br>2152<br>2153<br>2154<br>2155<br>2156<br>2157<br>2158<br>2159<br>2160<br>2161<br>2162<br>2163<br>2164<br>2165<br>2166<br>2167<br>2168<br>2169<br>2170<br>2171<br>2172<br>2173<br>2174<br>2175<br>2176<br>2177<br>2178<br>2179<br>2180<br>2181<br>2182<br>2183<br>2184<br>2185<br>2186<br>2187<br>2188<br>2189<br>2190<br>2191<br>2192<br>2193<br>2194<br>2195<br>2196<br>2197<br>2198<br>2199<br>2200<br>2201<br>2202<br>2203<br>2204<br>``` | ````md-code__content<br>def select_sheets(title='Select Sheets',<br>                  button_name='Select',<br>                  width=DEFAULT_INPUTWINDOW_WIDTH,<br>                  multiple=True,<br>                  filterfunc=None,<br>                  doc=None,<br>                  include_placeholder=True,<br>                  use_selection=False):<br>    """Standard form for selecting sheets.<br>    Sheets are grouped into sheet sets and sheet set can be selected from<br>    a drop down box at the top of window.<br>    Args:<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        width (int, optional): width of list window<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        doc (DB.Document, optional):<br>            source document for sheets; defaults to active document<br>        include_placeholder (bool, optional): include a placeholder.<br>            Defaults to True<br>        use_selection (bool, optional):<br>            ask if user wants to use currently selected sheets.<br>    Returns:<br>        (list[DB.ViewSheet]): list of selected sheets<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_sheets()<br>        [<Autodesk.Revit.DB.ViewSheet object>,<br>         <Autodesk.Revit.DB.ViewSheet object>]<br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    # check for previously selected sheets<br>    if use_selection:<br>        current_selected_sheets = revit.get_selection() \<br>                                       .include(DB.ViewSheet) \<br>                                       .elements<br>        if filterfunc:<br>            current_selected_sheets = \<br>                filter(filterfunc, current_selected_sheets)<br>        if not include_placeholder:<br>            current_selected_sheets = \<br>                [x for x in current_selected_sheets if not x.IsPlaceholder]<br>        if current_selected_sheets \<br>                and ask_to_use_selected("sheets",<br>                                        count=len(current_selected_sheets),<br>                                        multiple=multiple):<br>            return current_selected_sheets \<br>                if multiple else current_selected_sheets[0]<br>    # otherwise get all sheets and prompt for selection<br>    all_ops = {}<br>    all_sheets = DB.FilteredElementCollector(doc) \<br>                   .OfClass(DB.ViewSheet) \<br>                   .WhereElementIsNotElementType() \<br>                   .ToElements()<br>    if filterfunc:<br>        all_sheets = filter(filterfunc, all_sheets)<br>    if not include_placeholder:<br>        all_sheets = [x for x in all_sheets if not x.IsPlaceholder]<br>    all_sheets_ops = sorted([SheetOption(x) for x in all_sheets],<br>                            key=lambda x: x.number)<br>    all_ops['All Sheets'] = all_sheets_ops<br>    sheetsets = revit.query.get_sheet_sets(doc)<br>    for sheetset in sheetsets:<br>        sheetset_sheets = \<br>            [x for x in sheetset.Views if isinstance(x, DB.ViewSheet)]<br>        if filterfunc:<br>            sheetset_sheets = filter(filterfunc, sheetset_sheets)<br>        sheetset_ops = sorted([SheetOption(x) for x in sheetset_sheets],<br>                              key=lambda x: x.number)<br>        all_ops[sheetset.Name] = sheetset_ops<br>    # ask user for multiple sheets<br>    selected_sheets = SelectFromList.show(<br>        all_ops,<br>        title=title,<br>        group_selector_title='Sheet Sets:',<br>        button_name=button_name,<br>        width=width,<br>        multiselect=multiple,<br>        checked_only=True,<br>        default_group='All Sheets'<br>        )<br>    return selected_sheets<br>```` |

### `select_views(title='Select Views', button_name='Select', width=DEFAULT_INPUTWINDOW_WIDTH, multiple=True, filterfunc=None, doc=None, use_selection=False)`

Standard form for selecting views.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | list window title | `'Select Views'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `width` | `int` | width of list window | `DEFAULT_INPUTWINDOW_WIDTH` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `doc` | `Document` | source document for views; defaults to active document | `None` |
| `use_selection` | `bool` | ask if user wants to use currently selected views. | `False` |

Returns:

| Type | Description |
| --- | --- |
| `list[View]` | list of selected views |

Examples:

```md-code__content
from pyrevit import forms
forms.select_views()
[<Autodesk.Revit.DB.View object>,\
 <Autodesk.Revit.DB.View object>]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2207<br>2208<br>2209<br>2210<br>2211<br>2212<br>2213<br>2214<br>2215<br>2216<br>2217<br>2218<br>2219<br>2220<br>2221<br>2222<br>2223<br>2224<br>2225<br>2226<br>2227<br>2228<br>2229<br>2230<br>2231<br>2232<br>2233<br>2234<br>2235<br>2236<br>2237<br>2238<br>2239<br>2240<br>2241<br>2242<br>2243<br>2244<br>2245<br>2246<br>2247<br>2248<br>2249<br>2250<br>2251<br>2252<br>2253<br>2254<br>2255<br>2256<br>2257<br>2258<br>2259<br>2260<br>2261<br>2262<br>2263<br>2264<br>2265<br>2266<br>2267<br>2268<br>2269<br>2270<br>2271<br>2272<br>2273<br>2274<br>``` | ````md-code__content<br>def select_views(title='Select Views',<br>                 button_name='Select',<br>                 width=DEFAULT_INPUTWINDOW_WIDTH,<br>                 multiple=True,<br>                 filterfunc=None,<br>                 doc=None,<br>                 use_selection=False):<br>    """Standard form for selecting views.<br>    Args:<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        width (int, optional): width of list window<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        doc (DB.Document, optional):<br>            source document for views; defaults to active document<br>        use_selection (bool, optional):<br>            ask if user wants to use currently selected views.<br>    Returns:<br>        (list[DB.View]): list of selected views<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_views()<br>        [<Autodesk.Revit.DB.View object>,<br>         <Autodesk.Revit.DB.View object>]<br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    # check for previously selected sheets<br>    if use_selection:<br>        current_selected_views = revit.get_selection() \<br>                                      .include(DB.View) \<br>                                      .elements<br>        if filterfunc:<br>            current_selected_views = \<br>                filter(filterfunc, current_selected_views)<br>        if current_selected_views \<br>                and ask_to_use_selected("views",<br>                                        count=len(current_selected_views),<br>                                        multiple=multiple):<br>            return current_selected_views \<br>                if multiple else current_selected_views[0]<br>    # otherwise get all sheets and prompt for selection<br>    all_graphviews = revit.query.get_all_views(doc=doc)<br>    if filterfunc:<br>        all_graphviews = filter(filterfunc, all_graphviews)<br>    selected_views = SelectFromList.show(<br>        sorted([ViewOption(x) for x in all_graphviews],<br>               key=lambda x: x.name),<br>        title=title,<br>        button_name=button_name,<br>        width=width,<br>        multiselect=multiple,<br>        checked_only=True<br>        )<br>    return selected_views<br>```` |

### `select_levels(title='Select Levels', button_name='Select', width=DEFAULT_INPUTWINDOW_WIDTH, multiple=True, filterfunc=None, doc=None, use_selection=False)`

Standard form for selecting levels.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | list window title | `'Select Levels'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `width` | `int` | width of list window | `DEFAULT_INPUTWINDOW_WIDTH` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `doc` | `Document` | source document for levels; defaults to active document | `None` |
| `use_selection` | `bool` | ask if user wants to use currently selected levels. | `False` |

Returns:

| Type | Description |
| --- | --- |
| `list[Level]` | list of selected levels |

Examples:

```md-code__content
from pyrevit import forms
forms.select_levels()
[<Autodesk.Revit.DB.Level object>,\
 <Autodesk.Revit.DB.Level object>]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2277<br>2278<br>2279<br>2280<br>2281<br>2282<br>2283<br>2284<br>2285<br>2286<br>2287<br>2288<br>2289<br>2290<br>2291<br>2292<br>2293<br>2294<br>2295<br>2296<br>2297<br>2298<br>2299<br>2300<br>2301<br>2302<br>2303<br>2304<br>2305<br>2306<br>2307<br>2308<br>2309<br>2310<br>2311<br>2312<br>2313<br>2314<br>2315<br>2316<br>2317<br>2318<br>2319<br>2320<br>2321<br>2322<br>2323<br>2324<br>2325<br>2326<br>2327<br>2328<br>2329<br>2330<br>2331<br>2332<br>2333<br>2334<br>2335<br>2336<br>2337<br>2338<br>2339<br>2340<br>2341<br>2342<br>2343<br>2344<br>2345<br>2346<br>2347<br>``` | ````md-code__content<br>def select_levels(title='Select Levels',<br>                  button_name='Select',<br>                  width=DEFAULT_INPUTWINDOW_WIDTH,<br>                  multiple=True,<br>                  filterfunc=None,<br>                  doc=None,<br>                  use_selection=False):<br>    """Standard form for selecting levels.<br>    Args:<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        width (int, optional): width of list window<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        doc (DB.Document, optional):<br>            source document for levels; defaults to active document<br>        use_selection (bool, optional):<br>            ask if user wants to use currently selected levels.<br>    Returns:<br>        (list[DB.Level]): list of selected levels<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_levels()<br>        [<Autodesk.Revit.DB.Level object>,<br>         <Autodesk.Revit.DB.Level object>]<br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    # check for previously selected sheets<br>    if use_selection:<br>        current_selected_levels = revit.get_selection() \<br>                                       .include(DB.Level) \<br>                                       .elements<br>        if filterfunc:<br>            current_selected_levels = \<br>                filter(filterfunc, current_selected_levels)<br>        if current_selected_levels \<br>                and ask_to_use_selected("levels",<br>                                        count=len(current_selected_levels),<br>                                        multiple=multiple):<br>            return current_selected_levels \<br>                if multiple else current_selected_levels[0]<br>    all_levels = \<br>        revit.query.get_elements_by_categories(<br>            [DB.BuiltInCategory.OST_Levels],<br>            doc=doc<br>            )<br>    if filterfunc:<br>        all_levels = filter(filterfunc, all_levels)<br>    selected_levels = SelectFromList.show(<br>        sorted([LevelOption(x) for x in all_levels],<br>               key=lambda x: x.Elevation),<br>        title=title,<br>        button_name=button_name,<br>        width=width,<br>        multiselect=multiple,<br>        checked_only=True,<br>        )<br>    return selected_levels<br>```` |

### `select_viewtemplates(title='Select View Templates', button_name='Select', width=DEFAULT_INPUTWINDOW_WIDTH, multiple=True, filterfunc=None, doc=None)`

Standard form for selecting view templates.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | list window title | `'Select View Templates'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `width` | `int` | width of list window | `DEFAULT_INPUTWINDOW_WIDTH` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `doc` | `Document` | source document for views; defaults to active document | `None` |

Returns:

| Type | Description |
| --- | --- |
| `list[View]` | list of selected view templates |

Examples:

```md-code__content
from pyrevit import forms
forms.select_viewtemplates()
[<Autodesk.Revit.DB.View object>,\
 <Autodesk.Revit.DB.View object>]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2350<br>2351<br>2352<br>2353<br>2354<br>2355<br>2356<br>2357<br>2358<br>2359<br>2360<br>2361<br>2362<br>2363<br>2364<br>2365<br>2366<br>2367<br>2368<br>2369<br>2370<br>2371<br>2372<br>2373<br>2374<br>2375<br>2376<br>2377<br>2378<br>2379<br>2380<br>2381<br>2382<br>2383<br>2384<br>2385<br>2386<br>2387<br>2388<br>2389<br>2390<br>2391<br>2392<br>2393<br>2394<br>2395<br>2396<br>``` | ````md-code__content<br>def select_viewtemplates(title='Select View Templates',<br>                         button_name='Select',<br>                         width=DEFAULT_INPUTWINDOW_WIDTH,<br>                         multiple=True,<br>                         filterfunc=None,<br>                         doc=None):<br>    """Standard form for selecting view templates.<br>    Args:<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        width (int, optional): width of list window<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        doc (DB.Document, optional):<br>            source document for views; defaults to active document<br>    Returns:<br>        (list[DB.View]): list of selected view templates<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_viewtemplates()<br>        [<Autodesk.Revit.DB.View object>,<br>         <Autodesk.Revit.DB.View object>]<br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    all_viewtemplates = revit.query.get_all_view_templates(doc=doc)<br>    if filterfunc:<br>        all_viewtemplates = filter(filterfunc, all_viewtemplates)<br>    selected_viewtemplates = SelectFromList.show(<br>        sorted([ViewOption(x) for x in all_viewtemplates],<br>               key=lambda x: x.name),<br>        title=title,<br>        button_name=button_name,<br>        width=width,<br>        multiselect=multiple,<br>        checked_only=True<br>        )<br>    return selected_viewtemplates<br>```` |

### `select_schedules(title='Select Schedules', button_name='Select', width=DEFAULT_INPUTWINDOW_WIDTH, multiple=True, filterfunc=None, doc=None)`

Standard form for selecting schedules.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | list window title | `'Select Schedules'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `width` | `int` | width of list window | `DEFAULT_INPUTWINDOW_WIDTH` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `doc` | `Document` | source document for views; defaults to active document | `None` |

Returns:

| Type | Description |
| --- | --- |
| `list[ViewSchedule]` | list of selected schedules |

Examples:

```md-code__content
from pyrevit import forms
forms.select_schedules()
[<Autodesk.Revit.DB.ViewSchedule object>,\
 <Autodesk.Revit.DB.ViewSchedule object>]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2399<br>2400<br>2401<br>2402<br>2403<br>2404<br>2405<br>2406<br>2407<br>2408<br>2409<br>2410<br>2411<br>2412<br>2413<br>2414<br>2415<br>2416<br>2417<br>2418<br>2419<br>2420<br>2421<br>2422<br>2423<br>2424<br>2425<br>2426<br>2427<br>2428<br>2429<br>2430<br>2431<br>2432<br>2433<br>2434<br>2435<br>2436<br>2437<br>2438<br>2439<br>2440<br>2441<br>2442<br>2443<br>2444<br>2445<br>2446<br>``` | ````md-code__content<br>def select_schedules(title='Select Schedules',<br>                     button_name='Select',<br>                     width=DEFAULT_INPUTWINDOW_WIDTH,<br>                     multiple=True,<br>                     filterfunc=None,<br>                     doc=None):<br>    """Standard form for selecting schedules.<br>    Args:<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        width (int, optional): width of list window<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        doc (DB.Document, optional):<br>            source document for views; defaults to active document<br>    Returns:<br>        (list[DB.ViewSchedule]): list of selected schedules<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_schedules()<br>        [<Autodesk.Revit.DB.ViewSchedule object>,<br>         <Autodesk.Revit.DB.ViewSchedule object>]<br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    all_schedules = revit.query.get_all_schedules(doc=doc)<br>    if filterfunc:<br>        all_schedules = filter(filterfunc, all_schedules)<br>    selected_schedules = \<br>        SelectFromList.show(<br>            sorted([ViewOption(x) for x in all_schedules],<br>                   key=lambda x: x.name),<br>            title=title,<br>            button_name=button_name,<br>            width=width,<br>            multiselect=multiple,<br>            checked_only=True<br>        )<br>    return selected_schedules<br>```` |

### `select_open_docs(title='Select Open Documents', button_name='OK', width=DEFAULT_INPUTWINDOW_WIDTH, multiple=True, check_more_than_one=True, filterfunc=None)`

Standard form for selecting open documents.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | list window title | `'Select Open Documents'` |
| `button_name` | `str` | list window button caption | `'OK'` |
| `width` | `int` | width of list window | `DEFAULT_INPUTWINDOW_WIDTH` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `check_more_than_one` | `bool` |  | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |

Returns:

| Type | Description |
| --- | --- |
| `list[Document]` | list of selected documents |

Examples:

```md-code__content
from pyrevit import forms
forms.select_open_docs()
[<Autodesk.Revit.DB.Document object>,\
 <Autodesk.Revit.DB.Document object>]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2449<br>2450<br>2451<br>2452<br>2453<br>2454<br>2455<br>2456<br>2457<br>2458<br>2459<br>2460<br>2461<br>2462<br>2463<br>2464<br>2465<br>2466<br>2467<br>2468<br>2469<br>2470<br>2471<br>2472<br>2473<br>2474<br>2475<br>2476<br>2477<br>2478<br>2479<br>2480<br>2481<br>2482<br>2483<br>2484<br>2485<br>2486<br>2487<br>2488<br>2489<br>2490<br>2491<br>2492<br>2493<br>2494<br>2495<br>2496<br>``` | ````md-code__content<br>def select_open_docs(title='Select Open Documents',<br>                     button_name='OK',<br>                     width=DEFAULT_INPUTWINDOW_WIDTH,    #pylint: disable=W0613<br>                     multiple=True,<br>                     check_more_than_one=True,<br>                     filterfunc=None):<br>    """Standard form for selecting open documents.<br>    Args:<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        width (int, optional): width of list window<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        check_more_than_one (bool, optional): <br>        filterfunc (function):<br>            filter function to be applied to context items.<br>    Returns:<br>        (list[DB.Document]): list of selected documents<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_open_docs()<br>        [<Autodesk.Revit.DB.Document object>,<br>         <Autodesk.Revit.DB.Document object>]<br>        ```<br>    """<br>    # find open documents other than the active doc<br>    open_docs = [d for d in revit.docs if not d.IsLinked]    #pylint: disable=E1101<br>    if check_more_than_one:<br>        open_docs.remove(revit.doc)    #pylint: disable=E1101<br>    if not open_docs:<br>        alert('Only one active document is found. '<br>              'At least two documents must be open. '<br>              'Operation cancelled.')<br>        return<br>    return SelectFromList.show(<br>        open_docs,<br>        name_attr='Title',<br>        multiselect=multiple,<br>        title=title,<br>        button_name=button_name,<br>        filterfunc=filterfunc<br>        )<br>```` |

### `select_titleblocks(title='Select Titleblock', button_name='Select', no_tb_option='No Title Block', width=DEFAULT_INPUTWINDOW_WIDTH, multiple=False, filterfunc=None, doc=None)`

Standard form for selecting a titleblock.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | list window title | `'Select Titleblock'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `no_tb_option` | `str` | name of option for no title block | `'No Title Block'` |
| `width` | `int` | width of list window | `DEFAULT_INPUTWINDOW_WIDTH` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to False | `False` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `doc` | `Document` | source document for titleblocks; defaults to active document | `None` |

Returns:

| Type | Description |
| --- | --- |
| `ElementId` | selected titleblock id. |

Examples:

```md-code__content
from pyrevit import forms
forms.select_titleblocks()
<Autodesk.Revit.DB.ElementId object>

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2499<br>2500<br>2501<br>2502<br>2503<br>2504<br>2505<br>2506<br>2507<br>2508<br>2509<br>2510<br>2511<br>2512<br>2513<br>2514<br>2515<br>2516<br>2517<br>2518<br>2519<br>2520<br>2521<br>2522<br>2523<br>2524<br>2525<br>2526<br>2527<br>2528<br>2529<br>2530<br>2531<br>2532<br>2533<br>2534<br>2535<br>2536<br>2537<br>2538<br>2539<br>2540<br>2541<br>2542<br>2543<br>2544<br>2545<br>2546<br>2547<br>2548<br>2549<br>2550<br>``` | ````md-code__content<br>def select_titleblocks(title='Select Titleblock',<br>                       button_name='Select',<br>                       no_tb_option='No Title Block',<br>                       width=DEFAULT_INPUTWINDOW_WIDTH,<br>                       multiple=False,<br>                       filterfunc=None,<br>                       doc=None):<br>    """Standard form for selecting a titleblock.<br>    Args:<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        no_tb_option (str, optional): name of option for no title block<br>        width (int, optional): width of list window<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to False<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        doc (DB.Document, optional):<br>            source document for titleblocks; defaults to active document<br>    Returns:<br>        (DB.ElementId): selected titleblock id.<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_titleblocks()<br>        <Autodesk.Revit.DB.ElementId object><br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    titleblocks = DB.FilteredElementCollector(doc)\<br>                    .OfCategory(DB.BuiltInCategory.OST_TitleBlocks)\<br>                    .WhereElementIsElementType()\<br>                    .ToElements()<br>    tblock_dict = {'{}: {}'.format(tb.FamilyName,<br>                                   revit.query.get_name(tb)): tb.Id<br>                   for tb in titleblocks}<br>    tblock_dict[no_tb_option] = DB.ElementId.InvalidElementId<br>    selected_titleblocks = SelectFromList.show(sorted(tblock_dict.keys()),<br>                                               title=title,<br>                                               button_name=button_name,<br>                                               width=width,<br>                                               multiselect=multiple,<br>                                               filterfunc=filterfunc)<br>    if selected_titleblocks:<br>        if multiple:<br>            return [tblock_dict[x] for x in selected_titleblocks]<br>        else:<br>            return tblock_dict[selected_titleblocks]<br>```` |

### `select_swatch(title='Select Color Swatch', button_name='Select')`

Standard form for selecting a color swatch.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | swatch list window title | `'Select Color Swatch'` |
| `button_name` | `str` | swatch list window button caption | `'Select'` |

Returns:

| Type | Description |
| --- | --- |
| `RGB` | rgb color |

Examples:

```md-code__content
from pyrevit import forms
forms.select_swatch(title="Select Text Color")
<RGB #CD8800>

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2553<br>2554<br>2555<br>2556<br>2557<br>2558<br>2559<br>2560<br>2561<br>2562<br>2563<br>2564<br>2565<br>2566<br>2567<br>2568<br>2569<br>2570<br>2571<br>2572<br>2573<br>2574<br>2575<br>2576<br>2577<br>2578<br>2579<br>2580<br>2581<br>2582<br>``` | ````md-code__content<br>def select_swatch(title='Select Color Swatch', button_name='Select'):<br>    """Standard form for selecting a color swatch.<br>    Args:<br>        title (str, optional): swatch list window title<br>        button_name (str, optional): swatch list window button caption<br>    Returns:<br>        (pyrevit.coreutils.colors.RGB): rgb color<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_swatch(title="Select Text Color")<br>        <RGB #CD8800><br>        ```<br>    """<br>    itemplate = utils.load_ctrl_template(<br>        os.path.join(XAML_FILES_DIR, "SwatchContainerStyle.xaml")<br>        )<br>    swatch = SelectFromList.show(<br>        colors.COLORS.values(),<br>        title=title,<br>        button_name=button_name,<br>        width=300,<br>        multiselect=False,<br>        item_template=itemplate<br>        )<br>    return swatch<br>```` |

### `select_image(images, title='Select Image', button_name='Select')`

Standard form for selecting an image.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `images` | `list[str] | list[BitmapImage]` | list of image file paths or bitmaps | _required_ |
| `title` | `str` | swatch list window title | `'Select Image'` |
| `button_name` | `str` | swatch list window button caption | `'Select'` |

Returns:

| Type | Description |
| --- | --- |
| `str` | path of the selected image |

Examples:

```md-code__content
from pyrevit import forms
forms.select_image(['C:/path/to/image1.png',\
                    'C:/path/to/image2.png'],
                    title="Select Variation")
'C:/path/to/image1.png'

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2585<br>2586<br>2587<br>2588<br>2589<br>2590<br>2591<br>2592<br>2593<br>2594<br>2595<br>2596<br>2597<br>2598<br>2599<br>2600<br>2601<br>2602<br>2603<br>2604<br>2605<br>2606<br>2607<br>2608<br>2609<br>2610<br>2611<br>2612<br>2613<br>2614<br>2615<br>2616<br>2617<br>2618<br>2619<br>2620<br>2621<br>2622<br>2623<br>2624<br>2625<br>2626<br>2627<br>2628<br>2629<br>2630<br>2631<br>2632<br>2633<br>``` | ````md-code__content<br>def select_image(images, title='Select Image', button_name='Select'):<br>    """Standard form for selecting an image.<br>    Args:<br>        images (list[str] | list[framework.Imaging.BitmapImage]):<br>            list of image file paths or bitmaps<br>        title (str, optional): swatch list window title<br>        button_name (str, optional): swatch list window button caption<br>    Returns:<br>        (str): path of the selected image<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.select_image(['C:/path/to/image1.png',<br>                            'C:/path/to/image2.png'],<br>                            title="Select Variation")<br>        'C:/path/to/image1.png'<br>        ```<br>    """<br>    ptemplate = utils.load_itemspanel_template(<br>        os.path.join(XAML_FILES_DIR, "ImageListPanelStyle.xaml")<br>        )<br>    itemplate = utils.load_ctrl_template(<br>        os.path.join(XAML_FILES_DIR, "ImageListContainerStyle.xaml")<br>        )<br>    bitmap_images = {}<br>    for imageobj in images:<br>        if isinstance(imageobj, str):<br>            img = utils.bitmap_from_file(imageobj)<br>            if img:<br>                bitmap_images[img] = imageobj<br>        elif isinstance(imageobj, framework.Imaging.BitmapImage):<br>            bitmap_images[imageobj] = imageobj<br>    selected_image = SelectFromList.show(<br>        sorted(bitmap_images.keys(), key=lambda x: x.UriSource.AbsolutePath),<br>        title=title,<br>        button_name=button_name,<br>        width=500,<br>        multiselect=False,<br>        item_template=itemplate,<br>        items_panel_template=ptemplate<br>        )<br>    return bitmap_images.get(selected_image, None)<br>```` |

### `select_parameters(src_element, title='Select Parameters', button_name='Select', multiple=True, filterfunc=None, include_instance=True, include_type=True, exclude_readonly=True)`

Standard form for selecting parameters from given element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `src_element` | `Element` | source element | _required_ |
| `title` | `str` | list window title | `'Select Parameters'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `include_instance` | `bool` | list instance parameters | `True` |
| `include_type` | `bool` | list type parameters | `True` |
| `exclude_readonly` | `bool` | only shows parameters that are editable | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[ParamDef]` | list of paramdef objects |

Examples:

```md-code__content
forms.select_parameter(
    src_element,
    title='Select Parameters',
    multiple=True,
    include_instance=True,
    include_type=True
)
[<ParamDef >, <ParamDef >]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2636<br>2637<br>2638<br>2639<br>2640<br>2641<br>2642<br>2643<br>2644<br>2645<br>2646<br>2647<br>2648<br>2649<br>2650<br>2651<br>2652<br>2653<br>2654<br>2655<br>2656<br>2657<br>2658<br>2659<br>2660<br>2661<br>2662<br>2663<br>2664<br>2665<br>2666<br>2667<br>2668<br>2669<br>2670<br>2671<br>2672<br>2673<br>2674<br>2675<br>2676<br>2677<br>2678<br>2679<br>2680<br>2681<br>2682<br>2683<br>2684<br>2685<br>2686<br>2687<br>2688<br>2689<br>2690<br>2691<br>2692<br>2693<br>2694<br>2695<br>2696<br>2697<br>2698<br>2699<br>2700<br>2701<br>2702<br>2703<br>2704<br>2705<br>2706<br>2707<br>2708<br>2709<br>2710<br>2711<br>2712<br>2713<br>2714<br>2715<br>2716<br>2717<br>2718<br>2719<br>``` | ````md-code__content<br>def select_parameters(src_element,<br>                      title='Select Parameters',<br>                      button_name='Select',<br>                      multiple=True,<br>                      filterfunc=None,<br>                      include_instance=True,<br>                      include_type=True,<br>                      exclude_readonly=True):<br>    """Standard form for selecting parameters from given element.<br>    Args:<br>        src_element (DB.Element): source element<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        include_instance (bool, optional): list instance parameters<br>        include_type (bool, optional): list type parameters<br>        exclude_readonly (bool, optional): only shows parameters that are editable<br>    Returns:<br>        (list[ParamDef]): list of paramdef objects<br>    Examples:<br>        ```python<br>        forms.select_parameter(<br>            src_element,<br>            title='Select Parameters',<br>            multiple=True,<br>            include_instance=True,<br>            include_type=True<br>        )<br>        [<ParamDef >, <ParamDef >]<br>        ```<br>    """<br>    param_defs = []<br>    non_storage_type = coreutils.get_enum_none(DB.StorageType)<br>    if include_instance:<br>        # collect instance parameters<br>        param_defs.extend(<br>            [ParamDef(name=x.Definition.Name,<br>                      istype=False,<br>                      definition=x.Definition,<br>                      isreadonly=x.IsReadOnly)<br>             for x in src_element.Parameters<br>             if x.StorageType != non_storage_type]<br>        )<br>    if include_type:<br>        # collect type parameters<br>        src_type = revit.query.get_type(src_element) if src_element else None<br>        if src_type is not None:<br>            param_defs.extend(<br>                [ParamDef(name=x.Definition.Name,<br>                          istype=True,<br>                          definition=x.Definition,<br>                          isreadonly=x.IsReadOnly)<br>                 for x in src_type.Parameters<br>                 if x.StorageType != non_storage_type]<br>            )<br>    if exclude_readonly:<br>        param_defs = filter(lambda x: not x.isreadonly, param_defs)<br>    if filterfunc:<br>        param_defs = filter(filterfunc, param_defs)<br>    param_defs.sort(key=lambda x: x.name)<br>    itemplate = utils.load_ctrl_template(<br>        os.path.join(XAML_FILES_DIR, "ParameterItemStyle.xaml")<br>        )<br>    selected_params = SelectFromList.show(<br>        param_defs,<br>        title=title,<br>        button_name=button_name,<br>        width=450,<br>        multiselect=multiple,<br>        item_template=itemplate<br>        )<br>    return selected_params<br>```` |

### `select_family_parameters(family_doc, title='Select Parameters', button_name='Select', multiple=True, filterfunc=None, include_instance=True, include_type=True, include_builtin=True, include_labeled=True)`

Standard form for selecting parameters from given family document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `family_doc` | `Document` | source family document | _required_ |
| `title` | `str` | list window title | `'Select Parameters'` |
| `button_name` | `str` | list window button caption | `'Select'` |
| `multiple` | `bool` | allow multi-selection (uses check boxes). defaults to True | `True` |
| `filterfunc` | `function` | filter function to be applied to context items. | `None` |
| `include_instance` | `bool` | list instance parameters | `True` |
| `include_type` | `bool` | list type parameters | `True` |
| `include_builtin` | `bool` | list builtin parameters | `True` |
| `include_labeled` | `bool` | list parameters used as labels | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[FamilyParameter]` | list of family parameter objects |

Examples:

```md-code__content
forms.select_family_parameters(
    family_doc,
    title='Select Parameters',
    multiple=True,
    include_instance=True,
    include_type=True
)
[<DB.FamilyParameter >, <DB.FamilyParameter >]

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2722<br>2723<br>2724<br>2725<br>2726<br>2727<br>2728<br>2729<br>2730<br>2731<br>2732<br>2733<br>2734<br>2735<br>2736<br>2737<br>2738<br>2739<br>2740<br>2741<br>2742<br>2743<br>2744<br>2745<br>2746<br>2747<br>2748<br>2749<br>2750<br>2751<br>2752<br>2753<br>2754<br>2755<br>2756<br>2757<br>2758<br>2759<br>2760<br>2761<br>2762<br>2763<br>2764<br>2765<br>2766<br>2767<br>2768<br>2769<br>2770<br>2771<br>2772<br>2773<br>2774<br>2775<br>2776<br>2777<br>2778<br>2779<br>2780<br>2781<br>2782<br>2783<br>2784<br>2785<br>2786<br>2787<br>2788<br>2789<br>2790<br>2791<br>2792<br>2793<br>2794<br>2795<br>2796<br>2797<br>2798<br>2799<br>2800<br>2801<br>2802<br>2803<br>2804<br>2805<br>2806<br>2807<br>2808<br>``` | ````md-code__content<br>def select_family_parameters(family_doc,<br>                             title='Select Parameters',<br>                             button_name='Select',<br>                             multiple=True,<br>                             filterfunc=None,<br>                             include_instance=True,<br>                             include_type=True,<br>                             include_builtin=True,<br>                             include_labeled=True):<br>    """Standard form for selecting parameters from given family document.<br>    Args:<br>        family_doc (DB.Document): source family document<br>        title (str, optional): list window title<br>        button_name (str, optional): list window button caption<br>        multiple (bool, optional):<br>            allow multi-selection (uses check boxes). defaults to True<br>        filterfunc (function):<br>            filter function to be applied to context items.<br>        include_instance (bool, optional): list instance parameters<br>        include_type (bool, optional): list type parameters<br>        include_builtin (bool, optional): list builtin parameters<br>        include_labeled (bool, optional): list parameters used as labels<br>    Returns:<br>        (list[DB.FamilyParameter]): list of family parameter objects<br>    Examples:<br>        ```python<br>        forms.select_family_parameters(<br>            family_doc,<br>            title='Select Parameters',<br>            multiple=True,<br>            include_instance=True,<br>            include_type=True<br>        )<br>        [<DB.FamilyParameter >, <DB.FamilyParameter >]<br>        ```<br>    """<br>    family_doc = family_doc or DOCS.doc<br>    family_params = revit.query.get_family_parameters(family_doc)<br>    # get all params used in labeles<br>    label_param_ids = \<br>        [x.Id for x in revit.query.get_family_label_parameters(family_doc)]<br>    if filterfunc:<br>        family_params = filter(filterfunc, family_params)<br>    param_defs = []<br>    get_elementid_value = get_elementid_value_func()<br>    for family_param in family_params:<br>        if not include_instance and family_param.IsInstance:<br>            continue<br>        if not include_type and not family_param.IsInstance:<br>            continue<br>        if not include_builtin and get_elementid_value(family_param.Id) < 0:<br>            continue<br>        if not include_labeled and family_param.Id in label_param_ids:<br>            continue<br>        param_defs.append(<br>            FamilyParamOption(family_param,<br>                              builtin=get_elementid_value(family_param.Id) < 0,<br>                              labeled=family_param.Id in label_param_ids)<br>            )<br>    param_defs.sort(key=lambda x: x.name)<br>    itemplate = utils.load_ctrl_template(<br>        os.path.join(XAML_FILES_DIR, "FamilyParameterItemStyle.xaml")<br>        )<br>    selected_params = SelectFromList.show(<br>        {<br>            'All Parameters': param_defs,<br>            'Type Parameters': [x for x in param_defs if x.istype],<br>            'Built-in Parameters': [x for x in param_defs if x.isbuiltin],<br>            'Used as Label': [x for x in param_defs if x.islabeled],<br>        },<br>        title=title,<br>        button_name=button_name,<br>        group_selector_title='Parameter Filters:',<br>        width=450,<br>        multiselect=multiple,<br>        item_template=itemplate<br>        )<br>    return selected_params<br>```` |

### `alert(msg, title=None, sub_msg=None, expanded=None, footer='', ok=True, cancel=False, yes=False, no=False, retry=False, warn_icon=True, options=None, exitscript=False)`

Show a task dialog with given message.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `msg` | `str` | message to be displayed | _required_ |
| `title` | `str` | task dialog title | `None` |
| `sub_msg` | `str` | sub message, use html to create clickable links | `None` |
| `expanded` | `str` | expanded area message | `None` |
| `footer` | `str` | footer text | `''` |
| `ok` | `bool` | show OK button, defaults to True | `True` |
| `cancel` | `bool` | show Cancel button, defaults to False | `False` |
| `yes` | `bool` | show Yes button, defaults to False | `False` |
| `no` | `bool` | show NO button, defaults to False | `False` |
| `retry` | `bool` | show Retry button, defaults to False | `False` |
| `warn_icon` | `bool` | show warning icon | `True` |
| `options` | `list[str]` | list of command link titles in order | `None` |
| `exitscript` | `bool` | exit if cancel or no, defaults to False | `False` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if okay, yes, or retry, otherwise False |

Examples:

```md-code__content
from pyrevit import forms
forms.alert('Are you sure?',
            sub_msg='<a href=\"https://discourse.pyrevitlabs.io/ \">Click here if you are not sure and want to go to the pyRevit Forum</a>',
            ok=False, yes=True, no=True, exitscript=True)

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2811<br>2812<br>2813<br>2814<br>2815<br>2816<br>2817<br>2818<br>2819<br>2820<br>2821<br>2822<br>2823<br>2824<br>2825<br>2826<br>2827<br>2828<br>2829<br>2830<br>2831<br>2832<br>2833<br>2834<br>2835<br>2836<br>2837<br>2838<br>2839<br>2840<br>2841<br>2842<br>2843<br>2844<br>2845<br>2846<br>2847<br>2848<br>2849<br>2850<br>2851<br>2852<br>2853<br>2854<br>2855<br>2856<br>2857<br>2858<br>2859<br>2860<br>2861<br>2862<br>2863<br>2864<br>2865<br>2866<br>2867<br>2868<br>2869<br>2870<br>2871<br>2872<br>2873<br>2874<br>2875<br>2876<br>2877<br>2878<br>2879<br>2880<br>2881<br>2882<br>2883<br>2884<br>2885<br>2886<br>2887<br>2888<br>2889<br>2890<br>2891<br>2892<br>2893<br>2894<br>2895<br>2896<br>2897<br>2898<br>2899<br>2900<br>2901<br>2902<br>2903<br>2904<br>2905<br>2906<br>2907<br>2908<br>2909<br>2910<br>2911<br>2912<br>2913<br>2914<br>2915<br>2916<br>2917<br>2918<br>2919<br>2920<br>2921<br>2922<br>2923<br>2924<br>2925<br>``` | ````md-code__content<br>def alert(msg, title=None, sub_msg=None, expanded=None, footer='',<br>          ok=True, cancel=False, yes=False, no=False, retry=False,<br>          warn_icon=True, options=None, exitscript=False):<br>    r"""Show a task dialog with given message.<br>    Args:<br>        msg (str): message to be displayed<br>        title (str, optional): task dialog title<br>        sub_msg (str, optional): sub message, use html to create clickable links<br>        expanded (str, optional): expanded area message<br>        footer (str, optional): footer text<br>        ok (bool, optional): show OK button, defaults to True<br>        cancel (bool, optional): show Cancel button, defaults to False<br>        yes (bool, optional): show Yes button, defaults to False<br>        no (bool, optional): show NO button, defaults to False<br>        retry (bool, optional): show Retry button, defaults to False<br>        warn_icon (bool, optional): show warning icon<br>        options (list[str], optional): list of command link titles in order<br>        exitscript (bool, optional): exit if cancel or no, defaults to False<br>    Returns:<br>        (bool): True if okay, yes, or retry, otherwise False<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.alert('Are you sure?',<br>                    sub_msg='<a href=\"https://discourse.pyrevitlabs.io/ \">Click here if you are not sure and want to go to the pyRevit Forum</a>',<br>                    ok=False, yes=True, no=True, exitscript=True)<br>        ```<br>    """<br>    # BUILD DIALOG<br>    cmd_name = EXEC_PARAMS.command_name<br>    if not title:<br>        title = cmd_name if cmd_name else 'pyRevit'<br>    tdlg = UI.TaskDialog(title)<br>    # process input types<br>    just_ok = ok and not any([cancel, yes, no, retry])<br>    options = options or []<br>    # add command links if any<br>    if options:<br>        clinks = coreutils.get_enum_values(UI.TaskDialogCommandLinkId)<br>        max_clinks = len(clinks)<br>        for idx, cmd in enumerate(options):<br>            if idx < max_clinks:<br>                tdlg.AddCommandLink(clinks[idx], cmd)<br>    # otherwise add buttons<br>    else:<br>        buttons = coreutils.get_enum_none(UI.TaskDialogCommonButtons)<br>        if yes:<br>            buttons |= UI.TaskDialogCommonButtons.Yes<br>        elif ok:<br>            buttons |= UI.TaskDialogCommonButtons.Ok<br>        if cancel:<br>            buttons |= UI.TaskDialogCommonButtons.Cancel<br>        if no:<br>            buttons |= UI.TaskDialogCommonButtons.No<br>        if retry:<br>            buttons |= UI.TaskDialogCommonButtons.Retry<br>        tdlg.CommonButtons = buttons<br>    # set texts<br>    tdlg.MainInstruction = msg<br>    tdlg.MainContent = sub_msg<br>    tdlg.ExpandedContent = expanded<br>    if footer:<br>        footer = footer.strip() + '\n'<br>    tdlg.FooterText = footer + 'pyRevit {}'.format(<br>        versionmgr.get_pyrevit_version().get_formatted()<br>        )<br>    tdlg.TitleAutoPrefix = False<br>    # set icon<br>    tdlg.MainIcon = \<br>        UI.TaskDialogIcon.TaskDialogIconWarning \<br>        if warn_icon else UI.TaskDialogIcon.TaskDialogIconNone<br>    # tdlg.VerificationText = 'verif'<br>    # SHOW DIALOG<br>    res = tdlg.Show()<br>    # PROCESS REPONSES<br>    # positive response<br>    mlogger.debug('alert result: %s', res)<br>    if res == UI.TaskDialogResult.Ok \<br>            or res == UI.TaskDialogResult.Yes \<br>            or res == UI.TaskDialogResult.Retry:<br>        if just_ok and exitscript:<br>            sys.exit()<br>        return True<br>    # negative response<br>    elif res == coreutils.get_enum_none(UI.TaskDialogResult) \<br>            or res == UI.TaskDialogResult.Cancel \<br>            or res == UI.TaskDialogResult.No:<br>        if exitscript:<br>            sys.exit()<br>        else:<br>            return False<br>    # command link response<br>    elif 'CommandLink' in str(res):<br>        tdresults = sorted(<br>            [x for x in coreutils.get_enum_values(UI.TaskDialogResult)<br>             if 'CommandLink' in str(x)]<br>            )<br>        residx = tdresults.index(res)<br>        return options[residx]<br>    elif exitscript:<br>        sys.exit()<br>    else:<br>        return False<br>```` |

### `alert_ifnot(condition, msg, *args, **kwargs)`

Show a task dialog with given message if condition is NOT met.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `condition` | `bool` | condition to test | _required_ |
| `msg` | `str` | message to be displayed | _required_ |
| `*args` | `Any` | additional arguments | `()` |
| `**kwargs` | `Any` | additional keyword arguments | `{}` |

Other Parameters:

| Name | Type | Description |
| --- | --- | --- |
| `title` | `str` | task dialog title |
| `ok` | `bool` | show OK button, defaults to True |
| `cancel` | `bool` | show Cancel button, defaults to False |
| `yes` | `bool` | show Yes button, defaults to False |
| `no` | `bool` | show NO button, defaults to False |
| `retry` | `bool` | show Retry button, defaults to False |
| `exitscript` | `bool` | exit if cancel or no, defaults to False |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if okay, yes, or retry, otherwise False |

Examples:

```md-code__content
from pyrevit import forms
forms.alert_ifnot(value > 12,
                  'Are you sure?',
                   ok=False, yes=True, no=True, exitscript=True)

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2928<br>2929<br>2930<br>2931<br>2932<br>2933<br>2934<br>2935<br>2936<br>2937<br>2938<br>2939<br>2940<br>2941<br>2942<br>2943<br>2944<br>2945<br>2946<br>2947<br>2948<br>2949<br>2950<br>2951<br>2952<br>2953<br>2954<br>2955<br>2956<br>2957<br>2958<br>``` | ````md-code__content<br>def alert_ifnot(condition, msg, *args, **kwargs):<br>    """Show a task dialog with given message if condition is NOT met.<br>    Args:<br>        condition (bool): condition to test<br>        msg (str): message to be displayed<br>        *args (Any): additional arguments<br>        **kwargs (Any): additional keyword arguments<br>    Keyword Args:<br>        title (str, optional): task dialog title<br>        ok (bool, optional): show OK button, defaults to True<br>        cancel (bool, optional): show Cancel button, defaults to False<br>        yes (bool, optional): show Yes button, defaults to False<br>        no (bool, optional): show NO button, defaults to False<br>        retry (bool, optional): show Retry button, defaults to False<br>        exitscript (bool, optional): exit if cancel or no, defaults to False<br>    Returns:<br>        (bool): True if okay, yes, or retry, otherwise False<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.alert_ifnot(value > 12,<br>                          'Are you sure?',<br>                           ok=False, yes=True, no=True, exitscript=True)<br>        ```<br>    """<br>    if not condition:<br>        return alert(msg, *args, **kwargs)<br>```` |

### `pick_folder(title=None, owner=None)`

Show standard windows pick folder dialog.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | title for the window | `None` |
| `owner` | `object` | owner of the dialog | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str` | folder path |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2961<br>2962<br>2963<br>2964<br>2965<br>2966<br>2967<br>2968<br>2969<br>2970<br>2971<br>2972<br>2973<br>2974<br>2975<br>2976<br>2977<br>2978<br>2979<br>2980<br>2981<br>2982<br>2983<br>2984<br>2985<br>2986<br>2987<br>2988<br>2989<br>2990<br>``` | ```md-code__content<br>def pick_folder(title=None, owner=None):<br>    """Show standard windows pick folder dialog.<br>    Args:<br>        title (str, optional): title for the window<br>        owner (object, optional): owner of the dialog<br>    Returns:<br>        (str): folder path<br>    """<br>    if CPDialogs:<br>        fb_dlg = CPDialogs.CommonOpenFileDialog()<br>        fb_dlg.IsFolderPicker = True<br>        if title:<br>            fb_dlg.Title = title<br>        res = CPDialogs.CommonFileDialogResult.Cancel<br>        if owner:<br>            res = fb_dlg.ShowDialog(owner)<br>        else:<br>            res = fb_dlg.ShowDialog()<br>        if res == CPDialogs.CommonFileDialogResult.Ok:<br>            return fb_dlg.FileName<br>    else:<br>        fb_dlg = Forms.FolderBrowserDialog()<br>        if title:<br>            fb_dlg.Description = title<br>        if fb_dlg.ShowDialog() == Forms.DialogResult.OK:<br>            return fb_dlg.SelectedPath<br>``` |

### `result_item_result_clicked(sender, e, debug=False)`

Callback for a result item click event.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>2993<br>2994<br>2995<br>2996<br>2997<br>``` | ```md-code__content<br>def result_item_result_clicked(sender, e, debug=False):<br>    """Callback for a result item click event."""<br>    if debug:<br>        print("Result clicked")  # using print_md here will break the script<br>    pass<br>``` |

### `show_balloon(header, text, tooltip='', group='', is_favourite=False, is_new=False, timestamp=None, click_result=result_item_result_clicked)`

Show ballon in the info center section.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `header` | `str` | Category section (Bold) | _required_ |
| `text` | `str` | Title section (Regular) | _required_ |
| `tooltip` | `str` | Tooltip | `''` |
| `group` | `str` | Group | `''` |
| `is_favourite` | `bool` | Add a blue star before header | `False` |
| `is_new` | `bool` | Flag to new | `False` |
| `timestamp` | `str` | Set timestamp | `None` |
| `click_result` | `def` | Executed after a click event | `result_item_result_clicked` |

Examples:

```md-code__content
from pyrevit import forms
date = '2019-01-01 00:00:00'
date = datetime.datetime.strptime(date, '%Y-%m-%d %H:%M:%S')
forms.show_balloon("my header", "Lorem ipsum", tooltip='tooltip',   group='group', is_favourite=True, is_new=True, timestamp = date, click_result = forms.result_item_result_clicked)

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3000<br>3001<br>3002<br>3003<br>3004<br>3005<br>3006<br>3007<br>3008<br>3009<br>3010<br>3011<br>3012<br>3013<br>3014<br>3015<br>3016<br>3017<br>3018<br>3019<br>3020<br>3021<br>3022<br>3023<br>3024<br>3025<br>3026<br>3027<br>3028<br>3029<br>3030<br>3031<br>3032<br>3033<br>``` | ````md-code__content<br>def show_balloon(header, text, tooltip='', group='', is_favourite=False, is_new=False, timestamp=None, click_result=result_item_result_clicked):<br>    r"""Show ballon in the info center section.<br>    Args:<br>        header (str): Category section (Bold)<br>        text (str): Title section (Regular)<br>        tooltip (str): Tooltip<br>        group (str): Group<br>        is_favourite (bool): Add a blue star before header<br>        is_new (bool): Flag to new<br>        timestamp (str): Set timestamp<br>        click_result (def): Executed after a click event<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        date = '2019-01-01 00:00:00'<br>        date = datetime.datetime.strptime(date, '%Y-%m-%d %H:%M:%S')<br>        forms.show_balloon("my header", "Lorem ipsum", tooltip='tooltip',   group='group', is_favourite=True, is_new=True, timestamp = date, click_result = forms.result_item_result_clicked)<br>        ```<br>    """<br>    result_item = Autodesk.Internal.InfoCenter.ResultItem()<br>    result_item.Category = header<br>    result_item.Title = text<br>    result_item.TooltipText = tooltip<br>    result_item.Group = group<br>    result_item.IsFavorite = is_favourite<br>    result_item.IsNew = is_new<br>    if timestamp:<br>        result_item.Timestamp = timestamp<br>    result_item.ResultClicked += click_result<br>    balloon = Autodesk.Windows.ComponentManager.InfoCenterPaletteManager.ShowBalloon(<br>        result_item)<br>    return balloon<br>```` |

### `pick_file(file_ext='*', files_filter='', init_dir='', restore_dir=True, multi_file=False, unc_paths=False, title=None)`

Pick file dialog to select a destination file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_ext` | `str` | file extension | `'*'` |
| `files_filter` | `str` | file filter | `''` |
| `init_dir` | `str` | initial directory | `''` |
| `restore_dir` | `bool` | restore last directory | `True` |
| `multi_file` | `bool` | allow select multiple files | `False` |
| `unc_paths` | `bool` | return unc paths | `False` |
| `title` | `str` | text to show in the title bar | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str | list[str]` | file path or list of file paths if multi\_file=True |

Examples:

```md-code__content
from pyrevit import forms
forms.pick_file(file_ext='csv')
r'C:\output\somefile.csv'

```

```md-code__content
forms.pick_file(file_ext='csv', multi_file=True)
[r'C:\output\somefile1.csv', r'C:\output\somefile2.csv']

```

```md-code__content
forms.pick_file(files_filter='All Files (*.*)|*.*|'
                                 'Excel Workbook (*.xlsx)|*.xlsx|'
                                 'Excel 97-2003 Workbook|*.xls',
                    multi_file=True)
[r'C:\output\somefile1.xlsx', r'C:\output\somefile2.xls']

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3036<br>3037<br>3038<br>3039<br>3040<br>3041<br>3042<br>3043<br>3044<br>3045<br>3046<br>3047<br>3048<br>3049<br>3050<br>3051<br>3052<br>3053<br>3054<br>3055<br>3056<br>3057<br>3058<br>3059<br>3060<br>3061<br>3062<br>3063<br>3064<br>3065<br>3066<br>3067<br>3068<br>3069<br>3070<br>3071<br>3072<br>3073<br>3074<br>3075<br>3076<br>3077<br>3078<br>3079<br>3080<br>3081<br>3082<br>3083<br>3084<br>3085<br>3086<br>3087<br>3088<br>3089<br>3090<br>3091<br>3092<br>``` | ````md-code__content<br>def pick_file(file_ext='*', files_filter='', init_dir='',<br>              restore_dir=True, multi_file=False, unc_paths=False, title=None):<br>    r"""Pick file dialog to select a destination file.<br>    Args:<br>        file_ext (str): file extension<br>        files_filter (str): file filter<br>        init_dir (str): initial directory<br>        restore_dir (bool): restore last directory<br>        multi_file (bool): allow select multiple files<br>        unc_paths (bool): return unc paths<br>        title (str): text to show in the title bar<br>    Returns:<br>        (str | list[str]): file path or list of file paths if multi_file=True<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.pick_file(file_ext='csv')<br>        r'C:\output\somefile.csv'<br>        ```<br>        ```python<br>        forms.pick_file(file_ext='csv', multi_file=True)<br>        [r'C:\output\somefile1.csv', r'C:\output\somefile2.csv']<br>        ```<br>        ```python<br>        forms.pick_file(files_filter='All Files (*.*)|*.*|'<br>                                         'Excel Workbook (*.xlsx)|*.xlsx|'<br>                                         'Excel 97-2003 Workbook|*.xls',<br>                            multi_file=True)<br>        [r'C:\output\somefile1.xlsx', r'C:\output\somefile2.xls']<br>        ```<br>    """<br>    of_dlg = Forms.OpenFileDialog()<br>    if files_filter:<br>        of_dlg.Filter = files_filter<br>    else:<br>        of_dlg.Filter = '|*.{}'.format(file_ext)<br>    of_dlg.RestoreDirectory = restore_dir<br>    of_dlg.Multiselect = multi_file<br>    if init_dir:<br>        of_dlg.InitialDirectory = init_dir<br>    if title:<br>        of_dlg.Title = title<br>    if of_dlg.ShowDialog() == Forms.DialogResult.OK:<br>        if multi_file:<br>            if unc_paths:<br>                return [coreutils.dletter_to_unc(x)<br>                        for x in of_dlg.FileNames]<br>            return of_dlg.FileNames<br>        else:<br>            if unc_paths:<br>                return coreutils.dletter_to_unc(of_dlg.FileName)<br>            return of_dlg.FileName<br>```` |

### `save_file(file_ext='', files_filter='', init_dir='', default_name='', restore_dir=True, unc_paths=False, title=None)`

Save file dialog to select a destination file for data.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_ext` | `str` | file extension | `''` |
| `files_filter` | `str` | file filter | `''` |
| `init_dir` | `str` | initial directory | `''` |
| `default_name` | `str` | default file name | `''` |
| `restore_dir` | `bool` | restore last directory | `True` |
| `unc_paths` | `bool` | return unc paths | `False` |
| `title` | `str` | text to show in the title bar | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str` | file path |

Examples:

```md-code__content
from pyrevit import forms
forms.save_file(file_ext='csv')
r'C:\output\somefile.csv'

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3095<br>3096<br>3097<br>3098<br>3099<br>3100<br>3101<br>3102<br>3103<br>3104<br>3105<br>3106<br>3107<br>3108<br>3109<br>3110<br>3111<br>3112<br>3113<br>3114<br>3115<br>3116<br>3117<br>3118<br>3119<br>3120<br>3121<br>3122<br>3123<br>3124<br>3125<br>3126<br>3127<br>3128<br>3129<br>3130<br>3131<br>3132<br>3133<br>3134<br>3135<br>``` | ````md-code__content<br>def save_file(file_ext='', files_filter='', init_dir='', default_name='',<br>              restore_dir=True, unc_paths=False, title=None):<br>    r"""Save file dialog to select a destination file for data.<br>    Args:<br>        file_ext (str): file extension<br>        files_filter (str): file filter<br>        init_dir (str): initial directory<br>        default_name (str): default file name<br>        restore_dir (bool): restore last directory<br>        unc_paths (bool): return unc paths<br>        title (str): text to show in the title bar<br>    Returns:<br>        (str): file path<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.save_file(file_ext='csv')<br>        r'C:\output\somefile.csv'<br>        ```<br>    """<br>    sf_dlg = Forms.SaveFileDialog()<br>    if files_filter:<br>        sf_dlg.Filter = files_filter<br>    else:<br>        sf_dlg.Filter = '|*.{}'.format(file_ext)<br>    sf_dlg.RestoreDirectory = restore_dir<br>    if init_dir:<br>        sf_dlg.InitialDirectory = init_dir<br>    if title:<br>        sf_dlg.Title = title<br>    # setting default filename<br>    sf_dlg.FileName = default_name<br>    if sf_dlg.ShowDialog() == Forms.DialogResult.OK:<br>        if unc_paths:<br>            return coreutils.dletter_to_unc(sf_dlg.FileName)<br>        return sf_dlg.FileName<br>```` |

### `pick_excel_file(save=False, title=None)`

File pick/save dialog for an excel file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `save` | `bool` | show file save dialog, instead of file pick dialog | `False` |
| `title` | `str` | text to show in the title bar | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str` | file path |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3138<br>3139<br>3140<br>3141<br>3142<br>3143<br>3144<br>3145<br>3146<br>3147<br>3148<br>3149<br>3150<br>3151<br>3152<br>``` | ```md-code__content<br>def pick_excel_file(save=False, title=None):<br>    """File pick/save dialog for an excel file.<br>    Args:<br>        save (bool): show file save dialog, instead of file pick dialog<br>        title (str): text to show in the title bar<br>    Returns:<br>        (str): file path<br>    """<br>    if save:<br>        return save_file(file_ext='xlsx')<br>    return pick_file(files_filter='Excel Workbook (*.xlsx)|*.xlsx|'<br>                                  'Excel 97-2003 Workbook|*.xls',<br>                     title=title)<br>``` |

### `save_excel_file(title=None)`

File save dialog for an excel file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `title` | `str` | text to show in the title bar | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str` | file path |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3155<br>3156<br>3157<br>3158<br>3159<br>3160<br>3161<br>3162<br>3163<br>3164<br>``` | ```md-code__content<br>def save_excel_file(title=None):<br>    """File save dialog for an excel file.<br>    Args:<br>        title (str): text to show in the title bar<br>    Returns:<br>        (str): file path<br>    """<br>    return pick_excel_file(save=True, title=title)<br>``` |

### `check_workshared(doc=None, message='Model is not workshared.')`

Verify if model is workshared and notify user if not.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | target document, current of not provided | `None` |
| `message` | `str` | prompt message if returning False | `'Model is not workshared.'` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if doc is workshared |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3167<br>3168<br>3169<br>3170<br>3171<br>3172<br>3173<br>3174<br>3175<br>3176<br>3177<br>3178<br>3179<br>3180<br>3181<br>``` | ```md-code__content<br>def check_workshared(doc=None, message='Model is not workshared.'):<br>    """Verify if model is workshared and notify user if not.<br>    Args:<br>        doc (DB.Document): target document, current of not provided<br>        message (str): prompt message if returning False<br>    Returns:<br>        (bool): True if doc is workshared<br>    """<br>    doc = doc or DOCS.doc<br>    if not doc.IsWorkshared:<br>        alert(message, warn_icon=True)<br>        return False<br>    return True<br>``` |

### `check_selection(exitscript=False, message='At least one element must be selected.')`

Verify if selection is not empty notify user if it is.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `exitscript` | `bool` | exit script if returning False | `False` |
| `message` | `str` | prompt message if returning False | `'At least one element must be selected.'` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if selection has at least one item |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3184<br>3185<br>3186<br>3187<br>3188<br>3189<br>3190<br>3191<br>3192<br>3193<br>3194<br>3195<br>3196<br>3197<br>3198<br>``` | ```md-code__content<br>def check_selection(exitscript=False,<br>                    message='At least one element must be selected.'):<br>    """Verify if selection is not empty notify user if it is.<br>    Args:<br>        exitscript (bool): exit script if returning False<br>        message (str): prompt message if returning False<br>    Returns:<br>        (bool): True if selection has at least one item<br>    """<br>    if revit.get_selection().is_empty:<br>        alert(message, exitscript=exitscript)<br>        return False<br>    return True<br>``` |

### `check_familydoc(doc=None, family_cat=None, exitscript=False)`

Verify document is a Family and notify user if not.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | target document, current of not provided | `None` |
| `family_cat` | `str` | family category name | `None` |
| `exitscript` | `bool` | exit script if returning False | `False` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if doc is a Family and of provided category |

Examples:

```md-code__content
from pyrevit import forms
forms.check_familydoc(doc=revit.doc, family_cat='Data Devices')
True

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3201<br>3202<br>3203<br>3204<br>3205<br>3206<br>3207<br>3208<br>3209<br>3210<br>3211<br>3212<br>3213<br>3214<br>3215<br>3216<br>3217<br>3218<br>3219<br>3220<br>3221<br>3222<br>3223<br>3224<br>3225<br>3226<br>3227<br>3228<br>3229<br>3230<br>3231<br>``` | ````md-code__content<br>def check_familydoc(doc=None, family_cat=None, exitscript=False):<br>    """Verify document is a Family and notify user if not.<br>    Args:<br>        doc (DB.Document): target document, current of not provided<br>        family_cat (str): family category name<br>        exitscript (bool): exit script if returning False<br>    Returns:<br>        (bool): True if doc is a Family and of provided category<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.check_familydoc(doc=revit.doc, family_cat='Data Devices')<br>        True<br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    family_cat = revit.query.get_category(family_cat)<br>    if doc.IsFamilyDocument and family_cat:<br>        if doc.OwnerFamily.FamilyCategory.Id == family_cat.Id:<br>            return True<br>    elif doc.IsFamilyDocument and not family_cat:<br>        return True<br>    family_type_msg = ' of type {}'\<br>                      .format(family_cat.Name) if family_cat else''<br>    alert('Active document must be a Family document{}.'<br>          .format(family_type_msg), exitscript=exitscript)<br>    return False<br>```` |

### `check_modeldoc(doc=None, exitscript=False)`

Verify document is a not a Model and notify user if not.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | target document, current of not provided | `None` |
| `exitscript` | `bool` | exit script if returning False | `False` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if doc is a Model |

Examples:

```md-code__content
from pyrevit import forms
forms.check_modeldoc(doc=revit.doc)
True

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3234<br>3235<br>3236<br>3237<br>3238<br>3239<br>3240<br>3241<br>3242<br>3243<br>3244<br>3245<br>3246<br>3247<br>3248<br>3249<br>3250<br>3251<br>3252<br>3253<br>3254<br>3255<br>3256<br>3257<br>``` | ````md-code__content<br>def check_modeldoc(doc=None, exitscript=False):<br>    """Verify document is a not a Model and notify user if not.<br>    Args:<br>        doc (DB.Document): target document, current of not provided<br>        exitscript (bool): exit script if returning False<br>    Returns:<br>        (bool): True if doc is a Model<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.check_modeldoc(doc=revit.doc)<br>        True<br>        ```<br>    """<br>    doc = doc or DOCS.doc<br>    if not doc.IsFamilyDocument:<br>        return True<br>    alert('Active document must be a Revit model (not a Family).',<br>          exitscript=exitscript)<br>    return False<br>```` |

### `check_modelview(view, exitscript=False)`

Verify target view is a model view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | target view | _required_ |
| `exitscript` | `bool` | exit script if returning False | `False` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if view is model view |

Examples:

```md-code__content
from pyrevit import forms
forms.check_modelview(view=revit.active_view)
True

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3260<br>3261<br>3262<br>3263<br>3264<br>3265<br>3266<br>3267<br>3268<br>3269<br>3270<br>3271<br>3272<br>3273<br>3274<br>3275<br>3276<br>3277<br>3278<br>3279<br>3280<br>``` | ````md-code__content<br>def check_modelview(view, exitscript=False):<br>    """Verify target view is a model view.<br>    Args:<br>        view (DB.View): target view<br>        exitscript (bool): exit script if returning False<br>    Returns:<br>        (bool): True if view is model view<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.check_modelview(view=revit.active_view)<br>        True<br>        ```<br>    """<br>    if not isinstance(view, (DB.View3D, DB.ViewPlan, DB.ViewSection)):<br>        alert("Active view must be a model view.", exitscript=exitscript)<br>        return False<br>    return True<br>```` |

### `check_viewtype(view, view_type, exitscript=False)`

Verify target view is of given type.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | target view | _required_ |
| `view_type` | `ViewType` | type of view | _required_ |
| `exitscript` | `bool` | exit script if returning False | `False` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if view is of given type |

Examples:

```md-code__content
from pyrevit import forms
forms.check_viewtype(revit.active_view, DB.ViewType.DrawingSheet)
True

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3283<br>3284<br>3285<br>3286<br>3287<br>3288<br>3289<br>3290<br>3291<br>3292<br>3293<br>3294<br>3295<br>3296<br>3297<br>3298<br>3299<br>3300<br>3301<br>3302<br>3303<br>3304<br>3305<br>3306<br>3307<br>3308<br>``` | ````md-code__content<br>def check_viewtype(view, view_type, exitscript=False):<br>    """Verify target view is of given type.<br>    Args:<br>        view (DB.View): target view<br>        view_type (DB.ViewType): type of view<br>        exitscript (bool): exit script if returning False<br>    Returns:<br>        (bool): True if view is of given type<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.check_viewtype(revit.active_view, DB.ViewType.DrawingSheet)<br>        True<br>        ```<br>    """<br>    if view.ViewType != view_type:<br>        alert(<br>            "Active view must be a {}.".format(<br>                ' '.join(coreutils.split_words(str(view_type)))),<br>            exitscript=exitscript<br>            )<br>        return False<br>    return True<br>```` |

### `check_graphicalview(view, exitscript=False)`

Verify target view is a graphical view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | target view | _required_ |
| `exitscript` | `bool` | exit script if returning False | `False` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if view is a graphical view |

Examples:

```md-code__content
from pyrevit import forms
forms.check_graphicalview(revit.active_view)
True

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3311<br>3312<br>3313<br>3314<br>3315<br>3316<br>3317<br>3318<br>3319<br>3320<br>3321<br>3322<br>3323<br>3324<br>3325<br>3326<br>3327<br>3328<br>3329<br>3330<br>3331<br>3332<br>3333<br>3334<br>``` | ````md-code__content<br>def check_graphicalview(view, exitscript=False):<br>    """Verify target view is a graphical view.<br>    Args:<br>        view (DB.View): target view<br>        exitscript (bool): exit script if returning False<br>    Returns:<br>        (bool): True if view is a graphical view<br>    Examples:<br>        ```python<br>        from pyrevit import forms<br>        forms.check_graphicalview(revit.active_view)<br>        True<br>        ```<br>    """<br>    if not view.Category:<br>        alert(<br>            "Active view must be a grahical view.",<br>            exitscript=exitscript<br>            )<br>        return False<br>    return True<br>```` |

### `toast(message, title='pyRevit', appid='pyRevit', icon=None, click=None, actions=None)`

Show a Windows 10 notification.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | notification message | _required_ |
| `title` | `str` | notification title | `'pyRevit'` |
| `appid` | `str` | app name (will show under message) | `'pyRevit'` |
| `icon` | `str` | file path to icon .ico file (defaults to pyRevit icon) | `None` |
| `click` | `str` | click action commands string | `None` |
| `actions` | `dict` | dictionary of button names and action strings | `None` |

Examples:

```md-code__content
script.toast("Hello World!",
             title="My Script",
             appid="MyAPP",
             click="https://pyrevitlabs.github.io/pyRevit/",
             actions={
                 "Open Google":"https://google.com",
                 "Open Toast64":"https://github.com/go-toast/toast"
                 })

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3337<br>3338<br>3339<br>3340<br>3341<br>3342<br>3343<br>3344<br>3345<br>3346<br>3347<br>3348<br>3349<br>3350<br>3351<br>3352<br>3353<br>3354<br>3355<br>3356<br>3357<br>3358<br>3359<br>3360<br>3361<br>3362<br>3363<br>3364<br>3365<br>3366<br>3367<br>``` | ````md-code__content<br>def toast(message, title='pyRevit', appid='pyRevit',<br>          icon=None, click=None, actions=None):<br>    """Show a Windows 10 notification.<br>    Args:<br>        message (str): notification message<br>        title (str): notification title<br>        appid (str): app name (will show under message)<br>        icon (str): file path to icon .ico file (defaults to pyRevit icon)<br>        click (str): click action commands string<br>        actions (dict): dictionary of button names and action strings<br>    Examples:<br>        ```python<br>        script.toast("Hello World!",<br>                     title="My Script",<br>                     appid="MyAPP",<br>                     click="https://pyrevitlabs.github.io/pyRevit/",<br>                     actions={<br>                         "Open Google":"https://google.com",<br>                         "Open Toast64":"https://github.com/go-toast/toast"<br>                         })<br>        ```<br>    """<br>    toaster.send_toast(<br>        message,<br>        title=title,<br>        appid=appid,<br>        icon=icon,<br>        click=click,<br>        actions=actions)<br>```` |

### `ask_for_string(default=None, prompt=None, title=None, **kwargs)`

Ask user to select a string value.

This is a shortcut function that configures :obj: `GetValueWindow` for
string data types. kwargs can be used to pass on other arguments.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `default` | `str` | default unique string. must not be in reserved\_values | `None` |
| `prompt` | `str` | prompt message | `None` |
| `title` | `str` | title message | `None` |
| `kwargs` | `type` | other arguments to be passed to :obj: `GetValueWindow` | `{}` |

Returns:

| Type | Description |
| --- | --- |
| `str` | selected string value |

Examples:

```md-code__content
forms.ask_for_string(
    default='some-tag',
    prompt='Enter new tag name:',
    title='Tag Manager')
'new-tag'

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3370<br>3371<br>3372<br>3373<br>3374<br>3375<br>3376<br>3377<br>3378<br>3379<br>3380<br>3381<br>3382<br>3383<br>3384<br>3385<br>3386<br>3387<br>3388<br>3389<br>3390<br>3391<br>3392<br>3393<br>3394<br>3395<br>3396<br>3397<br>3398<br>3399<br>3400<br>3401<br>``` | ````md-code__content<br>def ask_for_string(default=None, prompt=None, title=None, **kwargs):<br>    """Ask user to select a string value.<br>    This is a shortcut function that configures :obj:`GetValueWindow` for<br>    string data types. kwargs can be used to pass on other arguments.<br>    Args:<br>        default (str): default unique string. must not be in reserved_values<br>        prompt (str): prompt message<br>        title (str): title message<br>        kwargs (type): other arguments to be passed to :obj:`GetValueWindow`<br>    Returns:<br>        (str): selected string value<br>    Examples:<br>        ```python<br>        forms.ask_for_string(<br>            default='some-tag',<br>            prompt='Enter new tag name:',<br>            title='Tag Manager')<br>        'new-tag'<br>        ```<br>    """<br>    return GetValueWindow.show(<br>        None,<br>        value_type='string',<br>        default=default,<br>        prompt=prompt,<br>        title=title,<br>        **kwargs<br>        )<br>```` |

### `ask_for_unique_string(reserved_values, default=None, prompt=None, title=None, **kwargs)`

Ask user to select a unique string value.

This is a shortcut function that configures :obj: `GetValueWindow` for
unique string data types. kwargs can be used to pass on other arguments.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `reserved_values` | `list[str]` | list of reserved (forbidden) values | _required_ |
| `default` | `str` | default unique string. must not be in reserved\_values | `None` |
| `prompt` | `str` | prompt message | `None` |
| `title` | `str` | title message | `None` |
| `kwargs` | `type` | other arguments to be passed to :obj: `GetValueWindow` | `{}` |

Returns:

| Type | Description |
| --- | --- |
| `str` | selected unique string |

Examples:

```md-code__content
forms.ask_for_unique_string(
    prompt='Enter a Unique Name',
    title=self.Title,
    reserved_values=['Ehsan', 'Gui', 'Guido'],
    owner=self)
'unique string'

```

In example above, owner argument is provided to be passed to underlying
:obj: `GetValueWindow`.

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3404<br>3405<br>3406<br>3407<br>3408<br>3409<br>3410<br>3411<br>3412<br>3413<br>3414<br>3415<br>3416<br>3417<br>3418<br>3419<br>3420<br>3421<br>3422<br>3423<br>3424<br>3425<br>3426<br>3427<br>3428<br>3429<br>3430<br>3431<br>3432<br>3433<br>3434<br>3435<br>3436<br>3437<br>3438<br>3439<br>3440<br>3441<br>3442<br>3443<br>``` | ````md-code__content<br>def ask_for_unique_string(reserved_values,<br>                          default=None, prompt=None, title=None, **kwargs):<br>    """Ask user to select a unique string value.<br>    This is a shortcut function that configures :obj:`GetValueWindow` for<br>    unique string data types. kwargs can be used to pass on other arguments.<br>    Args:<br>        reserved_values (list[str]): list of reserved (forbidden) values<br>        default (str): default unique string. must not be in reserved_values<br>        prompt (str): prompt message<br>        title (str): title message<br>        kwargs (type): other arguments to be passed to :obj:`GetValueWindow`<br>    Returns:<br>        (str): selected unique string<br>    Examples:<br>        ```python<br>        forms.ask_for_unique_string(<br>            prompt='Enter a Unique Name',<br>            title=self.Title,<br>            reserved_values=['Ehsan', 'Gui', 'Guido'],<br>            owner=self)<br>        'unique string'<br>        ```<br>        In example above, owner argument is provided to be passed to underlying<br>        :obj:`GetValueWindow`.<br>    """<br>    return GetValueWindow.show(<br>        None,<br>        value_type='string',<br>        default=default,<br>        prompt=prompt,<br>        title=title,<br>        reserved_values=reserved_values,<br>        **kwargs<br>        )<br>```` |

### `ask_for_one_item(items, default=None, prompt=None, title=None, **kwargs)`

Ask user to select an item from a list of items.

This is a shortcut function that configures :obj: `GetValueWindow` for
'single-select' data types. kwargs can be used to pass on other arguments.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `items` | `list[str]` | list of items to choose from | _required_ |
| `default` | `str` | default selected item | `None` |
| `prompt` | `str` | prompt message | `None` |
| `title` | `str` | title message | `None` |
| `kwargs` | `type` | other arguments to be passed to :obj: `GetValueWindow` | `{}` |

Returns:

| Type | Description |
| --- | --- |
| `str` | selected item |

Examples:

```md-code__content
forms.ask_for_one_item(
    ['test item 1', 'test item 2', 'test item 3'],
    default='test item 2',
    prompt='test prompt',
    title='test title'
)
'test item 1'

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3446<br>3447<br>3448<br>3449<br>3450<br>3451<br>3452<br>3453<br>3454<br>3455<br>3456<br>3457<br>3458<br>3459<br>3460<br>3461<br>3462<br>3463<br>3464<br>3465<br>3466<br>3467<br>3468<br>3469<br>3470<br>3471<br>3472<br>3473<br>3474<br>3475<br>3476<br>3477<br>3478<br>3479<br>3480<br>``` | ````md-code__content<br>def ask_for_one_item(items, default=None, prompt=None, title=None, **kwargs):<br>    """Ask user to select an item from a list of items.<br>    This is a shortcut function that configures :obj:`GetValueWindow` for<br>    'single-select' data types. kwargs can be used to pass on other arguments.<br>    Args:<br>        items (list[str]): list of items to choose from<br>        default (str): default selected item<br>        prompt (str): prompt message<br>        title (str): title message<br>        kwargs (type): other arguments to be passed to :obj:`GetValueWindow`<br>    Returns:<br>        (str): selected item<br>    Examples:<br>        ```python<br>        forms.ask_for_one_item(<br>            ['test item 1', 'test item 2', 'test item 3'],<br>            default='test item 2',<br>            prompt='test prompt',<br>            title='test title'<br>        )<br>        'test item 1'<br>        ```<br>    """<br>    return GetValueWindow.show(<br>        items,<br>        value_type='dropdown',<br>        default=default,<br>        prompt=prompt,<br>        title=title,<br>        **kwargs<br>        )<br>```` |

### `ask_for_date(default=None, prompt=None, title=None, **kwargs)`

Ask user to select a date value.

This is a shortcut function that configures :obj: `GetValueWindow` for
date data types. kwargs can be used to pass on other arguments.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `default` | `datetime` | default selected date value | `None` |
| `prompt` | `str` | prompt message | `None` |
| `title` | `str` | title message | `None` |
| `kwargs` | `type` | other arguments to be passed to :obj: `GetValueWindow` | `{}` |

Returns:

| Type | Description |
| --- | --- |
| `datetime` | selected date |

Examples:

```md-code__content
forms.ask_for_date(default="", title="Enter deadline:")
datetime.datetime(2019, 5, 17, 0, 0)

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3483<br>3484<br>3485<br>3486<br>3487<br>3488<br>3489<br>3490<br>3491<br>3492<br>3493<br>3494<br>3495<br>3496<br>3497<br>3498<br>3499<br>3500<br>3501<br>3502<br>3503<br>3504<br>3505<br>3506<br>3507<br>3508<br>3509<br>3510<br>3511<br>3512<br>``` | ````md-code__content<br>def ask_for_date(default=None, prompt=None, title=None, **kwargs):<br>    """Ask user to select a date value.<br>    This is a shortcut function that configures :obj:`GetValueWindow` for<br>    date data types. kwargs can be used to pass on other arguments.<br>    Args:<br>        default (datetime.datetime): default selected date value<br>        prompt (str): prompt message<br>        title (str): title message<br>        kwargs (type): other arguments to be passed to :obj:`GetValueWindow`<br>    Returns:<br>        (datetime.datetime): selected date<br>    Examples:<br>        ```python<br>        forms.ask_for_date(default="", title="Enter deadline:")<br>        datetime.datetime(2019, 5, 17, 0, 0)<br>        ```<br>    """<br>    # FIXME: window does not set default value<br>    return GetValueWindow.show(<br>        None,<br>        value_type='date',<br>        default=default,<br>        prompt=prompt,<br>        title=title,<br>        **kwargs<br>        )<br>```` |

### `ask_for_number_slider(default=None, min=0, max=100, interval=1, prompt=None, title=None, **kwargs)`

Ask user to select a number value.

This is a shortcut function that configures :obj: `GetValueWindow` for
numbers. kwargs can be used to pass on other arguments.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `default` | `str` | default unique string. must not be in reserved\_values | `None` |
| `min` | `int` | minimum value on slider | `0` |
| `max` | `int` | maximum value on slider | `100` |
| `interval` | `int` | number interval between values | `1` |
| `prompt` | `str` | prompt message | `None` |
| `title` | `str` | title message | `None` |
| `kwargs` | `type` | other arguments to be passed to :obj: `GetValueWindow` | `{}` |

Returns:

| Type | Description |
| --- | --- |
| `str` | selected string value |

Examples:

```md-code__content
forms.ask_for_number_slider(
    default=50,
    min = 0,
    max = 100,
    interval = 5,
    prompt='Select a number:',
    title='test title')
'50'

```

In this example, the slider will allow values such as '40, 45, 50, 55, 60' etc

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3515<br>3516<br>3517<br>3518<br>3519<br>3520<br>3521<br>3522<br>3523<br>3524<br>3525<br>3526<br>3527<br>3528<br>3529<br>3530<br>3531<br>3532<br>3533<br>3534<br>3535<br>3536<br>3537<br>3538<br>3539<br>3540<br>3541<br>3542<br>3543<br>3544<br>3545<br>3546<br>3547<br>3548<br>3549<br>3550<br>3551<br>3552<br>3553<br>3554<br>3555<br>3556<br>3557<br>``` | ````md-code__content<br>def ask_for_number_slider(default=None, min=0, max=100, interval=1, prompt=None, title=None, **kwargs):<br>    """Ask user to select a number value.<br>    This is a shortcut function that configures :obj:`GetValueWindow` for<br>    numbers. kwargs can be used to pass on other arguments.<br>    Args:<br>        default (str): default unique string. must not be in reserved_values<br>        min (int): minimum value on slider<br>        max (int): maximum value on slider<br>        interval (int): number interval between values<br>        prompt (str): prompt message<br>        title (str): title message<br>        kwargs (type): other arguments to be passed to :obj:`GetValueWindow`<br>    Returns:<br>        (str): selected string value<br>    Examples:<br>        ```python<br>        forms.ask_for_number_slider(<br>            default=50,<br>            min = 0,<br>            max = 100,<br>            interval = 5,<br>            prompt='Select a number:',<br>            title='test title')<br>        '50'<br>        ```<br>    In this example, the slider will allow values such as '40, 45, 50, 55, 60' etc<br>    """<br>    return GetValueWindow.show(<br>        None,<br>        value_type='slider',<br>        default=default,<br>        prompt=prompt,<br>        title=title,<br>        max=max,<br>        min=min,<br>        interval=interval,<br>        **kwargs<br>        )<br>```` |

### `ask_to_use_selected(type_name, count=None, multiple=True)`

Ask user if wants to use currently selected elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `type_name` | `str` | Element type of expected selected elements | _required_ |
| `count` | `int` | Number of selected items | `None` |
| `multiple` | `bool` | Whether multiple selected items are allowed | `True` |

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3560<br>3561<br>3562<br>3563<br>3564<br>3565<br>3566<br>3567<br>3568<br>3569<br>3570<br>3571<br>3572<br>3573<br>3574<br>3575<br>3576<br>3577<br>3578<br>3579<br>3580<br>3581<br>3582<br>3583<br>``` | ```md-code__content<br>def ask_to_use_selected(type_name, count=None, multiple=True):<br>    """Ask user if wants to use currently selected elements.<br>    Args:<br>        type_name (str): Element type of expected selected elements<br>        count (int): Number of selected items<br>        multiple (bool): Whether multiple selected items are allowed<br>    """<br>    report = type_name.lower()<br>    # multiple = True<br>    message = \<br>        "You currently have %s selected. Do you want to proceed with "\<br>        "currently selected item(s)?"<br>    # check is selecting multiple is allowd<br>    if not multiple:<br>        # multiple = False<br>        message = \<br>            "You currently have %s selected and only one is required. "\<br>            "Do you want to use the first selected item?"<br>    # check if count is provided<br>    if count is not None:<br>        report = '{} {}'.format(count, report)<br>    return alert(message % report, yes=True, no=True)<br>``` |

### `ask_for_color(default=None)`

Show system color picker and ask for color.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `default` | `str` | default color in HEX ARGB e.g. #ff808080 | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str` | selected color in HEX ARGB e.g. #ff808080, or None if cancelled |

Examples:

```md-code__content
forms.ask_for_color()
'#ff808080'

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3586<br>3587<br>3588<br>3589<br>3590<br>3591<br>3592<br>3593<br>3594<br>3595<br>3596<br>3597<br>3598<br>3599<br>3600<br>3601<br>3602<br>3603<br>3604<br>3605<br>3606<br>3607<br>3608<br>3609<br>3610<br>3611<br>3612<br>3613<br>3614<br>3615<br>``` | ````md-code__content<br>def ask_for_color(default=None):<br>    """Show system color picker and ask for color.<br>    Args:<br>        default (str): default color in HEX ARGB e.g. #ff808080<br>    Returns:<br>        (str): selected color in HEX ARGB e.g. #ff808080, or None if cancelled<br>    Examples:<br>        ```python<br>        forms.ask_for_color()<br>        '#ff808080'<br>        ```<br>    """<br>    # colorDlg.Color<br>    color_picker = Forms.ColorDialog()<br>    if default:<br>        default = default.replace('#', '')<br>        color_picker.Color = System.Drawing.Color.FromArgb(<br>            int(default[:2], 16),<br>            int(default[2:4], 16),<br>            int(default[4:6], 16),<br>            int(default[6:8], 16)<br>        )<br>    color_picker.FullOpen = True<br>    if color_picker.ShowDialog() == Forms.DialogResult.OK:<br>        c = color_picker.Color<br>        c_hex = ''.join('{:02X}'.format(int(x)) for x in [c.A, c.R, c.G, c.B])<br>        return '#' + c_hex<br>```` |

### `inform_wip()`

Show work-in-progress prompt to user and exit script.

Examples:

```md-code__content
forms.inform_wip()

```

Source code in `pyrevitlib/pyrevit/forms/__init__.py`

|     |     |
| --- | --- |
| ```<br>3618<br>3619<br>3620<br>3621<br>3622<br>3623<br>3624<br>3625<br>3626<br>``` | ````md-code__content<br>def inform_wip():<br>    """Show work-in-progress prompt to user and exit script.<br>    Examples:<br>        ```python<br>        forms.inform_wip()<br>        ```<br>    """<br>    alert("Work in progress.", exitscript=True)<br>```` |

Back to top

## pyRevit Unit Tests
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/unittests/#pyrevit.unittests)

# unittests

The main pyRevit test is the startup test which is done by launching Revit.

This module is created to provide a platform to perform complete tests on
different components of pyRevit.
For example, as the git module grows, new tests will be added to the git test
suite to test the full functionality of that module, although only a subset of
functions are used during startup and normal operations of pyRevit.

```md-code__content
from unittest import TestCase
class TestWithIndependentOutput(TestCase):
    def setUp(self):
        pass

    def tearDown(self):
        pass

    def doCleanups(self):
        pass

```

## Functions

Back to top

## Locale Conversion Services
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/applocales/#pyrevit.coreutils.applocales)

# applocales

Provide conversion services between python.locale and host languages.

## Attributes

### `DEFAULT_LANG_DIR = 'LTR'``module-attribute`

### `DEFAULT_LOCALE = AppLocale(lang_type=ApplicationServices.LanguageType.English_USA, lang_name='English USA', locale_codes=['en_us', 'english'])``module-attribute`

### `APP_LOCALES = [DEFAULT_LOCALE, AppLocale(lang_type=ApplicationServices.LanguageType.German, lang_name='Deutsch', locale_codes=['de_de', 'german']), AppLocale(lang_type=ApplicationServices.LanguageType.Spanish, lang_name='español', locale_codes=['es_es', 'spanish']), AppLocale(lang_type=ApplicationServices.LanguageType.French, lang_name='français', locale_codes=['fr_fr', 'french']), AppLocale(lang_type=ApplicationServices.LanguageType.Italian, lang_name='italiano', locale_codes=['it_it', 'italian']), AppLocale(lang_type=ApplicationServices.LanguageType.Dutch, lang_name='Nederlands', locale_codes=['nl_nl', 'nl_be', 'dutch']), AppLocale(lang_type=ApplicationServices.LanguageType.Chinese_Simplified, lang_name='简体中文', locale_codes=['chinese_s', 'chinese']), AppLocale(lang_type=ApplicationServices.LanguageType.Chinese_Traditional, lang_name='繁體中文', locale_codes=['chinese_t', 'chinese']), AppLocale(lang_type=ApplicationServices.LanguageType.Japanese, lang_name='日本語', locale_codes=['ja', 'japanese']), AppLocale(lang_type=ApplicationServices.LanguageType.Korean, lang_name='한국어', locale_codes=['ko', 'korean']), AppLocale(lang_type=ApplicationServices.LanguageType.Russian, lang_name='Русский', locale_codes=['ru', 'russian']), AppLocale(lang_type=ApplicationServices.LanguageType.Czech, lang_name='Čeština', locale_codes=['cs', 'czech']), AppLocale(lang_type=ApplicationServices.LanguageType.Polish, lang_name='Polski', locale_codes=['pl', 'polish']), AppLocale(lang_type=ApplicationServices.LanguageType.Hungarian, lang_name='Magyar', locale_codes=['hu', 'hungarian']), AppLocale(lang_type=ApplicationServices.LanguageType.Brazilian_Portuguese, lang_name='Português do Brasil', locale_codes=['pt_br', 'portuguese_brazil', 'brazilian', 'portuguese', 'pt_pt'])]``module-attribute`

## Classes

### `AppLocale(lang_type, locale_codes, lang_name=None, lang_dir=DEFAULT_LANG_DIR)`

Bases: `object`

Type representing a language option.

Source code in `pyrevitlib/pyrevit/coreutils/applocales.py`

|     |     |
| --- | --- |
| ```<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>``` | ```md-code__content<br>def __init__(self,<br>             lang_type,<br>             locale_codes,<br>             lang_name=None,<br>             lang_dir=DEFAULT_LANG_DIR):<br>    if isinstance(lang_type, ApplicationServices.LanguageType):<br>        self.lang_type = lang_type<br>    elif isinstance(lang_type, str):<br>        self.lang_type = lang_type<br>    self.lang_name = lang_name<br>    self.lang_dir = lang_dir<br>    self.locale_codes = locale_codes<br>    if self.locale_codes:<br>        self.locale_code = self.locale_codes[0]<br>``` |

#### Attributes

##### `lang_type = lang_type``instance-attribute`

##### `lang_name = lang_name``instance-attribute`

##### `lang_dir = lang_dir``instance-attribute`

##### `locale_codes = locale_codes``instance-attribute`

##### `locale_code = self.locale_codes[0]``instance-attribute`

## Functions

### `get_applocale_by_local_code(locale_code)`

Return application locale by locale code.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `locale_code` | `str` | locale code | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `AppLocale` | application locale |

Source code in `pyrevitlib/pyrevit/coreutils/applocales.py`

|     |     |
| --- | --- |
| ```<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>``` | ```md-code__content<br>def get_applocale_by_local_code(locale_code):<br>    """Return application locale by locale code.<br>    Args:<br>        locale_code (str): locale code<br>    Returns:<br>        (AppLocale): application locale<br>    """<br>    for applocale in APP_LOCALES:<br>        if locale_code in applocale.locale_codes:<br>            return applocale<br>``` |

### `get_applocale_by_lang_type(lang_type)`

Return application locale by language type.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `lang_type` | `LanguageType | str` | language type | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `AppLocale` | application locale |

Source code in `pyrevitlib/pyrevit/coreutils/applocales.py`

|     |     |
| --- | --- |
| ```<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>``` | ```md-code__content<br>def get_applocale_by_lang_type(lang_type):<br>    """Return application locale by language type.<br>    Args:<br>        lang_type (ApplicationServices.LanguageType | str): language type<br>    Returns:<br>        (AppLocale): application locale<br>    """<br>    for applocale in APP_LOCALES:<br>        if lang_type == applocale.lang_type:<br>            return applocale<br>``` |

### `get_applocale_by_lang_name(lang_name)`

Return application locale by language name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `lang_name` | `str` | language name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `AppLocale` | application locale |

Source code in `pyrevitlib/pyrevit/coreutils/applocales.py`

|     |     |
| --- | --- |
| ```<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>``` | ```md-code__content<br>def get_applocale_by_lang_name(lang_name):<br>    """Return application locale by language name.<br>    Args:<br>        lang_name (str): language name<br>    Returns:<br>        (AppLocale): application locale<br>    """<br>    for applocale in APP_LOCALES:<br>        if lang_name in {applocale.lang_name, str(applocale.lang_type)}:<br>            return applocale<br>``` |

### `get_current_applocale()`

Return the current locale.

This is the user locale, if set, or the host application locale otherwise.

Returns:

| Type | Description |
| --- | --- |
| `AppLocale` | current locale |

Source code in `pyrevitlib/pyrevit/coreutils/applocales.py`

|     |     |
| --- | --- |
| ```<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>``` | ```md-code__content<br>def get_current_applocale():<br>    """Return the current locale.<br>    This is the user locale, if set, or the host application locale otherwise.<br>    Returns:<br>        (AppLocale): current locale<br>    """<br>    if user_config.user_locale:<br>        return get_applocale_by_local_code(user_config.user_locale)<br>    return get_applocale_by_lang_type(HOST_APP.language)<br>``` |

### `get_host_applocale()`

Return host application locale.

Returns:

| Type | Description |
| --- | --- |
| `AppLocale` | host application locale |

Source code in `pyrevitlib/pyrevit/coreutils/applocales.py`

|     |     |
| --- | --- |
| ```<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>``` | ```md-code__content<br>def get_host_applocale():<br>    """Return host application locale.<br>    Returns:<br>        (AppLocale): host application locale<br>    """<br>    return get_applocale_by_lang_type(HOST_APP.language)<br>``` |

### `get_locale_string(string_dict)`

Returns the correct string from given dict based on host language.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `string_dict` | `dict[str, str]` | dict of strings in various locales | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | string in correct locale |

Examples:

```md-code__content
data = {"en_us":"Hello", "chinese_s":"你好"}
from pyrevit.coreutils import applocales
# assuming running Revit is Chinese
applocales.get_locale_string(data)

```

"你好"

Source code in `pyrevitlib/pyrevit/coreutils/applocales.py`

|     |     |
| --- | --- |
| ```<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>``` | ````md-code__content<br>def get_locale_string(string_dict):<br>    """Returns the correct string from given dict based on host language.<br>    Args:<br>        string_dict (dict[str, str]): dict of strings in various locales<br>    Returns:<br>        (str): string in correct locale<br>    Examples:<br>        ```python<br>        data = {"en_us":"Hello", "chinese_s":"你好"}<br>        from pyrevit.coreutils import applocales<br>        # assuming running Revit is Chinese<br>        applocales.get_locale_string(data)<br>        ```<br>        "你好"<br>    """<br>    applocale = get_applocale_by_local_code(user_config.user_locale)<br>    if applocale:<br>        local_codes = applocale.locale_codes + DEFAULT_LOCALE.locale_codes<br>    else:<br>        local_codes = DEFAULT_LOCALE.locale_codes<br>    for locale_code in local_codes:<br>        if locale_code in string_dict:<br>            return string_dict[locale_code]<br>```` |

Back to top

## Event Telemetry Management
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/telemetry/events/#pyrevit.telemetry.events)

# events

Event telemetry management.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `ALL_EVENTS = 340282366920938463463374607431768211455``module-attribute`

### `SUGGESTED_EVENTS = 31988513242969``module-attribute`

## Functions

### `register_event_telemetry(handler, flags)`

Registers application event telemetry handlers based on given flags.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `handler` | `EventTelemetry` | event telemetry handler | _required_ |
| `flags` | `int` | event flags | _required_ |

Source code in `pyrevitlib/pyrevit/telemetry/events.py`

|     |     |
| --- | --- |
| ```<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>``` | ```md-code__content<br>def register_event_telemetry(handler, flags):<br>    """Registers application event telemetry handlers based on given flags.<br>    Args:<br>        handler (EventTelemetry): event telemetry handler<br>        flags (int): event flags<br>    """<br>    try:<br>        handler.RegisterEventTelemetry(HOST_APP.uiapp, flags)<br>    except Exception as ex:<br>        mlogger.debug(<br>            "Error registering event telementry with flags: %s | %s",<br>            str(flags), ex)<br>``` |

### `unregister_event_telemetry(handler, flags)`

Unregisters application event telemetry handlers based on given flags.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `handler` | `EventTelemetry` | event telemetry handler | _required_ |
| `flags` | `int` | event flags | _required_ |

Source code in `pyrevitlib/pyrevit/telemetry/events.py`

|     |     |
| --- | --- |
| ```<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>``` | ```md-code__content<br>def unregister_event_telemetry(handler, flags):<br>    """Unregisters application event telemetry handlers based on given flags.<br>    Args:<br>        handler (EventTelemetry): event telemetry handler<br>        flags (int): event flags<br>    """<br>    try:<br>        handler.UnRegisterEventTelemetry(HOST_APP.uiapp, flags)<br>    except Exception as ex:<br>        mlogger.debug(<br>            "Error unregistering event telementry with flags: %s | %s",<br>            str(flags), ex)<br>``` |

### `unregister_all_event_telemetries(handler)`

Unregisters all available application event telemetry handlers.

Source code in `pyrevitlib/pyrevit/telemetry/events.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>``` | ```md-code__content<br>def unregister_all_event_telemetries(handler):<br>    """Unregisters all available application event telemetry handlers."""<br>    unregister_event_telemetry(handler, ALL_EVENTS)<br>``` |

Back to top

## Revit Journal Files
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/journals/#pyrevit.revit.journals)

# journals

Provide access to Revit Journal Files.

## Attributes

## Functions

### `get_journals_folder()`

Source code in `pyrevitlib/pyrevit/revit/journals.py`

|     |     |
| --- | --- |
| ```<br>12<br>13<br>``` | ```md-code__content<br>def get_journals_folder():<br>    return op.dirname(HOST_APP.app.RecordingJournalFilename)<br>``` |

### `get_current_journal_file()`

Source code in `pyrevitlib/pyrevit/revit/journals.py`

|     |     |
| --- | --- |
| ```<br>16<br>17<br>``` | ```md-code__content<br>def get_current_journal_file():<br>    return HOST_APP.app.RecordingJournalFilename<br>``` |

### `get_current_session_id()`

Source code in `pyrevitlib/pyrevit/revit/journals.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>``` | ```md-code__content<br>def get_current_session_id():<br>    re_finder = re.compile(r'.*>Session\s+(\$.{8}).*')<br>    journal_file = get_current_journal_file()<br>    with open(journal_file, "r") as jfile:<br>        for jline in reversed(jfile.readlines()):<br>            match = re_finder.match(jline)<br>            if match:<br>                return match.groups()[0]<br>``` |

Back to top

## ASCII Caching Module
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/cacher_asc/#pyrevit.extensions.cacher_asc)

# cacher\_asc

Base module to handle extension ASCII caching.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Classes

## Functions

### `update_cache(parsed_ext)`

Source code in `pyrevitlib/pyrevit/extensions/cacher_asc.py`

|     |     |
| --- | --- |
| ```<br>120<br>121<br>122<br>123<br>``` | ```md-code__content<br>def update_cache(parsed_ext):<br>    mlogger.debug('Updating cache for tab: %s ...', parsed_ext.name)<br>    _write_cache_for(parsed_ext)<br>    mlogger.debug('Cache updated for tab: %s', parsed_ext.name)<br>``` |

### `get_cached_extension(installed_ext)`

Source code in `pyrevitlib/pyrevit/extensions/cacher_asc.py`

|     |     |
| --- | --- |
| ```<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>``` | ```md-code__content<br>def get_cached_extension(installed_ext):<br>    cached_ext_dict = _read_cache_for(installed_ext)<br>    # try:<br>    mlogger.debug('Constructing components from cache for: %s',<br>                    installed_ext)<br>    # get cached sub component dictionary and call recursive maker function<br>    _make_sub_cmp_from_cache(installed_ext,<br>                                cached_ext_dict.pop(gencomps.SUB_CMP_KEY))<br>    mlogger.debug('Load successful...')<br>    # except Exception as err:<br>    #     mlogger.debug('Error reading cache...')<br>    #     raise PyRevitException('Error creating ext from cache for: {} | {}'<br>    #                            .format(installed_ext.name, err))<br>    return installed_ext<br>``` |

### `is_cache_valid(extension)`

Source code in `pyrevitlib/pyrevit/extensions/cacher_asc.py`

|     |     |
| --- | --- |
| ```<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>``` | ```md-code__content<br>def is_cache_valid(extension):<br>    try:<br>        cached_ext_dict = _read_cache_for(extension)  # type: dict<br>        mlogger.debug('Extension cache directory is: %s for: %s',<br>                      extension.directory, extension)<br>        cache_dir_valid = cached_ext_dict[gencomps.EXT_DIR_KEY] == extension.directory<br>        mlogger.debug('Extension cache version is: %s for: %s',<br>                      extension.pyrvt_version, extension)<br>        cache_version_valid = \<br>            cached_ext_dict[comps.EXT_HASH_VERSION_KEY] == extension.pyrvt_version<br>        mlogger.debug('Extension hash value is: %s for:%s',<br>                      extension.dir_hash_value, extension)<br>        cache_hash_valid = \<br>            cached_ext_dict[comps.EXT_HASH_VALUE_KEY] == extension.dir_hash_value<br>        cache_valid = \<br>            cache_dir_valid and cache_version_valid and cache_hash_valid<br>        # cache is valid if both version and hash value match<br>        return cache_valid<br>    except PyRevitException as err:<br>        mlogger.debug(err)<br>        return False<br>    except Exception as err:<br>        mlogger.debug('Error determining cache validity: %s | %s',<br>                      extension, err)<br>``` |

Back to top

## pyRevit Environment Variables
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/envvars/#pyrevit.coreutils.envvars)

# envvars

pyRevit managed environment variables framework.

pyRevit provides the environment variables framework to the pyRevit core
and all pyRevit tools so they can store arbitary data withing the running host
session and share small data quickly between script runs.

Some settings needs to be set for the current session and might need to affect
the behaviour of all individual scripts inside the extensions.
(e.g. If user activates the `DEBUG` mode, all scripts should follow and log
the debug entries.) The information is saved using `AppDomain.GetData` and
`SetData` in a dictionary parameter. The dictionary is used to minimize the
addition of named parameters to the AppDomain. The dictionary then includes
all the internal parameters and their associated value. This way each script
does not need to read the usersettings data which reduces io and saves time.

pyRevit uses environment variables extensively at its core and making changes
to the core environment variables (starting with `PYREVIT_`) through
scripts is strongly prohibited.

Examples:

```md-code__content
from pyrevit.coreutils import envvars
envvars.set_pyrevit_env_var('MY_SCRIPT_STATUS', True)
envvars.set_pyrevit_env_var('MY_SCRIPT_CONFIG', {'someconfig': True})

```

Then another script or same script when executed later within the same
session can query the shared environment variable:

```md-code__content
envvars.get_pyrevit_env_vars('MY_SCRIPT_STATUS')

```

True

```md-code__content
envvars.get_pyrevit_env_vars('MY_SCRIPT_CONFIG')

```

{'someconfig': True}

## Attributes

### `PRODUCT_NAME = str(Common.PyRevitLabsConsts.ProductName).upper()``module-attribute`

### `ENV_VAR_DICT_NAME = PRODUCT_NAME + 'EnvVarsDict'``module-attribute`

### `SESSIONUUID_ENVVAR = PRODUCT_NAME + '_UUID'``module-attribute`

### `APPVERSION_ENVVAR = PRODUCT_NAME + '_APPVERSION'``module-attribute`

### `VERSION_ENVVAR = PRODUCT_NAME + '_VERSION'``module-attribute`

### `CLONENAME_ENVVAR = PRODUCT_NAME + '_CLONE'``module-attribute`

### `IPYVERSION_ENVVAR = PRODUCT_NAME + '_IPYVERSION'``module-attribute`

### `CPYVERSION_ENVVAR = PRODUCT_NAME + '_CPYVERSION'``module-attribute`

### `LOGGING_LEVEL_ENVVAR = PRODUCT_NAME + '_LOGGINGLEVEL'``module-attribute`

### `FILELOGGING_ENVVAR = PRODUCT_NAME + '_FILELOGGING'``module-attribute`

### `LOADEDASSMS_ENVVAR = PRODUCT_NAME + '_LOADEDASSMS'``module-attribute`

### `REFEDASSMS_ENVVAR = PRODUCT_NAME + '_REFEDASSMS'``module-attribute`

### `TELEMETRYSTATE_ENVVAR = PRODUCT_NAME + '_TELEMETRYSTATE'``module-attribute`

### `TELEMETRYUTCTIMESTAMPS_ENVVAR = PRODUCT_NAME + '_TELEMETRYUTCTIMESTAMPS'``module-attribute`

### `TELEMETRYDIR_ENVVAR = PRODUCT_NAME + '_TELEMETRYDIR'``module-attribute`

### `TELEMETRYFILE_ENVVAR = PRODUCT_NAME + '_TELEMETRYFILE'``module-attribute`

### `TELEMETRYSERVER_ENVVAR = PRODUCT_NAME + '_TELEMETRYSERVER'``module-attribute`

### `TELEMETRYINCLUDEHOOKS_ENVVAR = PRODUCT_NAME + '_TELEMETRYINCLUDEHOOKS'``module-attribute`

### `APPTELEMETRYSTATE_ENVVAR = PRODUCT_NAME + '_APPTELEMETRYSTATE'``module-attribute`

### `APPTELEMETRYHANDLER_ENVVAR = PRODUCT_NAME + '_APPTELEMETRYHANDLER'``module-attribute`

### `APPTELEMETRYSERVER_ENVVAR = PRODUCT_NAME + '_APPTELEMETRYSERVER'``module-attribute`

### `APPTELEMETRYEVENTFLAGS_ENVVAR = PRODUCT_NAME + '_APPTELEMETRYEVENTFLAGS'``module-attribute`

### `ROUTES_SERVER = PRODUCT_NAME + '_ROUTESSERVER'``module-attribute`

### `ROUTES_ROUTES = PRODUCT_NAME + '_ROUTESROUTES'``module-attribute`

### `HOOKS_ENVVAR = PRODUCT_NAME + '_HOOKS'``module-attribute`

### `HOOKSHANDLER_ENVVAR = PRODUCT_NAME + '_HOOKSHANDLER'``module-attribute`

### `AUTOUPDATING_ENVVAR = PRODUCT_NAME + '_AUTOUPDATE'``module-attribute`

### `OUTPUT_STYLESHEET_ENVVAR = PRODUCT_NAME + '_STYLESHEET'``module-attribute`

### `RIBBONUPDATOR_ENVVAR = PRODUCT_NAME + '_RIBBONUPDATOR'``module-attribute`

### `TABCOLORIZER_ENVVAR = PRODUCT_NAME + '_TABCOLORIZER'``module-attribute`

## Functions

### `get_pyrevit_env_vars()`

Get the root dictionary, holding all environment variables.

Source code in `pyrevitlib/pyrevit/coreutils/envvars.py`

|     |     |
| --- | --- |
| ```<br>89<br>90<br>91<br>``` | ```md-code__content<br>def get_pyrevit_env_vars():<br>    """Get the root dictionary, holding all environment variables."""<br>    return AppDomain.CurrentDomain.GetData(ENV_VAR_DICT_NAME)<br>``` |

### `get_pyrevit_env_var(param_name)`

Get value of a parameter shared between all scripts.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | name of environment variable | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `object` | any object stored as the environment variable value |

Source code in `pyrevitlib/pyrevit/coreutils/envvars.py`

|     |     |
| --- | --- |
| ```<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>``` | ```md-code__content<br>def get_pyrevit_env_var(param_name):<br>    """Get value of a parameter shared between all scripts.<br>    Args:<br>        param_name (str): name of environment variable<br>    Returns:<br>        (object): any object stored as the environment variable value<br>    """<br>    # This function returns None if it can not find the parameter.<br>    # Thus value of None should not be used for params<br>    data_dict = get_pyrevit_env_vars()<br>    return data_dict.get(param_name) if data_dict else None<br>``` |

### `set_pyrevit_env_var(param_name, param_value)`

Set value of a parameter shared between all scripts.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | name of environment variable | _required_ |
| `param_value` | `object` | any python object | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/envvars.py`

|     |     |
| --- | --- |
| ```<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>``` | ```md-code__content<br>def set_pyrevit_env_var(param_name, param_value):<br>    """Set value of a parameter shared between all scripts.<br>    Args:<br>        param_name (str): name of environment variable<br>        param_value (object): any python object<br>    """<br>    # Get function returns None if it can not find the parameter.<br>    # Thus value of None should not be used for params<br>    data_dict = get_pyrevit_env_vars() or {}<br>    data_dict[param_name] = param_value<br>    AppDomain.CurrentDomain.SetData(ENV_VAR_DICT_NAME, data_dict)<br>``` |

Back to top

## Extension Package Management
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/extpackages/#pyrevit.extensions.extpackages)

# extpackages

Base module to handle processing extensions as packages.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `PLUGIN_EXT_DEF_MANIFEST_NAME = 'extensions'``module-attribute`

### `PLUGIN_EXT_DEF_FILE = PLUGIN_EXT_DEF_MANIFEST_NAME + exts.JSON_FILE_FORMAT``module-attribute`

### `EXTENSION_POSTFIXES = [x.POSTFIX for x in exts.ExtensionTypes.get_ext_types()]``module-attribute`

## Classes

### `PyRevitPluginAlreadyInstalledException(extpkg)`

Bases: `PyRevitException`

Exception raised when extension is already installed.

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>24<br>25<br>26<br>27<br>``` | ```md-code__content<br>def __init__(self, extpkg):<br>    super(PyRevitPluginAlreadyInstalledException, self).__init__()<br>    self.extpkg = extpkg<br>    PyRevitException(self)<br>``` |

#### Attributes

##### `msg``property`

Return exception message.

##### `extpkg = extpkg``instance-attribute`

### `PyRevitPluginNoInstallLinkException`

Bases: `PyRevitException`

Exception raised when extension does not have an install link.

#### Attributes

##### `msg``property`

Return exception message.

### `PyRevitPluginRemoveException`

Bases: `PyRevitException`

Exception raised when removing an extension.

#### Attributes

##### `msg``property`

Return exception message.

### `DependencyGraph(extpkg_list)`

Extension packages dependency graph.

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>``` | ```md-code__content<br>def __init__(self, extpkg_list):<br>    self.dep_dict = defaultdict(list)<br>    self.extpkgs = extpkg_list<br>    for extpkg in extpkg_list:<br>        if extpkg.dependencies:<br>            for dep_pkg_name in extpkg.dependencies:<br>                self.dep_dict[dep_pkg_name].append(extpkg)<br>``` |

#### Attributes

##### `dep_dict = defaultdict(list)``instance-attribute`

##### `extpkgs = extpkg_list``instance-attribute`

#### Functions

##### `has_installed_dependents(extpkg_name)`

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>``` | ```md-code__content<br>def has_installed_dependents(self, extpkg_name):<br>    if extpkg_name in self.dep_dict:<br>        for dep_pkg in self.dep_dict[extpkg_name]:<br>            if dep_pkg.is_installed:<br>                return True<br>    else:<br>        return False<br>``` |

### `ExtensionPackage(info_dict, def_file_path=None)`

Extension package class.

This class contains the extension information and also manages installation,
user configuration, and removal of the extension.
See the `__init__` class documentation for the required and
optional extension information.

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `type` | `ExtensionTypes` | Extension type |
| `name` | `str` | Extension name |
| `description` | `str` | Extension description |
| `url` | `str` | Url of online git repository |
| `website` | `str` | Url of extension website |
| `image` | `str` | Url of extension icon image (.png file) |
| `author` | `str` | Name of extension author |
| `author_profile` | `str` | Url of author profile |

Initialized the extension class based on provide information.

Required info (Dictionary keys):
type, name, description, url

Optional info

website, image, author, author-url, authusers

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `info_dict` | `dict` | A dictionary containing the required information<br>for initializing the extension. | _required_ |
| `def_file_path` | `str` | The file path of the extension definition file | `None` |

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br> 84<br> 85<br> 86<br> 87<br> 88<br> 89<br> 90<br> 91<br> 92<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>``` | ```md-code__content<br>def __init__(self, info_dict, def_file_path=None):<br>    """Initialized the extension class based on provide information.<br>    Required info (Dictionary keys):<br>        type, name, description, url<br>    Optional info:<br>        website, image, author, author-url, authusers<br>    Args:<br>        info_dict (dict): A dictionary containing the required information<br>                          for initializing the extension.<br>        def_file_path (str): The file path of the extension definition file<br>    """<br>    self.type = exts.ExtensionTypes.UI_EXTENSION<br>    self.builtin = False<br>    self.default_enabled = True<br>    self.name = None<br>    self.description = None<br>    self.url = None<br>    self.def_file_path = set()<br>    self.authusers = set()<br>    self.authgroups = set()<br>    self.rocket_mode_compatible = False<br>    self.website = None<br>    self.image = None<br>    self.author = None<br>    self.author_profile = None<br>    self.dependencies = set()<br>    self.update_info(info_dict, def_file_path=def_file_path)<br>``` |

#### Attributes

##### `type = exts.ExtensionTypes.UI_EXTENSION``instance-attribute`

##### `builtin = False``instance-attribute`

##### `default_enabled = True``instance-attribute`

##### `name = None``instance-attribute`

##### `description = None``instance-attribute`

##### `url = None``instance-attribute`

##### `def_file_path = set()``instance-attribute`

##### `authusers = set()``instance-attribute`

##### `authgroups = set()``instance-attribute`

##### `rocket_mode_compatible = False``instance-attribute`

##### `website = None``instance-attribute`

##### `image = None``instance-attribute`

##### `author = None``instance-attribute`

##### `author_profile = None``instance-attribute`

##### `dependencies = set()``instance-attribute`

##### `ext_dirname``property`

Installation directory name to use.

Returns:

| Type | Description |
| --- | --- |
| `str` | The name that should be used for the installation directory<br>(based on the extension type). |

##### `is_installed``property`

Installation directory.

Returns:

| Type | Description |
| --- | --- |
| `str` | Installed directory path or empty string if not installed. |

##### `installed_dir``property`

Installation directory.

Returns:

| Type | Description |
| --- | --- |
| `str` | Installed directory path or empty string if not installed. |

##### `is_removable``property`

Whether the extension is safe to remove.

Checks whether it is safe to remove this extension by confirming if
a git url is provided for this extension for later re-install.

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if removable, False if not |

##### `version``property`

Extension version.

Returns:

| Type | Description |
| --- | --- |
| `str` | Last commit hash of the extension git repo. |

##### `config``property`

Returns a valid config manager for this extension.

All config parameters will be saved in user config file.

Returns:

| Type | Description |
| --- | --- |
| `PyRevitConfigSectionParser` | Config section handler |

##### `is_enabled``property`

Checks the default and user configured load state of the extension.

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if package should be loaded |

##### `user_has_access``property`

Checks whether current user has access to this extension.

Returns:

| Type | Description |
| --- | --- |
| `bool` | True is current user has access |

#### Functions

##### `update_info(info_dict, def_file_path=None)`

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>``` | ```md-code__content<br>def update_info(self, info_dict, def_file_path=None):<br>    ext_def_type = info_dict.get('type', None)<br>    for ext_type in exts.ExtensionTypes.get_ext_types():<br>        if ext_def_type == ext_type.ID:<br>            self.type = ext_type<br>    self.builtin = \<br>        safe_strtype(info_dict.get('builtin',<br>                                   self.builtin)).lower() == 'true'<br>    self.default_enabled = safe_strtype(<br>        info_dict.get('default_enabled', self.default_enabled)<br>        ).lower() == 'true'<br>    self.name = info_dict.get('name', self.name)<br>    self.description = info_dict.get('description', self.description)<br>    self.url = info_dict.get('url', self.url)<br>    if def_file_path:<br>        self.def_file_path.add(def_file_path)<br>    # update list of authorized users<br>    authusers = info_dict.get('authusers', [])<br>    if authusers:<br>        self.authusers.update(authusers)<br>    # update list of authorized user groups<br>    authgroups = info_dict.get('authgroups', [])<br>    if authgroups:<br>        self.authgroups.update(authgroups)<br>    # rocket mode compatibility<br>    self.rocket_mode_compatible = \<br>        safe_strtype(<br>            info_dict.get('rocket_mode_compatible',<br>                          self.rocket_mode_compatible)<br>            ).lower() == 'true'<br>    # extended attributes<br>    self.website = info_dict.get(<br>        'website',<br>        self.url.replace('.git', '') if self.url else self.website<br>        )<br>    self.image = info_dict.get('image', self.image)<br>    self.author = info_dict.get('author', self.author)<br>    self.author_profile = info_dict.get('author_profile',<br>                                        self.author_profile)<br>    # update list dependencies<br>    depends = info_dict.get('dependencies', [])<br>    if depends:<br>        self.dependencies.update(depends)<br>``` |

##### `is_valid()`

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>169<br>170<br>``` | ```md-code__content<br>def is_valid(self):<br>    return self.name is not None and self.url is not None<br>``` |

##### `remove_pkg_config()`

Removes the installed extension configuration.

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def remove_pkg_config(self):<br>    """Removes the installed extension configuration."""<br>    user_config.remove_section(self.ext_dirname)<br>    user_config.save_changes()<br>``` |

##### `disable_package()`

Disables package in pyRevit configuration.

It won't be loaded in the next session.

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>``` | ```md-code__content<br>def disable_package(self):<br>    """Disables package in pyRevit configuration.<br>    It won't be loaded in the next session.<br>    """<br>    self.config.disabled = True<br>    user_config.save_changes()<br>``` |

##### `toggle_package()`

Disables/Enables package in pyRevit configuration.

A disabled package won't be loaded in the next session.

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>``` | ```md-code__content<br>def toggle_package(self):<br>    """Disables/Enables package in pyRevit configuration.<br>    A disabled package won't be loaded in the next session.<br>    """<br>    self.config.disabled = not self.config.disabled<br>    user_config.save_changes()<br>``` |

## Functions

### `get_ext_packages(authorized_only=True)`

Returns the registered plugin extensions packages.

Reads the list of registered plug-in extensions and returns a list of
ExtensionPackage classes which contain information on the plug-in extension.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `authorized_only` | `bool` | Only return authorized extensions | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[ExtensionPackage]` | list of registered plugin extensions |

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>427<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>``` | ```md-code__content<br>def get_ext_packages(authorized_only=True):<br>    """Returns the registered plugin extensions packages.<br>    Reads the list of registered plug-in extensions and returns a list of<br>    ExtensionPackage classes which contain information on the plug-in extension.<br>    Args:<br>        authorized_only (bool): Only return authorized extensions<br>    Returns:<br>        (list[ExtensionPackage]): list of registered plugin extensions<br>    """<br>    extpkgs = []<br>    for ext_dir in user_config.get_ext_root_dirs():<br>        # make a list of all availabe extension definition sources<br>        # default is under the extensions directory that ships with pyrevit<br>        extpkg_def_files = {op.join(ext_dir, PLUGIN_EXT_DEF_FILE)}<br>        # add other sources added by the user (using the cli)<br>        extpkg_def_files.update(user_config.get_ext_sources())<br>        for extpkg_def_file in extpkg_def_files:<br>            mlogger.debug('Looking for %s', extpkg_def_file)<br>            # check for external ext def file<br>            if op.exists(extpkg_def_file):<br>                mlogger.debug('Found %s', extpkg_def_file)<br>                _update_extpkgs(extpkg_def_file, extpkgs)<br>            # check internals now<br>            internal_extpkg_defs = _find_internal_extpkgs(ext_dir)<br>            for int_def_file in internal_extpkg_defs:<br>                _update_extpkgs(int_def_file, extpkgs)<br>    if authorized_only:<br>        return [x for x in extpkgs if x.user_has_access]<br>    return extpkgs<br>``` |

### `get_ext_package_by_name(extpkg_name)`

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>439<br>440<br>441<br>442<br>443<br>``` | ```md-code__content<br>def get_ext_package_by_name(extpkg_name):<br>    for extpkg in get_ext_packages(authorized_only=False):<br>        if extpkg.name == extpkg_name:<br>            return extpkg<br>    return None<br>``` |

### `get_dependency_graph()`

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>446<br>447<br>``` | ```md-code__content<br>def get_dependency_graph():<br>    return DependencyGraph(get_ext_packages(authorized_only=False))<br>``` |

### `install(extpkg, install_dir, install_dependencies=True)`

Install the extension in the given parent directory.

This method uses .installed\_dir property of extension object
as installation directory name for this extension.
This method also handles installation of extension dependencies.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extpkg` | `ExtensionPackage` | Extension package to be installed | _required_ |
| `install_dir` | `str` | Parent directory to install extension in. | _required_ |
| `install_dependencies` | `bool` | Install the dependencies as well | `True` |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | on install error with error message |

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>450<br>451<br>452<br>453<br>454<br>455<br>456<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>472<br>473<br>``` | ```md-code__content<br>def install(extpkg, install_dir, install_dependencies=True):<br>    """Install the extension in the given parent directory.<br>    This method uses .installed_dir property of extension object <br>    as installation directory name for this extension.<br>    This method also handles installation of extension dependencies.<br>    Args:<br>        extpkg (ExtensionPackage): Extension package to be installed<br>        install_dir (str): Parent directory to install extension in.<br>        install_dependencies (bool): Install the dependencies as well<br>    Raises:<br>        PyRevitException: on install error with error message<br>    """<br>    try:<br>        _install_extpkg(extpkg, install_dir, install_dependencies)<br>    except PyRevitPluginAlreadyInstalledException as already_installed_err:<br>        mlogger.warning('%s extension is already installed under %s',<br>                        already_installed_err.extpkg.name,<br>                        already_installed_err.extpkg.is_installed)<br>    except PyRevitPluginNoInstallLinkException:<br>        mlogger.error('Extension does not have an install link '<br>                      'and can not be installed.')<br>``` |

### `remove(extpkg, remove_dependencies=True)`

Removes the extension.

Removes the extension from its installed directory
and clears its configuration.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extpkg` | `ExtensionPackage` | Extension package to be removed | _required_ |
| `remove_dependencies` | `bool` | Remove the dependencies as well | `True` |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | on remove error with error message |

Source code in `pyrevitlib/pyrevit/extensions/extpackages.py`

|     |     |
| --- | --- |
| ```<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>``` | ```md-code__content<br>def remove(extpkg, remove_dependencies=True):<br>    """Removes the extension.<br>    Removes the extension from its installed directory<br>    and clears its configuration.<br>    Args:<br>        extpkg (ExtensionPackage): Extension package to be removed<br>        remove_dependencies (bool): Remove the dependencies as well<br>    Raises:<br>        PyRevitException: on remove error with error message<br>    """<br>    try:<br>        _remove_extpkg(extpkg, remove_dependencies)<br>    except PyRevitPluginRemoveException as remove_err:<br>        mlogger.error('Error removing extension: %s | %s',<br>                      extpkg.name, remove_err)<br>``` |

Back to top

## Charts Engine Overview
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/charts/#pyrevit.coreutils.charts)

# charts

Charts engine for output window.

## Attributes

### `CHARTS_ENGINE = 'Chart.bundle.js'``module-attribute`

### `LINE_CHART = 'line'``module-attribute`

### `BAR_CHART = 'bar'``module-attribute`

### `RADAR_CHART = 'radar'``module-attribute`

### `POLAR_CHART = 'polarArea'``module-attribute`

### `PIE_CHART = 'pie'``module-attribute`

### `DOUGHNUT_CHART = 'doughnut'``module-attribute`

### `BUBBLE_CHART = 'bubble'``module-attribute`

### `CHARTS_JS_PATH = 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/{version}/Chart.min.js'``module-attribute`

### `SCRIPT_TEMPLATE = "var ctx = document.getElementById('{canvas_id}').getContext('2d');var chart = new Chart(ctx, {canvas_code});"``module-attribute`

## Classes

### `PyRevitOutputChartOptions()`

Bases: `object`

Chart options wrapper object.

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>``` | ```md-code__content<br>def __init__(self):<br>    pass<br>``` |

### `PyRevitOutputChartDataset(label)`

Bases: `object`

Chart dataset wrapper object.

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>48<br>49<br>50<br>51<br>``` | ```md-code__content<br>def __init__(self, label):<br>    self.label = label<br>    self.data = []<br>    self.backgroundColor = ''<br>``` |

#### Attributes

##### `label = label``instance-attribute`

##### `data = []``instance-attribute`

##### `backgroundColor = ''``instance-attribute`

#### Functions

##### `set_color(*args)`

Set dataset color.

Arguments are expected to be R, G, B, A values.

Examples:

```md-code__content
dataset_obj.set_color(0xFF, 0x8C, 0x8D, 0.8)

```

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>``` | ````md-code__content<br>def set_color(self, *args):<br>    """Set dataset color.<br>    Arguments are expected to be R, G, B, A values.<br>    Examples:<br>        ```python<br>        dataset_obj.set_color(0xFF, 0x8C, 0x8D, 0.8)<br>        ```<br>    """<br>    if len(args) == 4:<br>        self.backgroundColor = 'rgba({},{},{},{})'.format(args[0],<br>                                                          args[1],<br>                                                          args[2],<br>                                                          args[3])<br>    elif len(args) == 1:<br>        self.backgroundColor = '{}'.format(args[0])<br>```` |

### `PyRevitOutputChartData()`

Bases: `object`

Chart data wrapper object.

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>74<br>75<br>76<br>``` | ```md-code__content<br>def __init__(self):<br>    self.labels = ''<br>    self.datasets = []<br>``` |

#### Attributes

##### `labels = ''``instance-attribute`

##### `datasets = []``instance-attribute`

#### Functions

##### `new_dataset(dataset_label)`

Create new data set.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `dataset_label` | `str` | dataset label | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `PyRevitOutputChartDataset` | dataset wrapper object |

Examples:

```md-code__content
chart.data.new_dataset('set_a')

```

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>94<br>``` | ````md-code__content<br>def new_dataset(self, dataset_label):<br>    """Create new data set.<br>    Args:<br>        dataset_label (str): dataset label<br>    Returns:<br>        (PyRevitOutputChartDataset): dataset wrapper object<br>    Examples:<br>        ```python<br>        chart.data.new_dataset('set_a')<br>        ```<br>    """<br>    new_dataset = PyRevitOutputChartDataset(dataset_label)<br>    self.datasets.append(new_dataset)<br>    return new_dataset<br>```` |

### `PyRevitOutputChart(output, chart_type=LINE_CHART, version=None)`

Bases: `object`

Chart wrapper object for output window.

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `output` | `PyRevitOutputWindow` | output window wrapper object |
| `chart_type` | `str` | chart type name |

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>``` | ```md-code__content<br>def __init__(self, output, chart_type=LINE_CHART, version=None):<br>    self._output = output<br>    self._style = None<br>    self._width = self._height = None<br>    self._version = version or '2.8.0'<br>    self.type = chart_type<br>    self.data = PyRevitOutputChartData()<br>    self.options = PyRevitOutputChartOptions()<br>``` |

#### Attributes

##### `type = chart_type``instance-attribute`

##### `data = PyRevitOutputChartData()``instance-attribute`

##### `options = PyRevitOutputChartOptions()``instance-attribute`

#### Functions

##### `randomize_colors()`

Randomize chart datasets colors.

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>``` | ```md-code__content<br>def randomize_colors(self):<br>    """Randomize chart datasets colors."""<br>    if self.type in [POLAR_CHART, PIE_CHART, DOUGHNUT_CHART]:<br>        for dataset in self.data.datasets:<br>            dataset.backgroundColor = [random_rgba_color()<br>                                       for _ in range(0, len(dataset.data))]<br>    else:<br>        for dataset in self.data.datasets:<br>            dataset.backgroundColor = random_rgba_color()<br>``` |

##### `set_width(width)`

Set chart width on output window.

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>202<br>203<br>204<br>``` | ```md-code__content<br>def set_width(self, width):<br>    """Set chart width on output window."""<br>    self._width = width<br>``` |

##### `set_height(height)`

Set chart height on output window.

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>206<br>207<br>208<br>``` | ```md-code__content<br>def set_height(self, height):<br>    """Set chart height on output window."""<br>    self._height = height<br>``` |

##### `set_style(html_style)`

Set chart styling.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `html_style` | `str` | inline html css styling string | _required_ |

Examples:

```md-code__content
chart.set_style('height:150px')

```

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>``` | ````md-code__content<br>def set_style(self, html_style):<br>    """Set chart styling.<br>    Args:<br>        html_style (str): inline html css styling string<br>    Examples:<br>        ```python<br>        chart.set_style('height:150px')<br>        ```<br>    """<br>    self._style = html_style<br>```` |

##### `draw()`

Request chart to draw itself on output window.

Source code in `pyrevitlib/pyrevit/coreutils/charts.py`

|     |     |
| --- | --- |
| ```<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>``` | ```md-code__content<br>def draw(self):<br>    """Request chart to draw itself on output window."""<br>    self._setup_charts()<br>    # setup canvas<br>    canvas_id = self._make_canvas_unique_id()<br>    canvas_code = self._make_canvas_code(canvas_id)<br>    self._output.print_html(canvas_code)<br>    # make the code<br>    js_code = self._make_charts_script(canvas_id)<br>    self._output.inject_script(js_code, body=True)<br>``` |

## Functions

Back to top

## PyRevit Unit Tests
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/unittests/runner/#pyrevit.unittests.runner)

# runner

Unit tests facility.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `DEBUG_OKAY_RESULT = 'PASSED'``module-attribute`

### `DEBUG_FAIL_RESULT = 'FAILED'``module-attribute`

### `RESULT_TEST_SUITE_START = '<div class="unittest unitteststart">Test Suite: {suite}</div>'``module-attribute`

### `RESULT_DIV_OKAY = '<div class="unittest unittestokay">:white_heavy_check_mark: PASSED {test}</div>'``module-attribute`

### `RESULT_DIV_FAIL = '<div class="unittest unittestfail">:cross_mark: FAILED {test}</div>'``module-attribute`

### `RESULT_DIV_ERROR = '<div class="unittest unittesterror">:heavy_large_circle: ERROR {test}</div>'``module-attribute`

## Classes

### `OutputWriter()`

Output writer for tests results.

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>35<br>36<br>``` | ```md-code__content<br>def __init__(self):<br>    self._output = get_output()<br>``` |

#### Functions

##### `write(output_str)`

Prints the results to the output window.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `output_str` | `str` | Text to output | _required_ |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>``` | ```md-code__content<br>def write(self, output_str):<br>    """Prints the results to the output window.<br>    Args:<br>        output_str (str): Text to output<br>    """<br>    self._output.print_html(output_str)<br>``` |

### `PyRevitTestResult(verbosity)`

Bases: `TestResult`

Pyrevit Test Result.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `verbosity` | `int` | verbosity level. | _required_ |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>53<br>54<br>55<br>``` | ```md-code__content<br>def __init__(self, verbosity):<br>    super(PyRevitTestResult, self).__init__(verbosity=verbosity)<br>    self.writer = OutputWriter()<br>``` |

#### Attributes

##### `writer = OutputWriter()``instance-attribute`

#### Functions

##### `getDescription(test)``staticmethod`

Returns the description of the test.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `test` | `TestCase` | Unit test. | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | test description |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>``` | ```md-code__content<br>@staticmethod<br>def getDescription(test):<br>    """Returns the description of the test.<br>    Args:<br>        test (TestCase): Unit test.<br>    Returns:<br>        (str): test description<br>    """<br>    return test.shortDescription() or test<br>``` |

##### `startTest(test)`

Starts the test.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `test` | `TestCase` | unit test | _required_ |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>``` | ```md-code__content<br>def startTest(self, test):<br>    """Starts the test.<br>    Args:<br>        test (TestCase): unit test<br>    """<br>    super(PyRevitTestResult, self).startTest(test)<br>    mlogger.debug('Running test: %s', self.getDescription(test))<br>``` |

##### `addSuccess(test)`

Adds a test success.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `test` | `TestCase` | unit test case | _required_ |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>``` | ```md-code__content<br>def addSuccess(self, test):<br>    """Adds a test success.<br>    Args:<br>        test (TestCase): unit test case<br>    """<br>    super(PyRevitTestResult, self).addSuccess(test)<br>    mlogger.debug(DEBUG_OKAY_RESULT)<br>    self.writer.write(RESULT_DIV_OKAY<br>                      .format(test=self.getDescription(test)))<br>``` |

##### `addError(test, err)`

Adds a test error.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `test` | `TestCase` | unit test case | _required_ |
| `err` | `OptExcInfo` | test exception info | _required_ |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>89<br>90<br>91<br>92<br>93<br>94<br>95<br>96<br>97<br>98<br>99<br>``` | ```md-code__content<br>def addError(self, test, err):<br>    """Adds a test error.<br>    Args:<br>        test (TestCase): unit test case<br>        err (OptExcInfo): test exception info<br>    """<br>    super(PyRevitTestResult, self).addError(test, err)<br>    mlogger.debug(DEBUG_FAIL_RESULT)<br>    self.writer.write(RESULT_DIV_ERROR<br>                      .format(test=self.getDescription(test)))<br>``` |

##### `addFailure(test, err)`

Adds a test failure.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `test` | `TestCase` | unit test case | _required_ |
| `err` | `OptExcInfo` | test exception info | _required_ |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>``` | ```md-code__content<br>def addFailure(self, test, err):<br>    """Adds a test failure.<br>    Args:<br>        test (TestCase): unit test case<br>        err (OptExcInfo): test exception info<br>    """<br>    super(PyRevitTestResult, self).addFailure(test, err)<br>    mlogger.debug(DEBUG_FAIL_RESULT)<br>    self.writer.write(RESULT_DIV_FAIL<br>                      .format(test=self.getDescription(test)))<br>``` |

### `PyRevitTestRunner(verbosity=1, failfast=False, use_buffer=False, resultclass=None)`

Bases: `object`

Test runner.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `verbosity` | `int` | level of vermosity. Defaults to 1. | `1` |
| `failfast` | `bool` | if True, stops at the first failure. Defaults to False. | `False` |
| `use_buffer` | `bool` | use a buffer. Defaults to False. | `False` |
| `resultclass` | `type` | Class to use to hold the results. <br>Defaults to `PyRevitTestResult`. | `None` |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>``` | ```md-code__content<br>def __init__(self, verbosity=1, failfast=False,<br>             use_buffer=False, resultclass=None):<br>    self.verbosity = verbosity<br>    self.failfast = failfast<br>    self.use_buffer = use_buffer<br>    if resultclass is not None:<br>        self.resultclass = resultclass<br>``` |

#### Attributes

##### `resultclass = PyRevitTestResult``class-attribute``instance-attribute`

##### `verbosity = verbosity``instance-attribute`

##### `failfast = failfast``instance-attribute`

##### `use_buffer = use_buffer``instance-attribute`

#### Functions

##### `run(test)`

Runs a test suite.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `test` | `TestSuite` | Test suite to run | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `PyRevitTestResult` | Test suite results. |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>``` | ```md-code__content<br>def run(self, test):<br>    """Runs a test suite.<br>    Args:<br>        test (TestSuite): Test suite to run<br>    Returns:<br>        (PyRevitTestResult): Test suite results.<br>    """<br>    # setup results object<br>    result = self._make_result()<br>    result.failfast = self.failfast<br>    result.buffer = self.use_buffer<br>    # start clock<br>    start_time = time.time()<br>    # find run test methods<br>    start_test_run = getattr(result, 'startTestRun', None)<br>    if start_test_run is not None:<br>        start_test_run()<br>    try:<br>        test(result)<br>    finally:<br>        stop_test_run = getattr(result, 'stopTestRun', None)<br>        if stop_test_run is not None:<br>            stop_test_run()<br>    # stop clock and calculate run time<br>    stop_time = time.time()<br>    time_taken = stop_time - start_time<br>    # print errots<br>    result.printErrors()<br>    test_count = result.testsRun<br>    mlogger.debug("Ran %d test%s in %.3fs",<br>                  test_count, test_count != 1 and "s" or "", time_taken)<br>    expected_fails = unexpected_successes = skipped = 0<br>    try:<br>        results = map(len, (result.expectedFailures,<br>                            result.unexpectedSuccesses,<br>                            result.skipped))<br>    except AttributeError:<br>        pass<br>    else:<br>        expected_fails, unexpected_successes, skipped = results<br>    infos = []<br>    if not result.wasSuccessful():<br>        mlogger.debug("FAILED")<br>        failed, errored = map(len, (result.failures, result.errors))<br>        if failed:<br>            infos.append("failures=%d" % failed)<br>        if errored:<br>            infos.append("errors=%d" % errored)<br>    else:<br>        mlogger.debug(DEBUG_OKAY_RESULT)<br>    if skipped:<br>        infos.append("skipped=%d" % skipped)<br>    if expected_fails:<br>        infos.append("expected failures=%d" % expected_fails)<br>    if unexpected_successes:<br>        infos.append("unexpected successes=%d" % unexpected_successes)<br>    if infos:<br>        mlogger.debug(" (%s)", (", ".join(infos),))<br>    return result<br>``` |

## Functions

### `run_module_tests(test_module)`

Runs the unit tests of the given module.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `test_module` | `module` | module with tests | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `PyRevitTestResult` | tests results. |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>``` | ```md-code__content<br>def run_module_tests(test_module):<br>    """Runs the unit tests of the given module.<br>    Args:<br>        test_module (module): module with tests<br>    Returns:<br>        (PyRevitTestResult): tests results.<br>    """<br>    test_runner = PyRevitTestRunner()<br>    test_loader = TestLoader()<br>    # load all testcases from the given module into a testsuite<br>    test_suite = test_loader.loadTestsFromModule(test_module)<br>    # run the test suite<br>    mlogger.debug('Running test suite for module: %s', test_module)<br>    OutputWriter()\<br>        .write(RESULT_TEST_SUITE_START.format(suite=test_module.__name__))<br>    return test_runner.run(test_suite)<br>``` |

### `run_test_case(test_case)`

Runs the unit test of the given TestCase class.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `test_case` | `type[TestCase]` | TestCase class with tests | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `PyRevitTestResult` | tests results. |

Source code in `pyrevitlib/pyrevit/unittests/runner.py`

|     |     |
| --- | --- |
| ```<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>``` | ```md-code__content<br>def run_test_case(test_case):<br>    """Runs the unit test of the given TestCase class.<br>    Args:<br>        test_case (type[TestCase]): TestCase class with tests<br>    Returns:<br>        (PyRevitTestResult): tests results.<br>    """<br>    test_runner = PyRevitTestRunner()<br>    suite = TestLoader().loadTestsFromTestCase(test_case)<br>    OutputWriter()\<br>        .write(RESULT_TEST_SUITE_START.format(suite=suite.__class__.__name__))<br>    return test_runner.run(suite)<br>``` |

Back to top

## PyRevit Upgrade Functions
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/versionmgr/upgrade/#pyrevit.versionmgr.upgrade)

# upgrade

Perform upgrades between version, e.g. adding a new config parameter.

## Functions

### `upgrade_user_config(user_config)`

Upgarde user configurations.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `user_config` |  | obj: `pyrevit.userconfig.PyRevitConfig`): config object | _required_ |

Source code in `pyrevitlib/pyrevit/versionmgr/upgrade.py`

|     |     |
| --- | --- |
| ```<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>``` | ```md-code__content<br>def upgrade_user_config(user_config):   #pylint: disable=W0613<br>    """Upgarde user configurations.<br>    Args:<br>        user_config (:obj:`pyrevit.userconfig.PyRevitConfig`): config object<br>    """<br>    # upgrade value formats<br>    for section in user_config:<br>        for option in section:<br>            setattr(section, option, getattr(section, option))<br>``` |

### `remove_leftover_temp_files()`

4.8.5 had a bug that would create temp files with extension ..bak.

This cleans them up.

Source code in `pyrevitlib/pyrevit/versionmgr/upgrade.py`

|     |     |
| --- | --- |
| ```<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>``` | ```md-code__content<br>def remove_leftover_temp_files():<br>    """4.8.5 had a bug that would create temp files with extension ..bak.<br>    This cleans them up.<br>    """<br>    univ_path = op.dirname(appdata.get_universal_data_file("X", 'bak'))<br>    if op.exists(univ_path):<br>        for entry in os.listdir(univ_path):<br>            if op.isfile(entry) and entry.lower().endswith('..bak'):<br>                appdata.garbage_data_file(op.join(univ_path, entry))<br>``` |

### `upgrade_existing_pyrevit()`

Upgrade existing pyRevit deployment.

Source code in `pyrevitlib/pyrevit/versionmgr/upgrade.py`

|     |     |
| --- | --- |
| ```<br>33<br>34<br>35<br>``` | ```md-code__content<br>def upgrade_existing_pyrevit():<br>    """Upgrade existing pyRevit deployment."""<br>    remove_leftover_temp_files()<br>``` |

Back to top

## Extension Manager
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/extensionmgr/#pyrevit.extensions.extensionmgr)

# extensionmgr

Find, parse and cache extensions.

There are two types of extensions: UI Extensions (components.Extension) and
Library Extensions (components.LibraryExtension).

This module, finds the ui extensions installed and parses their directory for
tools or loads them from cache. It also finds the library extensions and adds
their directory address to the ui extensions so the python tools can use
the shared libraries.

To do its job correctly, this module needs to communicate with
pyrevit.userconfig to get a list of user extension folder and also
pyrevit.extensions.extpackages to check whether an extension is active or not.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Classes

## Functions

### `get_thirdparty_extension_data()`

Returns all installed and active UI and Library extensions (not parsed).

Returns:

| Type | Description |
| --- | --- |
| `list` | list of components.Extension or components.LibraryExtension |

Source code in `pyrevitlib/pyrevit/extensions/extensionmgr.py`

|     |     |
| --- | --- |
| ```<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>``` | ```md-code__content<br>def get_thirdparty_extension_data():<br>    """Returns all installed and active UI and Library extensions (not parsed).<br>    Returns:<br>        (list): list of components.Extension or components.LibraryExtension<br>    """<br>    # FIXME: reorganzie this code to use one single method to collect<br>    # extension data for both lib and ui<br>    ext_data_list = []<br>    for root_dir in user_config.get_thirdparty_ext_root_dirs():<br>        ext_data_list.extend(<br>            [ui_ext for ui_ext in parse_dir_for_ext_type(root_dir,<br>                                                         Extension)])<br>        ext_data_list.extend(<br>            [lib_ext for lib_ext in parse_dir_for_ext_type(root_dir,<br>                                                           LibraryExtension)])<br>    return _remove_disabled_extensions(ext_data_list)<br>``` |

### `get_installed_lib_extensions(root_dir)`

Returns all the installed and active Library extensions (not parsed).

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `root_dir` | `str` | Extensions directory address | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[LibraryExtension]` | list of components.LibraryExtension objects |

Source code in `pyrevitlib/pyrevit/extensions/extensionmgr.py`

|     |     |
| --- | --- |
| ```<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>``` | ```md-code__content<br>def get_installed_lib_extensions(root_dir):<br>    """Returns all the installed and active Library extensions (not parsed).<br>    Args:<br>        root_dir (str): Extensions directory address<br>    Returns:<br>        (list[LibraryExtension]): list of components.LibraryExtension objects<br>    """<br>    lib_ext_list = \<br>        [lib_ext for lib_ext in parse_dir_for_ext_type(root_dir,<br>                                                       LibraryExtension)]<br>    return _remove_disabled_extensions(lib_ext_list)<br>``` |

### `get_installed_ui_extensions()`

Returns all UI extensions (fully parsed) under the given directory.

This will also process the Library extensions and will add
their path to the syspath of the UI extensions.

Returns:

| Type | Description |
| --- | --- |
| `list[Extension]` | list of components.Extension objects |

Source code in `pyrevitlib/pyrevit/extensions/extensionmgr.py`

|     |     |
| --- | --- |
| ```<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>``` | ```md-code__content<br>def get_installed_ui_extensions():<br>    """Returns all UI extensions (fully parsed) under the given directory.<br>    This will also process the Library extensions and will add<br>    their path to the syspath of the UI extensions.<br>    Returns:<br>        (list[Extension]): list of components.Extension objects<br>    """<br>    ui_ext_list = []<br>    lib_ext_list = []<br>    # get a list of all directories that could include extensions<br>    ext_search_dirs = user_config.get_ext_root_dirs()<br>    mlogger.debug('Extension Directories: %s', ext_search_dirs)<br>    # collect all library extensions. Their dir paths need to be added<br>    # to sys.path for all commands<br>    for root_dir in ext_search_dirs:<br>        lib_ext_list.extend(get_installed_lib_extensions(root_dir))<br>        # Get a list of all installed extensions in this directory<br>        # _parser.parse_dir_for_ext_type() returns a list of extensions<br>        # in given directory<br>    for root_dir in ext_search_dirs:<br>        for ext_info in parse_dir_for_ext_type(root_dir, Extension):<br>            # test if cache is valid for this ui_extension<br>            # it might seem unusual to create a ui_extension and then<br>            # re-load it from cache but minimum information about the<br>            # ui_extension needs to be passed to the cache module for proper<br>            # hash calculation and ui_extension recovery. at this point<br>            # `ui_extension` does not include any sub-components<br>            # (e.g, tabs, panels, etc) ui_extension object is very small and<br>            # its creation doesn't add much overhead.<br>            if _is_extension_enabled(ext_info):<br>                ui_extension = _parse_or_cache(ext_info)<br>                ui_ext_list.append(ui_extension)<br>            else:<br>                mlogger.debug('Skipping disabled ui extension: %s',<br>                             ext_info.name)<br>    # update extension master syspaths with standard pyrevit lib paths and<br>    # lib address of other lib extensions (to support extensions that provide<br>    # library only to be used by other extensions)<br>    # all other lib paths internal to the extension and tool bundles have<br>    # already been set inside the extension bundles and will take precedence<br>    # over paths added by this method (they're the first paths added to the<br>    # search paths list, and these paths will follow)<br>    for ui_extension in ui_ext_list:<br>        _update_extension_search_paths(<br>            ui_extension,<br>            lib_ext_list,<br>            [MAIN_LIB_DIR, MISC_LIB_DIR]<br>            )<br>    return ui_ext_list<br>``` |

Back to top

## pyRevit Git Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/git/#pyrevit.coreutils.git)

# git

LibGit2Sharp wrapper module for pyRevit.

Documentation

https://github.com/libgit2/libgit2sharp/wiki

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `GIT_LIB = 'LibGit2Sharp'``module-attribute`

### `LIBGIT_DLL = framework.get_dll_file(GIT_LIB)``module-attribute`

## Classes

### `PyRevitGitAuthenticationError`

Bases: `PyRevitException`

Git authentication error.

#### Attributes

##### `msg``property`

Return exception message.

### `RepoInfo(repo)`

Bases: `object`

Repo wrapper for passing around repository information.

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `directory` | `str` | repo directory |
| `name` | `str` | repo name |
| `head_name` | `str` | head branch name |
| `last_commit_hash` | `str` | hash of head commit |
| `repo` | `str` | `LibGit2Sharp.Repository` object |
| `branch` | `str` | current branch name |
| `username` | `str` | credentials - username |
| `password` | `str` | credentials - password |

Source code in `pyrevitlib/pyrevit/coreutils/git.py`

|     |     |
| --- | --- |
| ```<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>``` | ```md-code__content<br>def __init__(self, repo):<br>    self.directory = repo.Info.WorkingDirectory<br>    self.name = op.basename(op.normpath(self.directory))<br>    self.head_name = repo.Head.FriendlyName<br>    self.last_commit_hash = repo.Head.Tip.Id.Sha<br>    self.repo = repo<br>    self.branch = repo.Head.FriendlyName<br>    self.username = self.password = None<br>``` |

#### Attributes

##### `directory = repo.Info.WorkingDirectory``instance-attribute`

##### `name = op.basename(op.normpath(self.directory))``instance-attribute`

##### `head_name = repo.Head.FriendlyName``instance-attribute`

##### `last_commit_hash = repo.Head.Tip.Id.Sha``instance-attribute`

##### `repo = repo``instance-attribute`

##### `branch = repo.Head.FriendlyName``instance-attribute`

##### `username = None``instance-attribute`

##### `password = None``instance-attribute`

## Functions

### `get_repo(repo_dir)`

Return repo object for given git repo directory.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_dir` | `str` | full path of git repo directory | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `RepoInfo` | repo object |

Source code in `pyrevitlib/pyrevit/coreutils/git.py`

|     |     |
| --- | --- |
| ```<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>``` | ```md-code__content<br>def get_repo(repo_dir):<br>    """Return repo object for given git repo directory.<br>    Args:<br>        repo_dir (str): full path of git repo directory<br>    Returns:<br>        (RepoInfo): repo object<br>    """<br>    repo = libgit.Repository(repo_dir)<br>    return RepoInfo(repo)<br>``` |

### `git_pull(repo_info)`

Pull the current head of given repo.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_info` | `RepoInfo` | target repo object | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `RepoInfo` | repo object with updated head |

Source code in `pyrevitlib/pyrevit/coreutils/git.py`

|     |     |
| --- | --- |
| ```<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>``` | ```md-code__content<br>def git_pull(repo_info):<br>    """Pull the current head of given repo.<br>    Args:<br>        repo_info (RepoInfo): target repo object<br>    Returns:<br>        (RepoInfo): repo object with updated head<br>    """<br>    repo = repo_info.repo<br>    try:<br>        libgit.Commands.Pull(repo,<br>                             _make_pull_signature(),<br>                             _make_pull_options(repo_info))<br>        mlogger.debug('Successfully pulled repo: %s', repo_info.directory)<br>        head_msg = safe_strtype(repo.Head.Tip.Message).replace('\n', '')<br>        mlogger.debug('New head is: %s > %s', repo.Head.Tip.Id.Sha, head_msg)<br>        return RepoInfo(repo)<br>    except Exception as pull_err:<br>        mlogger.debug('Failed git pull: %s | %s', repo_info.directory, pull_err)<br>        _process_git_error(pull_err)<br>``` |

### `git_fetch(repo_info)`

Fetch current branch of given repo.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_info` | `RepoInfo` | target repo object | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `RepoInfo` | repo object with updated head |

Source code in `pyrevitlib/pyrevit/coreutils/git.py`

|     |     |
| --- | --- |
| ```<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>``` | ```md-code__content<br>def git_fetch(repo_info):<br>    """Fetch current branch of given repo.<br>    Args:<br>        repo_info (RepoInfo): target repo object<br>    Returns:<br>        (RepoInfo): repo object with updated head<br>    """<br>    repo = repo_info.repo<br>    try:<br>        libgit.Commands.Fetch(repo,<br>                              repo.Head.TrackedBranch.RemoteName,<br>                              [],<br>                              _make_fetch_options(repo_info),<br>                              'fetching pyrevit updates')<br>        mlogger.debug('Successfully pulled repo: %s', repo_info.directory)<br>        head_msg = safe_strtype(repo.Head.Tip.Message).replace('\n', '')<br>        mlogger.debug('New head is: %s > %s', repo.Head.Tip.Id.Sha, head_msg)<br>        return RepoInfo(repo)<br>    except Exception as fetch_err:<br>        mlogger.debug('Failed git fetch: %s | %s',<br>                      repo_info.directory, fetch_err)<br>        _process_git_error(fetch_err)<br>``` |

### `git_clone(repo_url, clone_dir, username=None, password=None)`

Clone git repository to given location.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_url` | `str` | repo .git url | _required_ |
| `clone_dir` | `str` | destination path | _required_ |
| `username` | `str` | credentials - username | `None` |
| `password` | `str` | credentials - password | `None` |

Source code in `pyrevitlib/pyrevit/coreutils/git.py`

|     |     |
| --- | --- |
| ```<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>``` | ```md-code__content<br>def git_clone(repo_url, clone_dir, username=None, password=None):<br>    """Clone git repository to given location.<br>    Args:<br>        repo_url (str): repo .git url<br>        clone_dir (str): destination path<br>        username (str): credentials - username<br>        password (str): credentials - password<br>    """<br>    try:<br>        libgit.Repository.Clone(repo_url,<br>                                clone_dir,<br>                                _make_clone_options(username=username,<br>                                                    password=password))<br>        mlogger.debug('Completed git clone: %s @ %s', repo_url, clone_dir)<br>    except Exception as clone_err:<br>        mlogger.debug('Error cloning repo: %s to %s | %s',<br>                      repo_url, clone_dir, clone_err)<br>        _process_git_error(clone_err)<br>``` |

### `compare_branch_heads(repo_info)`

Compare local and remote branch heads and return ???

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_info` | `RepoInfo` | target repo object | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/git.py`

|     |     |
| --- | --- |
| ```<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>``` | ```md-code__content<br>def compare_branch_heads(repo_info):<br>    """Compare local and remote branch heads and return ???<br>    Args:<br>        repo_info (RepoInfo): target repo object<br>    """<br>    # FIXME: need return type. possibly simplify<br>    repo = repo_info.repo<br>    repo_branches = repo.Branches<br>    mlogger.debug('Repo branches: %s', [b.FriendlyName for b in repo_branches])<br>    for branch in repo_branches:<br>        if branch.FriendlyName == repo_info.branch and not branch.IsRemote:<br>            try:<br>                if branch.TrackedBranch:<br>                    mlogger.debug('Comparing heads: %s of %s',<br>                                  branch.CanonicalName,<br>                                  branch.TrackedBranch.CanonicalName)<br>                    hist_div = repo.ObjectDatabase. \<br>                        CalculateHistoryDivergence(branch.Tip,<br>                                                   branch.TrackedBranch.Tip)<br>                    return hist_div<br>            except Exception as compare_err:<br>                mlogger.error('Can not compare branch %s in repo: %s | %s',<br>                              branch,<br>                              repo,<br>                              safe_strtype(compare_err).replace('\n', ''))<br>        else:<br>            mlogger.debug('Skipping remote branch: %s', branch.CanonicalName)<br>``` |

### `get_all_new_commits(repo_info)`

Fetch and return new commits ahead of current head.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_info` | `RepoInfo` | target repo object | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `OrderedDict[str, str]` | ordered dict of commit hash:message |

Source code in `pyrevitlib/pyrevit/coreutils/git.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>``` | ```md-code__content<br>def get_all_new_commits(repo_info):<br>    """Fetch and return new commits ahead of current head.<br>    Args:<br>        repo_info (RepoInfo): target repo object<br>    Returns:<br>        (OrderedDict[str, str]): ordered dict of commit hash:message<br>    """<br>    repo = repo_info.repo<br>    current_commit = repo_info.last_commit_hash<br>    ref_commit = repo.Lookup(libgit.ObjectId(current_commit),<br>                             libgit.ObjectType.Commit)<br>    # Let's only consider the refs that lead to this commit...<br>    refs = repo.Refs.ReachableFrom([ref_commit])<br>    # ...and create a filter that will retrieve all the commits...<br>    commit_filter = libgit.CommitFilter()<br>    commit_filter.IncludeReachableFrom = refs<br>    commit_filter.ExcludeReachableFrom = ref_commit<br>    commit_filter.SortBy = libgit.CommitSortStrategies.Time<br>    commits = repo.Commits.QueryBy(commit_filter)<br>    commitsdict = OrderedDict()<br>    for commit in commits:<br>        if commit in repo.Head.Commits \<br>                or commit in repo.Head.TrackedBranch.Commits:<br>            commitsdict[commit.Id.ToString()] = commit.MessageShort<br>    return commitsdict<br>``` |

Back to top

## Revit DB Object Wrappers
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/db/#pyrevit.revit.db)

# db

Revit DB objects wrappers.

## Attributes

## Classes

### `BaseWrapper(obj=None)`

Bases: `object`

Base revit databse object wrapper.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>``` | ```md-code__content<br>def __init__(self, obj=None):<br>    self._wrapped = obj<br>``` |

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

### `ElementWrapper(element)`

Bases: `BaseWrapper`

Revit element wrapper.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>62<br>63<br>64<br>65<br>66<br>``` | ```md-code__content<br>def __init__(self, element):<br>    super(ElementWrapper, self).__init__(element)<br>    if not isinstance(self._wrapped, DB.Element):<br>        raise PyRevitException('Can not wrap object that are not '<br>                               'derived from Element.')<br>``` |

#### Attributes

##### `assoc_doc``property`

##### `name``property`

##### `symbol_name``property`

##### `family_name``property`

##### `id``property`

##### `unique_id``property`

##### `workset_id``property`

##### `mark``property`

##### `location``property`

##### `x``property`

##### `y``property`

##### `z``property`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

##### `get_param(param_name)`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>126<br>127<br>``` | ```md-code__content<br>def get_param(self, param_name):<br>    return self._wrapped.LookupParameter(param_name)<br>``` |

##### `safe_get_param(param_name, default=None)`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>129<br>130<br>131<br>132<br>133<br>``` | ```md-code__content<br>def safe_get_param(self, param_name, default=None):<br>    try:<br>        return self._wrapped.LookupParameter(param_name)<br>    except Exception:<br>        return default<br>``` |

### `ExternalRef(link, extref)`

Bases: `ElementWrapper`

External reference wraper.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>138<br>139<br>140<br>``` | ```md-code__content<br>def __init__(self, link, extref):<br>    super(ExternalRef, self).__init__(link)<br>    self._extref = extref<br>``` |

#### Attributes

##### `assoc_doc``property`

##### `symbol_name``property`

##### `family_name``property`

##### `id``property`

##### `unique_id``property`

##### `workset_id``property`

##### `mark``property`

##### `location``property`

##### `x``property`

##### `y``property`

##### `z``property`

##### `name``property`

##### `link``property`

##### `linktype``property`

##### `path``property`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

##### `get_param(param_name)`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>126<br>127<br>``` | ```md-code__content<br>def get_param(self, param_name):<br>    return self._wrapped.LookupParameter(param_name)<br>``` |

##### `safe_get_param(param_name, default=None)`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>129<br>130<br>131<br>132<br>133<br>``` | ```md-code__content<br>def safe_get_param(self, param_name, default=None):<br>    try:<br>        return self._wrapped.LookupParameter(param_name)<br>    except Exception:<br>        return default<br>``` |

##### `reload()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>159<br>160<br>``` | ```md-code__content<br>def reload(self):<br>    return self._wrapped.Reload()<br>``` |

### `ProjectParameter(param_def, param_binding=None, param_ext_def=False)`

Bases: `BaseWrapper`

Project parameter wrapper.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>``` | ```md-code__content<br>def __init__(self, param_def, param_binding=None, param_ext_def=False):<br>    super(ProjectParameter, self).__init__()<br>    self.param_def = param_def<br>    self.param_binding = param_binding<br>    self.param_binding_type = self._determine_binding_type()<br>    self.shared = False<br>    self.param_ext_def = None<br>    self.param_guid = ''<br>    if param_ext_def:<br>        self.shared = True<br>        self.param_ext_def = param_ext_def<br>        self.param_guid = self.param_ext_def.GUID.ToString()<br>    self.name = self.param_def.Name<br>    # Revit <2017 does not have the Id parameter<br>    self.param_id = getattr(self.param_def, 'Id', None)<br>    if HOST_APP.is_exactly(2021):<br>        # Revit >2021 does not have the UnitType property<br>        self.unit_type = self.param_def.GetSpecTypeId()<br>        self.param_type = self.param_def.ParameterType<br>        self.param_group = self.param_def.ParameterGroup<br>    elif HOST_APP.is_newer_than(2022, or_equal=True):<br>        # GetSpecTypeId() Removed in Revit 2022<br>        self.unit_type = self.param_def.GetDataType()<br>        # Revit >2022 does not have the ParameterType property<br>        self.param_type = self.param_def.GetDataType()<br>        # ParameterGroup deprecated<br>        self.param_group = self.param_def.GetGroupTypeId().TypeId<br>    else:<br>        self.unit_type = self.param_def.UnitType<br>        self.param_type = self.param_def.ParameterType<br>        self.param_group = self.param_def.ParameterGroup<br>``` |

#### Attributes

##### `param_def = param_def``instance-attribute`

##### `param_binding = param_binding``instance-attribute`

##### `param_binding_type = self._determine_binding_type()``instance-attribute`

##### `shared = False``instance-attribute`

##### `param_ext_def = None``instance-attribute`

##### `param_guid = ''``instance-attribute`

##### `name = self.param_def.Name``instance-attribute`

##### `param_id = getattr(self.param_def, 'Id', None)``instance-attribute`

##### `unit_type = self.param_def.GetSpecTypeId()``instance-attribute`

##### `param_type = self.param_def.ParameterType``instance-attribute`

##### `param_group = self.param_def.ParameterGroup``instance-attribute`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

### `ProjectInfo(doc)`

Bases: `BaseWrapper`

Project information.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>221<br>222<br>223<br>``` | ```md-code__content<br>def __init__(self, doc):<br>    super(ProjectInfo, self).__init__()<br>    self._doc = doc<br>``` |

#### Attributes

##### `name``property`

##### `number``property`

##### `address``property`

##### `author``property`

##### `building_name``property`

##### `client_name``property`

##### `issue_date``property`

##### `org_name``property`

##### `org_desc``property`

##### `status``property`

##### `location``property`

##### `path``property`

##### `filename``property`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

### `XYZPoint(obj=None)`

Bases: `BaseWrapper`

Wrapper for XYZ point.

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>``` | ```md-code__content<br>def __init__(self, obj=None):<br>    self._wrapped = obj<br>``` |

#### Attributes

##### `x``property`

##### `y``property`

##### `z``property`

#### Functions

##### `unwrap()`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>``` | ```md-code__content<br>def unwrap(self):<br>    return self._wrapped<br>``` |

##### `compare_attr(src, dest, attr_name, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attr(src, dest, attr_name, case_sensitive=False):<br>    if case_sensitive:<br>        return safe_strtype(getattr(src, attr_name, '')).lower() == \<br>               safe_strtype(getattr(dest, attr_name, '')).lower()<br>    else:<br>        return safe_strtype(getattr(src, attr_name)) == \<br>               safe_strtype(getattr(dest, attr_name))<br>``` |

##### `compare_attrs(src, dest, attr_names, case_sensitive=False)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/db/__init__.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>``` | ```md-code__content<br>@staticmethod<br>def compare_attrs(src, dest, attr_names, case_sensitive=False):<br>    return [BaseWrapper.compare_attr(src,<br>                                     dest,<br>                                     x,<br>                                     case_sensitive=case_sensitive)<br>            for x in attr_names]<br>``` |

## Functions

Back to top

## pyRevit Bundle Type Maker
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/bundletypemaker/#pyrevit.runtime.bundletypemaker)

# bundletypemaker

Create necessary compiled types for pyRevit bundles.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

## Functions

### `create_bundle_type(module_builder, type_name, bundle_script, bundle_config_script, bundle_search_paths, bundle_arguments, bundle_help_url, bundle_tooltip, bundle_name, bundle_full_name, bundle_extension_name, bundle_unique_name, bundle_control_id, bundle_context, engine_cfgs)`

Source code in `pyrevitlib/pyrevit/runtime/bundletypemaker.py`

|     |     |
| --- | --- |
| ```<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>``` | ```md-code__content<br>def create_bundle_type(<br>        module_builder,<br>        type_name,<br>        bundle_script,<br>        bundle_config_script,<br>        bundle_search_paths,<br>        bundle_arguments,<br>        bundle_help_url,<br>        bundle_tooltip,<br>        bundle_name,<br>        bundle_full_name,<br>        bundle_extension_name,<br>        bundle_unique_name,<br>        bundle_control_id,<br>        bundle_context,<br>        engine_cfgs,<br>    ):<br>    runtime.create_type(<br>        module_builder,<br>        runtime.CMD_EXECUTOR_TYPE,<br>        type_name,<br>        runtime.create_ext_command_attrs(),<br>        bundle_script,<br>        bundle_config_script,<br>        coreutils.join_strings(bundle_search_paths),<br>        coreutils.join_strings(bundle_arguments),<br>        bundle_help_url,<br>        bundle_tooltip,<br>        bundle_name,<br>        bundle_full_name,<br>        bundle_extension_name,<br>        bundle_unique_name,<br>        bundle_control_id,<br>        bundle_context,<br>        engine_cfgs)<br>``` |

### `create_executor_type(extension, module_builder, cmd_component, eng_cfgs='')`

Source code in `pyrevitlib/pyrevit/runtime/bundletypemaker.py`

|     |     |
| --- | --- |
| ```<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>``` | ```md-code__content<br>def create_executor_type(extension, module_builder, cmd_component, eng_cfgs=''):<br>    mlogger.debug('Creating executor type for: %s', cmd_component)<br>    mlogger.debug('%s uses clean engine: %s',<br>                  cmd_component.name, cmd_component.requires_clean_engine)<br>    mlogger.debug('%s requires Fullframe engine: %s',<br>                  cmd_component.name, cmd_component.requires_fullframe_engine)<br>    mlogger.debug('%s requires Fullframe engine: %s',<br>                  cmd_component.name, cmd_component.requires_fullframe_engine)<br>    create_bundle_type(<br>        module_builder=module_builder,<br>        type_name=cmd_component.unique_name,<br>        bundle_script=cmd_component.script_file or "",<br>        bundle_config_script=cmd_component.config_script_file or "",<br>        bundle_search_paths=cmd_component.module_paths,<br>        bundle_arguments=cmd_component.arguments,<br>        bundle_help_url=cmd_component.help_url or "",<br>        bundle_tooltip=cmd_component.tooltip or "",<br>        bundle_name=cmd_component.name,<br>        bundle_full_name=cmd_component.get_full_bundle_name(),<br>        bundle_extension_name=extension.name,<br>        bundle_unique_name=cmd_component.unique_name,<br>        bundle_control_id=cmd_component.control_id,<br>        bundle_context=cmd_component.context or "",<br>        engine_cfgs=eng_cfgs<br>        )<br>    mlogger.debug('Successfully created executor type for: %s', cmd_component)<br>``` |

### `create_selection_avail_type(module_builder, cmd_component)`

Source code in `pyrevitlib/pyrevit/runtime/bundletypemaker.py`

|     |     |
| --- | --- |
| ```<br>80<br>81<br>82<br>83<br>84<br>85<br>``` | ```md-code__content<br>def create_selection_avail_type(module_builder, cmd_component):<br>    runtime.create_type(module_builder,<br>                        runtime.CMD_AVAIL_TYPE_SELECTION,<br>                        cmd_component.avail_class_name,<br>                        [],<br>                        cmd_component.context)<br>``` |

### `create_zerodoc_avail_type(module_builder, cmd_component)`

Source code in `pyrevitlib/pyrevit/runtime/bundletypemaker.py`

|     |     |
| --- | --- |
| ```<br>88<br>89<br>90<br>91<br>92<br>``` | ```md-code__content<br>def create_zerodoc_avail_type(module_builder, cmd_component):<br>    runtime.create_type(module_builder,<br>                        runtime.CMD_AVAIL_TYPE_ZERODOC,<br>                        cmd_component.avail_class_name,<br>                        [])<br>``` |

### `create_extended_avail_type(module_builder, cmd_component)`

Source code in `pyrevitlib/pyrevit/runtime/bundletypemaker.py`

|     |     |
| --- | --- |
| ```<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>``` | ```md-code__content<br>def create_extended_avail_type(module_builder, cmd_component):<br>    runtime.create_type(module_builder,<br>                        runtime.CMD_AVAIL_TYPE_EXTENDED,<br>                        cmd_component.avail_class_name,<br>                        [],<br>                        cmd_component.context)<br>``` |

Back to top

## pyRevit Project Information
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/versionmgr/about/#pyrevit.versionmgr.about)

# about

Utility module for pyRevit project information.

Examples:

```md-code__content
from pyrevit.versionmgr import about
a = about.get_pyrevit_about()
a.subtitle

```

'python RAD Environment for Autodesk Revit®'a.copyright'© 2014-2025 Ehsan Iran-Nejad'

## Attributes

### `PyRevitAbout = namedtuple('PyRevitAbout', ['subtitle', 'madein', 'copyright'])``module-attribute`

pyRevit project info tuple.

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `subtitle` | `str` | project subtitle |
| `madein` | `str` | project made-in info |
| `copyright` | `str` | project copyright info |

## Functions

### `get_pyrevit_about()`

Return information about pyRevit project.

Returns:

| Type | Description |
| --- | --- |
| `PyRevitAbout` | pyRevit project info tuple |

Source code in `pyrevitlib/pyrevit/versionmgr/about.py`

|     |     |
| --- | --- |
| ```<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>``` | ```md-code__content<br>def get_pyrevit_about():<br>    """Return information about pyRevit project.<br>    Returns:<br>        (PyRevitAbout): pyRevit project info tuple<br>    """<br>    return PyRevitAbout(subtitle='python RAD Environment for Autodesk Revit®',<br>                        madein="['pdx', 'hio', 'rno', 'sea']",<br>                        copyright='© 2014-2025 Ehsan Iran-Nejad')<br>``` |

Back to top

## Preflight Test Case
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/preflight/case/#pyrevit.preflight.case)

# case

Base Preflight test class that defines the minimum interface.

## Classes

### `PreflightTestCase`

Bases: `object`

Base class for preflight tests.

#### Functions

##### `setUp(doc, output)`

Hook method for setting up the test before exercising it.

Source code in `pyrevitlib/pyrevit/preflight/case.py`

|     |     |
| --- | --- |
| ```<br> 8<br> 9<br>10<br>``` | ```md-code__content<br>def setUp(self, doc, output):<br>    """Hook method for setting up the test before exercising it."""<br>    pass<br>``` |

##### `startTest(doc, output)`

Hook method for exercising the test.

Source code in `pyrevitlib/pyrevit/preflight/case.py`

|     |     |
| --- | --- |
| ```<br>12<br>13<br>14<br>``` | ```md-code__content<br>def startTest(self, doc, output):<br>    """Hook method for exercising the test."""<br>    pass<br>``` |

##### `tearDown(doc, output)`

Hook method for deconstructing the test after testing it.

Source code in `pyrevitlib/pyrevit/preflight/case.py`

|     |     |
| --- | --- |
| ```<br>16<br>17<br>18<br>``` | ```md-code__content<br>def tearDown(self, doc, output):<br>    """Hook method for deconstructing the test after testing it."""<br>    pass<br>``` |

##### `doCleanups(doc, output)`

Execute all cleanup functions. Normally called after tearDown.

Source code in `pyrevitlib/pyrevit/preflight/case.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>22<br>``` | ```md-code__content<br>def doCleanups(self, doc, output):<br>    """Execute all cleanup functions. Normally called after tearDown."""<br>    pass<br>``` |

Back to top

## Assembly Maker Module
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/loader/asmmaker/#pyrevit.loader.asmmaker)

# asmmaker

Assembly maker module.

## Attributes

### `ExtensionAssemblyInfo = namedtuple('ExtensionAssemblyInfo', ['name', 'location', 'reloading'])``module-attribute`

### `mlogger = logger.get_logger(__name__)``module-attribute`

## Functions

### `create_assembly(extension)`

Create an extension assembly.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extension` | `Extension` | pyRevit extension. | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `ExtensionAssemblyInfo` | assembly info |

Source code in `pyrevitlib/pyrevit/loader/asmmaker.py`

|     |     |
| --- | --- |
| ```<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>``` | ```md-code__content<br>def create_assembly(extension):<br>    """Create an extension assembly.<br>    Args:<br>        extension (pyrevit.extensions.components.Extension): pyRevit extension.<br>    Returns:<br>        (ExtensionAssemblyInfo): assembly info<br>    """<br>    mlogger.debug('Creating assembly for extension: %s', extension.name)<br>    # create assembly file and return assembly path to be used in UI creation<br>    # try:<br>    ext_asm_info = _produce_asm_file(extension)<br>    mlogger.debug('Assembly created: %s', ext_asm_info)<br>    return ext_asm_info<br>``` |

### `cleanup_assembly_files()`

Source code in `pyrevitlib/pyrevit/loader/asmmaker.py`

|     |     |
| --- | --- |
| ```<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>``` | ```md-code__content<br>def cleanup_assembly_files():<br>    if coreutils.get_revit_instance_count() == 1:<br>        for asm_file_path in appdata.list_data_files(file_ext='dll'):<br>            if not assmutils.find_loaded_asm(asm_file_path, by_location=True):<br>                appdata.garbage_data_file(asm_file_path)<br>                asm_log_file = asm_file_path.replace('.dll', '.log')<br>                if op.exists(asm_log_file):<br>                    appdata.garbage_data_file(asm_log_file)<br>``` |

Back to top

## YamlDotNet Wrapper
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/yaml/#pyrevit.coreutils.yaml)

# yaml

Wrapper for YamlDotNet.

## Attributes

## Functions

### `load(yaml_file)`

Load Yaml file into YamlDotNet object.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `yaml_file` | `str` | file path to yaml file | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `YamlMappingNode` | yaml node |

Source code in `pyrevitlib/pyrevit/coreutils/yaml.py`

|     |     |
| --- | --- |
| ```<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>``` | ```md-code__content<br>def load(yaml_file):<br>    """Load Yaml file into YamlDotNet object.<br>    Args:<br>        yaml_file (str): file path to yaml file<br>    Returns:<br>        (YamlDotNet.RepresentationModel.YamlMappingNode): yaml node<br>    """<br>    if PY3:<br>        with open(yaml_file, 'r', encoding="utf8") as yamlfile:<br>            yamlstr = libyaml.RepresentationModel.YamlStream()<br>            yamldata = yamlfile.read()<br>            yamlstr.Load(StringReader(yamldata))<br>            if yamlstr.Documents.Count >= 1:<br>                return yamlstr.Documents[0].RootNode<br>    else:<br>        with open(yaml_file, 'r') as yamlfile:<br>            yamlstr = libyaml.RepresentationModel.YamlStream()<br>            yamldata = yamlfile.read().decode('utf-8')<br>            yamlstr.Load(StringReader(yamldata))<br>            if yamlstr.Documents.Count >= 1:<br>                return yamlstr.Documents[0].RootNode<br>``` |

### `load_as_dict(yaml_file)`

Load Yaml file into python dict object.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `yaml_file` | `str` | file path to yaml file | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `dict[str, Any]` | dictionary representing yaml data |

Source code in `pyrevitlib/pyrevit/coreutils/yaml.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>``` | ```md-code__content<br>def load_as_dict(yaml_file):<br>    """Load Yaml file into python dict object.<br>    Args:<br>        yaml_file (str): file path to yaml file<br>    Returns:<br>        (dict[str, Any]): dictionary representing yaml data<br>    """<br>    return _convert_yamldotnet_to_dict(load(yaml_file))<br>``` |

### `dump_dict(dict_object, yaml_file)`

Save YamlDotNet object to Yaml file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `dict_object` | `dict` | dict object to be serialized into yaml | _required_ |
| `yaml_file` | `str` | file path to yaml file | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/yaml.py`

|     |     |
| --- | --- |
| ```<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>``` | ```md-code__content<br>def dump_dict(dict_object, yaml_file):<br>    """Save YamlDotNet object to Yaml file.<br>    Args:<br>        dict_object (dict): dict object to be serialized into yaml<br>        yaml_file (str): file path to yaml file<br>    """<br>    ybuilder = libyaml.Serialization.SerializerBuilder().Build()<br>    serialized_yaml = ybuilder.Serialize(dict_object)<br>    with codecs.open(yaml_file, 'w', 'utf-8') as yamlfile:<br>        yamlfile.write(serialized_yaml.replace('\r\n', '\n'))<br>``` |

Back to top

## pyRevit AppData Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/appdata/#pyrevit.coreutils.appdata)

# appdata

Utility functions for creating data files within pyRevit environment.

Most times, scripts need to save some data to share between different scripts
that work on a similar topic or between script executions. This module provides
the necessary and consistent mechanism for creating and maintaining such files.

Examples:

```md-code__content
from pyrevit.coreutils import appdata
appdata.list_data_files()

```

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `TEMP_FILE_EXT = 'tmp'``module-attribute`

## Functions

### `get_universal_data_file(file_id, file_ext, name_only=False)`

Get path to file that is shared between all host versions.

These data files are not cleaned up at Revit restart.
e.g pyrevit\_pyrevitlabs\_file\_id.file\_ext

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_id` | `str` | Unique identifier for the file | _required_ |
| `file_ext` | `str` | File extension | _required_ |
| `name_only` | `bool` | If true, function returns file name only | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | File name or full file path (depending on name\_only) |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>``` | ```md-code__content<br>def get_universal_data_file(file_id, file_ext, name_only=False):<br>    """Get path to file that is shared between all host versions.<br>    These data files are not cleaned up at Revit restart.<br>    e.g pyrevit_pyrevitlabs_file_id.file_ext<br>    Args:<br>        file_id (str): Unique identifier for the file<br>        file_ext (str): File extension<br>        name_only (bool): If true, function returns file name only<br>    Returns:<br>        (str): File name or full file path (depending on name_only)<br>    """<br>    return _get_app_file(file_id, file_ext,<br>                         filename_only=name_only, universal=True)<br>``` |

### `get_data_file(file_id, file_ext, name_only=False)`

Get path to file that will not be cleaned up at Revit load.

e.g pyrevit\_2016\_pyrevitlabs\_file\_id.file\_ext

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_id` | `str` | Unique identifier for the file | _required_ |
| `file_ext` | `str` | File extension | _required_ |
| `name_only` | `bool` | If true, function returns file name only | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | File name or full file path (depending on name\_only) |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>``` | ```md-code__content<br>def get_data_file(file_id, file_ext, name_only=False):<br>    """Get path to file that will not be cleaned up at Revit load.<br>    e.g pyrevit_2016_pyrevitlabs_file_id.file_ext<br>    Args:<br>        file_id (str): Unique identifier for the file<br>        file_ext (str): File extension<br>        name_only (bool): If true, function returns file name only<br>    Returns:<br>        (str): File name or full file path (depending on name_only)<br>    """<br>    return _get_app_file(file_id, file_ext, filename_only=name_only)<br>``` |

### `get_instance_data_file(file_id, file_ext=TEMP_FILE_EXT, name_only=False)`

Get path to file that should be used by current instance only.

These data files will be cleaned up at Revit restart.
e.g pyrevit\_2016\_pyrevitlabs\_2353\_file\_id.file\_ext

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_id` | `str` | Unique identifier for the file | _required_ |
| `file_ext` | `str` | File extension | `TEMP_FILE_EXT` |
| `name_only` | `bool` | If true, function returns file name only | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str` | File name or full file path (depending on name\_only) |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>``` | ```md-code__content<br>def get_instance_data_file(file_id, file_ext=TEMP_FILE_EXT, name_only=False):<br>    """Get path to file that should be used by current instance only.<br>    These data files will be cleaned up at Revit restart.<br>    e.g pyrevit_2016_pyrevitlabs_2353_file_id.file_ext<br>    Args:<br>        file_id (str): Unique identifier for the file<br>        file_ext (str): File extension<br>        name_only (bool): If true, function returns file name only<br>    Returns:<br>        (str): File name or full file path (depending on name_only)<br>    """<br>    return _get_app_file(file_id, file_ext,<br>                         filename_only=name_only, stamped=True)<br>``` |

### `is_pyrevit_data_file(file_name)`

Check if given file is a pyRevit data file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_name` | `str` | file name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if file is a pyRevit data file |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>``` | ```md-code__content<br>def is_pyrevit_data_file(file_name):<br>    """Check if given file is a pyRevit data file.<br>    Args:<br>        file_name (str): file name<br>    Returns:<br>        (bool): True if file is a pyRevit data file<br>    """<br>    return pyrevit.PYREVIT_FILE_PREFIX in file_name<br>``` |

### `is_file_available(file_name, file_ext, universal=False)`

Check if given file is available within appdata directory.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_name` | `str` | file name | _required_ |
| `file_ext` | `str` | file extension | _required_ |
| `universal` | `bool` | Check against universal data files | `False` |

Returns:

| Type | Description |
| --- | --- |
| `str | bool` | file path if file is available |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>``` | ```md-code__content<br>def is_file_available(file_name, file_ext, universal=False):<br>    """Check if given file is available within appdata directory.<br>    Args:<br>        file_name (str): file name<br>        file_ext (str): file extension<br>        universal (bool): Check against universal data files<br>    Returns:<br>        (str | bool): file path if file is available<br>    """<br>    if universal:<br>        full_filename = op.join(<br>            pyrevit.PYREVIT_APP_DIR,<br>            coreutils.make_canonical_name(file_name, file_ext))<br>    else:<br>        full_filename = op.join(<br>            pyrevit.PYREVIT_VERSION_APP_DIR,<br>            coreutils.make_canonical_name(file_name, file_ext))<br>    if op.exists(full_filename):<br>        return full_filename<br>    else:<br>        return False<br>``` |

### `is_data_file_available(file_id, file_ext)`

Check if given file is available within appdata directory.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_id` | `str` | data file id | _required_ |
| `file_ext` | `str` | file extension | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | file path if file is available |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>``` | ```md-code__content<br>def is_data_file_available(file_id, file_ext):<br>    """Check if given file is available within appdata directory.<br>    Args:<br>        file_id (str): data file id<br>        file_ext (str): file extension<br>    Returns:<br>        (str): file path if file is available<br>    """<br>    full_filename = _get_app_file(file_id, file_ext)<br>    if op.exists(full_filename):<br>        return full_filename<br>    else:<br>        return False<br>``` |

### `list_data_files(file_ext, universal=False)`

List all data files with given extension.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_ext` | `str` | file extension | _required_ |
| `universal` | `bool` | Check against universal data files | `False` |

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | list of files |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>``` | ```md-code__content<br>def list_data_files(file_ext, universal=False):<br>    """List all data files with given extension.<br>    Args:<br>        file_ext (str): file extension<br>        universal (bool): Check against universal data files<br>    Returns:<br>        (list[str]): list of files<br>    """<br>    return _list_app_files(<br>        pyrevit.PYREVIT_FILE_PREFIX,<br>        file_ext,<br>        universal=universal<br>        )<br>``` |

### `list_instance_data_files(file_ext)`

List all data files associated with current session.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_ext` | `str` | data files with this extension will be listed only. | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | list of data files |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>248<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>``` | ```md-code__content<br>def list_instance_data_files(file_ext):<br>    """List all data files associated with current session.<br>    Args:<br>        file_ext (str): data files with this extension will be listed only.<br>    Returns:<br>        (list[str]): list of data files<br>    """<br>    return _list_app_files(pyrevit.PYREVIT_FILE_PREFIX_STAMPED, file_ext)<br>``` |

### `find_data_files(file_ext)`

Find data files in all data files directories.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_ext` | `str` | data files with this extension will be listed only | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | list of files |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>``` | ```md-code__content<br>def find_data_files(file_ext):<br>    """Find data files in all data files directories.<br>    Args:<br>        file_ext (str): data files with this extension will be listed only<br>    Returns:<br>        (list[str]): list of files<br>    """<br>    all_datafiles = set()<br>    for app_folder in _list_app_folders():<br>        for appdata_file in os.listdir(app_folder):<br>            file_naming_dict = _match_file(<br>                op.basename(appdata_file)<br>            )<br>            if file_naming_dict \<br>                    and file_naming_dict['fname'].endswith(file_ext):<br>                all_datafiles.add(<br>                    op.join(app_folder, appdata_file)<br>                    )<br>    return all_datafiles<br>``` |

### `find_instance_data_files(file_ext, instance_id)`

Find instance data files in all data files directories.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_ext` | `str` | data files with this extension will be listed only | _required_ |
| `instance_id` | `int` | list data files for this instance id only | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | list of files |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>307<br>``` | ```md-code__content<br>def find_instance_data_files(file_ext, instance_id):<br>    """Find instance data files in all data files directories.<br>    Args:<br>        file_ext (str): data files with this extension will be listed only<br>        instance_id (int): list data files for this instance id only<br>    Returns:<br>        (list[str]): list of files<br>    """<br>    # instance files names are like pyRevit_2018_14422_<br>    instance_files = set()<br>    for appdata_file in find_data_files(file_ext):<br>        file_naming_dict = _match_file(<br>            op.basename(appdata_file)<br>        )<br>        if 'pid' in file_naming_dict:<br>            try:<br>                pid = int(file_naming_dict['pid'])<br>                if instance_id == pid:<br>                    instance_files.add(appdata_file)<br>            except Exception:<br>                pass<br>    return instance_files<br>``` |

### `garbage_data_file(file_path)`

Mark and remove the given appdata file.

Current implementation removes the file immediately.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `file_path` | `str` | path to the target file | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>``` | ```md-code__content<br>def garbage_data_file(file_path):<br>    """Mark and remove the given appdata file.<br>    Current implementation removes the file immediately.<br>    Args:<br>        file_path (str): path to the target file<br>    """<br>    _remove_app_file(file_path)<br>``` |

### `cleanup_appdata_folder()`

Cleanup appdata folder of all temporary appdata files.

Source code in `pyrevitlib/pyrevit/coreutils/appdata.py`

|     |     |
| --- | --- |
| ```<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def cleanup_appdata_folder():<br>    """Cleanup appdata folder of all temporary appdata files."""<br>    if EXEC_PARAMS.first_load:<br>        hostapp_pids = \<br>            [x.ProcessId<br>             for x in TargetApps.Revit.RevitController.ListRunningRevits()]<br>        for appdata_file in os.listdir(pyrevit.PYREVIT_VERSION_APP_DIR):<br>            file_naming_dict = _match_file(appdata_file)<br>            if 'pid' in file_naming_dict:<br>                try:<br>                    pid = int(file_naming_dict['pid'])<br>                    if pid not in hostapp_pids:<br>                        _remove_app_file(<br>                            op.join(pyrevit.PYREVIT_VERSION_APP_DIR,<br>                                    appdata_file)<br>                            )<br>                except Exception:<br>                    pass<br>``` |

Back to top

## Bounding Box File Operations
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/bbx/#pyrevit.interop.bbx)

# bbx

Read and Write Bounding Box Files.

## Functions

### `load(inputfile)`

Read list of bounding boxes from file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `inputfile` | `str` | path to input file | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[tuple[tuple[float, float, float], tuple[float, float, float]]]` | bounding boxes |

Source code in `pyrevitlib/pyrevit/interop/bbx.py`

|     |     |
| --- | --- |
| ```<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>``` | ```md-code__content<br>def load(inputfile):<br>    """Read list of bounding boxes from file.<br>    Args:<br>        inputfile (str): path to input file<br>    Returns:<br>        (list[tuple[tuple[float, float, float], tuple[float, float, float]]]):<br>            bounding boxes<br>    """<br>    bboxes = []<br>    with open(inputfile, 'r') as bbxfile:<br>        # bbox_count = int(bbxfile.readline())   #noqa<br>        for line in bbxfile:<br>            data = line.split(' ')<br>            bboxes.append(<br>                ((float(data[0]), float(data[1]), float(data[2])),<br>                 (float(data[3]), float(data[4]), float(data[5])))<br>                )<br>    return bboxes<br>``` |

### `dump(outputfile, bbox_list)`

Write list of bounding boxes to file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `outputfile` | `str` | path to output file | _required_ |
| `bbox_list` | `list[tuple[tuple[float, float, float], tuple[float, float, float]]]` | bounding boxes | _required_ |

Source code in `pyrevitlib/pyrevit/interop/bbx.py`

|     |     |
| --- | --- |
| ```<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>``` | ```md-code__content<br>def dump(outputfile, bbox_list):<br>    """Write list of bounding boxes to file.<br>    Args:<br>        outputfile (str): path to output file<br>        bbox_list (list[tuple[tuple[float, float, float], tuple[float, float, float]]]): <br>            bounding boxes<br>    """<br>    bbox_count = len(bbox_list)<br>    with open(outputfile, 'w') as bbxfile:<br>        bbxfile.write(str(bbox_count) + '\n')<br>        for bbox in bbox_list:<br>            minx, miny, minz = bbox[0]<br>            maxx, maxy, maxz = bbox[1]<br>            bbxfile.write(<br>                '{:.02f} {:.02f} {:.02f} {:.02f} {:.02f} {:.02f}\n'<br>                .format(minx, miny, minz, maxx, maxy, maxz)<br>                )<br>``` |

Back to top

## Toast Notification Module
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/forms/toaster/#pyrevit.forms.toaster)

# toaster

Base module for pushing toast messages on Win 10.

This module is a wrapper for a cli utility that provides toast message
functionality. See `https://github.com/go-toast/toast`

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Functions

### `get_toaster()`

Return full file path of the toast binary utility.

Source code in `pyrevitlib/pyrevit/forms/toaster.py`

|     |     |
| --- | --- |
| ```<br>18<br>19<br>20<br>``` | ```md-code__content<br>def get_toaster():<br>    """Return full file path of the toast binary utility."""<br>    return op.join(op.dirname(__file__), 'pyrevit-toast.exe')<br>``` |

### `send_toast(message, title=None, appid=None, icon=None, click=None, actions=None)`

Send toast notificaton.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | notification message | _required_ |
| `title` | `str` | notification title | `None` |
| `appid` | `str` | application unique id (see `--app-id` cli option) | `None` |
| `icon` | `str` | notification icon (see `--icon` cli option) | `None` |
| `click` | `str` | click action (see `--activation-arg` cli option) | `None` |
| `actions` | `dict[str` | str\]):<br>list of actions (see `--action` and `--action-arg` cli options) | `None` |

Source code in `pyrevitlib/pyrevit/forms/toaster.py`

|     |     |
| --- | --- |
| ```<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>``` | ```md-code__content<br>def send_toast(message,<br>               title=None, appid=None, icon=None, click=None, actions=None):<br>    """Send toast notificaton.<br>    Args:<br>        message (str): notification message<br>        title (str): notification title<br>        appid (str): application unique id (see `--app-id` cli option)<br>        icon (str): notification icon (see `--icon` cli option)<br>        click (str): click action (see `--activation-arg` cli option)<br>        actions (dict[str:str]):<br>            list of actions (see `--action` and `--action-arg` cli options)<br>    """<br>    # set defaults<br>    if not title:<br>        title = 'pyRevit'<br>    if not appid:<br>        appid = title<br>    if not icon:<br>        icon = op.join(ROOT_BIN_DIR, 'pyRevit.ico')<br>    if not actions:<br>        actions = {}<br>    # build the toast<br>    toast_args = r'"{}"'.format(get_toaster())<br>    toast_args += r' --app-id "{}"'.format(appid)<br>    toast_args += r' --title "{}"'.format(title)<br>    toast_args += r' --message "{}"'.format(message)<br>    toast_args += r' --icon "{}"'.format(icon)<br>    toast_args += r' --audio "default"'<br>    # toast_args += r' --duration "long"'<br>    if click:<br>        toast_args += r' --activation-arg "{}"'.format(click)<br>    for action, args in actions.items():<br>        toast_args += r' --action "{}" --action-arg "{}"'.format(action, args)<br>    # send the toast now<br>    mlogger.debug('toasting: %s', toast_args)<br>    subprocess.Popen(toast_args, shell=True)<br>``` |

Back to top

## PyRevit System Diagnostics
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/loader/systemdiag/#pyrevit.loader.systemdiag)

# systemdiag

Session diagnostics.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Functions

### `check_min_host_version()`

Source code in `pyrevitlib/pyrevit/loader/systemdiag.py`

|     |     |
| --- | --- |
| ```<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>``` | ```md-code__content<br>def check_min_host_version():<br>    # get required version and build from user config<br>    req_build = user_config.required_host_build<br>    if req_build:<br>        if HOST_APP.build != req_build:<br>            mlogger.warning('You are not using the required host build: %s',<br>                            req_build)<br>``` |

### `check_host_drive_freespace()`

Source code in `pyrevitlib/pyrevit/loader/systemdiag.py`

|     |     |
| --- | --- |
| ```<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>``` | ```md-code__content<br>def check_host_drive_freespace():<br>    # get min free space from user config<br>    min_freespace = user_config.min_host_drivefreespace<br>    if min_freespace:<br>        # find host drive and check free space<br>        host_drive = Path.GetPathRoot(HOST_APP.proc_path)<br>        for drive in DriveInfo.GetDrives():<br>            if drive.Name == host_drive:<br>                free_hd_space = float(drive.TotalFreeSpace) / (1024 ** 3)<br>                if free_hd_space < min_freespace:<br>                    mlogger.warning('Remaining space on local drive '<br>                                    'is less than %sGB...', min_freespace)<br>``` |

### `system_diag()`

Verifies system status is appropriate for a pyRevit session.

Source code in `pyrevitlib/pyrevit/loader/systemdiag.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>``` | ```md-code__content<br>def system_diag():<br>    """Verifies system status is appropriate for a pyRevit session."""<br>    # checking available drive space<br>    check_host_drive_freespace()<br>    # check if user is running the required host version and build<br>    check_min_host_version()<br>``` |

Back to top

## Invoke Type Maker
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/invoketypemaker/#pyrevit.runtime.invoketypemaker)

# invoketypemaker

Prepare and compile direct invoke script types.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

## Functions

### `create_executor_type(extension, module_builder, cmd_component)`

Source code in `pyrevitlib/pyrevit/runtime/invoketypemaker.py`

|     |     |
| --- | --- |
| ```<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>``` | ```md-code__content<br>def create_executor_type(extension, module_builder, cmd_component):<br>    # create argument to pass on to the executor for invoke commands<br>    target_assm_command_class = ''<br>    target_assm = cmd_component.get_target_assembly(required=True)<br>    target_class = cmd_component.command_class<br>    if target_assm and not target_class:<br>        # RevitPythonShell.dll<br>        target_assm_command_class = target_assm<br>    elif target_assm and target_class:<br>        # RevitPythonShell.dll::IronPythonConsoleCommand<br>        target_assm_command_class = '{}::{}'.format(target_assm, target_class)<br>    cmd_component.arguments = [target_assm_command_class]<br>    bundletypemaker.create_executor_type(<br>        extension,<br>        module_builder,<br>        cmd_component<br>        )<br>``` |

Back to top

## RGB Color Constants
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/colors/#pyrevit.coreutils.colors)

# colors

Colors constants.

Provide RGB color constants and a colors dictionary with
elements formatted: COLORS\[colorname\] = CONSTANT.

Examples:

```md-code__content
from pyrevit.coreutils import colors
colors.COLORS['black']

```

```md-code__content
colors.BLACK

```

## Attributes

### `ALICEBLUE = RGB(name='aliceblue', red=240, green=248, blue=255)``module-attribute`

### `ANTIQUEWHITE = RGB(name='antiquewhite', red=250, green=235, blue=215)``module-attribute`

### `ANTIQUEWHITE1 = RGB(name='antiquewhite1', red=255, green=239, blue=219)``module-attribute`

### `ANTIQUEWHITE2 = RGB(name='antiquewhite2', red=238, green=223, blue=204)``module-attribute`

### `ANTIQUEWHITE3 = RGB(name='antiquewhite3', red=205, green=192, blue=176)``module-attribute`

### `ANTIQUEWHITE4 = RGB(name='antiquewhite4', red=139, green=131, blue=120)``module-attribute`

### `AQUA = RGB(name='aqua', red=0, green=255, blue=255)``module-attribute`

### `AQUAMARINE1 = RGB(name='aquamarine1', red=127, green=255, blue=212)``module-attribute`

### `AQUAMARINE2 = RGB(name='aquamarine2', red=118, green=238, blue=198)``module-attribute`

### `AQUAMARINE3 = RGB(name='aquamarine3', red=102, green=205, blue=170)``module-attribute`

### `AQUAMARINE4 = RGB(name='aquamarine4', red=69, green=139, blue=116)``module-attribute`

### `AZURE1 = RGB(name='azure1', red=240, green=255, blue=255)``module-attribute`

### `AZURE2 = RGB(name='azure2', red=224, green=238, blue=238)``module-attribute`

### `AZURE3 = RGB(name='azure3', red=193, green=205, blue=205)``module-attribute`

### `AZURE4 = RGB(name='azure4', red=131, green=139, blue=139)``module-attribute`

### `BANANA = RGB(name='banana', red=227, green=207, blue=87)``module-attribute`

### `BEIGE = RGB(name='beige', red=245, green=245, blue=220)``module-attribute`

### `BISQUE1 = RGB(name='bisque1', red=255, green=228, blue=196)``module-attribute`

### `BISQUE2 = RGB(name='bisque2', red=238, green=213, blue=183)``module-attribute`

### `BISQUE3 = RGB(name='bisque3', red=205, green=183, blue=158)``module-attribute`

### `BISQUE4 = RGB(name='bisque4', red=139, green=125, blue=107)``module-attribute`

### `BLACK = RGB(name='black', red=0, green=0, blue=0)``module-attribute`

### `BLANCHEDALMOND = RGB(name='blanchedalmond', red=255, green=235, blue=205)``module-attribute`

### `BLUE = RGB(name='blue', red=0, green=0, blue=255)``module-attribute`

### `BLUE2 = RGB(name='blue2', red=0, green=0, blue=238)``module-attribute`

### `BLUE3 = RGB(name='blue3', red=0, green=0, blue=205)``module-attribute`

### `BLUE4 = RGB(name='blue4', red=0, green=0, blue=139)``module-attribute`

### `BLUEVIOLET = RGB(name='blueviolet', red=138, green=43, blue=226)``module-attribute`

### `BRICK = RGB(name='brick', red=156, green=102, blue=31)``module-attribute`

### `BROWN = RGB(name='brown', red=165, green=42, blue=42)``module-attribute`

### `BROWN1 = RGB(name='brown1', red=255, green=64, blue=64)``module-attribute`

### `BROWN2 = RGB(name='brown2', red=238, green=59, blue=59)``module-attribute`

### `BROWN3 = RGB(name='brown3', red=205, green=51, blue=51)``module-attribute`

### `BROWN4 = RGB(name='brown4', red=139, green=35, blue=35)``module-attribute`

### `BURLYWOOD = RGB(name='burlywood', red=222, green=184, blue=135)``module-attribute`

### `BURLYWOOD1 = RGB(name='burlywood1', red=255, green=211, blue=155)``module-attribute`

### `BURLYWOOD2 = RGB(name='burlywood2', red=238, green=197, blue=145)``module-attribute`

### `BURLYWOOD3 = RGB(name='burlywood3', red=205, green=170, blue=125)``module-attribute`

### `BURLYWOOD4 = RGB(name='burlywood4', red=139, green=115, blue=85)``module-attribute`

### `BURNTSIENNA = RGB(name='burntsienna', red=138, green=54, blue=15)``module-attribute`

### `BURNTUMBER = RGB(name='burntumber', red=138, green=51, blue=36)``module-attribute`

### `CADETBLUE = RGB(name='cadetblue', red=95, green=158, blue=160)``module-attribute`

### `CADETBLUE1 = RGB(name='cadetblue1', red=152, green=245, blue=255)``module-attribute`

### `CADETBLUE2 = RGB(name='cadetblue2', red=142, green=229, blue=238)``module-attribute`

### `CADETBLUE3 = RGB(name='cadetblue3', red=122, green=197, blue=205)``module-attribute`

### `CADETBLUE4 = RGB(name='cadetblue4', red=83, green=134, blue=139)``module-attribute`

### `CADMIUMORANGE = RGB(name='cadmiumorange', red=255, green=97, blue=3)``module-attribute`

### `CADMIUMYELLOW = RGB(name='cadmiumyellow', red=255, green=153, blue=18)``module-attribute`

### `CARROT = RGB(name='carrot', red=237, green=145, blue=33)``module-attribute`

### `CHARTREUSE1 = RGB(name='chartreuse1', red=127, green=255, blue=0)``module-attribute`

### `CHARTREUSE2 = RGB(name='chartreuse2', red=118, green=238, blue=0)``module-attribute`

### `CHARTREUSE3 = RGB(name='chartreuse3', red=102, green=205, blue=0)``module-attribute`

### `CHARTREUSE4 = RGB(name='chartreuse4', red=69, green=139, blue=0)``module-attribute`

### `CHOCOLATE = RGB(name='chocolate', red=210, green=105, blue=30)``module-attribute`

### `CHOCOLATE1 = RGB(name='chocolate1', red=255, green=127, blue=36)``module-attribute`

### `CHOCOLATE2 = RGB(name='chocolate2', red=238, green=118, blue=33)``module-attribute`

### `CHOCOLATE3 = RGB(name='chocolate3', red=205, green=102, blue=29)``module-attribute`

### `CHOCOLATE4 = RGB(name='chocolate4', red=139, green=69, blue=19)``module-attribute`

### `COBALT = RGB(name='cobalt', red=61, green=89, blue=171)``module-attribute`

### `COBALTGREEN = RGB(name='cobaltgreen', red=61, green=145, blue=64)``module-attribute`

### `COLDGREY = RGB(name='coldgrey', red=128, green=138, blue=135)``module-attribute`

### `CORAL = RGB(name='coral', red=255, green=127, blue=80)``module-attribute`

### `CORAL1 = RGB(name='coral1', red=255, green=114, blue=86)``module-attribute`

### `CORAL2 = RGB(name='coral2', red=238, green=106, blue=80)``module-attribute`

### `CORAL3 = RGB(name='coral3', red=205, green=91, blue=69)``module-attribute`

### `CORAL4 = RGB(name='coral4', red=139, green=62, blue=47)``module-attribute`

### `CORNFLOWERBLUE = RGB(name='cornflowerblue', red=100, green=149, blue=237)``module-attribute`

### `CORNSILK1 = RGB(name='cornsilk1', red=255, green=248, blue=220)``module-attribute`

### `CORNSILK2 = RGB(name='cornsilk2', red=238, green=232, blue=205)``module-attribute`

### `CORNSILK3 = RGB(name='cornsilk3', red=205, green=200, blue=177)``module-attribute`

### `CORNSILK4 = RGB(name='cornsilk4', red=139, green=136, blue=120)``module-attribute`

### `CRIMSON = RGB(name='crimson', red=220, green=20, blue=60)``module-attribute`

### `CYAN2 = RGB(name='cyan2', red=0, green=238, blue=238)``module-attribute`

### `CYAN3 = RGB(name='cyan3', red=0, green=205, blue=205)``module-attribute`

### `CYAN4 = RGB(name='cyan4', red=0, green=139, blue=139)``module-attribute`

### `DARKGOLDENROD = RGB(name='darkgoldenrod', red=184, green=134, blue=11)``module-attribute`

### `DARKGOLDENROD1 = RGB(name='darkgoldenrod1', red=255, green=185, blue=15)``module-attribute`

### `DARKGOLDENROD2 = RGB(name='darkgoldenrod2', red=238, green=173, blue=14)``module-attribute`

### `DARKGOLDENROD3 = RGB(name='darkgoldenrod3', red=205, green=149, blue=12)``module-attribute`

### `DARKGOLDENROD4 = RGB(name='darkgoldenrod4', red=139, green=101, blue=8)``module-attribute`

### `DARKGRAY = RGB(name='darkgray', red=169, green=169, blue=169)``module-attribute`

### `DARKGREEN = RGB(name='darkgreen', red=0, green=100, blue=0)``module-attribute`

### `DARKKHAKI = RGB(name='darkkhaki', red=189, green=183, blue=107)``module-attribute`

### `DARKOLIVEGREEN = RGB(name='darkolivegreen', red=85, green=107, blue=47)``module-attribute`

### `DARKOLIVEGREEN1 = RGB(name='darkolivegreen1', red=202, green=255, blue=112)``module-attribute`

### `DARKOLIVEGREEN2 = RGB(name='darkolivegreen2', red=188, green=238, blue=104)``module-attribute`

### `DARKOLIVEGREEN3 = RGB(name='darkolivegreen3', red=162, green=205, blue=90)``module-attribute`

### `DARKOLIVEGREEN4 = RGB(name='darkolivegreen4', red=110, green=139, blue=61)``module-attribute`

### `DARKORANGE = RGB(name='darkorange', red=255, green=140, blue=0)``module-attribute`

### `DARKORANGE1 = RGB(name='darkorange1', red=255, green=127, blue=0)``module-attribute`

### `DARKORANGE2 = RGB(name='darkorange2', red=238, green=118, blue=0)``module-attribute`

### `DARKORANGE3 = RGB(name='darkorange3', red=205, green=102, blue=0)``module-attribute`

### `DARKORANGE4 = RGB(name='darkorange4', red=139, green=69, blue=0)``module-attribute`

### `DARKORCHID = RGB(name='darkorchid', red=153, green=50, blue=204)``module-attribute`

### `DARKORCHID1 = RGB(name='darkorchid1', red=191, green=62, blue=255)``module-attribute`

### `DARKORCHID2 = RGB(name='darkorchid2', red=178, green=58, blue=238)``module-attribute`

### `DARKORCHID3 = RGB(name='darkorchid3', red=154, green=50, blue=205)``module-attribute`

### `DARKORCHID4 = RGB(name='darkorchid4', red=104, green=34, blue=139)``module-attribute`

### `DARKSALMON = RGB(name='darksalmon', red=233, green=150, blue=122)``module-attribute`

### `DARKSEAGREEN = RGB(name='darkseagreen', red=143, green=188, blue=143)``module-attribute`

### `DARKSEAGREEN1 = RGB(name='darkseagreen1', red=193, green=255, blue=193)``module-attribute`

### `DARKSEAGREEN2 = RGB(name='darkseagreen2', red=180, green=238, blue=180)``module-attribute`

### `DARKSEAGREEN3 = RGB(name='darkseagreen3', red=155, green=205, blue=155)``module-attribute`

### `DARKSEAGREEN4 = RGB(name='darkseagreen4', red=105, green=139, blue=105)``module-attribute`

### `DARKSLATEBLUE = RGB(name='darkslateblue', red=72, green=61, blue=139)``module-attribute`

### `DARKSLATEGRAY = RGB(name='darkslategray', red=47, green=79, blue=79)``module-attribute`

### `DARKSLATEGRAY1 = RGB(name='darkslategray1', red=151, green=255, blue=255)``module-attribute`

### `DARKSLATEGRAY2 = RGB(name='darkslategray2', red=141, green=238, blue=238)``module-attribute`

### `DARKSLATEGRAY3 = RGB(name='darkslategray3', red=121, green=205, blue=205)``module-attribute`

### `DARKSLATEGRAY4 = RGB(name='darkslategray4', red=82, green=139, blue=139)``module-attribute`

### `DARKTURQUOISE = RGB(name='darkturquoise', red=0, green=206, blue=209)``module-attribute`

### `DARKVIOLET = RGB(name='darkviolet', red=148, green=0, blue=211)``module-attribute`

### `DEEPPINK1 = RGB(name='deeppink1', red=255, green=20, blue=147)``module-attribute`

### `DEEPPINK2 = RGB(name='deeppink2', red=238, green=18, blue=137)``module-attribute`

### `DEEPPINK3 = RGB(name='deeppink3', red=205, green=16, blue=118)``module-attribute`

### `DEEPPINK4 = RGB(name='deeppink4', red=139, green=10, blue=80)``module-attribute`

### `DEEPSKYBLUE1 = RGB(name='deepskyblue1', red=0, green=191, blue=255)``module-attribute`

### `DEEPSKYBLUE2 = RGB(name='deepskyblue2', red=0, green=178, blue=238)``module-attribute`

### `DEEPSKYBLUE3 = RGB(name='deepskyblue3', red=0, green=154, blue=205)``module-attribute`

### `DEEPSKYBLUE4 = RGB(name='deepskyblue4', red=0, green=104, blue=139)``module-attribute`

### `DIMGRAY = RGB(name='dimgray', red=105, green=105, blue=105)``module-attribute`

### `DODGERBLUE1 = RGB(name='dodgerblue1', red=30, green=144, blue=255)``module-attribute`

### `DODGERBLUE2 = RGB(name='dodgerblue2', red=28, green=134, blue=238)``module-attribute`

### `DODGERBLUE3 = RGB(name='dodgerblue3', red=24, green=116, blue=205)``module-attribute`

### `DODGERBLUE4 = RGB(name='dodgerblue4', red=16, green=78, blue=139)``module-attribute`

### `EGGSHELL = RGB(name='eggshell', red=252, green=230, blue=201)``module-attribute`

### `EMERALDGREEN = RGB(name='emeraldgreen', red=0, green=201, blue=87)``module-attribute`

### `FIREBRICK = RGB(name='firebrick', red=178, green=34, blue=34)``module-attribute`

### `FIREBRICK1 = RGB(name='firebrick1', red=255, green=48, blue=48)``module-attribute`

### `FIREBRICK2 = RGB(name='firebrick2', red=238, green=44, blue=44)``module-attribute`

### `FIREBRICK3 = RGB(name='firebrick3', red=205, green=38, blue=38)``module-attribute`

### `FIREBRICK4 = RGB(name='firebrick4', red=139, green=26, blue=26)``module-attribute`

### `FLESH = RGB(name='flesh', red=255, green=125, blue=64)``module-attribute`

### `FLORALWHITE = RGB(name='floralwhite', red=255, green=250, blue=240)``module-attribute`

### `FORESTGREEN = RGB(name='forestgreen', red=34, green=139, blue=34)``module-attribute`

### `GAINSBORO = RGB(name='gainsboro', red=220, green=220, blue=220)``module-attribute`

### `GHOSTWHITE = RGB(name='ghostwhite', red=248, green=248, blue=255)``module-attribute`

### `GOLD1 = RGB(name='gold1', red=255, green=215, blue=0)``module-attribute`

### `GOLD2 = RGB(name='gold2', red=238, green=201, blue=0)``module-attribute`

### `GOLD3 = RGB(name='gold3', red=205, green=173, blue=0)``module-attribute`

### `GOLD4 = RGB(name='gold4', red=139, green=117, blue=0)``module-attribute`

### `GOLDENROD = RGB(name='goldenrod', red=218, green=165, blue=32)``module-attribute`

### `GOLDENROD1 = RGB(name='goldenrod1', red=255, green=193, blue=37)``module-attribute`

### `GOLDENROD2 = RGB(name='goldenrod2', red=238, green=180, blue=34)``module-attribute`

### `GOLDENROD3 = RGB(name='goldenrod3', red=205, green=155, blue=29)``module-attribute`

### `GOLDENROD4 = RGB(name='goldenrod4', red=139, green=105, blue=20)``module-attribute`

### `GRAY = RGB(name='gray', red=128, green=128, blue=128)``module-attribute`

### `GRAY1 = RGB(name='gray1', red=3, green=3, blue=3)``module-attribute`

### `GRAY10 = RGB(name='gray10', red=26, green=26, blue=26)``module-attribute`

### `GRAY11 = RGB(name='gray11', red=28, green=28, blue=28)``module-attribute`

### `GRAY12 = RGB(name='gray12', red=31, green=31, blue=31)``module-attribute`

### `GRAY13 = RGB(name='gray13', red=33, green=33, blue=33)``module-attribute`

### `GRAY14 = RGB(name='gray14', red=36, green=36, blue=36)``module-attribute`

### `GRAY15 = RGB(name='gray15', red=38, green=38, blue=38)``module-attribute`

### `GRAY16 = RGB(name='gray16', red=41, green=41, blue=41)``module-attribute`

### `GRAY17 = RGB(name='gray17', red=43, green=43, blue=43)``module-attribute`

### `GRAY18 = RGB(name='gray18', red=46, green=46, blue=46)``module-attribute`

### `GRAY19 = RGB(name='gray19', red=48, green=48, blue=48)``module-attribute`

### `GRAY2 = RGB(name='gray2', red=5, green=5, blue=5)``module-attribute`

### `GRAY20 = RGB(name='gray20', red=51, green=51, blue=51)``module-attribute`

### `GRAY21 = RGB(name='gray21', red=54, green=54, blue=54)``module-attribute`

### `GRAY22 = RGB(name='gray22', red=56, green=56, blue=56)``module-attribute`

### `GRAY23 = RGB(name='gray23', red=59, green=59, blue=59)``module-attribute`

### `GRAY24 = RGB(name='gray24', red=61, green=61, blue=61)``module-attribute`

### `GRAY25 = RGB(name='gray25', red=64, green=64, blue=64)``module-attribute`

### `GRAY26 = RGB(name='gray26', red=66, green=66, blue=66)``module-attribute`

### `GRAY27 = RGB(name='gray27', red=69, green=69, blue=69)``module-attribute`

### `GRAY28 = RGB(name='gray28', red=71, green=71, blue=71)``module-attribute`

### `GRAY29 = RGB(name='gray29', red=74, green=74, blue=74)``module-attribute`

### `GRAY3 = RGB(name='gray3', red=8, green=8, blue=8)``module-attribute`

### `GRAY30 = RGB(name='gray30', red=77, green=77, blue=77)``module-attribute`

### `GRAY31 = RGB(name='gray31', red=79, green=79, blue=79)``module-attribute`

### `GRAY32 = RGB(name='gray32', red=82, green=82, blue=82)``module-attribute`

### `GRAY33 = RGB(name='gray33', red=84, green=84, blue=84)``module-attribute`

### `GRAY34 = RGB(name='gray34', red=87, green=87, blue=87)``module-attribute`

### `GRAY35 = RGB(name='gray35', red=89, green=89, blue=89)``module-attribute`

### `GRAY36 = RGB(name='gray36', red=92, green=92, blue=92)``module-attribute`

### `GRAY37 = RGB(name='gray37', red=94, green=94, blue=94)``module-attribute`

### `GRAY38 = RGB(name='gray38', red=97, green=97, blue=97)``module-attribute`

### `GRAY39 = RGB(name='gray39', red=99, green=99, blue=99)``module-attribute`

### `GRAY4 = RGB(name='gray4', red=10, green=10, blue=10)``module-attribute`

### `GRAY40 = RGB(name='gray40', red=102, green=102, blue=102)``module-attribute`

### `GRAY42 = RGB(name='gray42', red=107, green=107, blue=107)``module-attribute`

### `GRAY43 = RGB(name='gray43', red=110, green=110, blue=110)``module-attribute`

### `GRAY44 = RGB(name='gray44', red=112, green=112, blue=112)``module-attribute`

### `GRAY45 = RGB(name='gray45', red=115, green=115, blue=115)``module-attribute`

### `GRAY46 = RGB(name='gray46', red=117, green=117, blue=117)``module-attribute`

### `GRAY47 = RGB(name='gray47', red=120, green=120, blue=120)``module-attribute`

### `GRAY48 = RGB(name='gray48', red=122, green=122, blue=122)``module-attribute`

### `GRAY49 = RGB(name='gray49', red=125, green=125, blue=125)``module-attribute`

### `GRAY5 = RGB(name='gray5', red=13, green=13, blue=13)``module-attribute`

### `GRAY50 = RGB(name='gray50', red=127, green=127, blue=127)``module-attribute`

### `GRAY51 = RGB(name='gray51', red=130, green=130, blue=130)``module-attribute`

### `GRAY52 = RGB(name='gray52', red=133, green=133, blue=133)``module-attribute`

### `GRAY53 = RGB(name='gray53', red=135, green=135, blue=135)``module-attribute`

### `GRAY54 = RGB(name='gray54', red=138, green=138, blue=138)``module-attribute`

### `GRAY55 = RGB(name='gray55', red=140, green=140, blue=140)``module-attribute`

### `GRAY56 = RGB(name='gray56', red=143, green=143, blue=143)``module-attribute`

### `GRAY57 = RGB(name='gray57', red=145, green=145, blue=145)``module-attribute`

### `GRAY58 = RGB(name='gray58', red=148, green=148, blue=148)``module-attribute`

### `GRAY59 = RGB(name='gray59', red=150, green=150, blue=150)``module-attribute`

### `GRAY6 = RGB(name='gray6', red=15, green=15, blue=15)``module-attribute`

### `GRAY60 = RGB(name='gray60', red=153, green=153, blue=153)``module-attribute`

### `GRAY61 = RGB(name='gray61', red=156, green=156, blue=156)``module-attribute`

### `GRAY62 = RGB(name='gray62', red=158, green=158, blue=158)``module-attribute`

### `GRAY63 = RGB(name='gray63', red=161, green=161, blue=161)``module-attribute`

### `GRAY64 = RGB(name='gray64', red=163, green=163, blue=163)``module-attribute`

### `GRAY65 = RGB(name='gray65', red=166, green=166, blue=166)``module-attribute`

### `GRAY66 = RGB(name='gray66', red=168, green=168, blue=168)``module-attribute`

### `GRAY67 = RGB(name='gray67', red=171, green=171, blue=171)``module-attribute`

### `GRAY68 = RGB(name='gray68', red=173, green=173, blue=173)``module-attribute`

### `GRAY69 = RGB(name='gray69', red=176, green=176, blue=176)``module-attribute`

### `GRAY7 = RGB(name='gray7', red=18, green=18, blue=18)``module-attribute`

### `GRAY70 = RGB(name='gray70', red=179, green=179, blue=179)``module-attribute`

### `GRAY71 = RGB(name='gray71', red=181, green=181, blue=181)``module-attribute`

### `GRAY72 = RGB(name='gray72', red=184, green=184, blue=184)``module-attribute`

### `GRAY73 = RGB(name='gray73', red=186, green=186, blue=186)``module-attribute`

### `GRAY74 = RGB(name='gray74', red=189, green=189, blue=189)``module-attribute`

### `GRAY75 = RGB(name='gray75', red=191, green=191, blue=191)``module-attribute`

### `GRAY76 = RGB(name='gray76', red=194, green=194, blue=194)``module-attribute`

### `GRAY77 = RGB(name='gray77', red=196, green=196, blue=196)``module-attribute`

### `GRAY78 = RGB(name='gray78', red=199, green=199, blue=199)``module-attribute`

### `GRAY79 = RGB(name='gray79', red=201, green=201, blue=201)``module-attribute`

### `GRAY8 = RGB(name='gray8', red=20, green=20, blue=20)``module-attribute`

### `GRAY80 = RGB(name='gray80', red=204, green=204, blue=204)``module-attribute`

### `GRAY81 = RGB(name='gray81', red=207, green=207, blue=207)``module-attribute`

### `GRAY82 = RGB(name='gray82', red=209, green=209, blue=209)``module-attribute`

### `GRAY83 = RGB(name='gray83', red=212, green=212, blue=212)``module-attribute`

### `GRAY84 = RGB(name='gray84', red=214, green=214, blue=214)``module-attribute`

### `GRAY85 = RGB(name='gray85', red=217, green=217, blue=217)``module-attribute`

### `GRAY86 = RGB(name='gray86', red=219, green=219, blue=219)``module-attribute`

### `GRAY87 = RGB(name='gray87', red=222, green=222, blue=222)``module-attribute`

### `GRAY88 = RGB(name='gray88', red=224, green=224, blue=224)``module-attribute`

### `GRAY89 = RGB(name='gray89', red=227, green=227, blue=227)``module-attribute`

### `GRAY9 = RGB(name='gray9', red=23, green=23, blue=23)``module-attribute`

### `GRAY90 = RGB(name='gray90', red=229, green=229, blue=229)``module-attribute`

### `GRAY91 = RGB(name='gray91', red=232, green=232, blue=232)``module-attribute`

### `GRAY92 = RGB(name='gray92', red=235, green=235, blue=235)``module-attribute`

### `GRAY93 = RGB(name='gray93', red=237, green=237, blue=237)``module-attribute`

### `GRAY94 = RGB(name='gray94', red=240, green=240, blue=240)``module-attribute`

### `GRAY95 = RGB(name='gray95', red=242, green=242, blue=242)``module-attribute`

### `GRAY97 = RGB(name='gray97', red=247, green=247, blue=247)``module-attribute`

### `GRAY98 = RGB(name='gray98', red=250, green=250, blue=250)``module-attribute`

### `GRAY99 = RGB(name='gray99', red=252, green=252, blue=252)``module-attribute`

### `GREEN = RGB(name='green', red=0, green=128, blue=0)``module-attribute`

### `GREEN1 = RGB(name='green1', red=0, green=255, blue=0)``module-attribute`

### `GREEN2 = RGB(name='green2', red=0, green=238, blue=0)``module-attribute`

### `GREEN3 = RGB(name='green3', red=0, green=205, blue=0)``module-attribute`

### `GREEN4 = RGB(name='green4', red=0, green=139, blue=0)``module-attribute`

### `GREENYELLOW = RGB(name='greenyellow', red=173, green=255, blue=47)``module-attribute`

### `HONEYDEW1 = RGB(name='honeydew1', red=240, green=255, blue=240)``module-attribute`

### `HONEYDEW2 = RGB(name='honeydew2', red=224, green=238, blue=224)``module-attribute`

### `HONEYDEW3 = RGB(name='honeydew3', red=193, green=205, blue=193)``module-attribute`

### `HONEYDEW4 = RGB(name='honeydew4', red=131, green=139, blue=131)``module-attribute`

### `HOTPINK = RGB(name='hotpink', red=255, green=105, blue=180)``module-attribute`

### `HOTPINK1 = RGB(name='hotpink1', red=255, green=110, blue=180)``module-attribute`

### `HOTPINK2 = RGB(name='hotpink2', red=238, green=106, blue=167)``module-attribute`

### `HOTPINK3 = RGB(name='hotpink3', red=205, green=96, blue=144)``module-attribute`

### `HOTPINK4 = RGB(name='hotpink4', red=139, green=58, blue=98)``module-attribute`

### `INDIANRED = RGB(name='indianred', red=205, green=92, blue=92)``module-attribute`

### `INDIANRED1 = RGB(name='indianred1', red=255, green=106, blue=106)``module-attribute`

### `INDIANRED2 = RGB(name='indianred2', red=238, green=99, blue=99)``module-attribute`

### `INDIANRED3 = RGB(name='indianred3', red=205, green=85, blue=85)``module-attribute`

### `INDIANRED4 = RGB(name='indianred4', red=139, green=58, blue=58)``module-attribute`

### `INDIGO = RGB(name='indigo', red=75, green=0, blue=130)``module-attribute`

### `IVORY1 = RGB(name='ivory1', red=255, green=255, blue=240)``module-attribute`

### `IVORY2 = RGB(name='ivory2', red=238, green=238, blue=224)``module-attribute`

### `IVORY3 = RGB(name='ivory3', red=205, green=205, blue=193)``module-attribute`

### `IVORY4 = RGB(name='ivory4', red=139, green=139, blue=131)``module-attribute`

### `IVORYBLACK = RGB(name='ivoryblack', red=41, green=36, blue=33)``module-attribute`

### `KHAKI = RGB(name='khaki', red=240, green=230, blue=140)``module-attribute`

### `KHAKI1 = RGB(name='khaki1', red=255, green=246, blue=143)``module-attribute`

### `KHAKI2 = RGB(name='khaki2', red=238, green=230, blue=133)``module-attribute`

### `KHAKI3 = RGB(name='khaki3', red=205, green=198, blue=115)``module-attribute`

### `KHAKI4 = RGB(name='khaki4', red=139, green=134, blue=78)``module-attribute`

### `LAVENDER = RGB(name='lavender', red=230, green=230, blue=250)``module-attribute`

### `LAVENDERBLUSH1 = RGB(name='lavenderblush1', red=255, green=240, blue=245)``module-attribute`

### `LAVENDERBLUSH2 = RGB(name='lavenderblush2', red=238, green=224, blue=229)``module-attribute`

### `LAVENDERBLUSH3 = RGB(name='lavenderblush3', red=205, green=193, blue=197)``module-attribute`

### `LAVENDERBLUSH4 = RGB(name='lavenderblush4', red=139, green=131, blue=134)``module-attribute`

### `LAWNGREEN = RGB(name='lawngreen', red=124, green=252, blue=0)``module-attribute`

### `LEMONCHIFFON1 = RGB(name='lemonchiffon1', red=255, green=250, blue=205)``module-attribute`

### `LEMONCHIFFON2 = RGB(name='lemonchiffon2', red=238, green=233, blue=191)``module-attribute`

### `LEMONCHIFFON3 = RGB(name='lemonchiffon3', red=205, green=201, blue=165)``module-attribute`

### `LEMONCHIFFON4 = RGB(name='lemonchiffon4', red=139, green=137, blue=112)``module-attribute`

### `LIGHTBLUE = RGB(name='lightblue', red=173, green=216, blue=230)``module-attribute`

### `LIGHTBLUE1 = RGB(name='lightblue1', red=191, green=239, blue=255)``module-attribute`

### `LIGHTBLUE2 = RGB(name='lightblue2', red=178, green=223, blue=238)``module-attribute`

### `LIGHTBLUE3 = RGB(name='lightblue3', red=154, green=192, blue=205)``module-attribute`

### `LIGHTBLUE4 = RGB(name='lightblue4', red=104, green=131, blue=139)``module-attribute`

### `LIGHTCORAL = RGB(name='lightcoral', red=240, green=128, blue=128)``module-attribute`

### `LIGHTCYAN1 = RGB(name='lightcyan1', red=224, green=255, blue=255)``module-attribute`

### `LIGHTCYAN2 = RGB(name='lightcyan2', red=209, green=238, blue=238)``module-attribute`

### `LIGHTCYAN3 = RGB(name='lightcyan3', red=180, green=205, blue=205)``module-attribute`

### `LIGHTCYAN4 = RGB(name='lightcyan4', red=122, green=139, blue=139)``module-attribute`

### `LIGHTGOLDENROD1 = RGB(name='lightgoldenrod1', red=255, green=236, blue=139)``module-attribute`

### `LIGHTGOLDENROD2 = RGB(name='lightgoldenrod2', red=238, green=220, blue=130)``module-attribute`

### `LIGHTGOLDENROD3 = RGB(name='lightgoldenrod3', red=205, green=190, blue=112)``module-attribute`

### `LIGHTGOLDENROD4 = RGB(name='lightgoldenrod4', red=139, green=129, blue=76)``module-attribute`

### `LIGHTGOLDENRODYELLOW = RGB(name='lightgoldenrodyellow', red=250, green=250, blue=210)``module-attribute`

### `LIGHTGREY = RGB(name='lightgrey', red=211, green=211, blue=211)``module-attribute`

### `LIGHTPINK = RGB(name='lightpink', red=255, green=182, blue=193)``module-attribute`

### `LIGHTPINK1 = RGB(name='lightpink1', red=255, green=174, blue=185)``module-attribute`

### `LIGHTPINK2 = RGB(name='lightpink2', red=238, green=162, blue=173)``module-attribute`

### `LIGHTPINK3 = RGB(name='lightpink3', red=205, green=140, blue=149)``module-attribute`

### `LIGHTPINK4 = RGB(name='lightpink4', red=139, green=95, blue=101)``module-attribute`

### `LIGHTSALMON1 = RGB(name='lightsalmon1', red=255, green=160, blue=122)``module-attribute`

### `LIGHTSALMON2 = RGB(name='lightsalmon2', red=238, green=149, blue=114)``module-attribute`

### `LIGHTSALMON3 = RGB(name='lightsalmon3', red=205, green=129, blue=98)``module-attribute`

### `LIGHTSALMON4 = RGB(name='lightsalmon4', red=139, green=87, blue=66)``module-attribute`

### `LIGHTSEAGREEN = RGB(name='lightseagreen', red=32, green=178, blue=170)``module-attribute`

### `LIGHTSKYBLUE = RGB(name='lightskyblue', red=135, green=206, blue=250)``module-attribute`

### `LIGHTSKYBLUE1 = RGB(name='lightskyblue1', red=176, green=226, blue=255)``module-attribute`

### `LIGHTSKYBLUE2 = RGB(name='lightskyblue2', red=164, green=211, blue=238)``module-attribute`

### `LIGHTSKYBLUE3 = RGB(name='lightskyblue3', red=141, green=182, blue=205)``module-attribute`

### `LIGHTSKYBLUE4 = RGB(name='lightskyblue4', red=96, green=123, blue=139)``module-attribute`

### `LIGHTSLATEBLUE = RGB(name='lightslateblue', red=132, green=112, blue=255)``module-attribute`

### `LIGHTSLATEGRAY = RGB(name='lightslategray', red=119, green=136, blue=153)``module-attribute`

### `LIGHTSTEELBLUE = RGB(name='lightsteelblue', red=176, green=196, blue=222)``module-attribute`

### `LIGHTSTEELBLUE1 = RGB(name='lightsteelblue1', red=202, green=225, blue=255)``module-attribute`

### `LIGHTSTEELBLUE2 = RGB(name='lightsteelblue2', red=188, green=210, blue=238)``module-attribute`

### `LIGHTSTEELBLUE3 = RGB(name='lightsteelblue3', red=162, green=181, blue=205)``module-attribute`

### `LIGHTSTEELBLUE4 = RGB(name='lightsteelblue4', red=110, green=123, blue=139)``module-attribute`

### `LIGHTYELLOW1 = RGB(name='lightyellow1', red=255, green=255, blue=224)``module-attribute`

### `LIGHTYELLOW2 = RGB(name='lightyellow2', red=238, green=238, blue=209)``module-attribute`

### `LIGHTYELLOW3 = RGB(name='lightyellow3', red=205, green=205, blue=180)``module-attribute`

### `LIGHTYELLOW4 = RGB(name='lightyellow4', red=139, green=139, blue=122)``module-attribute`

### `LIMEGREEN = RGB(name='limegreen', red=50, green=205, blue=50)``module-attribute`

### `LINEN = RGB(name='linen', red=250, green=240, blue=230)``module-attribute`

### `MAGENTA = RGB(name='magenta', red=255, green=0, blue=255)``module-attribute`

### `MAGENTA2 = RGB(name='magenta2', red=238, green=0, blue=238)``module-attribute`

### `MAGENTA3 = RGB(name='magenta3', red=205, green=0, blue=205)``module-attribute`

### `MAGENTA4 = RGB(name='magenta4', red=139, green=0, blue=139)``module-attribute`

### `MANGANESEBLUE = RGB(name='manganeseblue', red=3, green=168, blue=158)``module-attribute`

### `MAROON = RGB(name='maroon', red=128, green=0, blue=0)``module-attribute`

### `MAROON1 = RGB(name='maroon1', red=255, green=52, blue=179)``module-attribute`

### `MAROON2 = RGB(name='maroon2', red=238, green=48, blue=167)``module-attribute`

### `MAROON3 = RGB(name='maroon3', red=205, green=41, blue=144)``module-attribute`

### `MAROON4 = RGB(name='maroon4', red=139, green=28, blue=98)``module-attribute`

### `MEDIUMORCHID = RGB(name='mediumorchid', red=186, green=85, blue=211)``module-attribute`

### `MEDIUMORCHID1 = RGB(name='mediumorchid1', red=224, green=102, blue=255)``module-attribute`

### `MEDIUMORCHID2 = RGB(name='mediumorchid2', red=209, green=95, blue=238)``module-attribute`

### `MEDIUMORCHID3 = RGB(name='mediumorchid3', red=180, green=82, blue=205)``module-attribute`

### `MEDIUMORCHID4 = RGB(name='mediumorchid4', red=122, green=55, blue=139)``module-attribute`

### `MEDIUMPURPLE = RGB(name='mediumpurple', red=147, green=112, blue=219)``module-attribute`

### `MEDIUMPURPLE1 = RGB(name='mediumpurple1', red=171, green=130, blue=255)``module-attribute`

### `MEDIUMPURPLE2 = RGB(name='mediumpurple2', red=159, green=121, blue=238)``module-attribute`

### `MEDIUMPURPLE3 = RGB(name='mediumpurple3', red=137, green=104, blue=205)``module-attribute`

### `MEDIUMPURPLE4 = RGB(name='mediumpurple4', red=93, green=71, blue=139)``module-attribute`

### `MEDIUMSEAGREEN = RGB(name='mediumseagreen', red=60, green=179, blue=113)``module-attribute`

### `MEDIUMSLATEBLUE = RGB(name='mediumslateblue', red=123, green=104, blue=238)``module-attribute`

### `MEDIUMSPRINGGREEN = RGB(name='mediumspringgreen', red=0, green=250, blue=154)``module-attribute`

### `MEDIUMTURQUOISE = RGB(name='mediumturquoise', red=72, green=209, blue=204)``module-attribute`

### `MEDIUMVIOLETRED = RGB(name='mediumvioletred', red=199, green=21, blue=133)``module-attribute`

### `MELON = RGB(name='melon', red=227, green=168, blue=105)``module-attribute`

### `MIDNIGHTBLUE = RGB(name='midnightblue', red=25, green=25, blue=112)``module-attribute`

### `MINT = RGB(name='mint', red=189, green=252, blue=201)``module-attribute`

### `MINTCREAM = RGB(name='mintcream', red=245, green=255, blue=250)``module-attribute`

### `MISTYROSE1 = RGB(name='mistyrose1', red=255, green=228, blue=225)``module-attribute`

### `MISTYROSE2 = RGB(name='mistyrose2', red=238, green=213, blue=210)``module-attribute`

### `MISTYROSE3 = RGB(name='mistyrose3', red=205, green=183, blue=181)``module-attribute`

### `MISTYROSE4 = RGB(name='mistyrose4', red=139, green=125, blue=123)``module-attribute`

### `MOCCASIN = RGB(name='moccasin', red=255, green=228, blue=181)``module-attribute`

### `NAVAJOWHITE1 = RGB(name='navajowhite1', red=255, green=222, blue=173)``module-attribute`

### `NAVAJOWHITE2 = RGB(name='navajowhite2', red=238, green=207, blue=161)``module-attribute`

### `NAVAJOWHITE3 = RGB(name='navajowhite3', red=205, green=179, blue=139)``module-attribute`

### `NAVAJOWHITE4 = RGB(name='navajowhite4', red=139, green=121, blue=94)``module-attribute`

### `NAVY = RGB(name='navy', red=0, green=0, blue=128)``module-attribute`

### `OLDLACE = RGB(name='oldlace', red=253, green=245, blue=230)``module-attribute`

### `OLIVE = RGB(name='olive', red=128, green=128, blue=0)``module-attribute`

### `OLIVEDRAB = RGB(name='olivedrab', red=107, green=142, blue=35)``module-attribute`

### `OLIVEDRAB1 = RGB(name='olivedrab1', red=192, green=255, blue=62)``module-attribute`

### `OLIVEDRAB2 = RGB(name='olivedrab2', red=179, green=238, blue=58)``module-attribute`

### `OLIVEDRAB3 = RGB(name='olivedrab3', red=154, green=205, blue=50)``module-attribute`

### `OLIVEDRAB4 = RGB(name='olivedrab4', red=105, green=139, blue=34)``module-attribute`

### `ORANGE = RGB(name='orange', red=255, green=128, blue=0)``module-attribute`

### `ORANGE1 = RGB(name='orange1', red=255, green=165, blue=0)``module-attribute`

### `ORANGE2 = RGB(name='orange2', red=238, green=154, blue=0)``module-attribute`

### `ORANGE3 = RGB(name='orange3', red=205, green=133, blue=0)``module-attribute`

### `ORANGE4 = RGB(name='orange4', red=139, green=90, blue=0)``module-attribute`

### `ORANGERED1 = RGB(name='orangered1', red=255, green=69, blue=0)``module-attribute`

### `ORANGERED2 = RGB(name='orangered2', red=238, green=64, blue=0)``module-attribute`

### `ORANGERED3 = RGB(name='orangered3', red=205, green=55, blue=0)``module-attribute`

### `ORANGERED4 = RGB(name='orangered4', red=139, green=37, blue=0)``module-attribute`

### `ORCHID = RGB(name='orchid', red=218, green=112, blue=214)``module-attribute`

### `ORCHID1 = RGB(name='orchid1', red=255, green=131, blue=250)``module-attribute`

### `ORCHID2 = RGB(name='orchid2', red=238, green=122, blue=233)``module-attribute`

### `ORCHID3 = RGB(name='orchid3', red=205, green=105, blue=201)``module-attribute`

### `ORCHID4 = RGB(name='orchid4', red=139, green=71, blue=137)``module-attribute`

### `PALEGOLDENROD = RGB(name='palegoldenrod', red=238, green=232, blue=170)``module-attribute`

### `PALEGREEN = RGB(name='palegreen', red=152, green=251, blue=152)``module-attribute`

### `PALEGREEN1 = RGB(name='palegreen1', red=154, green=255, blue=154)``module-attribute`

### `PALEGREEN2 = RGB(name='palegreen2', red=144, green=238, blue=144)``module-attribute`

### `PALEGREEN3 = RGB(name='palegreen3', red=124, green=205, blue=124)``module-attribute`

### `PALEGREEN4 = RGB(name='palegreen4', red=84, green=139, blue=84)``module-attribute`

### `PALETURQUOISE1 = RGB(name='paleturquoise1', red=187, green=255, blue=255)``module-attribute`

### `PALETURQUOISE2 = RGB(name='paleturquoise2', red=174, green=238, blue=238)``module-attribute`

### `PALETURQUOISE3 = RGB(name='paleturquoise3', red=150, green=205, blue=205)``module-attribute`

### `PALETURQUOISE4 = RGB(name='paleturquoise4', red=102, green=139, blue=139)``module-attribute`

### `PALEVIOLETRED = RGB(name='palevioletred', red=219, green=112, blue=147)``module-attribute`

### `PALEVIOLETRED1 = RGB(name='palevioletred1', red=255, green=130, blue=171)``module-attribute`

### `PALEVIOLETRED2 = RGB(name='palevioletred2', red=238, green=121, blue=159)``module-attribute`

### `PALEVIOLETRED3 = RGB(name='palevioletred3', red=205, green=104, blue=137)``module-attribute`

### `PALEVIOLETRED4 = RGB(name='palevioletred4', red=139, green=71, blue=93)``module-attribute`

### `PAPAYAWHIP = RGB(name='papayawhip', red=255, green=239, blue=213)``module-attribute`

### `PEACHPUFF1 = RGB(name='peachpuff1', red=255, green=218, blue=185)``module-attribute`

### `PEACHPUFF2 = RGB(name='peachpuff2', red=238, green=203, blue=173)``module-attribute`

### `PEACHPUFF3 = RGB(name='peachpuff3', red=205, green=175, blue=149)``module-attribute`

### `PEACHPUFF4 = RGB(name='peachpuff4', red=139, green=119, blue=101)``module-attribute`

### `PEACOCK = RGB(name='peacock', red=51, green=161, blue=201)``module-attribute`

### `PINK = RGB(name='pink', red=255, green=192, blue=203)``module-attribute`

### `PINK1 = RGB(name='pink1', red=255, green=181, blue=197)``module-attribute`

### `PINK2 = RGB(name='pink2', red=238, green=169, blue=184)``module-attribute`

### `PINK3 = RGB(name='pink3', red=205, green=145, blue=158)``module-attribute`

### `PINK4 = RGB(name='pink4', red=139, green=99, blue=108)``module-attribute`

### `PLUM = RGB(name='plum', red=221, green=160, blue=221)``module-attribute`

### `PLUM1 = RGB(name='plum1', red=255, green=187, blue=255)``module-attribute`

### `PLUM2 = RGB(name='plum2', red=238, green=174, blue=238)``module-attribute`

### `PLUM3 = RGB(name='plum3', red=205, green=150, blue=205)``module-attribute`

### `PLUM4 = RGB(name='plum4', red=139, green=102, blue=139)``module-attribute`

### `POWDERBLUE = RGB(name='powderblue', red=176, green=224, blue=230)``module-attribute`

### `PURPLE = RGB(name='purple', red=128, green=0, blue=128)``module-attribute`

### `PURPLE1 = RGB(name='purple1', red=155, green=48, blue=255)``module-attribute`

### `PURPLE2 = RGB(name='purple2', red=145, green=44, blue=238)``module-attribute`

### `PURPLE3 = RGB(name='purple3', red=125, green=38, blue=205)``module-attribute`

### `PURPLE4 = RGB(name='purple4', red=85, green=26, blue=139)``module-attribute`

### `RASPBERRY = RGB(name='raspberry', red=135, green=38, blue=87)``module-attribute`

### `RAWSIENNA = RGB(name='rawsienna', red=199, green=97, blue=20)``module-attribute`

### `RED1 = RGB(name='red1', red=255, green=0, blue=0)``module-attribute`

### `RED2 = RGB(name='red2', red=238, green=0, blue=0)``module-attribute`

### `RED3 = RGB(name='red3', red=205, green=0, blue=0)``module-attribute`

### `RED4 = RGB(name='red4', red=139, green=0, blue=0)``module-attribute`

### `ROSYBROWN = RGB(name='rosybrown', red=188, green=143, blue=143)``module-attribute`

### `ROSYBROWN1 = RGB(name='rosybrown1', red=255, green=193, blue=193)``module-attribute`

### `ROSYBROWN2 = RGB(name='rosybrown2', red=238, green=180, blue=180)``module-attribute`

### `ROSYBROWN3 = RGB(name='rosybrown3', red=205, green=155, blue=155)``module-attribute`

### `ROSYBROWN4 = RGB(name='rosybrown4', red=139, green=105, blue=105)``module-attribute`

### `ROYALBLUE = RGB(name='royalblue', red=65, green=105, blue=225)``module-attribute`

### `ROYALBLUE1 = RGB(name='royalblue1', red=72, green=118, blue=255)``module-attribute`

### `ROYALBLUE2 = RGB(name='royalblue2', red=67, green=110, blue=238)``module-attribute`

### `ROYALBLUE3 = RGB(name='royalblue3', red=58, green=95, blue=205)``module-attribute`

### `ROYALBLUE4 = RGB(name='royalblue4', red=39, green=64, blue=139)``module-attribute`

### `SALMON = RGB(name='salmon', red=250, green=128, blue=114)``module-attribute`

### `SALMON1 = RGB(name='salmon1', red=255, green=140, blue=105)``module-attribute`

### `SALMON2 = RGB(name='salmon2', red=238, green=130, blue=98)``module-attribute`

### `SALMON3 = RGB(name='salmon3', red=205, green=112, blue=84)``module-attribute`

### `SALMON4 = RGB(name='salmon4', red=139, green=76, blue=57)``module-attribute`

### `SANDYBROWN = RGB(name='sandybrown', red=244, green=164, blue=96)``module-attribute`

### `SAPGREEN = RGB(name='sapgreen', red=48, green=128, blue=20)``module-attribute`

### `SEAGREEN1 = RGB(name='seagreen1', red=84, green=255, blue=159)``module-attribute`

### `SEAGREEN2 = RGB(name='seagreen2', red=78, green=238, blue=148)``module-attribute`

### `SEAGREEN3 = RGB(name='seagreen3', red=67, green=205, blue=128)``module-attribute`

### `SEAGREEN4 = RGB(name='seagreen4', red=46, green=139, blue=87)``module-attribute`

### `SEASHELL1 = RGB(name='seashell1', red=255, green=245, blue=238)``module-attribute`

### `SEASHELL2 = RGB(name='seashell2', red=238, green=229, blue=222)``module-attribute`

### `SEASHELL3 = RGB(name='seashell3', red=205, green=197, blue=191)``module-attribute`

### `SEASHELL4 = RGB(name='seashell4', red=139, green=134, blue=130)``module-attribute`

### `SEPIA = RGB(name='sepia', red=94, green=38, blue=18)``module-attribute`

### `SGIBEET = RGB(name='sgibeet', red=142, green=56, blue=142)``module-attribute`

### `SGIBRIGHTGRAY = RGB(name='sgibrightgray', red=197, green=193, blue=170)``module-attribute`

### `SGICHARTREUSE = RGB(name='sgichartreuse', red=113, green=198, blue=113)``module-attribute`

### `SGIDARKGRAY = RGB(name='sgidarkgray', red=85, green=85, blue=85)``module-attribute`

### `SGIGRAY12 = RGB(name='sgigray12', red=30, green=30, blue=30)``module-attribute`

### `SGIGRAY16 = RGB(name='sgigray16', red=40, green=40, blue=40)``module-attribute`

### `SGIGRAY32 = RGB(name='sgigray32', red=81, green=81, blue=81)``module-attribute`

### `SGIGRAY36 = RGB(name='sgigray36', red=91, green=91, blue=91)``module-attribute`

### `SGIGRAY52 = RGB(name='sgigray52', red=132, green=132, blue=132)``module-attribute`

### `SGIGRAY56 = RGB(name='sgigray56', red=142, green=142, blue=142)``module-attribute`

### `SGIGRAY72 = RGB(name='sgigray72', red=183, green=183, blue=183)``module-attribute`

### `SGIGRAY76 = RGB(name='sgigray76', red=193, green=193, blue=193)``module-attribute`

### `SGIGRAY92 = RGB(name='sgigray92', red=234, green=234, blue=234)``module-attribute`

### `SGIGRAY96 = RGB(name='sgigray96', red=244, green=244, blue=244)``module-attribute`

### `SGILIGHTBLUE = RGB(name='sgilightblue', red=125, green=158, blue=192)``module-attribute`

### `SGILIGHTGRAY = RGB(name='sgilightgray', red=170, green=170, blue=170)``module-attribute`

### `SGIOLIVEDRAB = RGB(name='sgiolivedrab', red=142, green=142, blue=56)``module-attribute`

### `SGISALMON = RGB(name='sgisalmon', red=198, green=113, blue=113)``module-attribute`

### `SGISLATEBLUE = RGB(name='sgislateblue', red=113, green=113, blue=198)``module-attribute`

### `SGITEAL = RGB(name='sgiteal', red=56, green=142, blue=142)``module-attribute`

### `SIENNA = RGB(name='sienna', red=160, green=82, blue=45)``module-attribute`

### `SIENNA1 = RGB(name='sienna1', red=255, green=130, blue=71)``module-attribute`

### `SIENNA2 = RGB(name='sienna2', red=238, green=121, blue=66)``module-attribute`

### `SIENNA3 = RGB(name='sienna3', red=205, green=104, blue=57)``module-attribute`

### `SIENNA4 = RGB(name='sienna4', red=139, green=71, blue=38)``module-attribute`

### `SILVER = RGB(name='silver', red=192, green=192, blue=192)``module-attribute`

### `SKYBLUE = RGB(name='skyblue', red=135, green=206, blue=235)``module-attribute`

### `SKYBLUE1 = RGB(name='skyblue1', red=135, green=206, blue=255)``module-attribute`

### `SKYBLUE2 = RGB(name='skyblue2', red=126, green=192, blue=238)``module-attribute`

### `SKYBLUE3 = RGB(name='skyblue3', red=108, green=166, blue=205)``module-attribute`

### `SKYBLUE4 = RGB(name='skyblue4', red=74, green=112, blue=139)``module-attribute`

### `SLATEBLUE = RGB(name='slateblue', red=106, green=90, blue=205)``module-attribute`

### `SLATEBLUE1 = RGB(name='slateblue1', red=131, green=111, blue=255)``module-attribute`

### `SLATEBLUE2 = RGB(name='slateblue2', red=122, green=103, blue=238)``module-attribute`

### `SLATEBLUE3 = RGB(name='slateblue3', red=105, green=89, blue=205)``module-attribute`

### `SLATEBLUE4 = RGB(name='slateblue4', red=71, green=60, blue=139)``module-attribute`

### `SLATEGRAY = RGB(name='slategray', red=112, green=128, blue=144)``module-attribute`

### `SLATEGRAY1 = RGB(name='slategray1', red=198, green=226, blue=255)``module-attribute`

### `SLATEGRAY2 = RGB(name='slategray2', red=185, green=211, blue=238)``module-attribute`

### `SLATEGRAY3 = RGB(name='slategray3', red=159, green=182, blue=205)``module-attribute`

### `SLATEGRAY4 = RGB(name='slategray4', red=108, green=123, blue=139)``module-attribute`

### `SNOW1 = RGB(name='snow1', red=255, green=250, blue=250)``module-attribute`

### `SNOW2 = RGB(name='snow2', red=238, green=233, blue=233)``module-attribute`

### `SNOW3 = RGB(name='snow3', red=205, green=201, blue=201)``module-attribute`

### `SNOW4 = RGB(name='snow4', red=139, green=137, blue=137)``module-attribute`

### `SPRINGGREEN = RGB(name='springgreen', red=0, green=255, blue=127)``module-attribute`

### `SPRINGGREEN1 = RGB(name='springgreen1', red=0, green=238, blue=118)``module-attribute`

### `SPRINGGREEN2 = RGB(name='springgreen2', red=0, green=205, blue=102)``module-attribute`

### `SPRINGGREEN3 = RGB(name='springgreen3', red=0, green=139, blue=69)``module-attribute`

### `STEELBLUE = RGB(name='steelblue', red=70, green=130, blue=180)``module-attribute`

### `STEELBLUE1 = RGB(name='steelblue1', red=99, green=184, blue=255)``module-attribute`

### `STEELBLUE2 = RGB(name='steelblue2', red=92, green=172, blue=238)``module-attribute`

### `STEELBLUE3 = RGB(name='steelblue3', red=79, green=148, blue=205)``module-attribute`

### `STEELBLUE4 = RGB(name='steelblue4', red=54, green=100, blue=139)``module-attribute`

### `TAN = RGB(name='tan', red=210, green=180, blue=140)``module-attribute`

### `TAN1 = RGB(name='tan1', red=255, green=165, blue=79)``module-attribute`

### `TAN2 = RGB(name='tan2', red=238, green=154, blue=73)``module-attribute`

### `TAN3 = RGB(name='tan3', red=205, green=133, blue=63)``module-attribute`

### `TAN4 = RGB(name='tan4', red=139, green=90, blue=43)``module-attribute`

### `TEAL = RGB(name='teal', red=0, green=128, blue=128)``module-attribute`

### `THISTLE = RGB(name='thistle', red=216, green=191, blue=216)``module-attribute`

### `THISTLE1 = RGB(name='thistle1', red=255, green=225, blue=255)``module-attribute`

### `THISTLE2 = RGB(name='thistle2', red=238, green=210, blue=238)``module-attribute`

### `THISTLE3 = RGB(name='thistle3', red=205, green=181, blue=205)``module-attribute`

### `THISTLE4 = RGB(name='thistle4', red=139, green=123, blue=139)``module-attribute`

### `TOMATO1 = RGB(name='tomato1', red=255, green=99, blue=71)``module-attribute`

### `TOMATO2 = RGB(name='tomato2', red=238, green=92, blue=66)``module-attribute`

### `TOMATO3 = RGB(name='tomato3', red=205, green=79, blue=57)``module-attribute`

### `TOMATO4 = RGB(name='tomato4', red=139, green=54, blue=38)``module-attribute`

### `TURQUOISE = RGB(name='turquoise', red=64, green=224, blue=208)``module-attribute`

### `TURQUOISE1 = RGB(name='turquoise1', red=0, green=245, blue=255)``module-attribute`

### `TURQUOISE2 = RGB(name='turquoise2', red=0, green=229, blue=238)``module-attribute`

### `TURQUOISE3 = RGB(name='turquoise3', red=0, green=197, blue=205)``module-attribute`

### `TURQUOISE4 = RGB(name='turquoise4', red=0, green=134, blue=139)``module-attribute`

### `TURQUOISEBLUE = RGB(name='turquoiseblue', red=0, green=199, blue=140)``module-attribute`

### `VIOLET = RGB(name='violet', red=238, green=130, blue=238)``module-attribute`

### `VIOLETRED = RGB(name='violetred', red=208, green=32, blue=144)``module-attribute`

### `VIOLETRED1 = RGB(name='violetred1', red=255, green=62, blue=150)``module-attribute`

### `VIOLETRED2 = RGB(name='violetred2', red=238, green=58, blue=140)``module-attribute`

### `VIOLETRED3 = RGB(name='violetred3', red=205, green=50, blue=120)``module-attribute`

### `VIOLETRED4 = RGB(name='violetred4', red=139, green=34, blue=82)``module-attribute`

### `WARMGREY = RGB(name='warmgrey', red=128, green=128, blue=105)``module-attribute`

### `WHEAT = RGB(name='wheat', red=245, green=222, blue=179)``module-attribute`

### `WHEAT1 = RGB(name='wheat1', red=255, green=231, blue=186)``module-attribute`

### `WHEAT2 = RGB(name='wheat2', red=238, green=216, blue=174)``module-attribute`

### `WHEAT3 = RGB(name='wheat3', red=205, green=186, blue=150)``module-attribute`

### `WHEAT4 = RGB(name='wheat4', red=139, green=126, blue=102)``module-attribute`

### `WHITE = RGB(name='white', red=255, green=255, blue=255)``module-attribute`

### `WHITESMOKE = RGB(name='whitesmoke', red=245, green=245, blue=245)``module-attribute`

### `YELLOW1 = RGB(name='yellow1', red=255, green=255, blue=0)``module-attribute`

### `YELLOW2 = RGB(name='yellow2', red=238, green=238, blue=0)``module-attribute`

### `YELLOW3 = RGB(name='yellow3', red=205, green=205, blue=0)``module-attribute`

### `YELLOW4 = RGB(name='yellow4', red=139, green=139, blue=0)``module-attribute`

### `COLORS = OrderedDict(sorted(COLORS.items(), key=lambda t: t[0]))``module-attribute`

## Classes

### `RGB(name='default', red=0, green=0, blue=0)`

Bases: `object`

RGB named color object.

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `name` | `str` | color name |
| `red` | `int` | value for red component (0-255) |
| `green` | `int` | value for green component (0-255) |
| `blue` | `int` | value for blue component (0-255) |

Source code in `pyrevitlib/pyrevit/coreutils/colors.py`

|     |     |
| --- | --- |
| ```<br>31<br>32<br>33<br>``` | ```md-code__content<br>def __init__(self, name='default', red=0, green=0, blue=0):<br>    self.name = name<br>    self.red, self.green, self.blue = red, green, blue<br>``` |

#### Attributes

##### `name = name``instance-attribute`

##### `hex_color``property`

Return color in hex format.

##### `luminance``property`

Return color luminance (preceived).

##### `safe_text_color``property`

Return text color that is safe to overlap this color.

Back to top

## pyRevit Updater
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/versionmgr/updater/#pyrevit.versionmgr.updater)

# updater

Handle updating pyRevit repository and its extensions.

## Attributes

### `logger = get_logger(__name__)``module-attribute`

### `COREUPDATE_TRIGGER = 'COREUPDATE'``module-attribute`

### `COREUPDATE_MESSAGE = '<div class="coreupdatewarn"><strong>IMPORTANT</strong>\npyRevit has a major core update. This update <u>can not</u> be applied when Revit is running. Please close all Revit instances, and update the clone using the pyRevit CLI. Start Revit again after the update and pyRevit will load with the new core changes.</div>'``module-attribute`

## Functions

### `get_thirdparty_ext_repos()`

Return a list of repos for installed third-party extensions.

Source code in `pyrevitlib/pyrevit/versionmgr/updater.py`

|     |     |
| --- | --- |
| ```<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>``` | ```md-code__content<br>def get_thirdparty_ext_repos():<br>    """Return a list of repos for installed third-party extensions."""<br>    processed_paths = set()<br>    valid_exts = []<br>    ext_repos = []<br>    logger.debug('Finding installed repos...')<br>    ext_info_list = extensionmgr.get_thirdparty_extension_data()<br>    for ext_info in ext_info_list:<br>        repo_path = libgit.libgit.Repository.Discover(ext_info.directory)<br>        if repo_path:<br>            repo_info = libgit.get_repo(repo_path)<br>            if repo_info:<br>                valid_exts.append(ext_info)<br>                if repo_info.directory not in processed_paths:<br>                    processed_paths.add(repo_info.directory)<br>                    ext_repos.append(repo_info)<br>    logger.debug('Valid third-party extensions for update: %s', valid_exts)<br>    return ext_repos<br>``` |

### `get_all_extension_repos()`

Return a list of repos for all installed extensions.

Source code in `pyrevitlib/pyrevit/versionmgr/updater.py`

|     |     |
| --- | --- |
| ```<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>94<br>95<br>96<br>97<br>98<br>``` | ```md-code__content<br>def get_all_extension_repos():<br>    """Return a list of repos for all installed extensions."""<br>    logger.debug('Finding all extension repos.')<br>    # pyrevit main repo<br>    repo_info_list = []<br>    pyrevit_repo = versionmgr.get_pyrevit_repo()<br>    if pyrevit_repo:<br>        repo_info_list.append(pyrevit_repo)<br>    # add all thirdparty extension repos<br>    repo_info_list.extend(get_thirdparty_ext_repos())<br>    logger.debug('Repos are: %s', repo_info_list)<br>    return repo_info_list<br>``` |

### `update_repo(repo_info)`

Update repository.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_info` |  | obj: `pyrevit.coreutils.git.RepoInfo`):<br>repository info wrapper object | _required_ |

Source code in `pyrevitlib/pyrevit/versionmgr/updater.py`

|     |     |
| --- | --- |
| ```<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>``` | ```md-code__content<br>def update_repo(repo_info):<br>    """Update repository.<br>    Args:<br>        repo_info (:obj:`pyrevit.coreutils.git.RepoInfo`):<br>            repository info wrapper object<br>    """<br>    repo = repo_info.repo<br>    logger.debug('Updating repo: %s', repo_info.directory)<br>    head_msg = safe_strtype(repo.Head.Tip.Message).replace('\n', '')<br>    logger.debug('Current head is: %s > %s', repo.Head.Tip.Id.Sha, head_msg)<br>    username, password = _get_extension_credentials(repo_info)<br>    if username and password:<br>        repo_info.username = username<br>        repo_info.password = password<br>    try:<br>        updated_repo_info = libgit.git_pull(repo_info)<br>        logger.debug('Successfully updated repo: %s',<br>                     updated_repo_info.directory)<br>        return updated_repo_info<br>    except libgit.PyRevitGitAuthenticationError as auth_err:<br>        logger.debug('Can not login to git repository to get updates: %s | %s',<br>                     repo_info, auth_err)<br>        raise auth_err<br>    except Exception as update_err:<br>        logger.debug('Failed updating repo: %s | %s', repo_info, update_err)<br>        raise update_err<br>``` |

### `get_updates(repo_info)`

Fetch updates on repository.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_info` |  | obj: `pyrevit.coreutils.git.RepoInfo`):<br>repository info wrapper object | _required_ |

Source code in `pyrevitlib/pyrevit/versionmgr/updater.py`

|     |     |
| --- | --- |
| ```<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>``` | ```md-code__content<br>def get_updates(repo_info):<br>    """Fetch updates on repository.<br>    Args:<br>        repo_info (:obj:`pyrevit.coreutils.git.RepoInfo`):<br>            repository info wrapper object<br>    """<br>    repo = repo_info.repo<br>    at_least_one_fetch_was_successful = False<br>    logger.debug('Fetching updates for: %s', repo_info.directory)<br>    for remote in repo.Network.Remotes:<br>        try:<br>            _fetch_remote(remote, repo_info)<br>            at_least_one_fetch_was_successful = True<br>        except libgit.PyRevitGitAuthenticationError:<br>            logger.debug('Failed fetching updates. '<br>                         'Can not login to repo to get updates: %s', repo_info)<br>            continue<br>        except Exception:<br>            logger.debug('Failed fetching updates: %s', repo_info)<br>            continue<br>    if at_least_one_fetch_was_successful:<br>        return True<br>    return False<br>``` |

### `has_pending_updates(repo_info)`

Check for updates on repository.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `repo_info` |  | obj: `pyrevit.coreutils.git.RepoInfo`):<br>repository info wrapper object | _required_ |

Source code in `pyrevitlib/pyrevit/versionmgr/updater.py`

|     |     |
| --- | --- |
| ```<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>``` | ```md-code__content<br>def has_pending_updates(repo_info):<br>    """Check for updates on repository.<br>    Args:<br>        repo_info (:obj:`pyrevit.coreutils.git.RepoInfo`):<br>            repository info wrapper object<br>    """<br>    if get_updates(repo_info):<br>        hist_div = libgit.compare_branch_heads(repo_info)<br>        if hist_div.BehindBy > 0:<br>            return True<br>``` |

### `check_for_updates()`

Check whether any available repo has pending updates.

Source code in `pyrevitlib/pyrevit/versionmgr/updater.py`

|     |     |
| --- | --- |
| ```<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>``` | ```md-code__content<br>def check_for_updates():<br>    """Check whether any available repo has pending updates."""<br>    if _check_connection():<br>        logger.info('Checking for updates...')<br>        for repo in get_all_extension_repos():<br>            if has_pending_updates(repo):<br>                logger.info('Updates are available for %s...', repo.name)<br>                return True<br>            else:<br>                logger.info('%s is up-to-date...', repo.name)<br>    else:<br>        logger.warning('No internet access detected. '<br>                       'Skipping check for updates.')<br>        return False<br>``` |

### `has_core_updates()`

Check whether pyRevit repo has core updates.

This would require host application to be closed to release the file lock
of core DLLs so they can be updated separately.

Source code in `pyrevitlib/pyrevit/versionmgr/updater.py`

|     |     |
| --- | --- |
| ```<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>``` | ```md-code__content<br>def has_core_updates():<br>    """Check whether pyRevit repo has core updates.<br>    This would require host application to be closed to release the file lock<br>    of core DLLs so they can be updated separately.<br>    """<br>    pyrevit_repo = versionmgr.get_pyrevit_repo()<br>    if pyrevit_repo and get_updates(pyrevit_repo):<br>        new_commits = libgit.get_all_new_commits(pyrevit_repo)<br>        logger.debug('Checking new commits on pyrevit repo.')<br>        for cmt_sha, cmt_msg in new_commits.items():<br>            logger.debug('%s: %s', cmt_sha, cmt_msg)<br>            if COREUPDATE_TRIGGER in cmt_msg:<br>                logger.debug('pyrevit repo has core update at %s: %s',<br>                             cmt_sha, cmt_msg)<br>                return True<br>    return False<br>``` |

### `update_pyrevit()`

Update pyrevit and its extension repositories.

Source code in `pyrevitlib/pyrevit/versionmgr/updater.py`

|     |     |
| --- | --- |
| ```<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>``` | ```md-code__content<br>def update_pyrevit():<br>    """Update pyrevit and its extension repositories."""<br>    if _check_connection():<br>        third_party_updated = False<br>        pyrevit_updated = False<br>        pyrevit_has_coreupdates = has_core_updates()<br>        thirdparty_repos = get_thirdparty_ext_repos()<br>        logger.debug('List of thirdparty repos to be updated: %s',<br>                     thirdparty_repos)<br>        # update third-party extensions first, one by one<br>        for repo_info in thirdparty_repos:<br>            logger.debug('Updating repo: %s', repo_info.directory)<br>            try:<br>                upped_repo_info = update_repo(repo_info)<br>                logger.info(':inbox_tray: Successfully updated: %s to %s',<br>                            upped_repo_info.name,<br>                            upped_repo_info.last_commit_hash[:7])<br>                third_party_updated = True<br>            except Exception:<br>                logger.info('Can not update repo: %s (Run in debug to see why)',<br>                            repo_info.name)<br>        # now update pyrevit repo and reload<br>        pyrevit_repo = versionmgr.get_pyrevit_repo()<br>        if pyrevit_repo:<br>            if not pyrevit_has_coreupdates:<br>                logger.debug('Updating pyrevit repo: %s',<br>                             pyrevit_repo.directory)<br>                try:<br>                    upped_pyrevit_repo_info = update_repo(pyrevit_repo)<br>                    logger.info(':inbox_tray: Successfully updated: %s to %s',<br>                                upped_pyrevit_repo_info.name,<br>                                upped_pyrevit_repo_info.last_commit_hash[:7])<br>                    pyrevit_updated = True<br>                except Exception as err:<br>                    logger.info('Can not update pyrevit repo '<br>                                '(Run in debug to see why) | %s', err)<br>                # perform upgrade tasks<br>                logger.info('Upgrading settings...')<br>                upgrade.upgrade_existing_pyrevit()<br>        if not pyrevit_has_coreupdates:<br>            if third_party_updated or pyrevit_updated:<br>                # now reload pyrevit<br>                from pyrevit.loader import sessionmgr<br>                sessionmgr.reload_pyrevit()<br>            else:<br>                logger.info('pyRevit and extensions seem to be up-to-date.')<br>        else:<br>            from pyrevit import script<br>            output = script.get_output()<br>            output.print_html(COREUPDATE_MESSAGE)<br>            logger.debug('Core updates. Skippin update and reload.')<br>    else:<br>        logger.warning('No internet access detected. Skipping update.')<br>``` |

Back to top

## Extension Binary Caching
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/cacher_bin/#pyrevit.extensions.cacher_bin)

# cacher\_bin

Base module to handle extension binary caching.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `loaded_extensions = []``module-attribute`

## Classes

## Functions

### `update_cache(parsed_ext)`

Source code in `pyrevitlib/pyrevit/extensions/cacher_bin.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>``` | ```md-code__content<br>def update_cache(parsed_ext):<br>    try:<br>        mlogger.debug('Writing cache for: %s', parsed_ext)<br>        cache_file = _get_cache_file(parsed_ext)<br>        mlogger.debug('Cache file is: %s', cache_file)<br>        with open(cache_file, 'wb') as bin_cache_file:<br>            pickle.dump(parsed_ext, bin_cache_file, pickle.HIGHEST_PROTOCOL)<br>    except Exception as err:<br>        raise PyRevitException('Error writing cache for: {} | {}'<br>                               .format(parsed_ext, err))<br>``` |

### `get_cached_extension(installed_ext)`

Source code in `pyrevitlib/pyrevit/extensions/cacher_bin.py`

|     |     |
| --- | --- |
| ```<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>``` | ```md-code__content<br>def get_cached_extension(installed_ext):<br>    for loaded_ext in loaded_extensions:<br>        if loaded_ext.name == installed_ext.name:<br>            return loaded_ext<br>    try:<br>        mlogger.debug('Reading cache for: %s', installed_ext)<br>        cache_file = _get_cache_file(installed_ext)<br>        mlogger.debug('Cache file is: %s', cache_file)<br>        with open(cache_file, 'rb') as bin_cache_file:<br>            unpickled_pkg = pickle.load(bin_cache_file)<br>    except Exception as err:<br>        raise PyRevitException('Error reading cache for: {} | {}'<br>                               .format(installed_ext, err))<br>    return unpickled_pkg<br>``` |

### `is_cache_valid(extension)`

Source code in `pyrevitlib/pyrevit/extensions/cacher_bin.py`

|     |     |
| --- | --- |
| ```<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>``` | ```md-code__content<br>def is_cache_valid(extension):<br>    try:<br>        cached_ext = get_cached_extension(extension)<br>        mlogger.debug('Extension cache directory is: %s for: %s',<br>                      extension.directory, extension)<br>        cache_dir_valid = \<br>            cached_ext.directory == extension.directory<br>        mlogger.debug('Extension cache version is: %s for: %s',<br>                      extension.pyrvt_version, extension)<br>        cache_version_valid = \<br>            cached_ext.pyrvt_version == extension.pyrvt_version<br>        mlogger.debug('Extension hash value is: %s for: %s',<br>                      extension.dir_hash_value, extension)<br>        cache_hash_valid = \<br>            cached_ext.dir_hash_value == extension.dir_hash_value<br>        cache_valid = \<br>            cache_dir_valid and cache_version_valid and cache_hash_valid<br>        # add loaded package to list so it can be recovered later<br>        if cache_valid:<br>            loaded_extensions.append(cached_ext)<br>        # cache is valid if both version and hash value match<br>        return cache_valid<br>    except PyRevitException as err:<br>        mlogger.debug('Error reading cache file or file is not available: %s',<br>                      err)<br>        return False<br>    except Exception as err:<br>        mlogger.debug('Error determining cache validity: %s | %s',<br>                      extension, err)<br>        return False<br>``` |

Back to top

## Python Type Maker
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/pythontypemaker/#pyrevit.runtime.pythontypemaker)

# pythontypemaker

Prepare and compile python script types.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

## Functions

### `create_executor_type(extension, module_builder, cmd_component)`

Create the dotnet type for the executor.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extension` | `Extension` | pyRevit extension | _required_ |
| `module_builder` | `ModuleBuilder` | module builder | _required_ |
| `cmd_component` | `GenericUICommand` | command | _required_ |

Source code in `pyrevitlib/pyrevit/runtime/pythontypemaker.py`

|     |     |
| --- | --- |
| ```<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>``` | ```md-code__content<br>def create_executor_type(extension, module_builder, cmd_component):<br>    """Create the dotnet type for the executor.<br>    Args:<br>        extension (pyrevit.extensions.components.Extension): pyRevit extension<br>        module_builder (ModuleBuilder): module builder<br>        cmd_component (pyrevit.extensions.genericcomps.GenericUICommand):<br>            command<br>    """<br>    cmd_component.requires_clean_engine = \<br>        _does_need_clean_engine(extension, cmd_component)<br>    engine_configs = runtime.create_ipyengine_configs(<br>        clean=cmd_component.requires_clean_engine,<br>        full_frame=cmd_component.requires_fullframe_engine,<br>        persistent=cmd_component.requires_persistent_engine,<br>    )<br>    bundletypemaker.create_executor_type(<br>        extension,<br>        module_builder,<br>        cmd_component,<br>        eng_cfgs=engine_configs<br>        )<br>``` |

Back to top

## Markdown to HTML
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/markdown/#pyrevit.coreutils.markdown)

# markdown

Python Markdown.

Python Markdown converts Markdown to HTML and can be used as a library or
called from the command line.

### Basic usage as a module:

```
import markdown
html = markdown.markdown(your_text_string)

```

See [https://pythonhosted.org/Markdown/](https://pythonhosted.org/Markdown/) for more
information and instructions on how to extend the functionality of
Python Markdown. Read that before you try modifying this file.

### Authors and License

Started by [Manfred Stienstra](http://www.dwerg.net/). Continued and
maintained by [Yuri Takhteyev](http://www.freewisdom.org/), [Waylan\\
Limberg](http://achinghead.com/) and [Artem Yunusov](http://blog.splyer.com/).

Contact: markdown@freewisdom.org

Copyright 2007-2013 The Python Markdown Project (v. 1.7 and later)
Copyright 200? Django Software Foundation (OrderedDict implementation)
Copyright 2004, 2005, 2006 Yuri Takhteyev (v. 0.2-1.6b)
Copyright 2004 Manfred Stienstra (the original version)

License: BSD (see LICENSE for details).

## Attributes

### `logger = logging.getLogger('MARKDOWN')``module-attribute`

## Classes

### `Markdown(*args, **kwargs)`

Bases: `object`

Convert Markdown to HTML.

Creates a new Markdown instance.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*args` | `Any` | positional args | `()` |
| `**kwargs` | `Any` | keyword args | `{}` |

Other Parameters:

| Name | Type | Description |
| --- | --- | --- |
| `extensions` | `list[Extension | str]` | A list of extensions.<br>If they are of type string, the module mdx\_name.py will be loaded.<br>If they are a subclass of markdown.Extension, they will be used<br>as-is. |
| `extension_configs` | `dict[str, Any]` | Configuration settings for extensions. |
| `output_format` | `str` | Format of output. Supported formats are:<br>\\* "xhtml1": Outputs XHTML 1.x. Default.<br>\\* "xhtml5": Outputs XHTML style tags of HTML 5<br>\\* "xhtml": Outputs latest supported version of XHTML<br>(currently XHTML 1.1).<br>\\* "html4": Outputs HTML 4<br>\\* "html5": Outputs HTML style tags of HTML 5<br>\\* "html": Outputs latest supported version of HTML<br>(currently HTML 4).<br>Note that it is suggested that the more specific formats ("xhtml1"<br>and "html4") be used as "xhtml" or "html" may change in the future<br>if it makes sense at that time. |
| `safe_mode` | `str` | Deprecated! Disallow raw html.<br>One of "remove", "replace" or "escape". |
| `html_replacement_text` | `str` | Deprecated! Text used when safe\_mode<br>is set to "replace". |
| `tab_length` | `int` | Length of tabs in the source. Default: 4 |
| `enable_attributes` | `bool` | Enable the conversion of attributes.<br>Default: True |
| `smart_emphasis` | `bool` | Treat `_connected_words_` intelligently<br>Default: True |
| `lazy_ol` | `bool` | Ignore number of first item of ordered lists.<br>Default: True |

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br> 78<br> 79<br> 80<br> 81<br> 82<br> 83<br> 84<br> 85<br> 86<br> 87<br> 88<br> 89<br> 90<br> 91<br> 92<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>``` | ```md-code__content<br>def __init__(self, *args, **kwargs):<br>    """Creates a new Markdown instance.<br>    Args:<br>        *args (Any): positional args<br>        **kwargs (Any): keyword args<br>    Keyword Args:<br>        extensions (list[Extension | str]): A list of extensions.<br>            If they are of type string, the module mdx_name.py will be loaded.<br>            If they are a subclass of markdown.Extension, they will be used<br>            as-is.<br>        extension_configs (dict[str, Any]): Configuration settings for extensions.<br>        output_format (str): Format of output. Supported formats are:<br>            * "xhtml1": Outputs XHTML 1.x. Default.<br>            * "xhtml5": Outputs XHTML style tags of HTML 5<br>            * "xhtml": Outputs latest supported version of XHTML<br>              (currently XHTML 1.1).<br>            * "html4": Outputs HTML 4<br>            * "html5": Outputs HTML style tags of HTML 5<br>            * "html": Outputs latest supported version of HTML<br>              (currently HTML 4).<br>            Note that it is suggested that the more specific formats ("xhtml1"<br>            and "html4") be used as "xhtml" or "html" may change in the future<br>            if it makes sense at that time.<br>        safe_mode (str): Deprecated! Disallow raw html.<br>            One of "remove", "replace" or "escape".<br>        html_replacement_text (str): Deprecated! Text used when safe_mode<br>            is set to "replace".<br>        tab_length (int): Length of tabs in the source. Default: 4<br>        enable_attributes (bool): Enable the conversion of attributes.<br>            Default: True<br>        smart_emphasis (bool): Treat `_connected_words_` intelligently<br>            Default: True<br>        lazy_ol (bool): Ignore number of first item of ordered lists.<br>            Default: True<br>    """<br>    # For backward compatibility, loop through old positional args<br>    pos = ['extensions', 'extension_configs', 'safe_mode', 'output_format']<br>    for c, arg in enumerate(args):<br>        if pos[c] not in kwargs:<br>            kwargs[pos[c]] = arg<br>        if c+1 == len(pos):  # pragma: no cover<br>            # ignore any additional args<br>            break<br>    if len(args):<br>        warnings.warn('Positional arguments are deprecated in Markdown. '<br>                      'Use keyword arguments only.',<br>                      DeprecationWarning)<br>    # Loop through kwargs and assign defaults<br>    for option, default in self.option_defaults.items():<br>        setattr(self, option, kwargs.get(option, default))<br>    self.safeMode = kwargs.get('safe_mode', False)<br>    if self.safeMode and 'enable_attributes' not in kwargs:<br>        # Disable attributes in safeMode when not explicitly set<br>        self.enable_attributes = False<br>    if 'safe_mode' in kwargs:<br>        warnings.warn('"safe_mode" is deprecated in Python-Markdown. '<br>                      'Use an HTML sanitizer (like '<br>                      'Bleach https://bleach.readthedocs.io/) '<br>                      'if you are parsing untrusted markdown text. '<br>                      'See the 2.6 release notes for more info',<br>                      DeprecationWarning)<br>    if 'html_replacement_text' in kwargs:<br>        warnings.warn('The "html_replacement_text" keyword is '<br>                      'deprecated along with "safe_mode".',<br>                      DeprecationWarning)<br>    self.ESCAPED_CHARS = ['\\', '`', '*', '_', '{', '}', '[', ']',<br>                          '(', ')', '>', '#', '+', '-', '.', '!']<br>    self.registeredExtensions = []<br>    self.docType = ""<br>    self.stripTopLevelTags = True<br>    self.build_parser()<br>    self.references = {}<br>    self.htmlStash = util.HtmlStash()<br>    self.registerExtensions(extensions=kwargs.get('extensions', []),<br>                            configs=kwargs.get('extension_configs', {}))<br>    self.set_output_format(kwargs.get('output_format', 'xhtml1'))<br>    self.reset()<br>``` |

#### Attributes

##### `doc_tag = 'div'``class-attribute``instance-attribute`

##### `option_defaults = {'html_replacement_text': '[HTML_REMOVED]', 'tab_length': 4, 'enable_attributes': True, 'smart_emphasis': True, 'lazy_ol': True}``class-attribute``instance-attribute`

##### `output_formats = {'html': to_html_string, 'html4': to_html_string, 'html5': to_html_string, 'xhtml': to_xhtml_string, 'xhtml1': to_xhtml_string, 'xhtml5': to_xhtml_string}``class-attribute``instance-attribute`

##### `safeMode = kwargs.get('safe_mode', False)``instance-attribute`

##### `enable_attributes = False``instance-attribute`

##### ``ESCAPED_CHARS = ['\\', '`', '*', '_', '{', '}', '[', ']', '(', ')', '>', '\#', '+', '-', '.', '!']```instance-attribute`

##### `registeredExtensions = []``instance-attribute`

##### `docType = ''``instance-attribute`

##### `stripTopLevelTags = True``instance-attribute`

##### `references = {}``instance-attribute`

##### `htmlStash = util.HtmlStash()``instance-attribute`

#### Functions

##### `build_parser()`

Build the parser from the various parts.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>``` | ```md-code__content<br>def build_parser(self):<br>    """Build the parser from the various parts."""<br>    self.preprocessors = build_preprocessors(self)<br>    self.parser = build_block_parser(self)<br>    self.inlinePatterns = build_inlinepatterns(self)<br>    self.treeprocessors = build_treeprocessors(self)<br>    self.postprocessors = build_postprocessors(self)<br>    return self<br>``` |

##### `registerExtensions(extensions, configs)`

Register extensions with this instance of Markdown.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extensions` | `list[Extension]` | extensions strings or objects.<br>See the docstring on Markdown. | _required_ |
| `configs` | `dict[str, Any]` | A dictionary mapping module names to config options. | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>``` | ```md-code__content<br>def registerExtensions(self, extensions, configs):<br>    """Register extensions with this instance of Markdown.<br>    Args:<br>        extensions (list[Extension]): extensions strings or objects.<br>            See the docstring on Markdown.<br>        configs (dict[str, Any]): A dictionary mapping module names to config options.<br>    """<br>    for ext in extensions:<br>        if isinstance(ext, util.string_type):<br>            ext = self.build_extension(ext, configs.get(ext, {}))<br>        if isinstance(ext, Extension):<br>            ext.extendMarkdown(self, globals())<br>            logger.debug(<br>                'Successfully loaded extension "%s.%s".'<br>                % (ext.__class__.__module__, ext.__class__.__name__)<br>            )<br>        elif ext is not None:<br>            raise TypeError(<br>                'Extension "%s.%s" must be of type: "markdown.Extension"'<br>                % (ext.__class__.__module__, ext.__class__.__name__))<br>    return self<br>``` |

##### `build_extension(ext_name, configs)`

Build extension by name, then return the module.

The extension name may contain arguments as part of the string in the
following format: "extname(key1=value1,key2=value2)"

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>``` | ```md-code__content<br>def build_extension(self, ext_name, configs):<br>    """Build extension by name, then return the module.<br>    The extension name may contain arguments as part of the string in the<br>    following format: "extname(key1=value1,key2=value2)"<br>    """<br>    configs = dict(configs)<br>    # Parse extensions config params (ignore the order)<br>    pos = ext_name.find("(")  # find the first "("<br>    if pos > 0:<br>        ext_args = ext_name[pos+1:-1]<br>        ext_name = ext_name[:pos]<br>        pairs = [x.split("=") for x in ext_args.split(",")]<br>        configs.update([(x.strip(), y.strip()) for (x, y) in pairs])<br>        warnings.warn('Setting configs in the Named Extension string is '<br>                      'deprecated. It is recommended that you '<br>                      'pass an instance of the extension class to '<br>                      'Markdown or use the "extension_configs" keyword. '<br>                      'The current behavior will raise an error in version 2.7. '<br>                      'See the Release Notes for Python-Markdown version '<br>                      '2.6 for more info.', DeprecationWarning)<br>    # Get class name (if provided): `path.to.module:ClassName`<br>    ext_name, class_name = ext_name.split(':', 1) \<br>        if ':' in ext_name else (ext_name, '')<br>    # Try loading the extension first from one place, then another<br>    try:<br>        # Assume string uses dot syntax (`path.to.some.module`)<br>        module = importlib.import_module(ext_name)<br>        logger.debug(<br>            'Successfuly imported extension module "%s".' % ext_name<br>        )<br>        # For backward compat (until deprecation)<br>        # check that this is an extension.<br>        if ('.' not in ext_name and not (hasattr(module, 'makeExtension') or<br>           (class_name and hasattr(module, class_name)))):<br>            # We have a name conflict<br>            # eg: extensions=['tables'] and PyTables is installed<br>            raise ImportError<br>    except ImportError:<br>        # Preppend `markdown.extensions.` to name<br>        module_name = '.'.join(['markdown.extensions', ext_name])<br>        try:<br>            module = importlib.import_module(module_name)<br>            logger.debug(<br>                'Successfuly imported extension module "%s".' %<br>                module_name<br>            )<br>            warnings.warn('Using short names for Markdown\'s builtin '<br>                          'extensions is deprecated. Use the '<br>                          'full path to the extension with Python\'s dot '<br>                          'notation (eg: "%s" instead of "%s"). The '<br>                          'current behavior will raise an error in version '<br>                          '2.7. See the Release Notes for '<br>                          'Python-Markdown version 2.6 for more info.' %<br>                          (module_name, ext_name),<br>                          DeprecationWarning)<br>        except ImportError:<br>            # Preppend `mdx_` to name<br>            module_name_old_style = '_'.join(['mdx', ext_name])<br>            try:<br>                module = importlib.import_module(module_name_old_style)<br>                logger.debug(<br>                    'Successfuly imported extension module "%s".' %<br>                    module_name_old_style)<br>                warnings.warn('Markdown\'s behavior of prepending "mdx_" '<br>                              'to an extension name is deprecated. '<br>                              'Use the full path to the '<br>                              'extension with Python\'s dot notation '<br>                              '(eg: "%s" instead of "%s"). The current '<br>                              'behavior will raise an error in version 2.7. '<br>                              'See the Release Notes for Python-Markdown '<br>                              'version 2.6 for more info.' %<br>                              (module_name_old_style, ext_name),<br>                              DeprecationWarning)<br>            except ImportError as e:<br>                message = "Failed loading extension '%s' from '%s', '%s' " \<br>                    "or '%s'" % (ext_name, ext_name, module_name,<br>                                 module_name_old_style)<br>                e.args = (message,) + e.args[1:]<br>                raise<br>    if class_name:<br>        # Load given class name from module.<br>        return getattr(module, class_name)(**configs)<br>    else:<br>        # Expect  makeExtension() function to return a class.<br>        try:<br>            return module.makeExtension(**configs)<br>        except AttributeError as e:<br>            message = e.args[0]<br>            message = "Failed to initiate extension " \<br>                      "'%s': %s" % (ext_name, message)<br>            e.args = (message,) + e.args[1:]<br>            raise<br>``` |

##### `registerExtension(extension)`

This gets called by the extension.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>299<br>300<br>301<br>302<br>``` | ```md-code__content<br>def registerExtension(self, extension):<br>    """This gets called by the extension."""<br>    self.registeredExtensions.append(extension)<br>    return self<br>``` |

##### `reset()`

Resets all state variables so that we can start with a new text.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>``` | ```md-code__content<br>def reset(self):<br>    """Resets all state variables so that we can start with a new text."""<br>    self.htmlStash.reset()<br>    self.references.clear()<br>    for extension in self.registeredExtensions:<br>        if hasattr(extension, 'reset'):<br>            extension.reset()<br>    return self<br>``` |

##### `set_output_format(format)`

Set the output format for the class instance.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>``` | ```md-code__content<br>def set_output_format(self, format):<br>    """Set the output format for the class instance."""<br>    self.output_format = format.lower()<br>    try:<br>        self.serializer = self.output_formats[self.output_format]<br>    except KeyError as e:<br>        valid_formats = list(self.output_formats.keys())<br>        valid_formats.sort()<br>        message = 'Invalid Output Format: "%s". Use one of %s.' \<br>            % (self.output_format,<br>               '"' + '", "'.join(valid_formats) + '"')<br>        e.args = (message,) + e.args[1:]<br>        raise<br>    return self<br>``` |

##### `convert(source)`

Convert markdown to serialized XHTML or HTML.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `source` | `str` | Source text as a Unicode string. | _required_ |

Markdown processing takes place in five steps:

1. A bunch of "preprocessors" munge the input text.
2. BlockParser() parses the high-level structural elements of the
    pre-processed text into an ElementTree.
3. A bunch of "treeprocessors" are run against the ElementTree. One
    such treeprocessor runs InlinePatterns against the ElementTree,
    detecting inline markup.
4. Some post-processors are run against the text after the ElementTree
    has been serialized into text.
5. The output is written to a string.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>350<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>387<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>``` | ```md-code__content<br>def convert(self, source):<br>    """Convert markdown to serialized XHTML or HTML.<br>    Args:<br>        source (str): Source text as a Unicode string.<br>    Markdown processing takes place in five steps:<br>    1. A bunch of "preprocessors" munge the input text.<br>    2. BlockParser() parses the high-level structural elements of the<br>       pre-processed text into an ElementTree.<br>    3. A bunch of "treeprocessors" are run against the ElementTree. One<br>       such treeprocessor runs InlinePatterns against the ElementTree,<br>       detecting inline markup.<br>    4. Some post-processors are run against the text after the ElementTree<br>       has been serialized into text.<br>    5. The output is written to a string.<br>    """<br>    # Fixup the source text<br>    if not source.strip():<br>        return ''  # a blank unicode string<br>    try:<br>        source = unicode(source)<br>    except UnicodeDecodeError as e:<br>        # Customise error message while maintaining original trackback<br>        e.reason += '. -- Note: Markdown only accepts unicode input!'<br>        raise<br>    # Split into lines and run the line preprocessors.<br>    self.lines = source.split("\n")<br>    for prep in self.preprocessors.values():<br>        self.lines = prep.run(self.lines)<br>    # Parse the high-level elements.<br>    root = self.parser.parseDocument(self.lines).getroot()<br>    # Run the tree-processors<br>    for treeprocessor in self.treeprocessors.values():<br>        newRoot = treeprocessor.run(root)<br>        if newRoot is not None:<br>            root = newRoot<br>    # Serialize _properly_.  Strip top-level tags.<br>    output = self.serializer(root)<br>    if self.stripTopLevelTags:<br>        try:<br>            start = output.index(<br>                '<%s>' % self.doc_tag) + len(self.doc_tag) + 2<br>            end = output.rindex('</%s>' % self.doc_tag)<br>            output = output[start:end].strip()<br>        except ValueError:  # pragma: no cover<br>            if output.strip().endswith('<%s />' % self.doc_tag):<br>                # We have an empty document<br>                output = ''<br>            else:<br>                # We have a serious problem<br>                raise ValueError('Markdown failed to strip top-level '<br>                                 'tags. Document=%r' % output.strip())<br>    # Run the text post-processors<br>    for pp in self.postprocessors.values():<br>        output = pp.run(output)<br>    return output.strip()<br>``` |

##### `convertFile(input=None, output=None, encoding=None)`

Converts a Markdown file and returns the HTML as a Unicode string.

Decodes the file using the provided encoding (defaults to utf-8),
passes the file content to markdown, and outputs the html to either
the provided stream or the file with provided name, using the same
encoding as the source file. The 'xmlcharrefreplace' error handler is
used when encoding the output.

**Note:** This is the only place that decoding and encoding of Unicode
takes place in Python-Markdown. (All other code is Unicode-in /
Unicode-out.)

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `input` | `str | None` | File object or path. Reads from stdin if `None`. | `None` |
| `output` | `str | None` | File object or path. Writes to stdout if `None`. | `None` |
| `encoding` | `str` | Encoding of input and output files. Defaults to utf-8. | `None` |

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>427<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def convertFile(self, input=None, output=None, encoding=None):<br>    """Converts a Markdown file and returns the HTML as a Unicode string.<br>    Decodes the file using the provided encoding (defaults to utf-8),<br>    passes the file content to markdown, and outputs the html to either<br>    the provided stream or the file with provided name, using the same<br>    encoding as the source file. The 'xmlcharrefreplace' error handler is<br>    used when encoding the output.<br>    **Note:** This is the only place that decoding and encoding of Unicode<br>    takes place in Python-Markdown.  (All other code is Unicode-in /<br>    Unicode-out.)<br>    Args:<br>        input (str | None): File object or path. Reads from stdin if `None`.<br>        output (str | None): File object or path. Writes to stdout if `None`.<br>        encoding (str): Encoding of input and output files. Defaults to utf-8.<br>    """<br>    encoding = encoding or "utf-8"<br>    # Read the source<br>    if input:<br>        if isinstance(input, util.string_type):<br>            input_file = codecs.open(input, mode="r", encoding=encoding)<br>        else:<br>            input_file = codecs.getreader(encoding)(input)<br>        text = input_file.read()<br>        input_file.close()<br>    else:<br>        text = sys.stdin.read()<br>        if not isinstance(text, util.text_type):<br>            text = text.decode(encoding)<br>    text = text.lstrip('\ufeff')  # remove the byte-order mark<br>    # Convert<br>    html = self.convert(text)<br>    # Write to file or stdout<br>    if output:<br>        if isinstance(output, util.string_type):<br>            output_file = codecs.open(output, "w",<br>                                      encoding=encoding,<br>                                      errors="xmlcharrefreplace")<br>            output_file.write(html)<br>            output_file.close()<br>        else:<br>            writer = codecs.getwriter(encoding)<br>            output_file = writer(output, errors="xmlcharrefreplace")<br>            output_file.write(html)<br>            # Don't close here. User may want to write more.<br>    else:<br>        # Encode manually and write bytes to stdout.<br>        html = html.encode(encoding, "xmlcharrefreplace")<br>        try:<br>            # Write bytes directly to buffer (Python 3).<br>            sys.stdout.buffer.write(html)<br>        except AttributeError:<br>            # Probably Python 2, which works with bytes by default.<br>            sys.stdout.write(html)<br>    return self<br>``` |

## Functions

### `markdown(text, *args, **kwargs)`

Convert a Markdown string to HTML and return HTML as a Unicode string.

This is a shortcut function for `Markdown` class to cover the most
basic use case. It initializes an instance of Markdown, loads the
necessary extensions and runs the parser on the given text.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `text` | `str` | Markdown formatted text as Unicode or ASCII string. | _required_ |
| `*args` | `Any` | Any arguments accepted by the Markdown class. | `()` |
| `**kwargs` | `Any` | Any arguments accepted by the Markdown class. | `{}` |

Returns:

| Type | Description |
| --- | --- |
| `str` | An HTML document as a string. |

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>``` | ```md-code__content<br>def markdown(text, *args, **kwargs):<br>    """Convert a Markdown string to HTML and return HTML as a Unicode string.<br>    This is a shortcut function for `Markdown` class to cover the most<br>    basic use case.  It initializes an instance of Markdown, loads the<br>    necessary extensions and runs the parser on the given text.<br>    Args:<br>        text (str): Markdown formatted text as Unicode or ASCII string.<br>        *args (Any): Any arguments accepted by the Markdown class.<br>        **kwargs (Any): Any arguments accepted by the Markdown class.<br>    Returns:<br>        (str): An HTML document as a string.<br>    """<br>    md = Markdown(*args, **kwargs)<br>    return md.convert(text)<br>``` |

### `markdownFromFile(*args, **kwargs)`

Read markdown code from a file and write it to a file or a stream.

This is a shortcut function which initializes an instance of Markdown,
and calls the convertFile method rather than convert.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `*args` | `Any` | Any arguments accepted by the Markdown class.<br>input (str): a file name or readable object.<br>output (str): a file name or writable object.<br>encoding (str): Encoding of input and output. | `()` |
| `**kwargs` | `Any` | Any arguments accepted by the Markdown class. | `{}` |

Source code in `pyrevitlib/pyrevit/coreutils/markdown/__init__.py`

|     |     |
| --- | --- |
| ```<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>509<br>510<br>511<br>512<br>513<br>514<br>515<br>516<br>517<br>518<br>519<br>520<br>521<br>``` | ```md-code__content<br>def markdownFromFile(*args, **kwargs):<br>    """Read markdown code from a file and write it to a file or a stream.<br>    This is a shortcut function which initializes an instance of Markdown,<br>    and calls the convertFile method rather than convert.<br>    Args:<br>        *args (Any): Any arguments accepted by the Markdown class.<br>            input (str): a file name or readable object.<br>            output (str): a file name or writable object.<br>            encoding (str): Encoding of input and output.<br>        **kwargs (Any): Any arguments accepted by the Markdown class.<br>    """<br>    # For backward compatibility loop through positional args<br>    pos = ['input', 'output', 'extensions', 'encoding']<br>    c = 0<br>    for arg in args:<br>        if pos[c] not in kwargs:<br>            kwargs[pos[c]] = arg<br>        c += 1<br>        if c == len(pos):<br>            break<br>    if len(args):<br>        warnings.warn('Positional arguments are depreacted in '<br>                      'Markdown and will raise an error in version 2.7. '<br>                      'Use keyword arguments only.',<br>                      DeprecationWarning)<br>    md = Markdown(**kwargs)<br>    md.convertFile(kwargs.get('input', None),<br>                   kwargs.get('output', None),<br>                   kwargs.get('encoding', None))<br>``` |

Back to top

## pyRevit Hooks Management
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/loader/hooks/#pyrevit.loader.hooks)

# hooks

Hooks management.

## Attributes

### `SUPPORTED_LANGUAGES = [exts.PYTHON_SCRIPT_FILE_FORMAT, exts.CSHARP_SCRIPT_FILE_FORMAT, exts.VB_SCRIPT_FILE_FORMAT]``module-attribute`

### `mlogger = get_logger(__name__)``module-attribute`

### `ExtensionEventHook = namedtuple('ExtensionEventHook', ['id', 'name', 'target', 'script', 'syspaths', 'extension_name'])``module-attribute`

## Functions

### `get_hooks_handler()`

Get the hook handler environment variable.

Returns:

| Type | Description |
| --- | --- |
| `EventHooks` | hook handler |

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>``` | ```md-code__content<br>def get_hooks_handler():<br>    """Get the hook handler environment variable.<br>    Returns:<br>        (EventHooks): hook handler<br>    """<br>    return envvars.get_pyrevit_env_var(envvars.HOOKSHANDLER_ENVVAR)<br>``` |

### `set_hooks_handler(handler)`

Set the hook handler environment variable.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `handler` | `EventHooks` | hook handler | _required_ |

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>``` | ```md-code__content<br>def set_hooks_handler(handler):<br>    """Set the hook handler environment variable.<br>    Args:<br>        handler (EventHooks): hook handler<br>    """<br>    envvars.set_pyrevit_env_var(envvars.HOOKSHANDLER_ENVVAR, handler)<br>``` |

### `is_valid_hook_script(hook_script)`

Check if the given hook script is valid.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `hook_script` | `str` | hook script path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if the script is valid, False otherwise |

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>``` | ```md-code__content<br>def is_valid_hook_script(hook_script):<br>    """Check if the given hook script is valid.<br>    Args:<br>        hook_script (str): hook script path<br>    Returns:<br>        (bool): True if the script is valid, False otherwise<br>    """<br>    return op.splitext(op.basename(hook_script))[1] in SUPPORTED_LANGUAGES<br>``` |

### `get_extension_hooks(extension)`

Get the hooks of the given extension.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extension` | `Extension` | pyRevit extension | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[ExtensionEventHook]` | list of hooks |

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br> 90<br> 91<br> 92<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>``` | ```md-code__content<br>def get_extension_hooks(extension):<br>    """Get the hooks of the given extension.<br>    Args:<br>        extension (pyrevit.extensions.components.Extension): pyRevit extension<br>    Returns:<br>        (list[ExtensionEventHook]): list of hooks<br>    """<br>    event_hooks = []<br>    for hook_script in extension.get_hooks():<br>        if is_valid_hook_script(hook_script):<br>            name, target = _get_hook_parts(extension, hook_script)<br>            if name:<br>                event_hooks.append(<br>                    ExtensionEventHook(<br>                        id=_create_hook_id(extension, hook_script),<br>                        name=name,<br>                        target=target,<br>                        script=hook_script,<br>                        syspaths=extension.module_paths,<br>                        extension_name=extension.name,<br>                    )<br>                )<br>    return event_hooks<br>``` |

### `get_event_hooks()`

Get all the event hooks.

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>120<br>``` | ```md-code__content<br>def get_event_hooks():<br>    """Get all the event hooks."""<br>    hooks_handler = get_hooks_handler()<br>    return hooks_handler.GetAllEventHooks()<br>``` |

### `register_hooks(extension)`

Register the hooks for the given extension.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extension` | `Extension` | pyRevit extension | _required_ |

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>``` | ```md-code__content<br>def register_hooks(extension):<br>    """Register the hooks for the given extension.<br>    Args:<br>        extension (pyrevit.extensions.components.Extension): pyRevit extension<br>    """<br>    hooks_handler = get_hooks_handler()<br>    for ext_hook in get_extension_hooks(extension):<br>        try:<br>            hooks_handler.RegisterHook(<br>                uniqueId=ext_hook.id,<br>                eventName=ext_hook.name,<br>                eventTarget=ext_hook.target,<br>                scriptPath=ext_hook.script,<br>                searchPaths=framework.Array[str](ext_hook.syspaths),<br>                extensionName=ext_hook.extension_name,<br>            )<br>        except Exception as hookEx:<br>            mlogger.error("Failed registering hook script %s | %s",<br>                          ext_hook.script, hookEx)<br>``` |

### `unregister_hooks(extension)`

Unregister all hooks for the given extension.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extension` | `Extension` | pyRevit extension | _required_ |

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>``` | ```md-code__content<br>def unregister_hooks(extension):<br>    """Unregister all hooks for the given extension.<br>    Args:<br>        extension (pyrevit.extensions.components.Extension): pyRevit extension<br>    """<br>    hooks_handler = get_hooks_handler()<br>    for ext_hook in get_extension_hooks(extension):<br>        hooks_handler.UnRegisterHook(uniqueId=ext_hook.id)<br>``` |

### `unregister_all_hooks()`

Unregister all hooks.

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>156<br>157<br>158<br>159<br>``` | ```md-code__content<br>def unregister_all_hooks():<br>    """Unregister all hooks."""<br>    hooks_handler = get_hooks_handler()<br>    hooks_handler.UnRegisterAllHooks(uiApp=HOST_APP.uiapp)<br>``` |

### `activate()`

Activate all event hooks.

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>162<br>163<br>164<br>165<br>``` | ```md-code__content<br>def activate():<br>    """Activate all event hooks."""<br>    hooks_handler = get_hooks_handler()<br>    hooks_handler.ActivateEventHooks(uiApp=HOST_APP.uiapp)<br>``` |

### `deactivate()`

Deactivate all event hooks.

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>168<br>169<br>170<br>171<br>``` | ```md-code__content<br>def deactivate():<br>    """Deactivate all event hooks."""<br>    hooks_handler = get_hooks_handler()<br>    hooks_handler.DeactivateEventHooks(uiApp=HOST_APP.uiapp)<br>``` |

### `setup_hooks(session_id=None)`

Setup the hooks for the given session.

If no session is specified, use the current one.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `session_id` | `str` | Session. Defaults to None. | `None` |

Source code in `pyrevitlib/pyrevit/loader/hooks.py`

|     |     |
| --- | --- |
| ```<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>``` | ```md-code__content<br>def setup_hooks(session_id=None):<br>    """Setup the hooks for the given session.<br>    If no session is specified, use the current one.<br>    Args:<br>        session_id (str, optional): Session. Defaults to None.<br>    """<br>    # make sure session id is availabe<br>    if not session_id:<br>        session_id = sessioninfo.get_session_uuid()<br>    hooks_handler = get_hooks_handler()<br>    if hooks_handler:<br>        # deactivate old<br>        hooks_handler.DeactivateEventHooks(uiApp=HOST_APP.uiapp)<br>    # setup new<br>    hooks_handler = EventHooks(session_id)<br>    set_hooks_handler(hooks_handler)<br>    unregister_all_hooks()<br>``` |

Back to top

## HTML Card Generation
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/output/cards/#pyrevit.output.cards)

# cards

This module contains functions to generate HTML cards for use in pyRevit output.

## Functions

### `card_start_style(limit, value, alt)`

Generates an HTML div element with a specific background color based on the ratio of value to limit.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `limit` | `float` | The limit value used to calculate the ratio. | _required_ |
| `value` | `float` | The current value to be compared against the limit. | _required_ |
| `alt` | `str` | The alt text for the div element. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | An HTML div element as a string with inline styles and the specified background color. |

The background color is determined by the following rules:
\- 'Grey' if value is 0 or if an exception occurs during ratio calculation.
\- 'Green' if 0 <= ratio < 0.5.
\- 'Orange' if 0.5 <= ratio <= 1.
\- 'Red' if ratio > 1.

Source code in `pyrevitlib/pyrevit/output/cards.py`

|     |     |
| --- | --- |
| ```<br> 6<br> 7<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def card_start_style(limit, value, alt):<br>    """<br>    Generates an HTML div element with a specific background color based on the ratio of value to limit.<br>    Args:<br>        limit (float): The limit value used to calculate the ratio.<br>        value (float): The current value to be compared against the limit.<br>        alt (str): The alt text for the div element.<br>    Returns:<br>        str: An HTML div element as a string with inline styles and the specified background color.<br>    The background color is determined by the following rules:<br>        - 'Grey' if value is 0 or if an exception occurs during ratio calculation.<br>        - 'Green' if 0 <= ratio < 0.5.<br>        - 'Orange' if 0.5 <= ratio <= 1.<br>        - 'Red' if ratio > 1.<br>    """<br>    try:<br>        ratio = float(value) / float(limit)<br>    except ZeroDivisionError:<br>        ratio = 0<br>    color = "#d0d3d4"<br>    if value != 0:<br>        if ratio < 0.5:<br>            color = "#D0E6A5"  # green<br>        elif ratio <= 1:<br>            color = "#FFDD94"  # orange<br>        else:<br>            color = "#FA897B"  # red<br>    try:<br>        card_start = '<div style="display: inline-block; width: 100px; height: 40px; background: {}; font-family: sans-serif; font-size: 0.85rem; padding: 5px; text-align: center; border-radius: 8px; margin: 5px; box-shadow: 0 6px 6px 0 rgba(0, 0, 0, 0.2); vertical-align: top;" alt="{}">'.format(<br>            color, alt<br>        )<br>    except Exception as e:<br>        print(e)<br>    return card_start<br>``` |

### `card_builder(limit, value, description)`

Builds an HTML card with the given limit, value, and description.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `limit` | `int` | The limit value to be displayed in the card. | _required_ |
| `value` | `int or str` | The main value to be displayed in the card. | _required_ |
| `description` | `str` | A description to be displayed in the card. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | A string containing the HTML representation of the card. |

Source code in `pyrevitlib/pyrevit/output/cards.py`

|     |     |
| --- | --- |
| ```<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>``` | ```md-code__content<br>def card_builder(limit, value, description):<br>    """<br>    Builds an HTML card with the given limit, value, and description.<br>    Args:<br>        limit (int): The limit value to be displayed in the card.<br>        value (int or str): The main value to be displayed in the card.<br>        description (str): A description to be displayed in the card.<br>    Returns:<br>        str: A string containing the HTML representation of the card.<br>    """<br>    alt = "{} {} (limit = {})".format(str(value), str(description), str(limit))<br>    card_end = '<b>{}</b><br /><a style="font-size: 0.70rem">{}</a></div>'.format(<br>        value, description<br>    )<br>    return card_start_style(limit, value, alt) + card_end<br>``` |

### `create_frame(title, *cards)`

Creates an HTML div frame containing multiple cards with a rounded border and a title on the top left corner.

return card\_start\_style(limit, value, alt) + card\_end
cards (str): Multiple strings representing HTML card elements.

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | A string containing the HTML representation of the div frame. |

Source code in `pyrevitlib/pyrevit/output/cards.py`

|     |     |
| --- | --- |
| ```<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>``` | ```md-code__content<br>def create_frame(title, *cards):<br>    """<br>    Creates an HTML div frame containing multiple cards with a rounded border and a title on the top left corner.<br>    return card_start_style(limit, value, alt) + card_end<br>        cards (str): Multiple strings representing HTML card elements.<br>    Returns:<br>        str: A string containing the HTML representation of the div frame.<br>    """<br>    # Add vertical-align: top to the frame and adjust title position<br>    frame_start = '<div style="display: inline-block; vertical-align: top; border: 1px solid #ccc; border-radius: 10px; padding: 5px; margin: 10px 5px 10px 5px; position: relative;">'<br>    title_html = '<div style="position: absolute; top: -12px; left: 10px; background: white; padding: 0 5px; font-weight: bold;">{}</div>'.format(<br>        title<br>    )<br>    cards_html = "".join(cards)<br>    frame_end = "</div>"<br>    return frame_start + title_html + cards_html + frame_end<br>``` |

Back to top

## Autodesk Desktop Connector
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/adc/#pyrevit.interop.adc)

# adc

Wrapping Autodesk Desktop Connector API.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `ADC_NAME = 'Autodesk Desktop Connector'``module-attribute`

### `ADC_SHORTNAME = 'ADC'``module-attribute`

### `ADC_DRIVE_SCHEMA = '{drive_name}://'``module-attribute`

### `ADC_DEFAULT_INSTALL_PATH = 'C:\\Program Files\\Autodesk\\Desktop Connector'``module-attribute`

### `ADC_API_DLL = 'Autodesk.DesktopConnector.API.dll'``module-attribute`

### `ADC_API_DLL_PATH = op.join(ADC_DEFAULT_INSTALL_PATH, ADC_API_DLL)``module-attribute`

## Classes

## Functions

### `is_available()`

Check if ADC service is available.

Source code in `pyrevitlib/pyrevit/interop/adc.py`

|     |     |
| --- | --- |
| ```<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>``` | ```md-code__content<br>def is_available():<br>    """Check if ADC service is available."""<br>    try:<br>        _get_adc().Discover()<br>        return True<br>    except Exception:<br>        return False<br>``` |

### `get_drive_paths()`

Get dict of local paths for ADC drives.

Source code in `pyrevitlib/pyrevit/interop/adc.py`

|     |     |
| --- | --- |
| ```<br>134<br>135<br>136<br>137<br>``` | ```md-code__content<br>def get_drive_paths():<br>    """Get dict of local paths for ADC drives."""<br>    adc = _get_adc()<br>    return {x.Name: x.WorkspaceLocation for x in _get_drives_info(adc)}<br>``` |

### `get_local_path(path)`

Convert ADC BIM360 drive path to local path.

Source code in `pyrevitlib/pyrevit/interop/adc.py`

|     |     |
| --- | --- |
| ```<br>140<br>141<br>142<br>143<br>144<br>145<br>``` | ```md-code__content<br>def get_local_path(path):<br>    """Convert ADC BIM360 drive path to local path."""<br>    adc = _get_adc()<br>    drv_info = _get_drive_from_path(adc, path)<br>    if drv_info:<br>        return _drive_path_to_local_path(drv_info, path)<br>``` |

### `lock_file(path)`

Lock given file.

Source code in `pyrevitlib/pyrevit/interop/adc.py`

|     |     |
| --- | --- |
| ```<br>148<br>149<br>150<br>151<br>152<br>``` | ```md-code__content<br>def lock_file(path):<br>    """Lock given file."""<br>    adc = _get_adc()<br>    item = _get_item(adc, path)<br>    adc.LockFile(item.Id)<br>``` |

### `is_locked(path)`

Check if file is locked.

Source code in `pyrevitlib/pyrevit/interop/adc.py`

|     |     |
| --- | --- |
| ```<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>``` | ```md-code__content<br>def is_locked(path):<br>    """Check if file is locked."""<br>    adc = _get_adc()<br>    item = _get_item(adc, path)<br>    lock_status = _get_item_lockstatus(adc, item)<br>    return lock_status.State == API.LockState.LockedByOther, \<br>        lock_status.LockOwner<br>``` |

### `unlock_file(path)`

Unlock given file.

Source code in `pyrevitlib/pyrevit/interop/adc.py`

|     |     |
| --- | --- |
| ```<br>164<br>165<br>166<br>167<br>168<br>``` | ```md-code__content<br>def unlock_file(path):<br>    """Unlock given file."""<br>    adc = _get_adc()<br>    item = _get_item(adc, path)<br>    adc.UnlockFile(item.Id)<br>``` |

### `is_synced(path)`

Check if file is synchronized.

Source code in `pyrevitlib/pyrevit/interop/adc.py`

|     |     |
| --- | --- |
| ```<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>``` | ```md-code__content<br>def is_synced(path):<br>    """Check if file is synchronized."""<br>    adc = _get_adc()<br>    item = _get_item(adc, path)<br>    drive = _get_item_drive(adc, item)<br>    # ADC uses translated property names so<br>    # check status property by its type "LocalState"<br>    # see https://github.com/pyrevitlabs/pyRevit/issues/1152<br>    # ADC version 15 changed property_id_value<br>    # see https://github.com/pyrevitlabs/pyRevit/issues/1371<br>    prop_val = _get_item_property_id_value(adc, drive, item, 'DesktopConnector.Core.LocalState')<br>    if prop_val is None:<br>        # version older than ADC 15<br>        prop_val = _get_item_property_id_value(adc, drive, item, 'LocalState')<br>    # possible values, 'Cached', 'Stale', 'Modified'<br>    # .Value is not translated<br>    return prop_val.Value == 'Cached'or prop_val.Value == 'Synced'<br>``` |

### `sync_file(path, force=False)`

Force ADC to sync given file to latest version.

Source code in `pyrevitlib/pyrevit/interop/adc.py`

|     |     |
| --- | --- |
| ```<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>``` | ```md-code__content<br>def sync_file(path, force=False):<br>    """Force ADC to sync given file to latest version."""<br>    if not force and is_synced(path):<br>        return<br>    adc = _get_adc()<br>    item = _get_item(adc, path)<br>    # make sure path is local<br>    local_path = _ensure_local_path(adc, path)<br>    for proc_id in _get_all_processids():<br>        adc.FileClosedWithinRunningProcess(proc_id, local_path)<br>    adc.SyncFiles([item.Id])<br>``` |

Back to top

## Generic Extension Components
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/genericcomps/#pyrevit.extensions.genericcomps)

# genericcomps

Generic extension components.

## Attributes

### `mlogger = coreutils.logger.get_logger(__name__)``module-attribute`

### `EXT_DIR_KEY = 'directory'``module-attribute`

### `SUB_CMP_KEY = 'components'``module-attribute`

### `LAYOUT_ITEM_KEY = 'layout_items'``module-attribute`

### `LAYOUT_DIR_KEY = 'directive'``module-attribute`

### `TYPE_ID_KEY = 'type_id'``module-attribute`

### `NAME_KEY = 'name'``module-attribute`

## Classes

### `TypedComponent`

Bases: `object`

Component with a type id.

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

### `CachableComponent`

Bases: `TypedComponent`

Cacheable Component.

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

### `LayoutDirective(directive_type=None, target=None)`

Bases: `CachableComponent`

Layout directive.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>50<br>51<br>52<br>``` | ```md-code__content<br>def __init__(self, directive_type=None, target=None):<br>    self.directive_type = directive_type<br>    self.target = target<br>``` |

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

##### `directive_type = directive_type``instance-attribute`

##### `target = target``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

### `LayoutItem(name=None, directive=None)`

Bases: `CachableComponent`

Layout item.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>57<br>58<br>59<br>``` | ```md-code__content<br>def __init__(self, name=None, directive=None):<br>    self.name = name<br>    self.directive = directive<br>``` |

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

##### `name = name``instance-attribute`

##### `directive = directive``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

### `GenericComponent()`

Bases: `CachableComponent`

Generic component object.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>64<br>65<br>``` | ```md-code__content<br>def __init__(self):<br>    self.name = None<br>``` |

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

##### `name = None``instance-attribute`

##### `is_container``property`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

### `GenericUIComponent(cmp_path=None)`

Bases: `GenericComponent`

Generic UI component.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br> 77<br> 78<br> 79<br> 80<br> 81<br> 82<br> 83<br> 84<br> 85<br> 86<br> 87<br> 88<br> 89<br> 90<br> 91<br> 92<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericComponent.__init__(self)<br>    self.directory = cmp_path<br>    self.unique_name = self.parent_ctrl_id = None<br>    self.icon_file = None<br>    self._ui_title = None<br>    self._tooltip = self.author = self._help_url = None<br>    self.media_file = None<br>    self.min_revit_ver = self.max_revit_ver = None<br>    self.is_beta = False<br>    self.highlight_type = None<br>    self.collapsed = False<br>    self.version = None<br>    self.meta = {}<br>    self.meta_file = None<br>    self.modules = []<br>    self.module_paths = []<br>    self.binary_path = None<br>    self.library_path = None<br>    if self.directory:<br>        self._update_from_directory()<br>``` |

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

### `GenericUIContainer(cmp_path=None)`

Bases: `GenericUIComponent`

Superclass for all UI group items (tab, panel, button groups, stacks).

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.layout_items = []<br>    self.components = []<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `allowed_sub_cmps = []``class-attribute``instance-attribute`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

### `GenericUICommand(cmp_path=None, needs_script=True)`

Bases: `GenericUIComponent`

Superclass for all single commands.

The information provided by these classes will be used to create a
push button under Revit UI. However, pyRevit expands the capabilities of
push button beyond what is provided by Revit UI. (e.g. Toggle button
changes it's icon based on its on/off status)
See LinkButton and ToggleButton classes.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>516<br>517<br>518<br>519<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None, needs_script=True):<br>    self.needs_script = needs_script<br>    self.script_file = self.config_script_file = None<br>    self.arguments = []<br>    self.context = None<br>    self.class_name = self.avail_class_name = None<br>    self.requires_clean_engine = False<br>    self.requires_fullframe_engine = False<br>    self.requires_persistent_engine = False<br>    self.requires_mainthread_engine = False<br>    # engine options specific to dynamo<br>    self.dynamo_path = None<br>    # self.dynamo_path_exec = False<br>    self.dynamo_path_check_existing = False<br>    self.dynamo_force_manual_run = False<br>    self.dynamo_model_nodes_info = None<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>    mlogger.debug('Maximum host version: %s', self.max_revit_ver)<br>    mlogger.debug('Minimum host version: %s', self.min_revit_ver)<br>    mlogger.debug('command tooltip: %s', self._tooltip)<br>    mlogger.debug('Command author: %s', self.author)<br>    mlogger.debug('Command help url: %s', self._help_url)<br>    if self.is_beta:<br>        mlogger.debug('Command is in beta.')<br>``` |

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `script_file = None``instance-attribute`

##### `config_script_file = None``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `control_id``property`

##### `is_cpython``property`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

Back to top

## Revit Geometric Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/geom/#pyrevit.revit.geom)

# geom

Geometric utilities for Revit.

## Functions

### `convert_point_coord_system(rvt_point, rvt_transform)`

Return coordinates of point in another coordinate system.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvt_point` | `XYZ` | Revit point | _required_ |
| `rvt_transform` | `Transform` | Revit transform for target coord system | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `XYZ` | Point coordinates in new coordinate system. |

Source code in `pyrevitlib/pyrevit/revit/geom.py`

|     |     |
| --- | --- |
| ```<br> 6<br> 7<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>``` | ```md-code__content<br>def convert_point_coord_system(rvt_point, rvt_transform):<br>    """Return coordinates of point in another coordinate system.<br>    Args:<br>        rvt_point (DB.XYZ): Revit point<br>        rvt_transform (DB.Transform): Revit transform for target coord system<br>    Returns:<br>        (DB.XYZ): Point coordinates in new coordinate system.<br>    """<br>    # transform the origin of the old coordinate system in the new<br>    # coordinate system<br>    return rvt_transform.OfVector(rvt_transform.Origin - rvt_point)<br>``` |

### `convert_point_to_metric(rvt_point)`

Convert given point coordinates to metric.

Source code in `pyrevitlib/pyrevit/revit/geom.py`

|     |     |
| --- | --- |
| ```<br>21<br>22<br>23<br>24<br>25<br>``` | ```md-code__content<br>def convert_point_to_metric(rvt_point):<br>    """Convert given point coordinates to metric."""<br>    return DB.XYZ(rvt_point.X * 0.3048,<br>                  rvt_point.Y * 0.3048,<br>                  rvt_point.Z * 0.3048)<br>``` |

Back to top

## pyRevit Extension Components
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/components/#pyrevit.extensions.components)

# components

Base classes for pyRevit extension components.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `EXT_HASH_VALUE_KEY = 'dir_hash_value'``module-attribute`

### `EXT_HASH_VERSION_KEY = 'pyrvt_version'``module-attribute`

## Classes

### `NoButton(cmp_path=None, needs_script=True)`

Bases: `GenericUICommand`

This is not a button.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>516<br>517<br>518<br>519<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None, needs_script=True):<br>    self.needs_script = needs_script<br>    self.script_file = self.config_script_file = None<br>    self.arguments = []<br>    self.context = None<br>    self.class_name = self.avail_class_name = None<br>    self.requires_clean_engine = False<br>    self.requires_fullframe_engine = False<br>    self.requires_persistent_engine = False<br>    self.requires_mainthread_engine = False<br>    # engine options specific to dynamo<br>    self.dynamo_path = None<br>    # self.dynamo_path_exec = False<br>    self.dynamo_path_check_existing = False<br>    self.dynamo_force_manual_run = False<br>    self.dynamo_model_nodes_info = None<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>    mlogger.debug('Maximum host version: %s', self.max_revit_ver)<br>    mlogger.debug('Minimum host version: %s', self.min_revit_ver)<br>    mlogger.debug('command tooltip: %s', self._tooltip)<br>    mlogger.debug('Command author: %s', self.author)<br>    mlogger.debug('Command help url: %s', self._help_url)<br>    if self.is_beta:<br>        mlogger.debug('Command is in beta.')<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `script_file = None``instance-attribute`

##### `config_script_file = None``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `type_id = exts.NOGUI_COMMAND_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

### `NoScriptButton(cmp_path=None, needs_commandclass=False)`

Bases: `GenericUICommand`

Base for buttons that doesn't run a script.

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None, needs_commandclass=False):<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUICommand.__init__(self, cmp_path=cmp_path, needs_script=False)<br>    self.assembly = self.command_class = self.avail_command_class = None<br>    # read metadata from metadata file<br>    if self.meta:<br>        # get the target assembly from metadata<br>        self.assembly = \<br>            self.meta.get(exts.MDATA_LINK_BUTTON_ASSEMBLY, None)<br>        # get the target command class from metadata<br>        self.command_class = \<br>            self.meta.get(exts.MDATA_LINK_BUTTON_COMMAND_CLASS, None)<br>        # get the target command class from metadata<br>        self.avail_command_class = \<br>            self.meta.get(exts.MDATA_LINK_BUTTON_AVAIL_COMMAND_CLASS, None)<br>        # for invoke buttons there is no script source so<br>        # assign the metadata file to the script<br>        self.script_file = self.config_script_file = self.meta_file<br>    else:<br>        mlogger.debug("%s does not specify target assembly::class.", self)<br>    if self.directory and not self.assembly:<br>        mlogger.error("%s does not specify target assembly.", self)<br>    if self.directory and needs_commandclass and not self.command_class:<br>        mlogger.error("%s does not specify target command class.", self)<br>    mlogger.debug('%s assembly.class: %s.%s',<br>                  self, self.assembly, self.command_class)<br>``` |

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `assembly = None``instance-attribute`

##### `command_class = None``instance-attribute`

##### `avail_command_class = None``instance-attribute`

##### `script_file = self.meta_file``instance-attribute`

##### `config_script_file = self.meta_file``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

##### `get_target_assembly(required=False)`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>``` | ```md-code__content<br>def get_target_assembly(self, required=False):<br>    assm_file = self.assembly.lower()<br>    if not assm_file.endswith(framework.ASSEMBLY_FILE_TYPE):<br>        assm_file += '.' + framework.ASSEMBLY_FILE_TYPE<br>    # try finding assembly for this specific host version<br>    target_asm_by_host = self.find_bundle_module(assm_file, by_host=True)<br>    if target_asm_by_host:<br>        return target_asm_by_host<br>    # try find assembly by its name<br>    target_asm = self.find_bundle_module(assm_file)<br>    if target_asm:<br>        return target_asm<br>    if required:<br>        mlogger.error("%s can not find target assembly.", self)<br>    return ''<br>``` |

### `LinkButton(cmp_path=None)`

Bases: `NoScriptButton`

Link button.

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    # using classname otherwise exceptions in superclasses won't show<br>    NoScriptButton.__init__(<br>        self,<br>        cmp_path=cmp_path,<br>        needs_commandclass=True<br>        )<br>    if self.context:<br>        mlogger.warn(<br>            "Linkbutton bundles do not support \"context:\". "<br>            "Use \"availability_class:\" instead and specify name of "<br>            "availability class in target assembly | %s", self<br>            )<br>        self.context = None<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `script_file = self.meta_file``instance-attribute`

##### `config_script_file = self.meta_file``instance-attribute`

##### `arguments = []``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `assembly = None``instance-attribute`

##### `command_class = None``instance-attribute`

##### `avail_command_class = None``instance-attribute`

##### `type_id = exts.LINK_BUTTON_POSTFIX``class-attribute``instance-attribute`

##### `context = None``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

##### `get_target_assembly(required=False)`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>``` | ```md-code__content<br>def get_target_assembly(self, required=False):<br>    assm_file = self.assembly.lower()<br>    if not assm_file.endswith(framework.ASSEMBLY_FILE_TYPE):<br>        assm_file += '.' + framework.ASSEMBLY_FILE_TYPE<br>    # try finding assembly for this specific host version<br>    target_asm_by_host = self.find_bundle_module(assm_file, by_host=True)<br>    if target_asm_by_host:<br>        return target_asm_by_host<br>    # try find assembly by its name<br>    target_asm = self.find_bundle_module(assm_file)<br>    if target_asm:<br>        return target_asm<br>    if required:<br>        mlogger.error("%s can not find target assembly.", self)<br>    return ''<br>``` |

### `InvokeButton(cmp_path=None)`

Bases: `NoScriptButton`

Invoke button.

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    # using classname otherwise exceptions in superclasses won't show<br>    NoScriptButton.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `script_file = self.meta_file``instance-attribute`

##### `config_script_file = self.meta_file``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `assembly = None``instance-attribute`

##### `command_class = None``instance-attribute`

##### `avail_command_class = None``instance-attribute`

##### `type_id = exts.INVOKE_BUTTON_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

##### `get_target_assembly(required=False)`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>``` | ```md-code__content<br>def get_target_assembly(self, required=False):<br>    assm_file = self.assembly.lower()<br>    if not assm_file.endswith(framework.ASSEMBLY_FILE_TYPE):<br>        assm_file += '.' + framework.ASSEMBLY_FILE_TYPE<br>    # try finding assembly for this specific host version<br>    target_asm_by_host = self.find_bundle_module(assm_file, by_host=True)<br>    if target_asm_by_host:<br>        return target_asm_by_host<br>    # try find assembly by its name<br>    target_asm = self.find_bundle_module(assm_file)<br>    if target_asm:<br>        return target_asm<br>    if required:<br>        mlogger.error("%s can not find target assembly.", self)<br>    return ''<br>``` |

### `PushButton(cmp_path=None, needs_script=True)`

Bases: `GenericUICommand`

Push button.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>516<br>517<br>518<br>519<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None, needs_script=True):<br>    self.needs_script = needs_script<br>    self.script_file = self.config_script_file = None<br>    self.arguments = []<br>    self.context = None<br>    self.class_name = self.avail_class_name = None<br>    self.requires_clean_engine = False<br>    self.requires_fullframe_engine = False<br>    self.requires_persistent_engine = False<br>    self.requires_mainthread_engine = False<br>    # engine options specific to dynamo<br>    self.dynamo_path = None<br>    # self.dynamo_path_exec = False<br>    self.dynamo_path_check_existing = False<br>    self.dynamo_force_manual_run = False<br>    self.dynamo_model_nodes_info = None<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>    mlogger.debug('Maximum host version: %s', self.max_revit_ver)<br>    mlogger.debug('Minimum host version: %s', self.min_revit_ver)<br>    mlogger.debug('command tooltip: %s', self._tooltip)<br>    mlogger.debug('Command author: %s', self.author)<br>    mlogger.debug('Command help url: %s', self._help_url)<br>    if self.is_beta:<br>        mlogger.debug('Command is in beta.')<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `script_file = None``instance-attribute`

##### `config_script_file = None``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `type_id = exts.PUSH_BUTTON_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

### `PanelPushButton(cmp_path=None, needs_script=True)`

Bases: `GenericUICommand`

Panel push button.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>516<br>517<br>518<br>519<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None, needs_script=True):<br>    self.needs_script = needs_script<br>    self.script_file = self.config_script_file = None<br>    self.arguments = []<br>    self.context = None<br>    self.class_name = self.avail_class_name = None<br>    self.requires_clean_engine = False<br>    self.requires_fullframe_engine = False<br>    self.requires_persistent_engine = False<br>    self.requires_mainthread_engine = False<br>    # engine options specific to dynamo<br>    self.dynamo_path = None<br>    # self.dynamo_path_exec = False<br>    self.dynamo_path_check_existing = False<br>    self.dynamo_force_manual_run = False<br>    self.dynamo_model_nodes_info = None<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>    mlogger.debug('Maximum host version: %s', self.max_revit_ver)<br>    mlogger.debug('Minimum host version: %s', self.min_revit_ver)<br>    mlogger.debug('command tooltip: %s', self._tooltip)<br>    mlogger.debug('Command author: %s', self.author)<br>    mlogger.debug('Command help url: %s', self._help_url)<br>    if self.is_beta:<br>        mlogger.debug('Command is in beta.')<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `script_file = None``instance-attribute`

##### `config_script_file = None``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `type_id = exts.PANEL_PUSH_BUTTON_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

### `SmartButton(cmp_path=None, needs_script=True)`

Bases: `GenericUICommand`

Smart button.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>516<br>517<br>518<br>519<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None, needs_script=True):<br>    self.needs_script = needs_script<br>    self.script_file = self.config_script_file = None<br>    self.arguments = []<br>    self.context = None<br>    self.class_name = self.avail_class_name = None<br>    self.requires_clean_engine = False<br>    self.requires_fullframe_engine = False<br>    self.requires_persistent_engine = False<br>    self.requires_mainthread_engine = False<br>    # engine options specific to dynamo<br>    self.dynamo_path = None<br>    # self.dynamo_path_exec = False<br>    self.dynamo_path_check_existing = False<br>    self.dynamo_force_manual_run = False<br>    self.dynamo_model_nodes_info = None<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>    mlogger.debug('Maximum host version: %s', self.max_revit_ver)<br>    mlogger.debug('Minimum host version: %s', self.min_revit_ver)<br>    mlogger.debug('command tooltip: %s', self._tooltip)<br>    mlogger.debug('Command author: %s', self.author)<br>    mlogger.debug('Command help url: %s', self._help_url)<br>    if self.is_beta:<br>        mlogger.debug('Command is in beta.')<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `script_file = None``instance-attribute`

##### `config_script_file = None``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `type_id = exts.SMART_BUTTON_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

### `ContentButton(cmp_path=None)`

Bases: `GenericUICommand`

Content Button.

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUICommand.__init__(<br>        self,<br>        cmp_path=cmp_path,<br>        needs_script=False<br>        )<br>    # find content file<br>    self.script_file = \<br>        self.find_bundle_file([<br>            exts.CONTENT_VERSION_POSTFIX.format(<br>                version=HOST_APP.version<br>                ),<br>            ])<br>    if not self.script_file:<br>        self.script_file = \<br>            self.find_bundle_file([<br>                exts.CONTENT_POSTFIX,<br>                ])<br>    # requires at least one bundles<br>    if self.directory and not self.script_file:<br>        mlogger.error('Command %s: Does not have content file.', self)<br>        self.script_file = ''<br>    # find alternative content file<br>    self.config_script_file = \<br>        self.find_bundle_file([<br>            exts.ALT_CONTENT_VERSION_POSTFIX.format(<br>                version=HOST_APP.version<br>                ),<br>            ])<br>    if not self.config_script_file:<br>        self.config_script_file = \<br>            self.find_bundle_file([<br>                exts.ALT_CONTENT_POSTFIX,<br>                ])<br>    if not self.config_script_file:<br>        self.config_script_file = self.script_file<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `type_id = exts.CONTENT_BUTTON_POSTFIX``class-attribute``instance-attribute`

##### `script_file = self.find_bundle_file([exts.CONTENT_VERSION_POSTFIX.format(version=HOST_APP.version)])``instance-attribute`

##### `config_script_file = self.find_bundle_file([exts.ALT_CONTENT_VERSION_POSTFIX.format(version=HOST_APP.version)])``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

### `URLButton(cmp_path=None)`

Bases: `GenericUICommand`

URL button.

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUICommand.__init__(self, cmp_path=cmp_path, needs_script=False)<br>    self.target_url = None<br>    # read metadata from metadata file<br>    if self.meta:<br>        # get the target url from metadata<br>        self.target_url = \<br>            self.meta.get(exts.MDATA_URL_BUTTON_HYPERLINK, None)<br>        # for url buttons there is no script source so<br>        # assign the metadata file to the script<br>        self.script_file = self.config_script_file = self.meta_file<br>    else:<br>        mlogger.debug("%s does not specify target assembly::class.", self)<br>    if self.directory and not self.target_url:<br>        mlogger.error("%s does not specify target url.", self)<br>    mlogger.debug('%s target url: %s', self, self.target_url)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `needs_script = needs_script``instance-attribute`

##### `arguments = []``instance-attribute`

##### `context = None``instance-attribute`

##### `class_name = None``instance-attribute`

##### `avail_class_name = None``instance-attribute`

##### `requires_clean_engine = False``instance-attribute`

##### `requires_fullframe_engine = False``instance-attribute`

##### `requires_persistent_engine = False``instance-attribute`

##### `requires_mainthread_engine = False``instance-attribute`

##### `dynamo_path = None``instance-attribute`

##### `dynamo_path_check_existing = False``instance-attribute`

##### `dynamo_force_manual_run = False``instance-attribute`

##### `dynamo_model_nodes_info = None``instance-attribute`

##### `script_language``property`

##### `is_cpython``property`

##### `type_id = exts.URL_BUTTON_POSTFIX``class-attribute``instance-attribute`

##### `target_url = None``instance-attribute`

##### `script_file = self.meta_file``instance-attribute`

##### `config_script_file = self.meta_file``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>276<br>277<br>278<br>279<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    configurable_params = \<br>        ['_ui_title', '_tooltip', '_help_url', 'author']<br>    # get root key:value pairs<br>    for key, value in config_dict.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>    # get key:value pairs grouped under special key, if exists<br>    templates = config_dict.get(exts.MDATA_TEMPLATES_KEY, {})<br>    for key, value in templates.items():<br>        for param_name in configurable_params:<br>            self._resolve_liquid_tag(param_name, key, value)<br>``` |

##### `has_config_script()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>819<br>820<br>``` | ```md-code__content<br>def has_config_script(self):<br>    return self.config_script_file != self.script_file<br>``` |

##### `get_target_url()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>205<br>206<br>``` | ```md-code__content<br>def get_target_url(self):<br>    return self.target_url or ""<br>``` |

### `GenericUICommandGroup(cmp_path=None)`

Bases: `GenericUIContainer`

Generic UI command group.

Command groups only include commands.
These classes can include GenericUICommand as sub components.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.layout_items = []<br>    self.components = []<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `type_id = None``class-attribute``instance-attribute`

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `allowed_sub_cmps = [GenericUICommand, NoScriptButton]``class-attribute``instance-attribute`

##### `control_id``property`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `has_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>229<br>230<br>231<br>232<br>``` | ```md-code__content<br>def has_commands(self):<br>    for component in self:<br>        if isinstance(component, GenericUICommand):<br>            return True<br>``` |

### `PullDownButtonGroup(cmp_path=None)`

Bases: `GenericUICommandGroup`

Pulldown button group.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.layout_items = []<br>    self.components = []<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `allowed_sub_cmps = [GenericUICommand, NoScriptButton]``class-attribute``instance-attribute`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `type_id = exts.PULLDOWN_BUTTON_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `has_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>229<br>230<br>231<br>232<br>``` | ```md-code__content<br>def has_commands(self):<br>    for component in self:<br>        if isinstance(component, GenericUICommand):<br>            return True<br>``` |

### `SplitPushButtonGroup(cmp_path=None)`

Bases: `GenericUICommandGroup`

Split push button group.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.layout_items = []<br>    self.components = []<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `allowed_sub_cmps = [GenericUICommand, NoScriptButton]``class-attribute``instance-attribute`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `type_id = exts.SPLITPUSH_BUTTON_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `has_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>229<br>230<br>231<br>232<br>``` | ```md-code__content<br>def has_commands(self):<br>    for component in self:<br>        if isinstance(component, GenericUICommand):<br>            return True<br>``` |

### `SplitButtonGroup(cmp_path=None)`

Bases: `GenericUICommandGroup`

Split button group.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.layout_items = []<br>    self.components = []<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `allowed_sub_cmps = [GenericUICommand, NoScriptButton]``class-attribute``instance-attribute`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `type_id = exts.SPLIT_BUTTON_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `has_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>229<br>230<br>231<br>232<br>``` | ```md-code__content<br>def has_commands(self):<br>    for component in self:<br>        if isinstance(component, GenericUICommand):<br>            return True<br>``` |

### `GenericStack(cmp_path=None)`

Bases: `GenericUIContainer`

Generic UI stack.

Stacks include GenericUICommand, or GenericUICommandGroup.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.layout_items = []<br>    self.components = []<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `type_id = exts.STACK_BUTTON_POSTFIX``class-attribute``instance-attribute`

##### `allowed_sub_cmps = [GenericUICommandGroup, GenericUICommand, NoScriptButton]``class-attribute``instance-attribute`

##### `control_id``property`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `has_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>``` | ```md-code__content<br>def has_commands(self):<br>    for component in self:<br>        if not component.is_container:<br>            if isinstance(component, GenericUICommand):<br>                return True<br>        else:<br>            if component.has_commands():<br>                return True<br>``` |

### `StackButtonGroup(cmp_path=None)`

Bases: `GenericStack`

Stack buttons group.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.layout_items = []<br>    self.components = []<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `allowed_sub_cmps = [GenericUICommandGroup, GenericUICommand, NoScriptButton]``class-attribute``instance-attribute`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `type_id = exts.STACK_BUTTON_POSTFIX``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `has_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>``` | ```md-code__content<br>def has_commands(self):<br>    for component in self:<br>        if not component.is_container:<br>            if isinstance(component, GenericUICommand):<br>                return True<br>        else:<br>            if component.has_commands():<br>                return True<br>``` |

### `Panel(cmp_path=None)`

Bases: `GenericUIContainer`

Panel container.

Panels include GenericStack, GenericUICommand, or GenericUICommandGroup

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIContainer.__init__(self, cmp_path=cmp_path)<br>    self.panel_background = \<br>        self.title_background = \<br>            self.slideout_background = None<br>    # read metadata from metadata file<br>    if self.meta:<br>        # check for background color configs<br>        self.panel_background = \<br>            self.meta.get(exts.MDATA_BACKGROUND_KEY, None)<br>        if self.panel_background:<br>            if isinstance(self.panel_background, dict):<br>                self.title_background = self.panel_background.get(<br>                    exts.MDATA_BACKGROUND_TITLE_KEY, None)<br>                self.slideout_background = self.panel_background.get(<br>                    exts.MDATA_BACKGROUND_SLIDEOUT_KEY, None)<br>                self.panel_background = self.panel_background.get(<br>                    exts.MDATA_BACKGROUND_PANEL_KEY, None)<br>            elif not isinstance(self.panel_background, str):<br>                mlogger.error(<br>                    "%s bad background definition in metadata.", self)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `type_id = exts.PANEL_POSTFIX``class-attribute``instance-attribute`

##### `allowed_sub_cmps = [GenericStack, GenericUICommandGroup, GenericUICommand, NoScriptButton]``class-attribute``instance-attribute`

##### `panel_background = None``instance-attribute`

##### `title_background = None``instance-attribute`

##### `slideout_background = None``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `has_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>``` | ```md-code__content<br>def has_commands(self):<br>    for component in self:<br>        if not component.is_container:<br>            if isinstance(component, GenericUICommand):<br>                return True<br>        else:<br>            if component.has_commands():<br>                return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    # Panels contain stacks. But stacks itself does not have any ui and its<br>    # subitems are displayed within the ui of the parent panel.<br>    # This is different from pulldowns and other button groups.<br>    # Button groups, contain and display their sub components in their<br>    # own drop down menu. So when checking if panel has a button,<br>    # panel should check all the items visible to the user and respond.<br>    item_exists = GenericUIContainer.contains(self, item_name)<br>    if item_exists:<br>        return True<br>    else:<br>        # if child is a stack item, check its children too<br>        for component in self:<br>            if isinstance(component, GenericStack) \<br>                    and component.contains(item_name):<br>                return True<br>``` |

### `Tab(cmp_path=None)`

Bases: `GenericUIContainer`

Tab container for Panels.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>345<br>346<br>347<br>348<br>349<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.layout_items = []<br>    self.components = []<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIComponent.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `control_id``property`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `type_id = exts.TAB_POSTFIX``class-attribute``instance-attribute`

##### `allowed_sub_cmps = [Panel]``class-attribute``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `configure(config_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>``` | ```md-code__content<br>def configure(self, config_dict):<br>    # update self meta<br>    GenericUIComponent.configure(self, config_dict=config_dict)<br>    # create an updated dict to pass to children<br>    updated_dict = copy.deepcopy(config_dict)<br>    updated_dict = pyutils.merge(updated_dict, self.meta)<br>    # replace the meta values with the expanded values<br>    # so children can use the expanded<br>    updated_dict[exts.MDATA_UI_TITLE] = self.ui_title<br>    updated_dict[exts.MDATA_TOOLTIP] = self.tooltip<br>    updated_dict[exts.MDATA_COMMAND_HELP_URL] = self.help_url<br>    updated_dict[exts.AUTHOR_PARAM] = self.author<br>    if exts.AUTHORS_PARAM in updated_dict:<br>        updated_dict.pop(exts.AUTHORS_PARAM)<br>    for component in self:<br>        component.configure(updated_dict)<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `has_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>344<br>345<br>346<br>347<br>348<br>``` | ```md-code__content<br>def has_commands(self):<br>    for panel in self:<br>        if panel.has_commands():<br>            return True<br>    return False<br>``` |

### `Extension(cmp_path=None)`

Bases: `GenericUIContainer`

UI Tools extension.

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>356<br>357<br>358<br>359<br>360<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    self.pyrvt_version = None<br>    self.dir_hash_value = None<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericUIContainer.__init__(self, cmp_path=cmp_path)<br>``` |

#### Attributes

##### `name = None``instance-attribute`

##### `is_container``property`

##### `directory = cmp_path``instance-attribute`

##### `unique_name = None``instance-attribute`

##### `parent_ctrl_id = None``instance-attribute`

##### `icon_file = None``instance-attribute`

##### `author = None``instance-attribute`

##### `media_file = None``instance-attribute`

##### `min_revit_ver = None``instance-attribute`

##### `max_revit_ver = None``instance-attribute`

##### `is_beta = False``instance-attribute`

##### `highlight_type = None``instance-attribute`

##### `collapsed = False``instance-attribute`

##### `version = None``instance-attribute`

##### `meta = {}``instance-attribute`

##### `meta_file = None``instance-attribute`

##### `modules = []``instance-attribute`

##### `module_paths = []``instance-attribute`

##### `binary_path = None``instance-attribute`

##### `library_path = None``instance-attribute`

##### `ui_title``property`

##### `tooltip``property`

##### `help_url``property`

##### `is_supported``property`

##### `layout_items = []``instance-attribute`

##### `components = []``instance-attribute`

##### `type_id = exts.ExtensionTypes.UI_EXTENSION.POSTFIX``class-attribute``instance-attribute`

##### `allowed_sub_cmps = [Tab]``class-attribute``instance-attribute`

##### `pyrvt_version = None``instance-attribute`

##### `dir_hash_value = None``instance-attribute`

##### `control_id``property`

##### `startup_script``property`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

##### `make_unique_name(cmp_path)``classmethod`

Creates a unique name for the command.

This is used to uniquely identify this command
and also to create the class in pyRevit dll assembly.
Current method create a unique name based on the command
full directory address.

Examples:

for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'
unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>``` | ```md-code__content<br>@classmethod<br>def make_unique_name(cls, cmp_path):<br>    """Creates a unique name for the command.<br>    This is used to uniquely identify this command<br>    and also to create the class in pyRevit dll assembly.<br>    Current method create a unique name based on the command<br>    full directory address.<br>    Examples:<br>        for 'pyRevit.extension/pyRevit.tab/Edit.panel/Flip doors.pushbutton'<br>        unique name would be: 'pyrevit-pyrevit-edit-flipdoors'.<br>    """<br>    pieces = []<br>    inside_ext = False<br>    for dname in cmp_path.split(op.sep):<br>        if exts.ExtensionTypes.UI_EXTENSION.POSTFIX in dname:<br>            inside_ext = True<br>        name, ext = op.splitext(dname)<br>        if ext != '' and inside_ext:<br>            pieces.append(name)<br>        else:<br>            continue<br>    return coreutils.cleanup_string(<br>        exts.UNIQUE_ID_SEPARATOR.join(pieces),<br>        skip=[exts.UNIQUE_ID_SEPARATOR]<br>        ).lower()<br>``` |

##### `get_full_bundle_name()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>270<br>271<br>``` | ```md-code__content<br>def get_full_bundle_name(self):<br>    return self.name + self.type_id<br>``` |

##### `has_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>``` | ```md-code__content<br>def has_module_path(self, path):<br>    return path in self.module_paths<br>``` |

##### `add_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>``` | ```md-code__content<br>def add_module_path(self, path):<br>    if path and not self.has_module_path(path):<br>        mlogger.debug('Appending syspath: %s to %s', path, self)<br>        for component in self.components:<br>            component.add_module_path(path)<br>        self.module_paths.append(path)<br>``` |

##### `remove_module_path(path)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>452<br>453<br>454<br>455<br>456<br>457<br>``` | ```md-code__content<br>def remove_module_path(self, path):<br>    if path and self.has_module_path(path):<br>        mlogger.debug('Removing syspath: %s from %s', path, self)<br>        for component in self.components:<br>            component.remove_module_path(path)<br>        return self.module_paths.remove(path)<br>``` |

##### `get_bundle_file(file_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>``` | ```md-code__content<br>def get_bundle_file(self, file_name):<br>    if self.directory and file_name:<br>        file_addr = op.join(self.directory, file_name)<br>        return file_addr if op.exists(file_addr) else None<br>``` |

##### `find_bundle_file(patterns, finder='postfix')`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>``` | ```md-code__content<br>def find_bundle_file(self, patterns, finder='postfix'):<br>    if self.directory:<br>        for bundle_file in os.listdir(self.directory):<br>            if 'name' == finder:<br>                for file_name in patterns:<br>                    if op.splitext(bundle_file)[0] == file_name:<br>                        return op.join(self.directory, bundle_file)<br>            elif 'postfix' == finder:<br>                for file_postfix in patterns:<br>                    if bundle_file.endswith(file_postfix):<br>                        return op.join(self.directory, bundle_file)<br>            elif 'regex' == finder:<br>                for regex_pattern in patterns:<br>                    if re.match(regex_pattern, bundle_file):<br>                        return op.join(self.directory, bundle_file)<br>    return None<br>``` |

##### `find_bundle_module(module, by_host=False)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>``` | ```md-code__content<br>def find_bundle_module(self, module, by_host=False):<br>    # test of file_name is an actually path to a file<br>    if op.isfile(module):<br>        return module<br>    def build_assm_filename(module_filename):<br>        # build assembly by host version (assm_file_2020.ext)<br>        assm_name, assm_ext = op.splitext(module_filename)<br>        return assm_name + '_' + HOST_APP.version + assm_ext<br>    if by_host:<br>        module = build_assm_filename(module)<br>    # test if module is inside search paths<br>    for module_path in self.module_paths:<br>        possible_module_path = op.join(module_path, module)<br>        if op.isfile(possible_module_path):<br>            return possible_module_path<br>``` |

##### `parse_layout_directive(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>``` | ```md-code__content<br>def parse_layout_directive(self, layout_line):<br>    parts = re.findall(r'(.+)\[(.+):(.*)\]', layout_line)<br>    if parts:<br>        source_item, directive, target_value = parts[0]<br>        # cleanup values<br>        directive = directive.lower().strip()<br>        target_value = target_value.strip()<br>        # process any escape characters in target value<br>        # https://stackoverflow.com/a/4020824/2350244<br>        target_value = target_value.encode('utf-8')<br>        if PY3:<br>            target_value = target_value.decode('unicode_escape')<br>        else:<br>            target_value = target_value.decode('string_escape')<br>        # create directive obj<br>        return source_item, LayoutDirective(directive_type=directive,<br>                                            target=target_value)<br>    return layout_line, None<br>``` |

##### `parse_layout_item(layout_line)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>422<br>423<br>424<br>425<br>426<br>427<br>``` | ```md-code__content<br>def parse_layout_item(self, layout_line):<br>    if layout_line:<br>        layout_item_name, layout_item_drctv = \<br>            self.parse_layout_directive(layout_line)<br>        return LayoutItem(name=layout_item_name,<br>                          directive=layout_item_drctv)<br>``` |

##### `parse_layout_items(layout_lines)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>``` | ```md-code__content<br>def parse_layout_items(self, layout_lines):<br>    for layout_line in layout_lines:<br>        layout_item = self.parse_layout_item(layout_line)<br>        if layout_item:<br>            self.layout_items.append(layout_item)<br>    mlogger.debug('Layout is: %s', self.layout_items)<br>``` |

##### `parse_layout_metadata()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>``` | ```md-code__content<br>def parse_layout_metadata(self):<br>    layout = self.meta.get(exts.MDATA_LAYOUT, [])<br>    if layout:<br>        self.parse_layout_items(layout)<br>        return True<br>``` |

##### `contains(item_name)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>``` | ```md-code__content<br>def contains(self, item_name):<br>    return any([x.name == item_name for x in self.components])<br>``` |

##### `add_component(comp)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>``` | ```md-code__content<br>def add_component(self, comp):<br>    # set search paths<br>    for path in self.module_paths:<br>        comp.add_module_path(path)<br>    # set its own control id on the child component<br>    if hasattr(comp, 'parent_ctrl_id'):<br>        comp.parent_ctrl_id = self.control_id<br>    # now add to list<br>    self.components.append(comp)<br>``` |

##### `find_components_of_type(cmp_type)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def find_components_of_type(self, cmp_type):<br>    sub_comp_list = []<br>    for sub_comp in self.components:<br>        if isinstance(sub_comp, cmp_type):<br>            sub_comp_list.append(sub_comp)<br>        elif sub_comp.is_container:<br>            sub_comp_list.extend(sub_comp.find_components_of_type(cmp_type))<br>    return sub_comp_list<br>``` |

##### `find_layout_items()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>``` | ```md-code__content<br>def find_layout_items(self):<br>    layout_items = []<br>    layout_items.extend(self.layout_items)<br>    for sub_comp in self.components:<br>        if sub_comp.is_container:<br>            layout_items.extend(sub_comp.find_layout_items())<br>    return layout_items<br>``` |

##### `get_hash()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>427<br>428<br>``` | ```md-code__content<br>def get_hash(self):<br>    return coreutils.get_str_hash(safe_strtype(self.get_cache_data()))<br>``` |

##### `get_all_commands()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>430<br>431<br>``` | ```md-code__content<br>def get_all_commands(self):<br>    return self.find_components_of_type(GenericUICommand)<br>``` |

##### `get_manifest_file()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>433<br>434<br>``` | ```md-code__content<br>def get_manifest_file(self):<br>    return self.get_bundle_file(exts.EXT_MANIFEST_FILE)<br>``` |

##### `get_manifest()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>def get_manifest(self):<br>    manifest_file = self.get_manifest_file()<br>    if manifest_file:<br>        with codecs.open(manifest_file, 'r', 'utf-8') as mfile:<br>            try:<br>                manifest_cfg = json.load(mfile)<br>                return manifest_cfg<br>            except Exception as manfload_err:<br>                print('Can not parse ext manifest file: {} '<br>                      '| {}'.format(manifest_file, manfload_err))<br>                return<br>``` |

##### `configure()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>448<br>449<br>450<br>451<br>452<br>``` | ```md-code__content<br>def configure(self):<br>    cfg_dict = self.get_manifest()<br>    if cfg_dict:<br>        for component in self:<br>            component.configure(cfg_dict)<br>``` |

##### `get_extension_modules()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>454<br>455<br>456<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>``` | ```md-code__content<br>def get_extension_modules(self):<br>    modules = []<br>    if self.binary_path and op.exists(self.binary_path):<br>        for item in os.listdir(self.binary_path):<br>            item_path = op.join(self.binary_path, item)<br>            item_name = item.lower()<br>            if op.isfile(item_path) \<br>                    and item_name.endswith(framework.ASSEMBLY_FILE_TYPE):<br>                modules.append(item_path)<br>    return modules<br>``` |

##### `get_command_modules()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>472<br>``` | ```md-code__content<br>def get_command_modules(self):<br>    referenced_modules = set()<br>    for cmd in self.get_all_commands():<br>        for module in cmd.modules:<br>            cmd_module = cmd.find_bundle_module(module)<br>            if cmd_module:<br>                referenced_modules.add(cmd_module)<br>    return referenced_modules<br>``` |

##### `get_hooks()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>474<br>475<br>476<br>``` | ```md-code__content<br>def get_hooks(self):<br>    hook_scripts = os.listdir(self.hooks_path) if self.hooks_path else []<br>    return [op.join(self.hooks_path, x) for x in hook_scripts]<br>``` |

##### `get_checks()`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>478<br>479<br>480<br>``` | ```md-code__content<br>def get_checks(self):<br>    check_scripts = os.listdir(self.checks_path) if self.checks_path else []<br>    return [op.join(self.checks_path, x) for x in check_scripts]<br>``` |

### `LibraryExtension(cmp_path=None)`

Bases: `GenericComponent`

Library extension.

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>``` | ```md-code__content<br>def __init__(self, cmp_path=None):<br>    # using classname otherwise exceptions in superclasses won't show<br>    GenericComponent.__init__(self)<br>    self.directory = cmp_path<br>    if self.directory:<br>        self.name = op.splitext(op.basename(self.directory))[0]<br>``` |

#### Attributes

##### `is_container``property`

##### `type_id = exts.ExtensionTypes.LIB_EXTENSION.POSTFIX``class-attribute``instance-attribute`

##### `directory = cmp_path``instance-attribute`

##### `name = op.splitext(op.basename(self.directory))[0]``instance-attribute`

#### Functions

##### `get_cache_data()`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def get_cache_data(self):<br>    cache_dict = self.__dict__.copy()<br>    if hasattr(self, TYPE_ID_KEY):<br>        cache_dict[TYPE_ID_KEY] = getattr(self, TYPE_ID_KEY)<br>    return cache_dict<br>``` |

##### `load_cache_data(cache_dict)`

Source code in `pyrevitlib/pyrevit/extensions/genericcomps.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>``` | ```md-code__content<br>def load_cache_data(self, cache_dict):<br>    for k, v in cache_dict.items():<br>        self.__dict__[k] = v<br>``` |

##### `matches(component_path)``classmethod`

Source code in `pyrevitlib/pyrevit/extensions/components.py`

|     |     |
| --- | --- |
| ```<br>499<br>500<br>501<br>``` | ```md-code__content<br>@classmethod<br>def matches(cls, component_path):<br>    return component_path.lower().endswith(cls.type_id)<br>``` |

## Functions

Back to top

## Revit Features Detection
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/features/#pyrevit.revit.features)

# features

Host application feature detectors.

## Attributes

### `GLOBAL_PARAMS = hasattr(DB, 'GlobalParametersManager')``module-attribute`

Back to top

## Smart Module Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/moduleutils/#pyrevit.coreutils.moduleutils)

# moduleutils

Utility fuctions to support smart modules.

## Functions

### `copy_func(func, func_name, doc_string=None, arg_list=None)`

Copy a function object to create a new function.

This is used inside smart modules that auto-generate functions based on
context.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `func` | `object` | python source function object | _required_ |
| `func_name` | `str` | new function name | _required_ |
| `doc_string` | `str` | new function docstring | `None` |
| `arg_list` | `list` | list of default values for function arguments | `None` |

Returns:

| Type | Description |
| --- | --- |
| `object` | new python function objects |

Source code in `pyrevitlib/pyrevit/coreutils/moduleutils.py`

|     |     |
| --- | --- |
| ```<br> 6<br> 7<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>``` | ```md-code__content<br>def copy_func(func, func_name, doc_string=None, arg_list=None):<br>    """Copy a function object to create a new function.<br>    This is used inside smart modules that auto-generate functions based on<br>    context.<br>    Args:<br>        func (object): python source function object<br>        func_name (str): new function name<br>        doc_string (str): new function docstring<br>        arg_list (list): list of default values for function arguments<br>    Returns:<br>        (object): new python function objects<br>    """<br>    new_func = types.FunctionType(func.func_code, func.func_globals,<br>                                  func_name, tuple(arg_list), func.func_closure)<br>    new_func.__doc__ = doc_string<br>    return new_func<br>``` |

### `mark(prop_name)`

Decorator function to add a marker property to the given type.

Source code in `pyrevitlib/pyrevit/coreutils/moduleutils.py`

|     |     |
| --- | --- |
| ```<br>27<br>28<br>29<br>30<br>31<br>32<br>``` | ```md-code__content<br>def mark(prop_name):<br>    """Decorator function to add a marker property to the given type."""<br>    def setter_decorator(type_obj):<br>        setattr(type_obj, prop_name, True)<br>        return type_obj<br>    return setter_decorator<br>``` |

### `collect_marked(module_obj, prop_name)`

Collect module objects that are marked with given property.

Source code in `pyrevitlib/pyrevit/coreutils/moduleutils.py`

|     |     |
| --- | --- |
| ```<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>``` | ```md-code__content<br>def collect_marked(module_obj, prop_name):<br>    """Collect module objects that are marked with given property."""<br>    marked_objs = []<br>    for member in inspect.getmembers(module_obj):<br>        _, type_obj = member<br>        if (inspect.isclass(type_obj) or inspect.isfunction(type_obj)) \<br>                and getattr(type_obj, prop_name, False):<br>            marked_objs.append(type_obj)<br>    return marked_objs<br>``` |

### `has_argument(function_obj, arg_name)`

Check if given function object has argument matching arg\_name.

Source code in `pyrevitlib/pyrevit/coreutils/moduleutils.py`

|     |     |
| --- | --- |
| ```<br>46<br>47<br>48<br>``` | ```md-code__content<br>def has_argument(function_obj, arg_name):<br>    """Check if given function object has argument matching arg_name."""<br>    return arg_name in inspect.getargspec(function_obj)[0] #pylint: disable=deprecated-method<br>``` |

### `has_any_arguments(function_obj, arg_name_list)`

Check if given function object has any of given arguments.

Source code in `pyrevitlib/pyrevit/coreutils/moduleutils.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>``` | ```md-code__content<br>def has_any_arguments(function_obj, arg_name_list):<br>    """Check if given function object has any of given arguments."""<br>    args = inspect.getargspec(function_obj)[0] #pylint: disable=deprecated-method<br>    if arg_name_list:<br>        return any(x in args for x in arg_name_list)<br>    return False<br>``` |

### `filter_kwargs(function_obj, kwargs)`

Filter given arguments dict for function\_obj arguments.

Source code in `pyrevitlib/pyrevit/coreutils/moduleutils.py`

|     |     |
| --- | --- |
| ```<br>59<br>60<br>61<br>62<br>63<br>64<br>``` | ```md-code__content<br>def filter_kwargs(function_obj, kwargs):<br>    """Filter given arguments dict for function_obj arguments."""<br>    filtered_kwargs = {}<br>    for arg_name in inspect.getargspec(function_obj)[0]: #pylint: disable=deprecated-method<br>        filtered_kwargs[arg_name] = kwargs.get(arg_name, None)<br>    return filtered_kwargs<br>``` |

Back to top

## Revit UI Functions
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/ui/#pyrevit.revit.ui)

# ui

UI functions.

## Attributes

## Functions

### `get_mainwindow_hwnd()`

Get the handle of the main window.

Returns:

| Type | Description |
| --- | --- |
| `intptr` | The handle of the main window. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>``` | ```md-code__content<br>def get_mainwindow_hwnd():<br>    """Get the handle of the main window.<br>    Returns:<br>        (intptr): The handle of the main window.<br>    """<br>    return HOST_APP.proc_window<br>``` |

### `get_mainwindow()`

Get the main window of the application.

Returns:

| Type | Description |
| --- | --- |
| `MainWindow` | The root visual of the main window. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>``` | ```md-code__content<br>def get_mainwindow():<br>    """Get the main window of the application.<br>    Returns:<br>        (MainWindow): The root visual of the main window.<br>    """<br>    try:<br>        hwnd_source = Interop.HwndSource.FromHwnd(HOST_APP.proc_window)<br>        return hwnd_source.RootVisual<br>    except Exception:<br>        pass<br>``` |

### `get_statusbar_hwnd()`

Retrieves the handle of the status bar control belonging to the main window.

Returns:

| Type | Description |
| --- | --- |
| `IntPtr` | The handle of the status bar control. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>``` | ```md-code__content<br>def get_statusbar_hwnd():<br>    """Retrieves the handle of the status bar control belonging to the main window.<br>    Returns:<br>        (IntPtr): The handle of the status bar control.<br>    """<br>    return Common.User32.FindWindowEx(<br>        get_mainwindow_hwnd(),<br>        IntPtr.Zero,<br>        "msctls_statusbar32",<br>        "")<br>``` |

### `set_statusbar_text(text)`

Sets the text of the status bar.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `text` | `str` | The text to be displayed in the status bar. | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if the text was successfully set, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>``` | ```md-code__content<br>def set_statusbar_text(text):<br>    """Sets the text of the status bar.<br>    Parameters:<br>        text (str): The text to be displayed in the status bar.<br>    Returns:<br>        (bool): True if the text was successfully set, False otherwise.<br>    """<br>    status_bar_ptr = get_statusbar_hwnd()<br>    if status_bar_ptr != IntPtr.Zero:<br>        Common.User32.SetWindowText(status_bar_ptr, text)<br>        return True<br>    return False<br>``` |

### `get_window_rectangle()`

Get the rectangle coordinates of the main window.

Returns:

| Type | Description |
| --- | --- |
| `Tuple[int, int, int, int]` | The left, top, right, and bottom <br>coordinates of the window rectangle. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>``` | ```md-code__content<br>def get_window_rectangle():<br>    """Get the rectangle coordinates of the main window.<br>    Returns:<br>        (Tuple[int, int, int, int]): The left, top, right, and bottom <br>            coordinates of the window rectangle.<br>    """<br>    return Common.User32.GetWindowRect(get_mainwindow_hwnd())<br>``` |

### `is_infocenter_visible()`

Check if the InfoCenter toolbar is visible.

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if the InfoCenter toolbar is visible, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>``` | ```md-code__content<br>def is_infocenter_visible():<br>    """Check if the InfoCenter toolbar is visible.<br>    Returns:<br>        (bool): True if the InfoCenter toolbar is visible, False otherwise.<br>    """<br>    return ad.ComponentManager.InfoCenterToolBar.Visibility == \<br>        Windows.Visibility.Visible<br>``` |

### `toggle_infocenter()`

Toggles the visibility of the InfoCenter toolbar.

This function retrieves the current visibility state of the InfoCenter
toolbar and toggles it to the opposite state.
If the toolbar is currently collapsed, it will be set to visible,
and if it is currently visible, it will be set to collapsed.
The function then returns the visibility state of the InfoCenter toolbar
after the toggle operation.

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if the InfoCenter toolbar is visible, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>``` | ```md-code__content<br>def toggle_infocenter():<br>    """Toggles the visibility of the InfoCenter toolbar.<br>    This function retrieves the current visibility state of the InfoCenter <br>    toolbar and toggles it to the opposite state.<br>    If the toolbar is currently collapsed, it will be set to visible,<br>    and if it is currently visible, it will be set to collapsed.<br>    The function then returns the visibility state of the InfoCenter toolbar<br>    after the toggle operation.<br>    Returns:<br>        (bool): True if the InfoCenter toolbar is visible, False otherwise.<br>    """<br>    current_state = ad.ComponentManager.InfoCenterToolBar.Visibility<br>    is_hidden = (current_state == Windows.Visibility.Collapsed)<br>    ad.ComponentManager.InfoCenterToolBar.Visibility = \<br>        Windows.Visibility.Visible if is_hidden else \<br>            Windows.Visibility.Collapsed<br>    return is_infocenter_visible()<br>``` |

### `get_ribbon_roottype()`

Get the type of the ribbon root.

Returns:

| Type | Description |
| --- | --- |
| `type` | type of the ribbon root |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>``` | ```md-code__content<br>def get_ribbon_roottype():<br>    """Get the type of the ribbon root.<br>    Returns:<br>        (type): type of the ribbon root<br>    """<br>    ap_assm = clr.GetClrType(ap.Windows.RibbonTabList).Assembly<br>    for apt in ap_assm.GetTypes():<br>        if 'PanelSetListView' in apt.Name:<br>            return apt<br>``` |

### `get_current_theme()`

Get the current UI theme.

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `UITheme` | `UITheme` | The current UI theme. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>``` | ```md-code__content<br>def get_current_theme():<br>    """Get the current UI theme.<br>    Returns:<br>        UITheme (UITheme): The current UI theme.<br>    """<br>    return UIThemeManager.CurrentTheme<br>``` |

### `set_current_theme(theme='Dark')`

Sets the current UI theme to either 'Dark' or 'Light'.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `theme` | `str` | The theme to set. Defaults to 'Dark'. | `'Dark'` |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>``` | ```md-code__content<br>def set_current_theme(theme='Dark'):<br>    """Sets the current UI theme to either 'Dark' or 'Light'.<br>    Args:<br>        theme (str, optional): The theme to set. Defaults to 'Dark'.<br>    """<br>    if theme == 'Dark':<br>        UIThemeManager.CurrentTheme = UITheme.Dark<br>    else:<br>        UIThemeManager.CurrentTheme = UITheme.Light<br>``` |

### `resolve_icon_file(directory, icon_name)`

Resolves the icon file path based on the current UI theme.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `directory` | `str` | The directory where the icon file is located. | _required_ |
| `icon_name` | `str` | The name of the icon file. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `full_file_path` | `str` | The full file path of the icon file. |

Source code in `pyrevitlib/pyrevit/revit/ui.py`

|     |     |
| --- | --- |
| ```<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>``` | ```md-code__content<br>def resolve_icon_file(directory, icon_name):<br>    """Resolves the icon file path based on the current UI theme.<br>    Args:<br>        directory (str): The directory where the icon file is located.<br>        icon_name (str): The name of the icon file.<br>    Returns:<br>        full_file_path (str): The full file path of the icon file.<br>    """<br>    full_file_path = op.join(directory, icon_name)<br>    if HOST_APP.is_newer_than(2024, True) and get_current_theme() == UITheme.Dark:<br>        dark_icon_name = op.splitext(icon_name)[0] + ICON_DARK_SUFFIX + ICON_FILE_FORMAT<br>        dark_file_path = op.join(directory, dark_icon_name)<br>        full_file_path = dark_file_path if op.exists(dark_file_path) else full_file_path<br>    return full_file_path if op.exists(full_file_path) else None<br>``` |

Back to top

## Revit Reporting Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/report/#pyrevit.revit.report)

# report

"Utility methods for reporting Revit data uniformly.

## Classes

## Functions

### `print_revision(rev, prefix='', print_id=True)`

Print a revision.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rev` | `Revision` | revision to output | _required_ |
| `prefix` | `str` | prefix to add to the output text. Defaults to empty string. | `''` |
| `print_id` | `bool` | whether to print the revision id. Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/revit/report.py`

|     |     |
| --- | --- |
| ```<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>``` | ```md-code__content<br>def print_revision(rev, prefix='', print_id=True):<br>    """Print a revision.<br>    Args:<br>        rev (DB.Revision): revision to output<br>        prefix (str, optional): prefix to add to the output text. Defaults to empty string.<br>        print_id (bool, optional): whether to print the revision id. Defaults to True.<br>    """<br>    outstr = 'SEQ#: {} REV#: {} DATE: {} TYPE: {} DESC: {} ' \<br>             .format(rev.SequenceNumber,<br>                     str(query.get_param(rev, 'RevisionNumber', '')).ljust(5),<br>                     str(rev.RevisionDate).ljust(10),<br>                     str(rev.NumberType if rev.NumberType else "").ljust(15),<br>                     str(rev.Description).replace('\n', '').replace('\r', ''))<br>    if print_id:<br>        outstr = PyRevitOutputWindow.linkify(rev.Id) + '\t' + outstr<br>    print(prefix + outstr)<br>``` |

### `print_sheet(sht, prefix='', print_id=True)`

Print the name of a sheet.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `sht` | `ViewSheet` | sheet to output | _required_ |
| `prefix` | `str` | prefix to add to the output text. Defaults to empty string. | `''` |
| `print_id` | `bool` | whether to print the sheet id. Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/revit/report.py`

|     |     |
| --- | --- |
| ```<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def print_sheet(sht, prefix='', print_id=True):<br>    """Print the name of a sheet.<br>    Args:<br>        sht (DB.ViewSheet): sheet to output<br>        prefix (str, optional): prefix to add to the output text. Defaults to empty string.<br>        print_id (bool, optional): whether to print the sheet id. Defaults to True.<br>    """<br>    outstr = '{}\t{}'.format(<br>        sht.Parameter[DB.BuiltInParameter.SHEET_NUMBER].AsString(),<br>        sht.Parameter[DB.BuiltInParameter.SHEET_NAME].AsString()<br>        )<br>    if print_id:<br>        outstr = PyRevitOutputWindow.linkify(sht.Id) + '\t' + outstr<br>    print(prefix + outstr)<br>``` |

### `print_view(view, prefix='', print_id=True)`

Print the name of a view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | view to output | _required_ |
| `prefix` | `str` | prefix to add to the output text. Defaults to empty string. | `''` |
| `print_id` | `bool` | whether to print the view id. Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/revit/report.py`

|     |     |
| --- | --- |
| ```<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>``` | ```md-code__content<br>def print_view(view, prefix='', print_id=True):<br>    """Print the name of a view.<br>    Args:<br>        view (DB.View): view to output<br>        prefix (str, optional): prefix to add to the output text. Defaults to empty string.<br>        print_id (bool, optional): whether to print the view id. Defaults to True.<br>    """<br>    outstr = query.get_name(view)<br>    if print_id:<br>        outstr = PyRevitOutputWindow.linkify(view.Id) + '\t' + outstr<br>    print(prefix + outstr)<br>``` |

Back to top

## Revit Tab Colorizer API
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/tabs/#pyrevit.revit.tabs)

# tabs

Document colorizer python API.

## Attributes

## Functions

### `hex_to_brush(color_hex)`

Convert hex color to WPF brush.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>11<br>12<br>13<br>14<br>15<br>``` | ```md-code__content<br>def hex_to_brush(color_hex):<br>    """Convert hex color to WPF brush."""<br>    return Media.SolidColorBrush(<br>        Media.ColorConverter.ConvertFromString(color_hex)<br>    )<br>``` |

### `hex_from_brush(solid_brush)`

Convert WPF brush to hex color.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>``` | ```md-code__content<br>def hex_from_brush(solid_brush):<br>    """Convert WPF brush to hex color."""<br>    color = solid_brush.Color<br>    color_hex = ''.join(<br>        '{:02X}'.format(int(x)) for x in<br>        [color.A, color.R, color.G, color.B]<br>        )<br>    return '#' + color_hex<br>``` |

### `get_tabcoloring_theme(usercfg)`

Get tab coloring theme from settings.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>``` | ```md-code__content<br>def get_tabcoloring_theme(usercfg):<br>    """Get tab coloring theme from settings."""<br>    tabcfgs = _get_tabcoloring_cfgs(usercfg)<br>    theme = types.TabColoringTheme()<br>    theme.SortDocTabs = _get_sort_colorize_docs(tabcfgs)<br>    theme.TabStyle = _get_tabstyle(tabcfgs)<br>    theme.FamilyTabStyle = _get_family_tabstyle(tabcfgs)<br>    theme.TabOrderRules = _get_tab_orderrules(tabcfgs)<br>    theme.TabFilterRules = _get_tab_filterrules(tabcfgs)<br>    return theme<br>``` |

### `reset_tab_ordercolors(usercfg, theme)`

Reset tab order colors to internal default.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>114<br>115<br>116<br>117<br>``` | ```md-code__content<br>def reset_tab_ordercolors(usercfg, theme):<br>    """Reset tab order colors to internal default."""<br>    tabcfgs = _get_tabcoloring_cfgs(usercfg)<br>    theme.TabOrderRules = _get_tab_orderrules(tabcfgs, default=True)<br>``` |

### `set_tabcoloring_theme(usercfg, theme)`

Set tab coloring theme in settings.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def set_tabcoloring_theme(usercfg, theme):<br>    """Set tab coloring theme in settings."""<br>    tabcfgs = _get_tabcoloring_cfgs(usercfg)<br>    _set_sort_colorize_docs(tabcfgs, theme)<br>    _set_tabstyle(tabcfgs, theme)<br>    _set_family_tabstyle(tabcfgs, theme)<br>    _set_tab_ordercolors(tabcfgs, theme)<br>    _set_tab_filtercolors(tabcfgs, theme)<br>``` |

### `get_tab_orderrule(theme, index)`

Get coloring rule from active theme, at index.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>132<br>133<br>134<br>``` | ```md-code__content<br>def get_tab_orderrule(theme, index):<br>    """Get coloring rule from active theme, at index."""<br>    return hex_from_brush(theme.TabOrderRules[index].Brush)<br>``` |

### `add_tab_orderrule(theme, color)`

Add coloring rule to active theme.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>137<br>138<br>139<br>140<br>141<br>``` | ```md-code__content<br>def add_tab_orderrule(theme, color):<br>    """Add coloring rule to active theme."""<br>    theme.TabOrderRules.Add(<br>        types.TabColoringRule(hex_to_brush(color))<br>        )<br>``` |

### `remove_tab_orderrule(theme, index)`

Remove coloring rule at index, from active theme.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>144<br>145<br>146<br>``` | ```md-code__content<br>def remove_tab_orderrule(theme, index):<br>    """Remove coloring rule at index, from active theme."""<br>    theme.TabOrderRules.RemoveAt(index)<br>``` |

### `update_tab_orderrule(theme, index, color)`

Update coloring rule at index, on active theme.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>149<br>150<br>151<br>152<br>``` | ```md-code__content<br>def update_tab_orderrule(theme, index, color):<br>    """Update coloring rule at index, on active theme."""<br>    tor = theme.TabOrderRules[index]<br>    tor.Brush = hex_to_brush(color)<br>``` |

### `get_tab_filterrule(theme, index)`

Get coloring filter rule from active theme, at index.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>``` | ```md-code__content<br>def get_tab_filterrule(theme, index):<br>    """Get coloring filter rule from active theme, at index."""<br>    tfr = theme.TabFilterRules[index]<br>    color = tfr.Brush.Color<br>    color_hex = ''.join(<br>        '{:02X}'.format(int(x)) for x in<br>        [color.A, color.R, color.G, color.B]<br>        )<br>    return '#' + color_hex, str(tfr.TitleFilter)<br>``` |

### `add_tab_filterrule(theme, color, title_filter)`

Add coloring filter rule to active theme.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>166<br>167<br>168<br>169<br>``` | ```md-code__content<br>def add_tab_filterrule(theme, color, title_filter):<br>    """Add coloring filter rule to active theme."""<br>    fc = types.TabColoringRule(hex_to_brush(color), title_filter)<br>    theme.TabFilterRules.Add(fc)<br>``` |

### `remove_tab_filterrule(theme, index)`

Remove coloring filter rule at index, from active theme.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>172<br>173<br>174<br>``` | ```md-code__content<br>def remove_tab_filterrule(theme, index):<br>    """Remove coloring filter rule at index, from active theme."""<br>    theme.TabFilterRules.RemoveAt(index)<br>``` |

### `update_tab_filterrule(theme, index, color=None, title_filter=None)`

Update coloring filter rule at index, on active theme.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>``` | ```md-code__content<br>def update_tab_filterrule(theme, index, color=None, title_filter=None):<br>    """Update coloring filter rule at index, on active theme."""<br>    tfr = theme.TabFilterRules[index]<br>    if color:<br>        tfr.Brush = hex_to_brush(color)<br>    if title_filter:<br>        tfr.TitleFilter = Regex(title_filter)<br>``` |

### `update_tabstyle(theme, tab_style)`

Update current tab style.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>186<br>187<br>188<br>189<br>190<br>``` | ```md-code__content<br>def update_tabstyle(theme, tab_style):<br>    """Update current tab style."""<br>    for ts in types.TabColoringTheme.AvailableStyles:<br>        if ts.Name == tab_style.Name:<br>            theme.TabStyle = ts<br>``` |

### `update_family_tabstyle(theme, tab_style)`

Update current family tab style.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>193<br>194<br>195<br>196<br>197<br>``` | ```md-code__content<br>def update_family_tabstyle(theme, tab_style):<br>    """Update current family tab style."""<br>    for ts in types.TabColoringTheme.AvailableStyles:<br>        if ts.Name == tab_style.Name:<br>            theme.FamilyTabStyle = ts<br>``` |

### `get_doc_colorizer_state()`

Get state of document colorizer.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>200<br>201<br>202<br>``` | ```md-code__content<br>def get_doc_colorizer_state():<br>    """Get state of document colorizer."""<br>    return types.DocumentTabEventUtils.IsUpdatingDocumentTabs<br>``` |

### `get_styled_slots()`

Get list of current styling slots.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>205<br>206<br>207<br>208<br>209<br>``` | ```md-code__content<br>def get_styled_slots():<br>    """Get list of current styling slots."""<br>    active_theme = types.DocumentTabEventUtils.TabColoringTheme<br>    if active_theme:<br>        return list(active_theme.StyledDocuments)<br>``` |

### `toggle_doc_colorizer()`

Toggle state of document colorizer.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>``` | ```md-code__content<br>def toggle_doc_colorizer():<br>    """Toggle state of document colorizer."""<br>    if types.DocumentTabEventUtils.IsUpdatingDocumentTabs:<br>        types.DocumentTabEventUtils.StopGroupingDocumentTabs()<br>    else:<br>        types.DocumentTabEventUtils.StartGroupingDocumentTabs(HOST_APP.uiapp)<br>    return types.DocumentTabEventUtils.IsUpdatingDocumentTabs<br>``` |

### `reset_doc_colorizer()`

Reset document colorizer.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>221<br>222<br>223<br>``` | ```md-code__content<br>def reset_doc_colorizer():<br>    """Reset document colorizer."""<br>    types.DocumentTabEventUtils.ResetGroupingDocumentTabs()<br>``` |

### `init_doc_colorizer(usercfg)`

Initialize document colorizer from settings.

Source code in `pyrevitlib/pyrevit/revit/tabs.py`

|     |     |
| --- | --- |
| ```<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>252<br>253<br>254<br>``` | ```md-code__content<br>def init_doc_colorizer(usercfg):<br>    """Initialize document colorizer from settings."""<br>    uiapp = HOST_APP.uiapp<br>    if HOST_APP.is_newer_than(2018):<br>        current_tabcolorizer = \<br>            envvars.get_pyrevit_env_var(envvars.TABCOLORIZER_ENVVAR)<br>        new_theme = get_tabcoloring_theme(usercfg)<br>        # cancel out the colorizer from previous runtime version<br>        if current_tabcolorizer:<br>            # TODO: adopt the previous slots state<br>            # prev_theme = current_tabcolorizer.TabColoringTheme<br>            # if prev_theme:<br>            #     new_theme.InitSlots(prev_theme)<br>            current_tabcolorizer.StopGroupingDocumentTabs()<br>        # start or stop the document colorizer<br>        types.DocumentTabEventUtils.TabColoringTheme = new_theme<br>        if usercfg.colorize_docs:<br>            types.DocumentTabEventUtils.StartGroupingDocumentTabs(uiapp)<br>        else:<br>            types.DocumentTabEventUtils.StopGroupingDocumentTabs()<br>        # set the new colorizer<br>        envvars.set_pyrevit_env_var(<br>            envvars.TABCOLORIZER_ENVVAR,<br>            types.DocumentTabEventUtils<br>            )<br>``` |

Back to top

## pyRevit Resource Links
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/versionmgr/urls/#pyrevit.versionmgr.urls)

# urls

pyRevit related links.

## Attributes

### `PYREVIT_LICENSE = Common.PyRevitLabsConsts.LicenseUrl``module-attribute`

### `PYREVIT_CREDITS = Common.PyRevitLabsConsts.CreditsUrl``module-attribute`

### `PYREVIT_WIKI = Common.PyRevitLabsConsts.WikiUrl``module-attribute`

### `PYREVIT_TWITTER = 'https://twitter.com/pyrevit'``module-attribute`

### `PYREVIT_BLOG = Common.PyRevitLabsConsts.BlogsUrl``module-attribute`

### `PYREVIT_DOCS = Common.PyRevitLabsConsts.DocsUrl``module-attribute`

### `PYREVIT_GITHUB = Common.PyRevitLabsConsts.OriginalRepoBasePath``module-attribute`

### `PYREVIT_GITHUBBRANCH = Common.PyRevitLabsConsts.OriginalRepoBasePath + '/tree/{branch}'``module-attribute`

### `PYREVIT_GITHUBMASTER_COMMIT = Common.PyRevitLabsConsts.OriginalRepoBasePath + '/commits/master'``module-attribute`

### `PYREVIT_GITHUBBRANCH_COMMIT = Common.PyRevitLabsConsts.OriginalRepoBasePath + '/commits/{branch}'``module-attribute`

### `PYREVIT_GITHUBISSUES = Common.PyRevitLabsConsts.IssuesUrl``module-attribute`

### `PYREVIT_YOUTUBE = Common.PyRevitLabsConsts.YoutubeUrl``module-attribute`

### `PYREVIT_SUPPORT = Common.PyRevitLabsConsts.SupportUrl``module-attribute`

### `PYREVIT_RELEASENOTES = Common.PyRevitLabsConsts.ReleasesUrl``module-attribute`

### `PROFILE_EIN = 'https://ein.sh'``module-attribute`

Back to top

## Revit Output Linkmaker
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/output/linkmaker/#pyrevit.output.linkmaker)

# linkmaker

Handle creation of output window helper links.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `PROTOCOL_NAME = 'revit://outputhelpers?'``module-attribute`

### `LINK_SHOW_ICON = 'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z'``module-attribute`

### `DEFAULT_LINK = '<span><a class="elementlink" style="margin-right:0px;padding-right:3px" title="Click to select or show element" {attrs_select} >{ids}</a><a class="elementlink" style="margin-left:0px;padding-left:3px" {attrs_show}><svg width="14" height="14" viewBox="2 2 20 20" ><path fill="white" d="{show_icon}" /></svg></a></span>'``module-attribute`

## Functions

### `make_link(element_ids, contents=None)`

Create link for given element ids.

This link is a special format link with revit:// scheme that is handled
by the output window to select the provided element ids in current project.
Scripts should not call this function directly. Creating clickable element
links is handled by the output wrapper object through the :func: `linkify`
method.

Examples:

```md-code__content
output = pyrevit.output.get_output()
for idx, elid in enumerate(element_ids):
    print('{}: {}'.format(idx+1, output.linkify(elid)))

```

Source code in `pyrevitlib/pyrevit/output/linkmaker.py`

|     |     |
| --- | --- |
| ```<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>``` | ````md-code__content<br>def make_link(element_ids, contents=None):<br>    """Create link for given element ids.<br>    This link is a special format link with revit:// scheme that is handled<br>    by the output window to select the provided element ids in current project.<br>    Scripts should not call this function directly. Creating clickable element<br>    links is handled by the output wrapper object through the :func:`linkify`<br>    method.<br>    Examples:<br>        ```python<br>        output = pyrevit.output.get_output()<br>        for idx, elid in enumerate(element_ids):<br>            print('{}: {}'.format(idx+1, output.linkify(elid)))<br>        ```<br>    """<br>    get_elementid_value = get_elementid_value_func()<br>    try:<br>        try:<br>            strids = [safe_strtype(get_elementid_value(x)) for x in element_ids]<br>        except TypeError:<br>            strids = [safe_strtype(get_elementid_value(element_ids))]<br>    except AttributeError:<br>        raise ValueError("One or more items are not ElementIds")<br>    elementquery = ('element[]={}'.format(strid) for strid in strids)<br>    reviturl = '&'.join(elementquery)<br>    link_title = ', '.join(strids)<br>    if len(reviturl) >= 2000:<br>        alertjs = 'alert(&quot;Url was too long and discarded!&quot;);'<br>        linkattrs_select = 'href="#" onClick="{}"'.format(alertjs)<br>        linkattrs_show = linkattrs_select<br>    else:<br>        base_link = 'href="{}{}{}&show={{}}"'.format(<br>            PROTOCOL_NAME, '&command=select&', reviturl<br>        )<br>        linkattrs_select = base_link.format("false")<br>        linkattrs_show = base_link.format("true")<br>    return DEFAULT_LINK.format(<br>        attrs_select=linkattrs_select,<br>        attrs_show=linkattrs_show,<br>        ids=contents or link_title,<br>        show_icon=LINK_SHOW_ICON<br>    )<br>```` |

Back to top

## Revit Unit Conversion
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/units/#pyrevit.revit.units)

# units

Unit conversion utilities for Revit.

## Attributes

## Functions

### `format_area(area_value, doc=None)`

Return formatted area value in document units.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `area_value` | `float` | area value | _required_ |
| `doc` | `Document` | Revit document, defaults to current | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str` | formatted value |

Source code in `pyrevitlib/pyrevit/revit/units.py`

|     |     |
| --- | --- |
| ```<br> 7<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>``` | ```md-code__content<br>def format_area(area_value, doc=None):<br>    """Return formatted area value in document units.<br>    Args:<br>        area_value (float): area value<br>        doc (DB.Document, optional): Revit document, defaults to current<br>    Returns:<br>        (str): formatted value<br>    """<br>    doc = doc or DOCS.doc<br>    if HOST_APP.is_newer_than(2021):<br>        return DB.UnitFormatUtils.Format(units=doc.GetUnits(),<br>                                         specTypeId=DB.SpecTypeId.Area,<br>                                         value=area_value,<br>                                         forEditing=False)<br>    else:<br>        return DB.UnitFormatUtils.Format(units=doc.GetUnits(),<br>                                         unitType=DB.UnitType.UT_Area,<br>                                         value=area_value,<br>                                         maxAccuracy=False,<br>                                         forEditing=False)<br>``` |

### `format_slope(slope_value, doc=None)`

Return formatted slope value in document units.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `slope_value` | `float` | slope value | _required_ |
| `doc` | `Document` | Revit document, defaults to current | `None` |

Returns:

| Type | Description |
| --- | --- |
| `str` | formatted value |

Source code in `pyrevitlib/pyrevit/revit/units.py`

|     |     |
| --- | --- |
| ```<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>``` | ```md-code__content<br>def format_slope(slope_value, doc=None):<br>    """Return formatted slope value in document units.<br>    Args:<br>        slope_value (float): slope value<br>        doc (DB.Document, optional): Revit document, defaults to current<br>    Returns:<br>        (str): formatted value<br>    """<br>    doc = doc or DOCS.doc<br>    if HOST_APP.is_newer_than(2021):<br>        return DB.UnitFormatUtils.Format(units=doc.GetUnits(),<br>                                         specTypeId=DB.SpecTypeId.Slope,<br>                                         value=slope_value,<br>                                         forEditing=False)<br>    else:<br>        return DB.UnitFormatUtils.Format(units=doc.GetUnits(),<br>                                         unitType=DB.UnitType.UT_Slope,<br>                                         value=slope_value,<br>                                         maxAccuracy=False,<br>                                         forEditing=False)<br>``` |

### `project_to_viewport(xyz, view)`

Project a point to viewport coordinates.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xyz` | `XYZ` | point to project | _required_ |
| `view` | `View` | target view | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `UV` | \[description\] |

Source code in `pyrevitlib/pyrevit/revit/units.py`

|     |     |
| --- | --- |
| ```<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>``` | ```md-code__content<br>def project_to_viewport(xyz, view):<br>    """Project a point to viewport coordinates.<br>    Args:<br>        xyz (DB.XYZ): point to project<br>        view (DB.View): target view<br>    Returns:<br>        (DB.UV): [description]<br>    """<br>    plane = _create_view_plane(view)<br>    uv, _ = plane.Project(xyz)<br>    return uv<br>``` |

### `project_to_world(uv, view)`

Get view-based point (UV) back to model coordinates.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `uv` | `UV` | point on a view | _required_ |
| `view` | `View` | view to get coordinates from | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `XYZ` | point in world coordinates |

Source code in `pyrevitlib/pyrevit/revit/units.py`

|     |     |
| --- | --- |
| ```<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>94<br>95<br>96<br>97<br>98<br>99<br>``` | ```md-code__content<br>def project_to_world(uv, view):<br>    """Get view-based point (UV) back to model coordinates.<br>    Args:<br>        uv (DB.UV): point on a view<br>        view (DB.View): view to get coordinates from<br>    Returns:<br>        (DB.XYZ): point in world coordinates<br>    """<br>    plane = _create_view_plane(view)<br>    trf = DB.Transform.Identity<br>    trf.BasisX = plane.XVec<br>    trf.BasisY = plane.YVec<br>    trf.BasisZ = plane.Normal<br>    trf.Origin = plane.Origin<br>    return trf.OfPoint(DB.XYZ(uv.U, uv.V, 0))<br>``` |

### `get_spec_name(forge_id)`

Returns the measurable spec name for the given unit id.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `forge_id` | `ForgeTypeId` | Unit id | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | Spec name |

Source code in `pyrevitlib/pyrevit/revit/units.py`

|     |     |
| --- | --- |
| ```<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>``` | ```md-code__content<br>def get_spec_name(forge_id):<br>    """Returns the measurable spec name for the given unit id.<br>    Args:<br>        forge_id (DB.ForgeTypeId): Unit id<br>    Returns:<br>        (str): Spec name<br>    """<br>    if HOST_APP.is_newer_than(2021) \<br>            and DB.UnitUtils.IsMeasurableSpec(forge_id):<br>        return DB.UnitUtils.GetTypeCatalogStringForSpec(forge_id)<br>    return ""<br>``` |

### `get_unit_name(forge_id)`

Returns the unit name for the given unit id.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `forge_id` | `ForgeTypeId` | Unit id | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `str` | Unit name |

Source code in `pyrevitlib/pyrevit/revit/units.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def get_unit_name(forge_id):<br>    """Returns the unit name for the given unit id.<br>    Args:<br>        forge_id (DB.ForgeTypeId): Unit id<br>    Returns:<br>        (str): Unit name<br>    """<br>    if HOST_APP.is_newer_than(2021) \<br>            and DB.UnitUtils.IsUnit(forge_id):<br>        return DB.UnitUtils.GetTypeCatalogStringForUnit(forge_id)<br>    return ""<br>``` |

Back to top

## Revit File Management
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/files/#pyrevit.revit.files)

# files

Helper functions for working with revit files.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Functions

### `cleanup_backups(main_revitfile)`

Remove all incremental saves of the given Revit file.

Source code in `pyrevitlib/pyrevit/revit/files.py`

|     |     |
| --- | --- |
| ```<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>``` | ```md-code__content<br>def cleanup_backups(main_revitfile):<br>    """Remove all incremental saves of the given Revit file."""<br>    file_dir = op.dirname(main_revitfile)<br>    fname, fext = op.splitext(op.basename(main_revitfile))<br>    backup_fname = re.compile(r'{}\.\d\d\d\d\.{}'.format(fname,<br>                                                         fext.replace('.', '')))<br>    for f in os.listdir(file_dir):<br>        if backup_fname.findall(f):<br>            file_path = op.join(file_dir, f)<br>            try:<br>                os.remove(file_path)<br>            except Exception as osremove_err:<br>                mlogger.error('Error backup file cleanup on: %s | %s',<br>                              file_path, osremove_err)<br>``` |

### `correct_text_encoding(filename)`

Convert encoding of text file generated by Revit to UTF-8.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `filename` | `str` | file path | _required_ |

Source code in `pyrevitlib/pyrevit/revit/files.py`

|     |     |
| --- | --- |
| ```<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>``` | ```md-code__content<br>def correct_text_encoding(filename):<br>    """Convert encoding of text file generated by Revit to UTF-8.<br>    Args:<br>        filename (str): file path<br>    """<br>    fcontent = None<br>    if coreutils.check_encoding_bom(filename, bom_bytes=codecs.BOM_UTF16):<br>        with codecs.open(filename, 'r', 'utf_16_le') as oldf:<br>            fcontent = oldf.readlines()<br>    elif coreutils.check_encoding_bom(filename, bom_bytes=codecs.BOM_UTF8):<br>        with codecs.open(filename, 'r', 'utf_8') as oldf:<br>            fcontent = oldf.readlines()<br>    with codecs.open(filename, 'w', 'utf-8') as newf:<br>        newf.writelines(fcontent)<br>``` |

### `read_text(filepath)`

Safely read text files with Revit encoding.

Source code in `pyrevitlib/pyrevit/revit/files.py`

|     |     |
| --- | --- |
| ```<br>50<br>51<br>52<br>53<br>``` | ```md-code__content<br>def read_text(filepath):<br>    """Safely read text files with Revit encoding."""<br>    with codecs.open(filepath, 'r', 'utf_16_le') as text_file:<br>        return text_file.read()<br>``` |

### `write_text(filepath, contents)`

Safely write text files with Revit encoding.

Source code in `pyrevitlib/pyrevit/revit/files.py`

|     |     |
| --- | --- |
| ```<br>56<br>57<br>58<br>59<br>60<br>``` | ```md-code__content<br>def write_text(filepath, contents):<br>    """Safely write text files with Revit encoding."""<br>    # if 'utf_16_le' is specified, codecs will not write the BOM<br>    with codecs.open(filepath, 'w', 'utf_16') as text_file:<br>        text_file.write(contents)<br>``` |

### `get_file_info(filepath)`

Returns file information.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `filepath` | `str` | file path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `RevitModelFile` | file information |

Source code in `pyrevitlib/pyrevit/revit/files.py`

|     |     |
| --- | --- |
| ```<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>``` | ```md-code__content<br>def get_file_info(filepath):<br>    """Returns file information.<br>    Args:<br>        filepath (str): file path<br>    Returns:<br>        (RevitModelFile): file information<br>    """<br>    return TargetApps.Revit.RevitModelFile(filepath)<br>``` |

Back to top

## Script Type Preparation
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/typemaker/#pyrevit.runtime.typemaker)

# typemaker

Prepare and compile script types.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

## Functions

### `create_avail_type(extension, cmd_component, module_builder=None)`

Source code in `pyrevitlib/pyrevit/runtime/typemaker.py`

|     |     |
| --- | --- |
| ```<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>``` | ```md-code__content<br>def create_avail_type(extension, cmd_component, module_builder=None):<br>    if cmd_component.type_id == exts.LINK_BUTTON_POSTFIX:<br>        mlogger.debug(<br>            'Skipped creating availability type for: %s', cmd_component<br>            )<br>        return<br>    # create command availability class for this command<br>    mlogger.debug('Creating availability type for: %s', cmd_component)<br>    # set the name of the created type<br>    cmd_component.avail_class_name = \<br>            cmd_component.class_name + runtime.CMD_AVAIL_NAME_POSTFIX<br>    if module_builder:<br>        context_str = cmd_component.context.lower()<br>        if context_str == exts.CTX_SELETION:<br>            bundletypemaker.create_selection_avail_type(<br>                module_builder=module_builder,<br>                cmd_component=cmd_component<br>                )<br>        elif context_str == exts.CTX_ZERODOC:<br>            bundletypemaker.create_zerodoc_avail_type(<br>                module_builder=module_builder,<br>                cmd_component=cmd_component<br>                )<br>        else:<br>            bundletypemaker.create_extended_avail_type(<br>                module_builder=module_builder,<br>                cmd_component=cmd_component<br>                )<br>        mlogger.debug(<br>            'Successfully created availability type for: %s', cmd_component)<br>``` |

### `create_exec_types(extension, cmd_component, module_builder=None)`

Source code in `pyrevitlib/pyrevit/runtime/typemaker.py`

|     |     |
| --- | --- |
| ```<br> 57<br> 58<br> 59<br> 60<br> 61<br> 62<br> 63<br> 64<br> 65<br> 66<br> 67<br> 68<br> 69<br> 70<br> 71<br> 72<br> 73<br> 74<br> 75<br> 76<br> 77<br> 78<br> 79<br> 80<br> 81<br> 82<br> 83<br> 84<br> 85<br> 86<br> 87<br> 88<br> 89<br> 90<br> 91<br> 92<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>``` | ```md-code__content<br>def create_exec_types(extension, cmd_component, module_builder=None):<br>    mlogger.debug('Command language is: %s', cmd_component.script_language)<br>    # set the name of the created type<br>    cmd_component.class_name = cmd_component.unique_name<br>    if module_builder:<br>        ### create the executor types<br>        ## first highly custom button types<br>        # if invoke<br>        if cmd_component.type_id == exts.INVOKE_BUTTON_POSTFIX:<br>            invoketypemaker.create_executor_type(<br>                extension,<br>                module_builder,<br>                cmd_component<br>                )<br>        # if link<br>        elif cmd_component.type_id == exts.LINK_BUTTON_POSTFIX:<br>            # link buttons don't need types<br>            mlogger.debug('Skipped creating executor type for: %s',<br>                          cmd_component)<br>        # if content<br>        elif cmd_component.type_id == exts.CONTENT_BUTTON_POSTFIX:<br>            # link buttons don't need types<br>            bundletypemaker.create_executor_type(<br>                extension,<br>                module_builder,<br>                cmd_component<br>                )<br>        # if url<br>        elif cmd_component.type_id == exts.URL_BUTTON_POSTFIX:<br>            urltypemaker.create_executor_type(<br>                extension,<br>                module_builder,<br>                cmd_component<br>                )<br>        ## now language based button types<br>        # if python<br>        elif cmd_component.script_language == exts.PYTHON_LANG:<br>            pythontypemaker.create_executor_type(<br>                extension,<br>                module_builder,<br>                cmd_component<br>                )<br>        # if dynamo<br>        elif cmd_component.script_language == exts.DYNAMO_LANG:<br>            dynamotypemaker.create_executor_type(<br>                extension,<br>                module_builder,<br>                cmd_component<br>                )<br>        # if anything else<br>        else:<br>            bundletypemaker.create_executor_type(<br>                extension,<br>                module_builder,<br>                cmd_component<br>                )<br>``` |

### `make_bundle_types(extension, cmd_component, module_builder=None)`

Create the types for the bundle.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extension` | `Extension` | pyRevit extension | _required_ |
| `cmd_component` | `GenericUICommand` | command | _required_ |
| `module_builder` | `ModuleBuilder` | module builder. | `None` |

Source code in `pyrevitlib/pyrevit/runtime/typemaker.py`

|     |     |
| --- | --- |
| ```<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>``` | ```md-code__content<br>def make_bundle_types(extension, cmd_component, module_builder=None):<br>    """Create the types for the bundle.<br>    Args:<br>        extension (pyrevit.extensions.components.Extension): pyRevit extension<br>        cmd_component (pyrevit.extensions.genericcomps.GenericUICommand):<br>            command<br>        module_builder (ModuleBuilder): module builder.<br>    """<br>    # make command interface type for the given command<br>    try:<br>        create_exec_types(extension, cmd_component, module_builder)<br>    except Exception as createtype_err:<br>        mlogger.error('Error creating appropriate exec types for: %s | %s',<br>                      cmd_component, createtype_err)<br>    # create availability types if necessary<br>    if cmd_component.context:<br>        try:<br>            create_avail_type(extension, cmd_component, module_builder)<br>        except Exception as createtype_err:<br>            mlogger.error('Error creating appropriate avail types for: %s | %s',<br>                          cmd_component, createtype_err)<br>``` |

Back to top

## URL Type Maker
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/urltypemaker/#pyrevit.runtime.urltypemaker)

# urltypemaker

Prepare and compile url script types.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

## Functions

### `create_executor_type(extension, module_builder, cmd_component)`

Create the dotnet type for the executor.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extension` | `Extension` | pyRevit extension | _required_ |
| `module_builder` | `ModuleBuilder` | module builder | _required_ |
| `cmd_component` | `GenericUICommand` | command component | _required_ |

Source code in `pyrevitlib/pyrevit/runtime/urltypemaker.py`

|     |     |
| --- | --- |
| ```<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>``` | ```md-code__content<br>def create_executor_type(extension, module_builder, cmd_component):<br>    """Create the dotnet type for the executor.<br>    Args:<br>        extension (Extension): pyRevit extension<br>        module_builder (ModuleBuilder): module builder<br>        cmd_component (GenericUICommand): command component<br>    """<br>    cmd_component.arguments = [cmd_component.get_target_url()]<br>    bundletypemaker.create_executor_type(<br>        extension,<br>        module_builder,<br>        cmd_component<br>        )<br>``` |

Back to top

## MathNet Module
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/mathnet/#pyrevit.coreutils.mathnet)

# mathnet

MathNet importer module.

See https://www.mathdotnet.com for documentation.

Examples:

```md-code__content
from pyrevit.coreutils.mathnet import MathNet

```

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `MATHNET_LIB = 'MathNet.Numerics'``module-attribute`

### `mathnet_dll = framework.get_dll_file(MATHNET_LIB)``module-attribute`

## Functions

Back to top

## pyRevit Core Logger
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/logger/#pyrevit.coreutils.logger)

# logger

Core logging module for pyRevit.

## Attributes

### `LOG_REC_FORMAT = '%(levelname)s [%(name)s] %(message)s'``module-attribute`

### `LOG_REC_FORMAT_HEADER = coreutils.prepare_html_str('<strong>%(levelname)s</strong> [%(name)s] %(message)s')``module-attribute`

### `LOG_REC_FORMAT_HEADER_NO_NAME = coreutils.prepare_html_str('<strong>%(levelname)s</strong>\n%(message)s')``module-attribute`

### `LOG_REC_FORMAT_EMOJI = '{emoji} %(levelname)s [%(name)s] %(message)s'``module-attribute`

### `LOG_REC_FORMAT_FILE = '%(asctime)s %(levelname)s [%(name)s] %(message)s'``module-attribute`

### `LOG_REC_FORMAT_FILE_C = '%(asctime)s %(levelname)s [<{}> %(name)s] %(message)s'``module-attribute`

### `LOG_REC_FORMAT_HTML = coreutils.prepare_html_str('<div class="logdefault {style}">{message}</div>')``module-attribute`

### `LOG_REC_CLASS_ERROR = 'logerror'``module-attribute`

### `LOG_REC_FORMAT_ERROR = LOG_REC_FORMAT_HTML.format(style=LOG_REC_CLASS_ERROR, message=LOG_REC_FORMAT_HEADER)``module-attribute`

### `LOG_REC_CLASS_WARNING = 'logwarning'``module-attribute`

### `LOG_REC_FORMAT_WARNING = LOG_REC_FORMAT_HTML.format(style=LOG_REC_CLASS_WARNING, message=LOG_REC_FORMAT_HEADER)``module-attribute`

### `LOG_REC_CLASS_CRITICAL = 'logcritical'``module-attribute`

### `LOG_REC_FORMAT_CRITICAL = LOG_REC_FORMAT_HTML.format(style=LOG_REC_CLASS_CRITICAL, message=LOG_REC_FORMAT_HEADER)``module-attribute`

### `LOG_REC_CLASS_SUCCESS = 'logsuccess'``module-attribute`

### `LOG_REC_FORMAT_SUCCESS = LOG_REC_FORMAT_HTML.format(style=LOG_REC_CLASS_SUCCESS, message=LOG_REC_FORMAT_HEADER_NO_NAME)``module-attribute`

### `LOG_REC_CLASS_DEPRECATE = 'logdeprecate'``module-attribute`

### `LOG_REC_FORMAT_DEPRECATE = LOG_REC_FORMAT_HTML.format(style=LOG_REC_CLASS_DEPRECATE, message=LOG_REC_FORMAT_HEADER_NO_NAME)``module-attribute`

### `DEFAULT_LOGGING_LEVEL = logging.WARNING``module-attribute`

### `DEPRECATE_LOG_LEVEL = 25``module-attribute`

### `SUCCESS_LOG_LEVEL = 80``module-attribute`

### `FILE_LOG_FILENAME = '{}runtime.log'.format(PYREVIT_FILE_PREFIX_STAMPED)``module-attribute`

### `FILE_LOG_FILEPATH = op.join(PYREVIT_VERSION_APP_DIR, FILE_LOG_FILENAME)``module-attribute`

### `FILE_LOGGING_DEFAULT_STATE = False``module-attribute`

### `stdout_hndlr = logging.StreamHandler(sys.stdout)``module-attribute`

### `default_formatter = logging.Formatter(LOG_REC_FORMAT)``module-attribute`

### `formatters = {SUCCESS_LOG_LEVEL: logging.Formatter(LOG_REC_FORMAT_SUCCESS), logging.ERROR: logging.Formatter(LOG_REC_FORMAT_ERROR), logging.WARNING: logging.Formatter(LOG_REC_FORMAT_WARNING), logging.CRITICAL: logging.Formatter(LOG_REC_FORMAT_CRITICAL), DEPRECATE_LOG_LEVEL: logging.Formatter(LOG_REC_FORMAT_DEPRECATE)}``module-attribute`

### `file_hndlr = logging.FileHandler(FILE_LOG_FILEPATH, mode='a', delay=True)``module-attribute`

### `file_formatter = logging.Formatter(LOG_REC_FORMAT_FILE)``module-attribute`

### `loggers = {}``module-attribute`

## Classes

### `DispatchingFormatter(log_formatters, log_default_formatter)`

Bases: `object`

Dispatching formatter to format by log level.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `log_formatters` | `dict[int` | logging.Formatter\]):<br>dict of level:formatter key pairs | _required_ |
| `log_default_formatter` | `Formatter` | default formatter | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>92<br>93<br>94<br>``` | ```md-code__content<br>def __init__(self, log_formatters, log_default_formatter):<br>    self._formatters = log_formatters<br>    self._default_formatter = log_default_formatter<br>``` |

#### Functions

##### `format(record)`

Format given record by log level.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br> 96<br> 97<br> 98<br> 99<br>100<br>``` | ```md-code__content<br>def format(self, record):<br>    """Format given record by log level."""<br>    formatter = self._formatters.get(record.levelno,<br>                                     self._default_formatter)<br>    return formatter.format(record)<br>``` |

### `LoggerWrapper(*args)`

Bases: `Logger`

Custom logging object.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>105<br>106<br>107<br>108<br>109<br>``` | ```md-code__content<br>def __init__(self, *args):<br>    logging.Logger.__init__(self, *args)<br>    self._has_errors = False<br>    self._filelogstate = False<br>    self._curlevel = DEFAULT_LOGGING_LEVEL<br>``` |

#### Functions

##### `callHandlers(record)`

Override logging.Logger.callHandlers.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>``` | ```md-code__content<br>def callHandlers(self, record):<br>    """Override logging.Logger.callHandlers."""<br>    for hdlr in self.handlers:<br>        # stream-handler only records based on current level<br>        if isinstance(hdlr, logging.StreamHandler) \<br>                and record.levelno >= self._curlevel:<br>            hdlr.handle(record)<br>        # file-handler must record everything<br>        elif isinstance(hdlr, logging.FileHandler) \<br>                and self._filelogstate:<br>            hdlr.handle(record)<br>``` |

##### `isEnabledFor(level)`

Override logging.Logger.isEnabledFor.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>``` | ```md-code__content<br>def isEnabledFor(self, level):<br>    """Override logging.Logger.isEnabledFor."""<br>    # update current logging level and file logging state<br>    self._filelogstate = \<br>        envvars.get_pyrevit_env_var(envvars.FILELOGGING_ENVVAR)<br>    self._curlevel = \<br>        envvars.get_pyrevit_env_var(envvars.LOGGING_LEVEL_ENVVAR)<br>    # the loader assembly sets EXEC_PARAMS.debug_mode to true if<br>    # user Ctrl-clicks on the button at script runtime.<br>    if EXEC_PARAMS.debug_mode:<br>        self._curlevel = logging.DEBUG<br>    # if file logging is disabled, return the current logging level<br>    # but if it's enabled, return the file logging level so the record<br>    # is generated and logged by file-handler. The stream-handler still<br>    # outputs the record based on the current logging level<br>    if self._filelogstate:<br>        return level >= logging.DEBUG<br>    return level >= self._curlevel<br>``` |

##### `is_enabled_for(level)`

Check if logger is enabled for level in pyRevit environment.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>``` | ```md-code__content<br>def is_enabled_for(self, level):<br>    """Check if logger is enabled for level in pyRevit environment."""<br>    self._curlevel = \<br>        envvars.get_pyrevit_env_var(envvars.LOGGING_LEVEL_ENVVAR)<br>    # the loader assembly sets EXEC_PARAMS.debug_mode to true if<br>    # user Ctrl-clicks on the button at script runtime.<br>    if EXEC_PARAMS.debug_mode:<br>        self._curlevel = logging.DEBUG<br>    return level >= self._curlevel<br>``` |

##### `has_errors()`

Check if logger has reported any errors.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>176<br>177<br>178<br>``` | ```md-code__content<br>def has_errors(self):<br>    """Check if logger has reported any errors."""<br>    return self._has_errors<br>``` |

##### `set_level(level)`

Set logging level to level.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>180<br>181<br>182<br>``` | ```md-code__content<br>def set_level(self, level):<br>    """Set logging level to level."""<br>    self._reset_logger_env_vars(level)<br>``` |

##### `set_quiet_mode()`

Activate quiet mode. All log levels are disabled.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>184<br>185<br>186<br>``` | ```md-code__content<br>def set_quiet_mode(self):<br>    """Activate quiet mode. All log levels are disabled."""<br>    self._reset_logger_env_vars(logging.CRITICAL)<br>``` |

##### `set_verbose_mode()`

Activate verbose mode. Log levels >= INFO are enabled.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>188<br>189<br>190<br>``` | ```md-code__content<br>def set_verbose_mode(self):<br>    """Activate verbose mode. Log levels >= INFO are enabled."""<br>    self._reset_logger_env_vars(logging.INFO)<br>``` |

##### `set_debug_mode()`

Activate debug mode. Log levels >= DEBUG are enabled.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>192<br>193<br>194<br>``` | ```md-code__content<br>def set_debug_mode(self):<br>    """Activate debug mode. Log levels >= DEBUG are enabled."""<br>    self._reset_logger_env_vars(logging.DEBUG)<br>``` |

##### `reset_level()`

Reset logging level back to default.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>196<br>197<br>198<br>``` | ```md-code__content<br>def reset_level(self):<br>    """Reset logging level back to default."""<br>    self._reset_logger_env_vars(DEFAULT_LOGGING_LEVEL)<br>``` |

##### `get_level()`

Return current logging level.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>200<br>201<br>202<br>``` | ```md-code__content<br>def get_level(self):<br>    """Return current logging level."""<br>    return envvars.get_pyrevit_env_var(envvars.LOGGING_LEVEL_ENVVAR)<br>``` |

##### `log_parse_except(parsed_file, parse_ex)`

Logs a file parsing exception.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `parsed_file` | `str` | File path that failed the parsing | _required_ |
| `parse_ex` | `Exception` | Parsing exception | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>``` | ```md-code__content<br>def log_parse_except(self, parsed_file, parse_ex):<br>    """Logs a file parsing exception.<br>    Args:<br>        parsed_file (str): File path that failed the parsing<br>        parse_ex (Exception): Parsing exception<br>    """<br>    err_msg = '<strong>Error while parsing file:</strong>\n{file}\n' \<br>              '<strong>Error type:</strong> {type}\n' \<br>              '<strong>Error Message:</strong> {errmsg}\n' \<br>              '<strong>Line/Column:</strong> {lineno}/{colno}\n' \<br>              '<strong>Line Text:</strong> {linetext}' \<br>              .format(file=parsed_file,<br>                      type=parse_ex.__class__.__name__,<br>                      errmsg=parse_ex.msg if hasattr(parse_ex, 'msg') else "",<br>                      lineno=parse_ex.lineno if hasattr(parse_ex, 'lineno') else 0,<br>                      colno=parse_ex.offset if hasattr(parse_ex, 'offset') else 0,<br>                      linetext=parse_ex.text if hasattr(parse_ex, 'text') else "",<br>                      )<br>    self.error(coreutils.prepare_html_str(err_msg))<br>``` |

##### `success(message, *args, **kws)`

Log a success message.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | success message | _required_ |
| `*args` | `Any` | extra agruments passed to the log function | `()` |
| `**kws` | `Any` | extra agruments passed to the log function | `{}` |

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>``` | ```md-code__content<br>def success(self, message, *args, **kws):<br>    """Log a success message.<br>    Args:<br>        message (str): success message<br>        *args (Any): extra agruments passed to the log function<br>        **kws (Any): extra agruments passed to the log function<br>    """<br>    if self.isEnabledFor(SUCCESS_LOG_LEVEL):<br>        # Yes, logger takes its '*args' as 'args'.<br>        self._log(SUCCESS_LOG_LEVEL, message, args, **kws)<br>``` |

##### `deprecate(message, *args, **kws)`

Log a deprecation message.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | deprecation message | _required_ |
| `*args` | `Any` | extra agruments passed to the log function | `()` |
| `**kws` | `Any` | extra agruments passed to the log function | `{}` |

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>``` | ```md-code__content<br>def deprecate(self, message, *args, **kws):<br>    """Log a deprecation message.<br>    Args:<br>        message (str): deprecation message<br>        *args (Any): extra agruments passed to the log function<br>        **kws (Any): extra agruments passed to the log function<br>    """<br>    if self.isEnabledFor(DEPRECATE_LOG_LEVEL):<br>        # Yes, logger takes its '*args' as 'args'.<br>        self._log(DEPRECATE_LOG_LEVEL, message, args, **kws)<br>``` |

##### `dev_log(source, message='')`

Appends a message to a log file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `source` | `str` | source of the message | _required_ |
| `message` | `str` | message to log | `''` |

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>``` | ```md-code__content<br>def dev_log(self, source, message=''):<br>    """Appends a message to a log file.<br>    Args:<br>        source (str): source of the message<br>        message (str): message to log<br>    """<br>    devlog_fname = \<br>        '{}.log'.format(EXEC_PARAMS.command_uniqueid or self.name)<br>    with open(op.join(USER_DESKTOP, devlog_fname), 'a') as devlog_file:<br>        devlog_file.writelines('{tstamp} [{exid}] {src}: {msg}\n'.format(<br>            tstamp=EXEC_PARAMS.exec_timestamp,<br>            exid=EXEC_PARAMS.exec_id,<br>            src=source,<br>            msg=message,<br>            ))<br>``` |

## Functions

### `get_stdout_hndlr()`

Return stdout logging handler object.

Returns:

| Type | Description |
| --- | --- |
| `StreamHandler` | configured instance of python's native stream handler |

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>``` | ```md-code__content<br>def get_stdout_hndlr():<br>    """Return stdout logging handler object.<br>    Returns:<br>        (logging.StreamHandler):<br>            configured instance of python's native stream handler<br>    """<br>    global stdout_hndlr     #pylint: disable=W0603<br>    return stdout_hndlr<br>``` |

### `get_file_hndlr()`

Return file logging handler object.

Returns:

| Type | Description |
| --- | --- |
| `FileHandler` | configured instance of python's native stream handler |

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>``` | ```md-code__content<br>def get_file_hndlr():<br>    """Return file logging handler object.<br>    Returns:<br>        (logging.FileHandler):<br>            configured instance of python's native stream handler<br>    """<br>    global file_hndlr       #pylint: disable=W0603<br>    if EXEC_PARAMS.command_mode:<br>        cmd_file_hndlr = logging.FileHandler(FILE_LOG_FILEPATH,<br>                                             mode='a', delay=True)<br>        logformat = LOG_REC_FORMAT_FILE_C.format(EXEC_PARAMS.command_name)<br>        formatter = logging.Formatter(logformat)<br>        cmd_file_hndlr.setFormatter(formatter)<br>        return cmd_file_hndlr<br>    else:<br>        return file_hndlr<br>``` |

### `get_logger(logger_name)`

Register and return a logger with given name.

Caches all registered loggers and returns the same logger object on
second call with the same logger name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `logger_name` | `str` | logger name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `LoggerWrapper` | logger object wrapper python's native logger |

Examples:

```md-code__content
get_logger('my command')

```

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>350<br>351<br>352<br>``` | ````md-code__content<br>def get_logger(logger_name):<br>    """Register and return a logger with given name.<br>    Caches all registered loggers and returns the same logger object on<br>    second call with the same logger name.<br>    Args:<br>        logger_name (str): logger name<br>    Returns:<br>        (LoggerWrapper): logger object wrapper python's native logger<br>    Examples:<br>        ```python<br>        get_logger('my command')<br>        ```<br>        <LoggerWrapper ...><br>    """<br>    if loggers.get(logger_name):<br>        return loggers.get(logger_name)<br>    else:<br>        logger = logging.getLogger(logger_name)    # type: LoggerWrapper<br>        logger.addHandler(get_stdout_hndlr())<br>        logger.propagate = False<br>        logger.addHandler(get_file_hndlr())<br>        loggers.update({logger_name: logger})<br>        return logger<br>```` |

### `set_file_logging(status)`

Set file logging status (enable/disable).

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `status` | `bool` | True to enable, False to disable | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>355<br>356<br>357<br>358<br>359<br>360<br>361<br>``` | ```md-code__content<br>def set_file_logging(status):<br>    """Set file logging status (enable/disable).<br>    Args:<br>        status (bool): True to enable, False to disable<br>    """<br>    envvars.set_pyrevit_env_var(envvars.FILELOGGING_ENVVAR, status)<br>``` |

### `loggers_have_errors()`

Check if any errors have been reported by any of registered loggers.

Source code in `pyrevitlib/pyrevit/coreutils/logger.py`

|     |     |
| --- | --- |
| ```<br>364<br>365<br>366<br>367<br>368<br>369<br>``` | ```md-code__content<br>def loggers_have_errors():<br>    """Check if any errors have been reported by any of registered loggers."""<br>    for logger in loggers.values():<br>        if logger.has_errors():<br>            return True<br>    return False<br>``` |

Back to top

## Excel File Interop
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/xl/#pyrevit.interop.xl)

# xl

Read and Write Excel Files.

## Functions

### `load(xlfile, sheets=[], columns=[], datatype=None, headers=True)`

Read data from Excel file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xlfile` | `str` | full path of the excel file to read | _required_ |
| `sheets` | `list` | worksheets to read. Defaults to all the sheets. | `[]` |
| `columns` | `list` | Names to give to the columns.<br>It builds a dictionary for each row with the column name and value.<br>If none given (default), it returns a simple list of values. | `[]` |
| `datatype` | `type` | Type of the data. Defaults to None. | `None` |
| `headers` | `bool` | Whether to use the first row as headers.<br>Defaults to True. | `True` |

Returns:

| Type | Description |
| --- | --- |
| `dict[str, dict[str, Any]]` | Excel data grouped by worksheet.<br>Each worksheet is a dictionary with `headers` and `rows`. |

Source code in `pyrevitlib/pyrevit/interop/xl.py`

|     |     |
| --- | --- |
| ```<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>``` | ```md-code__content<br>def load(xlfile, sheets=[], columns=[], datatype=None, headers=True):<br>    """Read data from Excel file.<br>    Args:<br>        xlfile (str): full path of the excel file to read<br>        sheets (list, optional): worksheets to read. Defaults to all the sheets.<br>        columns (list, optional): Names to give to the columns.<br>            It builds a dictionary for each row with the column name and value.<br>            If none given (default), it returns a simple list of values.<br>        datatype (type, optional): Type of the data. Defaults to None.<br>        headers (bool, optional): Whether to use the first row as headers.<br>            Defaults to True.<br>    Returns:<br>        (dict[str, dict[str, Any]]): Excel data grouped by worksheet.<br>            Each worksheet is a dictionary with `headers` and `rows`.<br>    """<br>    xldata = {}<br>    xlwb = xlrd.open_workbook(xlfile)<br>    for xlsheet in xlwb.sheets():<br>        if sheets:<br>            if xlsheet.name in sheets:<br>                xldata[xlsheet.name] = _read_xlsheet(xlsheet,<br>                                                     columns=columns,<br>                                                     datatype=datatype,<br>                                                     headers=headers)<br>        else:<br>            xldata[xlsheet.name] = _read_xlsheet(xlsheet,<br>                                                 columns=columns,<br>                                                 datatype=datatype,<br>                                                 headers=headers)<br>    return xldata<br>``` |

### `dump(xlfile, datadict)`

Write data to Excel file.

Creates a worksheet for each item of the input dictionary.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xlfile` | `str` | full path of the target excel file | _required_ |
| `datadict` | `dict[str, list]` | dictionary of worksheets names and data | _required_ |

Source code in `pyrevitlib/pyrevit/interop/xl.py`

|     |     |
| --- | --- |
| ```<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>``` | ```md-code__content<br>def dump(xlfile, datadict):<br>    """Write data to Excel file.<br>    Creates a worksheet for each item of the input dictionary.<br>    Args:<br>        xlfile (str): full path of the target excel file<br>        datadict (dict[str, list]): dictionary of worksheets names and data<br>    """<br>    xlwb = xlsxwriter.Workbook(xlfile)<br>    # bold = xlwb.add_format({'bold': True})<br>    for xlsheetname, xlsheetdata in datadict.items():<br>        xlsheet = xlwb.add_worksheet(xlsheetname)<br>        for idx, data in enumerate(xlsheetdata):<br>            xlsheet.write_row(idx, 0, data)<br>    xlwb.close()<br>``` |

Back to top

## Revit Element Selection Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/selection/#pyrevit.revit.selection)

# selection

Elements selection utilities.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Classes

### `ElementSelection(element_list=None)`

Element selection handler.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element_list` | `list[Element]` | list of selected elements | `None` |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>``` | ```md-code__content<br>def __init__(self, element_list=None):<br>    if element_list is None:<br>        if HOST_APP.uidoc:<br>            self._refs = \<br>                [x for x in HOST_APP.uidoc.Selection.GetElementIds()]<br>        else:<br>            self._refs = []<br>    else:<br>        self._refs = ElementSelection.get_element_ids(element_list)<br>``` |

#### Attributes

##### `is_empty``property`

##### `elements``property`

##### `element_ids``property`

##### `first``property`

##### `last``property`

#### Functions

##### `get_element_ids(mixed_list)``classmethod`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>61<br>62<br>63<br>``` | ```md-code__content<br>@classmethod<br>def get_element_ids(cls, mixed_list):<br>    return ensure.ensure_element_ids(mixed_list)<br>``` |

##### `set_to(element_list)`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>87<br>88<br>89<br>90<br>91<br>92<br>``` | ```md-code__content<br>def set_to(self, element_list):<br>    self._refs = ElementSelection.get_element_ids(element_list)<br>    HOST_APP.uidoc.Selection.SetElementIds(<br>        framework.List[DB.ElementId](self._refs)<br>        )<br>    HOST_APP.uidoc.RefreshActiveView()<br>``` |

##### `clear()`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>94<br>95<br>96<br>97<br>98<br>``` | ```md-code__content<br>def clear(self):<br>    HOST_APP.uidoc.Selection.SetElementIds(<br>        framework.List[DB.ElementId]([DB.ElementId.InvalidElementId])<br>    )<br>    HOST_APP.uidoc.RefreshActiveView()<br>``` |

##### `append(element_list)`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>100<br>101<br>102<br>``` | ```md-code__content<br>def append(self, element_list):<br>    self._refs.extend(ElementSelection.get_element_ids(element_list))<br>    self.set_to(self._refs)<br>``` |

##### `include(element_type)`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>104<br>105<br>106<br>107<br>108<br>``` | ```md-code__content<br>def include(self, element_type):<br>    refs = [x for x in self._refs<br>            if isinstance(DOCS.doc.GetElement(x),<br>                          element_type)]<br>    return ElementSelection(refs)<br>``` |

##### `exclude(element_type)`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>110<br>111<br>112<br>113<br>114<br>``` | ```md-code__content<br>def exclude(self, element_type):<br>    refs = [x for x in self._refs<br>            if not isinstance(DOCS.doc.GetElement(x),<br>                              element_type)]<br>    return ElementSelection(refs)<br>``` |

##### `no_views()`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>116<br>117<br>``` | ```md-code__content<br>def no_views(self):<br>    return self.exclude(DB.View)<br>``` |

##### `only_views()`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>119<br>120<br>``` | ```md-code__content<br>def only_views(self):<br>    return self.include(DB.View)<br>``` |

##### `expand_groups()`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>``` | ```md-code__content<br>def expand_groups(self):<br>    expanded_refs = []<br>    for element in self.elements:<br>        if isinstance(element, DB.Group):<br>            expanded_refs.extend(element.GetMemberIds())<br>        else:<br>            expanded_refs.append(element.Id)<br>    self._refs = expanded_refs<br>``` |

### `PickByCategorySelectionFilter(category_id)`

Bases: `ISelectionFilter`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>133<br>134<br>``` | ```md-code__content<br>def __init__(self, category_id):<br>    self.category_id = category_id<br>``` |

#### Attributes

##### `category_id = category_id``instance-attribute`

#### Functions

##### `AllowElement(element)`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>137<br>138<br>139<br>140<br>141<br>``` | ```md-code__content<br>def AllowElement(self, element):<br>    if element.Category and self.category_id == element.Category.Id:<br>        return True<br>    else:<br>        return False<br>``` |

##### `AllowReference(refer, point)`

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>144<br>145<br>``` | ```md-code__content<br>def AllowReference(self, refer, point):  # pylint: disable=W0613<br>    return False<br>``` |

## Functions

### `pick_element(message='')`

Asks the user to pick an element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | An optional message to display. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `Element` | element selected by the user. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>``` | ```md-code__content<br>def pick_element(message=''):<br>    """Asks the user to pick an element.<br>    Args:<br>        message (str): An optional message to display.<br>    Returns:<br>        (Element): element selected by the user.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Element,<br>                     message)<br>``` |

### `pick_element_by_category(cat_name_or_builtin, message='')`

Returns the element of the specified category picked by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_builtin` | `str` | name or built-in category of the element<br>to pick. | _required_ |
| `message` | `str` | message to display on selection.<br>Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `Element` | picked element. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If no category matches the specified name or builtin. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>``` | ```md-code__content<br>def pick_element_by_category(cat_name_or_builtin, message=''):<br>    """Returns the element of the specified category picked by the user.<br>    Args:<br>        cat_name_or_builtin (str): name or built-in category of the element<br>            to pick.<br>        message (str, optional): message to display on selection.<br>            Defaults to ''.<br>    Returns:<br>        (Element): picked element.<br>    Raises:<br>        PyRevitException: If no category matches the specified name or builtin.<br>    """<br>    category = query.get_category(cat_name_or_builtin)<br>    if category:<br>        pick_filter = PickByCategorySelectionFilter(category.Id)<br>        return _pick_obj(UI.Selection.ObjectType.Element,<br>                         message,<br>                         selection_filter=pick_filter)<br>    else:<br>        raise PyRevitException("Can not determine category id from: {}"<br>                               .format(cat_name_or_builtin))<br>``` |

### `pick_elementpoint(message='', world=False)`

Returns the element point selected by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | message to display. Defaults to ''. | `''` |
| `world` | `bool` | whether to use world coordinates. Defaults to False. | `False` |

Returns:

| Type | Description |
| --- | --- |
| `PointOnElement` | The selected point. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>``` | ```md-code__content<br>def pick_elementpoint(message='', world=False):<br>    """Returns the element point selected by the user.<br>    Args:<br>        message (str, optional): message to display. Defaults to ''.<br>        world (bool, optional): whether to use world coordinates. Defaults to False.<br>    Returns:<br>        (PointOnElement): The selected point.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.PointOnElement,<br>                     message,<br>                     world=world)<br>``` |

### `pick_edge(message='')`

Returns the edge selected by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | message to display. Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `Edge` | The selected edge. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>``` | ```md-code__content<br>def pick_edge(message=''):<br>    """Returns the edge selected by the user.<br>    Args:<br>        message (str, optional): message to display. Defaults to ''.<br>    Returns:<br>        (Edge): The selected edge.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Edge,<br>                     message)<br>``` |

### `pick_face(message='')`

Returns the face selected by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | message to display. Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `Face` | The selected face. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>``` | ```md-code__content<br>def pick_face(message=''):<br>    """Returns the face selected by the user.<br>    Args:<br>        message (str, optional): message to display. Defaults to ''.<br>    Returns:<br>        (Face): The selected face.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Face,<br>                     message)<br>``` |

### `pick_linked(message='')`

Returns the linked element selected by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | message to display. Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `LinkedElement` | The selected linked element. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>``` | ```md-code__content<br>def pick_linked(message=''):<br>    """Returns the linked element selected by the user.<br>    Args:<br>        message (str, optional): message to display. Defaults to ''.<br>    Returns:<br>        (LinkedElement): The selected linked element.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.LinkedElement,<br>                     message)<br>``` |

### `pick_elements(message='')`

Asks the user to pick multiple elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | An optional message to display. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[Element]` | elements selected by the user. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>``` | ```md-code__content<br>def pick_elements(message=''):<br>    """Asks the user to pick multiple elements.<br>    Args:<br>        message (str): An optional message to display.<br>    Returns:<br>        (list[Element]): elements selected by the user.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Element,<br>                     message,<br>                     multiple=True)<br>``` |

### `pick_elements_by_category(cat_name_or_builtin, message='')`

Returns the elements of the specified category picked by the user.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_builtin` | `str` | name or built-in category of the elements<br>to pick. | _required_ |
| `message` | `str` | message to display on selection.<br>Defaults to ''. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[Element]` | picked elements. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If no category matches the specified name or builtin. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>``` | ```md-code__content<br>def pick_elements_by_category(cat_name_or_builtin, message=''):<br>    """Returns the elements of the specified category picked by the user.<br>    Args:<br>        cat_name_or_builtin (str): name or built-in category of the elements<br>            to pick.<br>        message (str, optional): message to display on selection.<br>            Defaults to ''.<br>    Returns:<br>        (list[Element]): picked elements.<br>    Raises:<br>        PyRevitException: If no category matches the specified name or builtin.<br>    """<br>    category = query.get_category(cat_name_or_builtin)<br>    if category:<br>        pick_filter = PickByCategorySelectionFilter(category.Id)<br>        return _pick_obj(UI.Selection.ObjectType.Element,<br>                         message,<br>                         multiple=True,<br>                         selection_filter=pick_filter)<br>    else:<br>        raise PyRevitException("Can not determine category id from: {}"<br>                               .format(cat_name_or_builtin))<br>``` |

### `get_picked_elements(message='')`

Allows the user to pick multple elements, one at a time.

It keeps asking the user to pick an element until no elements are selected.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display. Defaults to ''. | `''` |

Yields:

| Type | Description |
| --- | --- |
| `Element` | selected element |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>``` | ```md-code__content<br>def get_picked_elements(message=''):<br>    """Allows the user to pick multple elements, one at a time.<br>    It keeps asking the user to pick an element until no elements are selected.<br>    Args:<br>        message (str, optional): The message to display. Defaults to ''.<br>    Yields:<br>        (DB.Element): selected element<br>    """<br>    picked_element = True<br>    while picked_element:<br>        picked_element = pick_element(message=message)<br>        if not picked_element:<br>            break<br>        yield picked_element<br>``` |

### `get_picked_elements_by_category(cat_name_or_builtin, message='')`

Pick elements by category.

Keeps asking the user to pick an element until no elements are selected.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_builtin` | `str` | category name or built-in category. | _required_ |
| `message` | `str` | message to display while picking elements. | `''` |

Yields:

| Type | Description |
| --- | --- |
| `Element` | The picked elements from the specified category. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>``` | ```md-code__content<br>def get_picked_elements_by_category(cat_name_or_builtin, message=''):<br>    """Pick elements by category.<br>    Keeps asking the user to pick an element until no elements are selected.<br>    Args:<br>        cat_name_or_builtin (str): category name or built-in category.<br>        message (str, optional): message to display while picking elements.<br>    Yields:<br>        (DB.Element): The picked elements from the specified category.<br>    """<br>    picked_element = True<br>    while picked_element:<br>        picked_element = pick_element_by_category(cat_name_or_builtin,<br>                                                  message=message)<br>        if not picked_element:<br>            break<br>        yield picked_element<br>``` |

### `pick_elementpoints(message='', world=False)`

Selects element points.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display when selecting element points. | `''` |
| `world` | `bool` | Select points in world coordinates. Defaults to False. | `False` |

Returns:

| Type | Description |
| --- | --- |
| `list[PointOnElement]` | selected element points. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>383<br>384<br>``` | ```md-code__content<br>def pick_elementpoints(message='', world=False):<br>    """Selects element points.<br>    Args:<br>        message (str): The message to display when selecting element points.<br>        world (bool, optional): Select points in world coordinates. Defaults to False.<br>    Returns:<br>        (list[PointOnElement]): selected element points.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.PointOnElement,<br>                     message,<br>                     multiple=True, world=world)<br>``` |

### `pick_edges(message='')`

Selects edges.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display when selecting edges. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[Edge]` | selected edges. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>387<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>``` | ```md-code__content<br>def pick_edges(message=''):<br>    """Selects edges.<br>    Args:<br>        message (str): The message to display when selecting edges.<br>    Returns:<br>        (list[Edge]): selected edges.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Edge,<br>                     message,<br>                     multiple=True)<br>``` |

### `pick_faces(message='')`

Selects faces.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display when selecting the faces. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[Face]` | selected faces. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>``` | ```md-code__content<br>def pick_faces(message=''):<br>    """Selects faces.<br>    Args:<br>        message (str): The message to display when selecting the faces.<br>    Returns:<br>        (list[Face]): selected faces.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.Face,<br>                     message,<br>                     multiple=True)<br>``` |

### `pick_linkeds(message='')`

Selects linked elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | The message to display when selecting linked elements. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `list[LinkedElement]` | selected linked elements. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>def pick_linkeds(message=''):<br>    """Selects linked elements.<br>    Args:<br>        message (str): The message to display when selecting linked elements.<br>    Returns:<br>        (list[LinkedElement]): selected linked elements.<br>    """<br>    return _pick_obj(UI.Selection.ObjectType.LinkedElement,<br>                     message,<br>                     multiple=True)<br>``` |

### `pick_point(message='')`

Pick a point from the user interface.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | A message to display when prompting for the point. | `''` |

Returns:

| Type | Description |
| --- | --- |
| `tuple or None` | A tuple representing the picked point as (x, y, z)<br>coordinates, or None if no point was picked or an error occurred. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>``` | ```md-code__content<br>def pick_point(message=''):<br>    """Pick a point from the user interface.<br>    Args:<br>        message (str): A message to display when prompting for the point.<br>    Returns:<br>        (tuple or None): A tuple representing the picked point as (x, y, z)<br>            coordinates, or None if no point was picked or an error occurred.<br>    """<br>    try:<br>        return HOST_APP.uidoc.Selection.PickPoint(message)<br>    except Exception:<br>        return None<br>``` |

### `pick_rectangle(message='', pick_filter=None)`

Picks elements from the user interface by specifying a rectangular area.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `message` | `str` | A custom message to display when prompting<br>the user to pick elements. Default is an empty string. | `''` |
| `pick_filter` | `object` | An object specifying the filter to apply<br>when picking elements. Default is None. | `None` |

Returns:

| Type | Description |
| --- | --- |
| `list[ElementId]` | The selected elements. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>456<br>457<br>458<br>459<br>460<br>461<br>``` | ```md-code__content<br>def pick_rectangle(message='', pick_filter=None):<br>    """Picks elements from the user interface by specifying a rectangular area.<br>    Args:<br>        message (str, optional): A custom message to display when prompting<br>            the user to pick elements. Default is an empty string.<br>        pick_filter (object, optional): An object specifying the filter to apply<br>            when picking elements. Default is None.<br>    Returns:<br>        (list[DB.ElementId]): The selected elements.<br>    """<br>    if pick_filter:<br>        return HOST_APP.uidoc.Selection.PickElementsByRectangle(pick_filter,<br>                                                                message)<br>    else:<br>        return HOST_APP.uidoc.Selection.PickElementsByRectangle(message)<br>``` |

### `get_selection_category_set()`

Returns a CategorySet with the categories of the selected elements.

Returns:

| Type | Description |
| --- | --- |
| `CategorySet` | categories of the selected elements. |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>472<br>473<br>474<br>``` | ```md-code__content<br>def get_selection_category_set():<br>    """Returns a CategorySet with the categories of the selected elements.<br>    Returns:<br>        (CategorySet): categories of the selected elements.<br>    """<br>    selection = ElementSelection()<br>    cset = DB.CategorySet()<br>    for element in selection:<br>        cset.Insert(element.Category)<br>    return cset<br>``` |

### `get_selection()`

Returns the current selected items.

Returns:

| Type | Description |
| --- | --- |
| `ElementSelection` | the current selected items |

Source code in `pyrevitlib/pyrevit/revit/selection.py`

|     |     |
| --- | --- |
| ```<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>``` | ```md-code__content<br>def get_selection():<br>    """Returns the current selected items.<br>    Returns:<br>        (ElementSelection): the current selected items<br>    """<br>    return ElementSelection()<br>``` |

Back to top

## pyRevit Config Parser
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/configparser/#pyrevit.coreutils.configparser)

# configparser

Base module for pyRevit config parsing.

## Attributes

### `KEY_VALUE_TRUE = 'True'``module-attribute`

### `KEY_VALUE_FALSE = 'False'``module-attribute`

## Classes

### `PyRevitConfigSectionParser(config_parser, section_name)`

Bases: `object`

Config section parser object. Handle section options.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>16<br>17<br>18<br>``` | ```md-code__content<br>def __init__(self, config_parser, section_name):<br>    self._parser = config_parser<br>    self._section_name = section_name<br>``` |

#### Attributes

##### `header``property`

Section header.

##### `subheader``property`

Section sub-header e.g. Section.SubSection.

#### Functions

##### `has_option(option_name)`

Check if section contains given option.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>93<br>94<br>95<br>``` | ```md-code__content<br>def has_option(self, option_name):<br>    """Check if section contains given option."""<br>    return self._parser.has_option(self._section_name, option_name)<br>``` |

##### `get_option(op_name, default_value=None)`

Get option value or return default.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>``` | ```md-code__content<br>def get_option(self, op_name, default_value=None):<br>    """Get option value or return default."""<br>    try:<br>        return self.__getattr__(op_name)<br>    except Exception as opt_get_err:<br>        if default_value is not None:<br>            return default_value<br>        else:<br>            raise opt_get_err<br>``` |

##### `set_option(op_name, value)`

Set value of given option.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>107<br>108<br>109<br>``` | ```md-code__content<br>def set_option(self, op_name, value):<br>    """Set value of given option."""<br>    self.__setattr__(op_name, value)<br>``` |

##### `remove_option(option_name)`

Remove given option from section.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>111<br>112<br>113<br>``` | ```md-code__content<br>def remove_option(self, option_name):<br>    """Remove given option from section."""<br>    return self._parser.remove_option(self._section_name, option_name)<br>``` |

##### `has_subsection(section_name)`

Check if section has any subsections.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>115<br>116<br>117<br>``` | ```md-code__content<br>def has_subsection(self, section_name):<br>    """Check if section has any subsections."""<br>    return True if self.get_subsection(section_name) else False<br>``` |

##### `add_subsection(section_name)`

Add subsection to section.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>119<br>120<br>121<br>122<br>123<br>``` | ```md-code__content<br>def add_subsection(self, section_name):<br>    """Add subsection to section."""<br>    return self._parser.add_section(<br>        coreutils.make_canonical_name(self._section_name, section_name)<br>    )<br>``` |

##### `get_subsections()`

Get all subsections.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>``` | ```md-code__content<br>def get_subsections(self):<br>    """Get all subsections."""<br>    subsections = []<br>    for section_name in self._parser.sections():<br>        if section_name.startswith(self._section_name + '.'):<br>            subsec = PyRevitConfigSectionParser(self._parser, section_name)<br>            subsections.append(subsec)<br>    return subsections<br>``` |

##### `get_subsection(section_name)`

Get subsection with given name.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>134<br>135<br>136<br>137<br>138<br>``` | ```md-code__content<br>def get_subsection(self, section_name):<br>    """Get subsection with given name."""<br>    for subsection in self.get_subsections():<br>        if subsection.subheader == section_name:<br>            return subsection<br>``` |

### `PyRevitConfigParser(cfg_file_path=None)`

Bases: `object`

Config parser object. Handle config sections and io.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>``` | ```md-code__content<br>def __init__(self, cfg_file_path=None):<br>    self._cfg_file_path = cfg_file_path<br>    self._parser = configparser.ConfigParser()<br>    if self._cfg_file_path:<br>        try:<br>            with codecs.open(self._cfg_file_path, 'r', 'utf-8') as cfg_file:<br>                try:<br>                    self._parser.readfp(cfg_file)<br>                except AttributeError:<br>                    self._parser.read_file(cfg_file)<br>        except (OSError, IOError):<br>            raise PyRevitIOError()<br>        except Exception as read_err:<br>            raise PyRevitException(read_err)<br>``` |

#### Functions

##### `get_config_file_hash()`

Get calculated unique hash for this config.

Returns:

| Type | Description |
| --- | --- |
| `str` | hash of the config. |

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>``` | ```md-code__content<br>def get_config_file_hash(self):<br>    """Get calculated unique hash for this config.<br>    Returns:<br>        (str): hash of the config.<br>    """<br>    with codecs.open(self._cfg_file_path, 'r', 'utf-8') as cfg_file:<br>        cfg_hash = coreutils.get_str_hash(cfg_file.read())<br>    return cfg_hash<br>``` |

##### `has_section(section_name)`

Check if config contains given section.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>``` | ```md-code__content<br>def has_section(self, section_name):<br>    """Check if config contains given section."""<br>    try:<br>        self.get_section(section_name)<br>        return True<br>    except Exception:<br>        return False<br>``` |

##### `add_section(section_name)`

Add section with given name to config.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>189<br>190<br>191<br>192<br>``` | ```md-code__content<br>def add_section(self, section_name):<br>    """Add section with given name to config."""<br>    self._parser.add_section(section_name)<br>    return PyRevitConfigSectionParser(self._parser, section_name)<br>``` |

##### `get_section(section_name)`

Get section with given name.

Raises:

| Type | Description |
| --- | --- |
| `AttributeError` | if section is missing |

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>``` | ```md-code__content<br>def get_section(self, section_name):<br>    """Get section with given name.<br>    Raises:<br>        AttributeError: if section is missing<br>    """<br>    # check is section with full name is available<br>    if self._parser.has_section(section_name):<br>        return PyRevitConfigSectionParser(self._parser, section_name)<br>    # if not try to match with section_name.subsection<br>    # if there is a section_name.subsection defined, that should be<br>    # the sign that the section exists<br>    # section obj then supports getting all subsections<br>    for cfg_section_name in self._parser.sections():<br>        master_section = coreutils.get_canonical_parts(cfg_section_name)[0]<br>        if section_name == master_section:<br>            return PyRevitConfigSectionParser(self._parser,<br>                                              master_section)<br>    # if no match happened then raise exception<br>    raise AttributeError('Section does not exist in config file.')<br>``` |

##### `remove_section(section_name)`

Remove section from config.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>217<br>218<br>219<br>220<br>221<br>222<br>``` | ```md-code__content<br>def remove_section(self, section_name):<br>    """Remove section from config."""<br>    cfg_section = self.get_section(section_name)<br>    for cfg_subsection in cfg_section.get_subsections():<br>        self._parser.remove_section(cfg_subsection.header)<br>    self._parser.remove_section(cfg_section.header)<br>``` |

##### `reload(cfg_file_path=None)`

Reload config from original or given file.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>``` | ```md-code__content<br>def reload(self, cfg_file_path=None):<br>    """Reload config from original or given file."""<br>    try:<br>        with codecs.open(cfg_file_path \<br>                or self._cfg_file_path, 'r', 'utf-8') as cfg_file:<br>            try:<br>                self._parser.readfp(cfg_file)<br>            except AttributeError:<br>                self._parser.read_file(cfg_file)<br>    except (OSError, IOError):<br>        raise PyRevitIOError()<br>``` |

##### `save(cfg_file_path=None)`

Save config to original or given file.

Source code in `pyrevitlib/pyrevit/coreutils/configparser.py`

|     |     |
| --- | --- |
| ```<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>``` | ```md-code__content<br>def save(self, cfg_file_path=None):<br>    """Save config to original or given file."""<br>    try:<br>        with codecs.open(cfg_file_path \<br>                or self._cfg_file_path, 'w', 'utf-8') as cfg_file:<br>            self._parser.write(cfg_file)<br>    except (OSError, IOError):<br>        raise PyRevitIOError()<br>``` |

Back to top

## DirectContext3DServer Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/dc3dserver/#pyrevit.revit.dc3dserver)

# dc3dserver

DirectContext3DServer wrapper and utilities.

## Attributes

### `Edge = namedtuple('Edge', ['a', 'b', 'color'])``module-attribute`

### `Triangle = namedtuple('Triangle', ['a', 'b', 'c', 'normal', 'color'])``module-attribute`

## Classes

### `Mesh(edges, triangles)`

Bases: `object`

Geometry container class to generate DirectContext3DServer buffers.

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>``` | ```md-code__content<br>def __init__(self, edges, triangles):<br>    if not isinstance(edges, list):<br>        raise ValueError("List of Edges should be provided")<br>    self.edges = edges<br>    if not isinstance(triangles, list):<br>        raise ValueError("List of Triangles should be provided")<br>    self.triangles = triangles<br>    vertices = []<br>    for edge in self.edges:<br>        vertices.extend([edge.a, edge.b])<br>    for triangle in self.triangles:<br>        vertices.extend([triangle.a, triangle.b, triangle.c])<br>    self.vertices = vertices<br>``` |

#### Attributes

##### `edges = edges``instance-attribute`

##### `triangles = triangles``instance-attribute`

##### `vertices = vertices``instance-attribute`

#### Functions

##### `calculate_triangle_normal(a, b, c)``staticmethod`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>32<br>33<br>34<br>``` | ```md-code__content<br>@staticmethod<br>def calculate_triangle_normal(a, b, c):<br>    return (c - a).CrossProduct(b - a)<br>``` |

##### `from_solid(doc, solid)``classmethod`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>``` | ```md-code__content<br>@classmethod<br>def from_solid(cls, doc, solid):<br>    try:<br>        if not isinstance(solid, DB.Solid):<br>            raise TypeError("Provided object has to be a Revit Solid!")<br>        triangles = []<br>        edges = []<br>        for face in solid.Faces:<br>            if face.MaterialElementId == DB.ElementId.InvalidElementId:<br>                # make it white if material is <By Category><br>                color = DB.ColorWithTransparency(255, 255, 255, 0)<br>            else:<br>                material = doc.GetElement(face.MaterialElementId)<br>                color = DB.ColorWithTransparency(<br>                    material.Color.Red,<br>                    material.Color.Green,<br>                    material.Color.Blue,<br>                    int(material.Transparency / 100 * 255)<br>                )<br>            face_mesh = face.Triangulate()<br>            triangle_count = face_mesh.NumTriangles<br>            for idx in range(triangle_count):<br>                mesh_triangle = face_mesh.get_Triangle(idx)<br>                if face_mesh.DistributionOfNormals == \<br>                        DB.DistributionOfNormals.OnePerFace:<br>                    normal = face_mesh.GetNormal(0)<br>                elif face_mesh.DistributionOfNormals == \<br>                        DB.DistributionOfNormals.OnEachFacet:<br>                    normal = face_mesh.GetNormal(idx)<br>                elif face_mesh.DistributionOfNormals == \<br>                        DB.DistributionOfNormals.AtEachPoint:<br>                    normal = (<br>                        face_mesh.GetNormal(mesh_triangle.get_Index(0)) +<br>                        face_mesh.GetNormal(mesh_triangle.get_Index(1)) +<br>                        face_mesh.GetNormal(mesh_triangle.get_Index(2))<br>                    ).Normalize()<br>                triangles.append(<br>                    Triangle(<br>                        mesh_triangle.get_Vertex(0),<br>                        mesh_triangle.get_Vertex(1),<br>                        mesh_triangle.get_Vertex(2),<br>                        normal,<br>                        color<br>                    )<br>                )<br>        for edge in solid.Edges:<br>            pts = edge.Tessellate()<br>            for idx in range(len(pts)-1):<br>                edges.append(<br>                    Edge(<br>                        pts[idx],<br>                        pts[idx+1],<br>                        DB.ColorWithTransparency(0,0,0,0)<br>                    )<br>                )<br>        return cls(edges, triangles)<br>    except:<br>        print(traceback.format_exc())<br>``` |

##### `from_boundingbox(bounding_box, color, black_edges=True)``classmethod`

Generates a Mesh object from the input BoundigBoxXYZ.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `bounding_box` | `BoundingBoxXYZ` | The source object. | _required_ |
| `color` | `ColorWithTransparency` | The desired color. | _required_ |
| `black_edges` | `bool` | To have black edges instead of the provided color.<br>Defaults to True. | `True` |

Returns:

| Type | Description |
| --- | --- |
| `Mesh` | The resulting Mesh |

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>``` | ```md-code__content<br>@classmethod<br>def from_boundingbox(cls, bounding_box, color, black_edges = True):<br>    """Generates a Mesh object from the input BoundigBoxXYZ.<br>    Args:<br>        bounding_box (DB.BoundingBoxXYZ): The source object.<br>        color (DB.ColorWithTransparency): The desired color.<br>        black_edges (bool, optional):<br>            To have black edges instead of the provided color.<br>            Defaults to True.<br>    Returns:<br>        (Mesh): The resulting Mesh<br>    """<br>    try:<br>        # get all untransformed vertices of the boundingbox<br>        vertices = [<br>            [<br>                DB.XYZ(<br>                    bounding_box.Min.X,<br>                    bounding_box.Min.Y,<br>                    bounding_box.Min.Z<br>                ),<br>                DB.XYZ(<br>                    bounding_box.Min.X,<br>                    bounding_box.Max.Y,<br>                    bounding_box.Min.Z<br>                ),<br>                DB.XYZ(<br>                    bounding_box.Max.X,<br>                    bounding_box.Max.Y,<br>                    bounding_box.Min.Z<br>                ),<br>                DB.XYZ(<br>                    bounding_box.Max.X,<br>                    bounding_box.Min.Y,<br>                    bounding_box.Min.Z<br>                ),<br>            ],<br>            [<br>                DB.XYZ(<br>                    bounding_box.Min.X,<br>                    bounding_box.Min.Y,<br>                    bounding_box.Max.Z<br>                ),<br>                DB.XYZ(<br>                    bounding_box.Min.X,<br>                    bounding_box.Max.Y,<br>                    bounding_box.Max.Z<br>                ),<br>                DB.XYZ(<br>                    bounding_box.Max.X,<br>                    bounding_box.Max.Y,<br>                    bounding_box.Max.Z<br>                ),<br>                DB.XYZ(<br>                    bounding_box.Max.X,<br>                    bounding_box.Min.Y,<br>                    bounding_box.Max.Z<br>                )<br>            ]<br>        ]<br>        # apply it's transform if it has any<br>        vertices = [<br>            [bounding_box.Transform.OfPoint(pt) for pt in vertices[idx]]<br>            for idx in range(len(vertices))<br>        ]<br>        if black_edges:<br>            edge_color = DB.ColorWithTransparency(0,0,0,0)<br>        else:<br>            edge_color = color<br>        edges = []<br>        # creating top and bottom face triangles<br>        triangles = [<br>                Triangle(<br>                    vertices[0][0],<br>                    vertices[0][2],<br>                    vertices[0][1],<br>                    Mesh.calculate_triangle_normal(<br>                        vertices[0][0],<br>                        vertices[0][2],<br>                        vertices[0][1]<br>                    ),<br>                    color),<br>                Triangle(<br>                    vertices[0][0],<br>                    vertices[0][3],<br>                    vertices[0][2],<br>                    Mesh.calculate_triangle_normal(<br>                        vertices[0][0],<br>                        vertices[0][3],<br>                        vertices[0][2]<br>                    ),<br>                    color),<br>                Triangle(<br>                    vertices[1][0],<br>                    vertices[1][1],<br>                    vertices[1][2],<br>                    Mesh.calculate_triangle_normal(<br>                        vertices[1][0],<br>                        vertices[1][1],<br>                        vertices[1][2]<br>                    ),<br>                    color),<br>                Triangle(<br>                    vertices[1][0],<br>                    vertices[1][2],<br>                    vertices[1][3],<br>                    Mesh.calculate_triangle_normal(<br>                        vertices[1][0],<br>                        vertices[1][2],<br>                        vertices[1][3]<br>                    ),<br>                    color)<br>        ]<br>        # creating edges and face triangles for the sides<br>        for idx in range(4):<br>            edges.extend([<br>                Edge(vertices[0][idx], vertices[1][idx], edge_color),<br>                Edge(vertices[0][idx], vertices[0][idx-1], edge_color),<br>                Edge(vertices[1][idx], vertices[1][idx-1], edge_color)<br>            ])<br>            triangles.extend([<br>                Triangle(<br>                    vertices[0][idx],<br>                    vertices[1][idx],<br>                    vertices[0][idx-1],<br>                    Mesh.calculate_triangle_normal(<br>                        vertices[0][idx],<br>                        vertices[1][idx],<br>                        vertices[0][idx-1]<br>                    ),<br>                    color),<br>                Triangle(<br>                    vertices[1][idx],<br>                    vertices[1][idx-1],<br>                    vertices[0][idx-1],<br>                    Mesh.calculate_triangle_normal(<br>                        vertices[1][idx],<br>                        vertices[1][idx-1],<br>                        vertices[0][idx-1]<br>                    ),<br>                    color)<br>            ])<br>        return cls(edges, triangles)<br>    except Exception:<br>        print(traceback.format_exc())<br>``` |

### `Buffer(display_style, vertex_buffer, vertex_count, index_buffer, index_count, vertex_format, effect_instance, primitive_type, start, primitive_count)`

Bases: `object`

Buffer container for DirectContext3DServer.

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>``` | ```md-code__content<br>def __init__(self,<br>             display_style,<br>             vertex_buffer,<br>             vertex_count,<br>             index_buffer,<br>             index_count,<br>             vertex_format,<br>             effect_instance,<br>             primitive_type,<br>             start,<br>             primitive_count):<br>    self.display_style = display_style<br>    self.vertex_buffer = vertex_buffer<br>    self.vertex_count = vertex_count<br>    self.index_buffer = index_buffer<br>    self.index_count = index_count<br>    self.vertex_format = vertex_format<br>    self.effect_instance = effect_instance<br>    self.primitive_type = primitive_type<br>    self.start = start<br>    self.primitive_count = primitive_count<br>``` |

#### Attributes

##### `display_style = display_style``instance-attribute`

##### `vertex_buffer = vertex_buffer``instance-attribute`

##### `vertex_count = vertex_count``instance-attribute`

##### `index_buffer = index_buffer``instance-attribute`

##### `index_count = index_count``instance-attribute`

##### `vertex_format = vertex_format``instance-attribute`

##### `effect_instance = effect_instance``instance-attribute`

##### `primitive_type = primitive_type``instance-attribute`

##### `start = start``instance-attribute`

##### `primitive_count = primitive_count``instance-attribute`

#### Functions

##### `is_valid(display_style)`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>``` | ```md-code__content<br>def is_valid(self, display_style):<br>    return all([<br>        self.display_style == display_style,<br>        self.vertex_buffer.IsValid,<br>        self.index_buffer.IsValid,<br>        self.vertex_format.IsValid,<br>        self.effect_instance.IsValid<br>    ])<br>``` |

##### `build_edge_buffer(display_style, meshes)``classmethod`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>``` | ```md-code__content<br>@classmethod<br>def build_edge_buffer(cls, display_style, meshes):<br>    try:<br>        if not meshes:<br>            return<br>        edges = [<br>            edge for edges in [m.edges for m in meshes]<br>            for edge in edges<br>        ]<br>        format_bits = dc3d.VertexFormatBits.PositionColored<br>        vertex_format = dc3d.VertexFormat(format_bits)<br>        effect_instance = dc3d.EffectInstance(format_bits)<br>        vertex_count = (dc3d.VertexPositionColored.GetSizeInFloats()<br>                        * len(edges) * 2)<br>        vertex_buffer = dc3d.VertexBuffer(vertex_count)<br>        index_count = dc3d.IndexLine.GetSizeInShortInts() * len(edges)<br>        index_buffer = dc3d.IndexBuffer(index_count)<br>        vertex_buffer.Map(vertex_count)<br>        index_buffer.Map(index_count)<br>        vertex_stream_pos = vertex_buffer.GetVertexStreamPositionColored()<br>        index_stream_pos = index_buffer.GetIndexStreamLine()<br>        for edge in edges:<br>            edge_index = edges.index(edge)<br>            first_idx = edge_index * 2<br>            vertex_stream_pos.AddVertex(dc3d.VertexPositionColored(<br>                edge.a, edge.color<br>            ))<br>            vertex_stream_pos.AddVertex(dc3d.VertexPositionColored(<br>                edge.b, edge.color<br>            ))<br>            index_stream_pos.AddLine(dc3d.IndexLine(<br>                first_idx,<br>                first_idx + 1<br>            ))<br>        vertex_buffer.Unmap()<br>        index_buffer.Unmap()<br>        return cls(<br>            display_style,<br>            vertex_buffer,<br>            vertex_count,<br>            index_buffer,<br>            index_count,<br>            vertex_format,<br>            effect_instance,<br>            dc3d.PrimitiveType.LineList,<br>            0,<br>            len(edges)<br>        )<br>    except:<br>        print(traceback.format_exc())<br>``` |

##### `build_triangle_buffer(display_style, meshes, transparent=False)``classmethod`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>350<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>387<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>419<br>420<br>421<br>422<br>423<br>424<br>``` | ```md-code__content<br>@classmethod<br>def build_triangle_buffer(cls, display_style, meshes, transparent = False):<br>    try:<br>        if not meshes:<br>            return<br>        triangles = [<br>            triangle for triangles in [m.triangles for m in meshes]<br>            for triangle in triangles<br>            if transparent == (triangle.color.GetTransparency() > 0)<br>        ]<br>        if not triangles:<br>            return<br>        shaded = any([<br>                display_style == DB.DisplayStyle.Shading,<br>                display_style == DB.DisplayStyle.ShadingWithEdges<br>        ])<br>        format_bits = dc3d.VertexFormatBits.PositionNormalColored<br>        vertex_format = dc3d.VertexFormat(format_bits)<br>        if shaded:<br>            effect_instance = dc3d.EffectInstance(<br>                dc3d.VertexFormatBits.PositionNormalColored<br>            )<br>        else:<br>            effect_instance = dc3d.EffectInstance(<br>                dc3d.VertexFormatBits.PositionColored<br>            )<br>        vertex_count = (dc3d.VertexPositionNormalColored.GetSizeInFloats()<br>                        * len(triangles) * 3)<br>        vertex_buffer = dc3d.VertexBuffer(vertex_count)<br>        index_count = (dc3d.IndexTriangle.GetSizeInShortInts()<br>                       * len(triangles))<br>        index_buffer = dc3d.IndexBuffer(index_count)<br>        vertex_buffer.Map(vertex_count)<br>        index_buffer.Map(index_count)<br>        vertex_stream_pos = (vertex_buffer<br>                             .GetVertexStreamPositionNormalColored())<br>        index_stream_pos = index_buffer.GetIndexStreamTriangle()<br>        for triangle in triangles:<br>            if display_style == DB.DisplayStyle.HLR:<br>                color = DB.ColorWithTransparency(<br>                    255, 255, 255, triangle.color.GetTransparency()<br>                )<br>            else:<br>                color = triangle.color<br>            normal = triangle.normal<br>            triangle_index = triangles.index(triangle)<br>            first_idx = triangle_index * 3<br>            vertex_stream_pos.AddVertex(dc3d.VertexPositionNormalColored(<br>                triangle.a, normal, color<br>            ))<br>            vertex_stream_pos.AddVertex(dc3d.VertexPositionNormalColored(<br>                triangle.b, normal, color<br>            ))<br>            vertex_stream_pos.AddVertex(dc3d.VertexPositionNormalColored(<br>                triangle.c, normal, color<br>            ))<br>            index_stream_pos.AddTriangle(dc3d.IndexTriangle(<br>                first_idx,<br>                first_idx + 1,<br>                first_idx + 2<br>            ))<br>        vertex_buffer.Unmap()<br>        index_buffer.Unmap()<br>        return cls(<br>            display_style,<br>            vertex_buffer,<br>            vertex_count,<br>            index_buffer,<br>            index_count,<br>            vertex_format,<br>            effect_instance,<br>            dc3d.PrimitiveType.TriangleList,<br>            0,<br>            len(triangles)<br>        )<br>    except:<br>        print(traceback.format_exc())<br>``` |

##### `flush()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>426<br>427<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>437<br>``` | ```md-code__content<br>def flush(self):<br>    dc3d.DrawContext.FlushBuffer(<br>        self.vertex_buffer,<br>        self.vertex_count,<br>        self.index_buffer,<br>        self.index_count,<br>        self.vertex_format,<br>        self.effect_instance,<br>        self.primitive_type,<br>        self.start,<br>        self.primitive_count<br>    )<br>``` |

### `Server(guid=None, uidoc=None, name='pyRevit DirectContext3DServer', description='Displaying temporary geometries', vendor_id='pyRevit', register=True)`

Bases: `IDirectContext3DServer`

A generic DirectContext3dServer interface implementation.

Initalize a DirectContext3DServer instance.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `guid` | `Guid` | The guid of the server, auto-generated if None.<br>Defaults to None. | `None` |
| `uidoc` | `UIDocument` | Required only, if the geometry is Document specific.<br>Defaults to None. | `None` |
| `name` | `str` | The name of the server.<br>Defaults to "pyRevit DirectContext3DServer". | `'pyRevit DirectContext3DServer'` |
| `description` | `str` | The descritpion of the server.<br>Defaults to "Displaying temporary geometries". | `'Displaying temporary geometries'` |
| `vendor_id` | `str` | The name of the vendor. Defaults to "pyRevit". | `'pyRevit'` |
| `register` | `bool` | To register the server on initalization.<br>Defaults to True. | `True` |

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>456<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>``` | ```md-code__content<br>def __init__(<br>        self,<br>        guid=None,<br>        uidoc=None,<br>        name="pyRevit DirectContext3DServer",<br>        description="Displaying temporary geometries",<br>        vendor_id="pyRevit",<br>        register=True<br>):<br>    """Initalize a DirectContext3DServer instance.<br>    Args:<br>        guid (System.Guid, optional):<br>            The guid of the server, auto-generated if None.<br>            Defaults to None.<br>        uidoc (UI.UIDocument, optional):<br>            Required only, if the geometry is Document specific.<br>            Defaults to None.<br>        name (str, optional):<br>            The name of the server.<br>            Defaults to "pyRevit DirectContext3DServer".<br>        description (str, optional):<br>            The descritpion of the server.<br>            Defaults to "Displaying temporary geometries".<br>        vendor_id (str, optional):<br>            The name of the vendor. Defaults to "pyRevit".<br>        register (bool, optional):<br>            To register the server on initalization.<br>            Defaults to True.<br>    """<br>    try:<br>        if guid is None:<br>            self.guid = Guid.NewGuid()<br>        else:<br>            self.guid = guid<br>        self.uidoc = uidoc<br>        self.name = name<br>        self.description = description<br>        self.vendor_id = vendor_id<br>        self.meshes = []<br>        self._line_buffer = None<br>        self._transparent_buffer = None<br>        self._opaque_buffer = None<br>        self.enabled_view_types = [<br>            DB.ViewType.ThreeD,<br>            DB.ViewType.Elevation,<br>            DB.ViewType.Section,<br>            DB.ViewType.FloorPlan,<br>            DB.ViewType.CeilingPlan,<br>            DB.ViewType.EngineeringPlan<br>        ]<br>        if register:<br>            self.add_server()<br>    except Exception:<br>        print(traceback.format_exc())<br>``` |

#### Attributes

##### `guid = Guid.NewGuid()``instance-attribute`

##### `uidoc = uidoc``instance-attribute`

##### `name = name``instance-attribute`

##### `description = description``instance-attribute`

##### `vendor_id = vendor_id``instance-attribute`

##### `enabled_view_types = [DB.ViewType.ThreeD, DB.ViewType.Elevation, DB.ViewType.Section, DB.ViewType.FloorPlan, DB.ViewType.CeilingPlan, DB.ViewType.EngineeringPlan]``instance-attribute`

##### `meshes``property``writable`

The container for the source geometries.

#### Functions

##### `CanExecute(view)`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>501<br>502<br>503<br>504<br>505<br>506<br>``` | ```md-code__content<br>def CanExecute(self, view):<br>    if any(vt == view.ViewType for vt in self.enabled_view_types):<br>        if self.uidoc is not None:<br>            return self.uidoc.Document.Equals(view.Document)<br>        return True<br>    return False<br>``` |

##### `GetApplicationId()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>508<br>509<br>``` | ```md-code__content<br>def GetApplicationId(self):<br>    return ""<br>``` |

##### `GetBoundingBox(view)`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>511<br>512<br>513<br>514<br>515<br>516<br>517<br>518<br>519<br>520<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>``` | ```md-code__content<br>def GetBoundingBox(self, view):<br>    try:<br>        if not self.meshes:<br>            return<br>        vertices = [<br>            vertex for vertices in [m.vertices for m in self.meshes]<br>            for vertex in vertices<br>        ]<br>        if not len(vertices) > 1:<br>            return<br>        outline = DB.Outline(vertices[0], vertices[1])<br>        for idx in range(2, len(vertices)):<br>            outline.AddPoint(vertices[idx])<br>        return outline<br>    except:<br>        print(traceback.format_exc())<br>``` |

##### `GetDescription()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>533<br>534<br>``` | ```md-code__content<br>def GetDescription(self):<br>    return self.description<br>``` |

##### `GetName()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>536<br>537<br>``` | ```md-code__content<br>def GetName(self):<br>    return self.name<br>``` |

##### `GetServerId()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>539<br>540<br>``` | ```md-code__content<br>def GetServerId(self):<br>    return self.guid<br>``` |

##### `GetServiceId()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>542<br>543<br>544<br>``` | ```md-code__content<br>def GetServiceId(self):<br>    return ( es.ExternalServices<br>            .BuiltInExternalServices.DirectContext3DService)<br>``` |

##### `GetSourceId()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>546<br>547<br>``` | ```md-code__content<br>def GetSourceId(self):<br>    return ""<br>``` |

##### `GetVendorId()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>549<br>550<br>``` | ```md-code__content<br>def GetVendorId(self):<br>    return self.vendor_id<br>``` |

##### `UsesHandles()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>552<br>553<br>``` | ```md-code__content<br>def UsesHandles(self):<br>    return False<br>``` |

##### `UseInTransparentPass(view)`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>555<br>556<br>``` | ```md-code__content<br>def UseInTransparentPass(self, view):<br>    return True<br>``` |

##### `RenderScene(view, display_style)`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>558<br>559<br>560<br>561<br>562<br>563<br>564<br>565<br>566<br>567<br>568<br>569<br>570<br>571<br>572<br>573<br>574<br>575<br>576<br>577<br>578<br>579<br>580<br>581<br>582<br>583<br>584<br>585<br>586<br>587<br>588<br>``` | ```md-code__content<br>def RenderScene(self, view, display_style):<br>    try:<br>        if self.meshes:<br>            if all([<br>                self._line_buffer is None,<br>                self._opaque_buffer is None,<br>                self._transparent_buffer is None<br>            ]) or any([<br>                (self._line_buffer is not None<br>                    and not self._line_buffer.is_valid(display_style)),<br>                (self._opaque_buffer is not None<br>                    and not self._opaque_buffer.is_valid(display_style)),<br>                (self._transparent_buffer is not None<br>                    and not self._transparent_buffer.is_valid(display_style))<br>            ]):<br>                self.update_buffers(display_style)<br>            if dc3d.DrawContext.IsTransparentPass():<br>                if (self._transparent_buffer is not None<br>                        and display_style != DB.DisplayStyle.Wireframe):<br>                    self._transparent_buffer.flush()<br>            else:<br>                if (self._opaque_buffer is not None<br>                        and display_style != DB.DisplayStyle.Wireframe):<br>                    self._opaque_buffer.flush()<br>                if (self._line_buffer is not None<br>                        and display_style != DB.DisplayStyle.Rendering<br>                        and display_style != DB.DisplayStyle.Shading):<br>                    self._line_buffer.flush()<br>    except:<br>        print(traceback.format_exc())<br>``` |

##### `add_server()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>607<br>608<br>609<br>610<br>611<br>612<br>613<br>614<br>615<br>``` | ```md-code__content<br>def add_server(self):<br>    service = es.ExternalServiceRegistry.GetService(self.GetServiceId())<br>    # check for leftovers<br>    if service.IsRegisteredServerId(self.GetServerId()):<br>        self.remove_server()<br>    service.AddServer(self)<br>    server_ids = service.GetActiveServerIds()<br>    server_ids.Add(self.GetServerId())<br>    service.SetActiveServers(server_ids)<br>``` |

##### `remove_server()`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>617<br>618<br>619<br>620<br>``` | ```md-code__content<br>def remove_server(self):<br>    service = es.ExternalServiceRegistry.GetService(self.GetServiceId())<br>    if service.IsRegisteredServerId(self.GetServerId()):<br>        service.RemoveServer(self.GetServerId())<br>``` |

##### `update_buffers(display_style)`

Source code in `pyrevitlib/pyrevit/revit/dc3dserver.py`

|     |     |
| --- | --- |
| ```<br>622<br>623<br>624<br>625<br>626<br>627<br>``` | ```md-code__content<br>def update_buffers(self, display_style):<br>    self._line_buffer = Buffer.build_edge_buffer(display_style, self.meshes)<br>    self._opaque_buffer = Buffer.build_triangle_buffer(<br>        display_style, self.meshes, transparent=False)<br>    self._transparent_buffer = Buffer.build_triangle_buffer(<br>        display_style, self.meshes, transparent=True)<br>``` |

Back to top

## pyRevit Session Info
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/loader/sessioninfo/#pyrevit.loader.sessioninfo)

# sessioninfo

Manage information about pyRevit sessions.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `RuntimeInfo = namedtuple('RuntimeInfo', ['pyrevit_version', 'engine_version', 'host_version'])``module-attribute`

Session runtime information tuple.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrevit_version` | `str` | formatted pyRevit version | _required_ |
| `engine_version` | `int` | active IronPython engine version | _required_ |
| `host_version` | `str` | Current Revit version | _required_ |

## Functions

### `setup_runtime_vars()`

Setup runtime environment variables with session information.

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>``` | ```md-code__content<br>def setup_runtime_vars():<br>    """Setup runtime environment variables with session information."""<br>    # set pyrevit version<br>    pyrvt_ver = versionmgr.get_pyrevit_version().get_formatted()<br>    envvars.set_pyrevit_env_var(envvars.VERSION_ENVVAR, pyrvt_ver)<br>    # set app version env var<br>    if HOST_APP.is_newer_than(2017):<br>        envvars.set_pyrevit_env_var(envvars.APPVERSION_ENVVAR,<br>                                    HOST_APP.subversion)<br>    else:<br>        envvars.set_pyrevit_env_var(envvars.APPVERSION_ENVVAR,<br>                                    HOST_APP.version)<br>    # set ironpython engine version env var<br>    attachment = user_config.get_current_attachment()<br>    if attachment and attachment.Clone:<br>        envvars.set_pyrevit_env_var(envvars.CLONENAME_ENVVAR,<br>                                    attachment.Clone.Name)<br>        envvars.set_pyrevit_env_var(envvars.IPYVERSION_ENVVAR,<br>                                    str(attachment.Engine.Version))<br>    else:<br>        mlogger.debug('Can not determine attachment.')<br>        envvars.set_pyrevit_env_var(envvars.CLONENAME_ENVVAR, "Unknown")<br>        envvars.set_pyrevit_env_var(envvars.IPYVERSION_ENVVAR, "0")<br>    # set cpython engine version env var<br>    cpyengine = user_config.get_active_cpython_engine()<br>    if cpyengine:<br>        envvars.set_pyrevit_env_var(envvars.CPYVERSION_ENVVAR,<br>                                    str(cpyengine.Version))<br>    else:<br>        envvars.set_pyrevit_env_var(envvars.CPYVERSION_ENVVAR, "0")<br>    # set a list of important assemblies<br>    # this is required for dotnet script execution<br>    set_loaded_pyrevit_referenced_modules(<br>        runtime.get_references()<br>        )<br>``` |

### `get_runtime_info()`

Return runtime information tuple.

Returns:

| Type | Description |
| --- | --- |
| `RuntimeInfo` | runtime info tuple |

Examples:

```md-code__content
sessioninfo.get_runtime_info()

```

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>``` | ````md-code__content<br>def get_runtime_info():<br>    """Return runtime information tuple.<br>    Returns:<br>        (RuntimeInfo): runtime info tuple<br>    Examples:<br>        ```python<br>        sessioninfo.get_runtime_info()<br>        ```<br>    """<br>    # FIXME: add example output<br>    return RuntimeInfo(<br>        pyrevit_version=envvars.get_pyrevit_env_var(envvars.VERSION_ENVVAR),<br>        engine_version=envvars.get_pyrevit_env_var(envvars.IPYVERSION_ENVVAR),<br>        host_version=envvars.get_pyrevit_env_var(envvars.APPVERSION_ENVVAR)<br>        )<br>```` |

### `set_session_uuid(uuid_str)`

Set session uuid on environment variable.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `uuid_str` | `str` | session uuid string | _required_ |

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>``` | ```md-code__content<br>def set_session_uuid(uuid_str):<br>    """Set session uuid on environment variable.<br>    Args:<br>        uuid_str (str): session uuid string<br>    """<br>    envvars.set_pyrevit_env_var(envvars.SESSIONUUID_ENVVAR, uuid_str)<br>``` |

### `get_session_uuid()`

Read session uuid from environment variable.

Returns:

| Type | Description |
| --- | --- |
| `str` | session uuid string |

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>``` | ```md-code__content<br>def get_session_uuid():<br>    """Read session uuid from environment variable.<br>    Returns:<br>        (str): session uuid string<br>    """<br>    return envvars.get_pyrevit_env_var(envvars.SESSIONUUID_ENVVAR)<br>``` |

### `new_session_uuid()`

Create a new uuid for a pyRevit session.

Returns:

| Type | Description |
| --- | --- |
| `str` | session uuid string |

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>``` | ```md-code__content<br>def new_session_uuid():<br>    """Create a new uuid for a pyRevit session.<br>    Returns:<br>        (str): session uuid string<br>    """<br>    uuid_str = safe_strtype(coreutils.new_uuid())<br>    set_session_uuid(uuid_str)<br>    return uuid_str<br>``` |

### `get_loaded_pyrevit_assemblies()`

Return list of loaded pyRevit assemblies from environment variable.

Returns:

| Type | Description |
| --- | --- |
| `list[str]` | list of loaded assemblies |

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>``` | ```md-code__content<br>def get_loaded_pyrevit_assemblies():<br>    """Return list of loaded pyRevit assemblies from environment variable.<br>    Returns:<br>        (list[str]): list of loaded assemblies<br>    """<br>    # FIXME: verify and document return type<br>    loaded_assms_str = envvars.get_pyrevit_env_var(envvars.LOADEDASSMS_ENVVAR)<br>    if loaded_assms_str:<br>        return loaded_assms_str.split(coreutils.DEFAULT_SEPARATOR)<br>    else:<br>        return []<br>``` |

### `set_loaded_pyrevit_assemblies(loaded_assm_name_list)`

Set the environment variable with list of loaded assemblies.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `loaded_assm_name_list` | `list[str]` | list of assembly names | _required_ |

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>``` | ```md-code__content<br>def set_loaded_pyrevit_assemblies(loaded_assm_name_list):<br>    """Set the environment variable with list of loaded assemblies.<br>    Args:<br>        loaded_assm_name_list (list[str]): list of assembly names<br>    """<br>    envvars.set_pyrevit_env_var(<br>        envvars.LOADEDASSMS_ENVVAR,<br>        coreutils.DEFAULT_SEPARATOR.join(loaded_assm_name_list)<br>        )<br>``` |

### `get_loaded_pyrevit_referenced_modules()`

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>149<br>150<br>151<br>152<br>153<br>154<br>``` | ```md-code__content<br>def get_loaded_pyrevit_referenced_modules():<br>    loaded_assms_str = envvars.get_pyrevit_env_var(envvars.REFEDASSMS_ENVVAR)<br>    if loaded_assms_str:<br>        return set(loaded_assms_str.split(coreutils.DEFAULT_SEPARATOR))<br>    else:<br>        return set()<br>``` |

### `set_loaded_pyrevit_referenced_modules(loaded_assm_name_list)`

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>157<br>158<br>159<br>160<br>161<br>``` | ```md-code__content<br>def set_loaded_pyrevit_referenced_modules(loaded_assm_name_list):<br>    envvars.set_pyrevit_env_var(<br>        envvars.REFEDASSMS_ENVVAR,<br>        coreutils.DEFAULT_SEPARATOR.join(loaded_assm_name_list)<br>        )<br>``` |

### `update_loaded_pyrevit_referenced_modules(loaded_assm_name_list)`

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>164<br>165<br>166<br>167<br>``` | ```md-code__content<br>def update_loaded_pyrevit_referenced_modules(loaded_assm_name_list):<br>    loaded_modules = get_loaded_pyrevit_referenced_modules()<br>    loaded_modules.update(loaded_assm_name_list)<br>    set_loaded_pyrevit_referenced_modules(loaded_modules)<br>``` |

### `report_env()`

Report python version, home directory, config file, etc.

Source code in `pyrevitlib/pyrevit/loader/sessioninfo.py`

|     |     |
| --- | --- |
| ```<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>``` | ```md-code__content<br>def report_env():<br>    """Report python version, home directory, config file, etc."""<br>    # run diagnostics<br>    system_diag()<br>    # get python version that includes last commit hash<br>    mlogger.info('pyRevit version: %s - </> with :growing_heart: in %s',<br>                 envvars.get_pyrevit_env_var(envvars.VERSION_ENVVAR),<br>                 about.get_pyrevit_about().madein)<br>    if user_config.rocket_mode:<br>        mlogger.info('pyRevit Rocket Mode enabled. :rocket:')<br>    mlogger.info('Host is %s pid: %s', HOST_APP.pretty_name, HOST_APP.proc_id)<br>    # ipy 2.7.10 has a new line in its sys.version :rolling-eyes-emoji:<br>    mlogger.info('Running on: %s', sys.version.replace('\n', ' '))<br>    mlogger.info('User is: %s', HOST_APP.username)<br>    mlogger.info('Home Directory is: %s', HOME_DIR)<br>    mlogger.info('Session uuid is: %s', get_session_uuid())<br>    mlogger.info('Runtime assembly is: %s', runtime.RUNTIME_ASSM_NAME)<br>    mlogger.info('Config file is (%s): %s',<br>                 user_config.config_type, user_config.config_file)<br>``` |

Back to top

## Revit Server Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/serverutils/#pyrevit.revit.serverutils)

# serverutils

Helper functions for working with revit server.

## Attributes

### `MODEL_HISTORY_SQLDB = '/Data/Model.db3'``module-attribute`

### `SyncHistory = namedtuple('SyncHistory', ['index', 'userid', 'timestamp'])``module-attribute`

namedtuple for model sync history data in revit server

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `index` | `int` | row index in history db |
| `userid` | `str` | user identifier |
| `timestamp` | `str` | time stamp string (e.g. "2017-12-13 19:56:20") |

## Functions

### `get_server_path(doc, path_dict)`

Return file path of a model hosted on revit server.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | revit document object | _required_ |
| `path_dict` | `dict` | dict of RSN paths and their directory paths | _required_ |

Examples:

```md-code__content
rsn_paths = {'RSN://SERVERNAME': '//servername/filestore'}
get_server_path(doc, rsn_paths)

```

"//servername/filestore/path/to/model.rvt"

Source code in `pyrevitlib/pyrevit/revit/serverutils.py`

|     |     |
| --- | --- |
| ```<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>``` | ````md-code__content<br>def get_server_path(doc, path_dict):<br>    """Return file path of a model hosted on revit server.<br>    Args:<br>        doc (Document): revit document object<br>        path_dict (dict): dict of RSN paths and their directory paths<br>    Examples:<br>        ```python<br>        rsn_paths = {'RSN://SERVERNAME': '//servername/filestore'}<br>        get_server_path(doc, rsn_paths)<br>        ```<br>        "//servername/filestore/path/to/model.rvt"<br>    """<br>    model_path = doc.GetWorksharingCentralModelPath()<br>    path = DB.ModelPathUtils.ConvertModelPathToUserVisiblePath(model_path)<br>    for key, value in path_dict.items():<br>        path = path.replace(key, value)<br>    return path<br>```` |

### `get_model_sync_history(server_path)`

Read model sync history from revit server sqlite history file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `server_path` | `str` | directory path of revit server filestore | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[SyncHistory]` | list of SyncHistory instances |

Examples:

```md-code__content
get_model_sync_history("//servername/path/to/model.rvt")

```

\[SyncHistory(index=498, userid="user",\
timestamp="2017-12-13 19:56:20")\]

Source code in `pyrevitlib/pyrevit/revit/serverutils.py`

|     |     |
| --- | --- |
| ```<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>``` | ````md-code__content<br>def get_model_sync_history(server_path):<br>    """Read model sync history from revit server sqlite history file.<br>    Args:<br>        server_path (str): directory path of revit server filestore<br>    Returns:<br>        (list[SyncHistory]): list of SyncHistory instances<br>    Examples:<br>        ```python<br>        get_model_sync_history("//servername/path/to/model.rvt")<br>        ```<br>        [SyncHistory(index=498, userid="user",<br>                    timestamp="2017-12-13 19:56:20")]<br>    """<br>    db_path = server_path + MODEL_HISTORY_SQLDB<br>    conn = sqlite3.connect(db_path)<br>    sync_hist = []<br>    for row in conn.execute("SELECT * FROM ModelHistory"):<br>        sync_hist.append(SyncHistory(index=int(row[0]),<br>                                     userid=row[1],<br>                                     timestamp=row[2][:-1]))<br>    return sync_hist<br>```` |

Back to top

## Python Helper Functions
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/pyutils/#pyrevit.coreutils.pyutils)

# pyutils

Helper functions for python.

Examples:

```md-code__content
from pyrevit.coreutils import pyutils
pyutils.safe_cast('string', int, 0)

```

## Attributes

## Classes

### `DefaultOrderedDict(default_factory=None, *a, **kw)`

Bases: `OrderedDict`

Ordered dictionary with default type.

This is similar to defaultdict and maintains the order of items added
to it so in that regards it functions similar to OrderedDict.

Examples:

```md-code__content
from pyrevit.coreutils import pyutils
od = pyutils.DefaultOrderedDict(list)
od['A'] = [1, 2, 3]
od['B'] = [4, 5, 6]
od['C'].extend([7, 8, 9])
for k, v in od.items():
    print(k, v)

```

('A', \[1, 2, 3\])
('B', \[4, 5, 6\])
('C', \[7, 8, 9\])

Source code in `pyrevitlib/pyrevit/coreutils/pyutils.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>``` | ```md-code__content<br>def __init__(self, default_factory=None, *a, **kw): #pylint: disable=W1113<br>    if (default_factory is not None \<br>            and not isinstance(default_factory, Callable)):<br>        raise TypeError('first argument must be callable')<br>    OrderedDict.__init__(self, *a, **kw)<br>    self.default_factory = default_factory<br>``` |

#### Attributes

##### `default_factory = default_factory``instance-attribute`

#### Functions

##### `copy()`

Copy the dictionary.

Source code in `pyrevitlib/pyrevit/coreutils/pyutils.py`

|     |     |
| --- | --- |
| ```<br>69<br>70<br>71<br>``` | ```md-code__content<br>def copy(self):<br>    """Copy the dictionary."""<br>    return self.__copy__()<br>``` |

## Functions

### `pairwise(iterable, step=2)`

Iterate through items in pairs.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `iterable` | `iterable` | any iterable object | _required_ |
| `step` | `int` | number of steps to move when making pairs | `2` |

Returns:

| Type | Description |
| --- | --- |
| `Iterable[Any]` | list of pairs |

Examples:

```md-code__content
pairwise([1, 2, 3, 4, 5])

```

\[(1, 2), (3, 4)\] # 5 can not be paired

```md-code__content
pairwise([1, 2, 3, 4, 5, 6])

```

\[(1, 2), (3, 4), (5, 6)\]

```md-code__content
pairwise([1, 2, 3, 4, 5, 6], step=1)

```

\[(1, 2), (2, 3), (3, 4), (4, 5), (5, 6)\]

Source code in `pyrevitlib/pyrevit/coreutils/pyutils.py`

|     |     |
| --- | --- |
| ```<br> 85<br> 86<br> 87<br> 88<br> 89<br> 90<br> 91<br> 92<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>``` | ````md-code__content<br>def pairwise(iterable, step=2):<br>    """Iterate through items in pairs.<br>    Args:<br>        iterable (iterable): any iterable object<br>        step (int): number of steps to move when making pairs<br>    Returns:<br>        (Iterable[Any]): list of pairs<br>    Examples:<br>        ```python<br>        pairwise([1, 2, 3, 4, 5])<br>        ```<br>        [(1, 2), (3, 4)]    # 5 can not be paired<br>        ```python<br>        pairwise([1, 2, 3, 4, 5, 6])<br>        ```<br>        [(1, 2), (3, 4), (5, 6)]<br>        ```python<br>        pairwise([1, 2, 3, 4, 5, 6], step=1)<br>        ```<br>        [(1, 2), (2, 3), (3, 4), (4, 5), (5, 6)]<br>    """<br>    if step == 1:<br>        a, b = tee(iterable)<br>        next(b, None)<br>        return zip(a, b)<br>    elif step == 2:<br>        a = iter(iterable)<br>        return zip(a, a)<br>```` |

### `safe_cast(val, to_type, default=None)`

Convert value to type gracefully.

This method basically calls to\_type(value) and returns the default
if exception occurs.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `val` | `any` | value to be converted | _required_ |
| `to_type` | `type` | target type | _required_ |
| `default` | `any` | value to rerun on conversion exception | `None` |

Examples:

```md-code__content
safe_cast('name', int, default=0)

```

0

Source code in `pyrevitlib/pyrevit/coreutils/pyutils.py`

|     |     |
| --- | --- |
| ```<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>``` | ````md-code__content<br>def safe_cast(val, to_type, default=None):<br>    """Convert value to type gracefully.<br>    This method basically calls to_type(value) and returns the default<br>    if exception occurs.<br>    Args:<br>        val (any): value to be converted<br>        to_type (type): target type<br>        default (any): value to rerun on conversion exception<br>    Examples:<br>        ```python<br>        safe_cast('name', int, default=0)<br>        ```<br>        0<br>    """<br>    try:<br>        return to_type(val)<br>    except (ValueError, TypeError):<br>        return default<br>```` |

### `isnumber(token)`

Verify if given string token is int or float.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `token` | `str` | string value | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True of token is int or float |

Examples:

```md-code__content
isnumber('12.3')

```

True

Source code in `pyrevitlib/pyrevit/coreutils/pyutils.py`

|     |     |
| --- | --- |
| ```<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>``` | ````md-code__content<br>def isnumber(token):<br>    """Verify if given string token is int or float.<br>    Args:<br>        token (str): string value<br>    Returns:<br>        (bool): True of token is int or float<br>    Examples:<br>        ```python<br>        isnumber('12.3')<br>        ```<br>        True<br>    """<br>    if token:<br>        return re.match("^-*[0-9.]+?$", token) is not None<br>    else:<br>        return False<br>```` |

### `compare_lists(x, y)`

Compare two lists.

See: https://stackoverflow.com/a/10872313/2350244

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `x` | `list` | first list | _required_ |
| `y` | `list` | second list | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/pyutils.py`

|     |     |
| --- | --- |
| ```<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>``` | ```md-code__content<br>def compare_lists(x, y):<br>    """Compare two lists.<br>    See: https://stackoverflow.com/a/10872313/2350244<br>    Args:<br>        x (list): first list<br>        y (list): second list<br>    """<br>    return len(frozenset(x).difference(y)) == 0<br>``` |

### `merge(d1, d2)`

Merge d2 into d1.

d2 dict values are recursively merged into d1 dict values
other d2 values are added to d1 dict values with the same key
new d2 values are added to d1
d2 values override other d1 values

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `d1` | `dict` | dict to be updated | _required_ |
| `d2` | `dict` | dict to be merge into d1 | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `dict[Any, Any]` | updated d1 |

Examples:

```md-code__content
d1 = {1: 1, 2: "B"    , 3: {1:"A", 2:"B"}, 4: "b"  , 5: ["a", "b"]}
d2 = {1: 1, 2: {1:"A"}, 3: {1:"S", 3:"C"}, 4: ["a"], 5: ["c"]}
merge(d1, d2)

```

{ 1:1,
2:{1:'A', 2:'B'},
3:{1:'S', 2:'B', 3:'C'},
4:\['a','b'\],
5: \['c', 'a', 'b'\]
}

Source code in `pyrevitlib/pyrevit/coreutils/pyutils.py`

|     |     |
| --- | --- |
| ```<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>219<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>``` | ````md-code__content<br>def merge(d1, d2):<br>    """Merge d2 into d1.<br>    d2 dict values are recursively merged into d1 dict values<br>    other d2 values are added to d1 dict values with the same key<br>    new d2 values are added to d1<br>    d2 values override other d1 values<br>    Args:<br>        d1 (dict): dict to be updated<br>        d2 (dict): dict to be merge into d1<br>    Returns:<br>        (dict[Any, Any]): updated d1<br>    Examples:<br>        ```python<br>        d1 = {1: 1, 2: "B"    , 3: {1:"A", 2:"B"}, 4: "b"  , 5: ["a", "b"]}<br>        d2 = {1: 1, 2: {1:"A"}, 3: {1:"S", 3:"C"}, 4: ["a"], 5: ["c"]}<br>        merge(d1, d2)<br>        ```<br>        { 1:1,<br>          2:{1:'A', 2:'B'},<br>          3:{1:'S', 2:'B', 3:'C'},<br>          4:['a','b'],<br>          5: ['c', 'a', 'b']<br>        }<br>    """<br>    if not (isinstance(d1, dict) and isinstance(d2, dict)):<br>        raise Exception('Both inputs must be of type dict')<br>    for key, new_value in d2.items():<br>        if key in d1:<br>            old_value = d1[key]<br>            if isinstance(new_value, dict):<br>                if isinstance(old_value, dict):<br>                    merge(old_value, new_value)<br>                else:<br>                    new_dict = copy.deepcopy(new_value)<br>                    new_dict[key] = old_value<br>                    d1[key] = new_dict<br>            elif isinstance(old_value, dict):<br>                old_value[key] = new_value<br>            elif isinstance(new_value, list):<br>                new_list = copy.deepcopy(new_value)<br>                if isinstance(old_value, list):<br>                    new_list.extend(old_value)<br>                else:<br>                    if old_value not in new_value:<br>                        new_list.append(old_value)<br>                d1[key] = new_list<br>            elif isinstance(old_value, list):<br>                if new_value not in old_value:<br>                    old_value.append(new_value)<br>            else:<br>                d1[key] = new_value<br>        else:<br>            d1[key] = new_value<br>    return d1<br>```` |

### `almost_equal(a, b, rnd=5)`

Check if two numerical values almost equal.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `a` | `float` | value a | _required_ |
| `b` | `float` | value b | _required_ |
| `rnd` | `int` | n digits after comma. Defaults to 5. | `5` |

Returns:

| Type | Description |
| --- | --- |
| `bool` | True if almost equal |

Source code in `pyrevitlib/pyrevit/coreutils/pyutils.py`

|     |     |
| --- | --- |
| ```<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>``` | ```md-code__content<br>def almost_equal(a, b, rnd=5):<br>    """Check if two numerical values almost equal.<br>    Args:<br>        a (float): value a<br>        b (float): value b<br>        rnd (int, optional): n digits after comma. Defaults to 5.<br>    Returns:<br>        (bool): True if almost equal<br>    """<br>    return a == b or int(a*10**rnd) == int(b*10**rnd)<br>``` |

Back to top

## Revit Ribbon Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/ribbon/#pyrevit.coreutils.ribbon)

# ribbon

Base module to interact with Revit ribbon.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `PYREVIT_TAB_IDENTIFIER = 'pyrevit_tab'``module-attribute`

### `ICON_SMALL = 16``module-attribute`

### `ICON_MEDIUM = 24``module-attribute`

### `ICON_LARGE = 32``module-attribute`

### `DEFAULT_DPI = 96``module-attribute`

### `DEFAULT_TOOLTIP_IMAGE_FORMAT = '.png'``module-attribute`

### `DEFAULT_TOOLTIP_VIDEO_FORMAT = '.swf'``module-attribute`

## Classes

### `PyRevitUIError`

Bases: `PyRevitException`

Common base class for all pyRevit ui-related exceptions.

#### Attributes

##### `msg``property`

Return exception message.

### `ButtonIcons(image_file)`

Bases: `object`

pyRevit ui element icon.

Upon init, this type reads the given image file into an io stream and
releases the os lock on the file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `image_file` | `str` | image file path to be used as icon | _required_ |

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `icon_file_path` | `str` | icon image file path |
| `filestream` | `FileStream` | io stream containing image binary data |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>``` | ```md-code__content<br>def __init__(self, image_file):<br>    self.icon_file_path = image_file<br>    self.check_icon_size()<br>    self.filestream = IO.FileStream(image_file,<br>                                    IO.FileMode.Open,<br>                                    IO.FileAccess.Read)<br>``` |

#### Attributes

##### `icon_file_path = image_file``instance-attribute`

##### `filestream = IO.FileStream(image_file, IO.FileMode.Open, IO.FileAccess.Read)``instance-attribute`

##### `small_bitmap``property`

Resamples image and creates bitmap for size :obj: `ICON_SMALL`.

Returns:

| Type | Description |
| --- | --- |
| `BitmapSource` | object containing image data at given size |

##### `medium_bitmap``property`

Resamples image and creates bitmap for size :obj: `ICON_MEDIUM`.

Returns:

| Type | Description |
| --- | --- |
| `BitmapSource` | object containing image data at given size |

##### `large_bitmap``property`

Resamples image and creates bitmap for size :obj: `ICON_LARGE`.

Returns:

| Type | Description |
| --- | --- |
| `BitmapSource` | object containing image data at given size |

#### Functions

##### `recolour(image_data, size, stride, color)``staticmethod`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>``` | ```md-code__content<br>@staticmethod<br>def recolour(image_data, size, stride, color):<br>    # FIXME: needs doc, and argument types<br>    # ButtonIcons.recolour(image_data, image_size, stride, 0x8e44ad)<br>    step = stride / size<br>    for i in range(0, stride, step):<br>        for j in range(0, stride, step):<br>            idx = (i * size) + j<br>            # R = image_data[idx+2]<br>            # G = image_data[idx+1]<br>            # B = image_data[idx]<br>            # luminance = (0.299*R + 0.587*G + 0.114*B)<br>            image_data[idx] = color >> 0 & 0xff       # blue<br>            image_data[idx+1] = color >> 8 & 0xff     # green<br>            image_data[idx+2] = color >> 16 & 0xff    # red<br>``` |

##### `check_icon_size()`

Verify icon size is within acceptable range.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>``` | ```md-code__content<br>def check_icon_size(self):<br>    """Verify icon size is within acceptable range."""<br>    image = System.Drawing.Image.FromFile(self.icon_file_path)<br>    image_size = max(image.Width, image.Height)<br>    if image_size > 96:<br>        mlogger.warning('Icon file is too large. Large icons adversely '<br>                        'affect the load time since they need to be '<br>                        'processed and adjusted for screen scaling. '<br>                        'Keep icons at max 96x96 pixels: %s',<br>                        self.icon_file_path)<br>``` |

##### `create_bitmap(icon_size)`

Resamples image and creates bitmap for the given size.

Icons are assumed to be square.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `icon_size` | `int` | icon size (width or height) | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `BitmapSource` | object containing image data at given size |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>``` | ```md-code__content<br>def create_bitmap(self, icon_size):<br>    """Resamples image and creates bitmap for the given size.<br>    Icons are assumed to be square.<br>    Args:<br>        icon_size (int): icon size (width or height)<br>    Returns:<br>        (Imaging.BitmapSource): object containing image data at given size<br>    """<br>    mlogger.debug('Creating %sx%s bitmap from: %s',<br>                  icon_size, icon_size, self.icon_file_path)<br>    adjusted_icon_size = icon_size * 2<br>    adjusted_dpi = DEFAULT_DPI * 2<br>    screen_scaling = HOST_APP.proc_screen_scalefactor<br>    self.filestream.Seek(0, IO.SeekOrigin.Begin)<br>    base_image = Imaging.BitmapImage()<br>    base_image.BeginInit()<br>    base_image.StreamSource = self.filestream<br>    base_image.DecodePixelHeight = int(adjusted_icon_size * screen_scaling)<br>    base_image.EndInit()<br>    self.filestream.Seek(0, IO.SeekOrigin.Begin)<br>    image_size = base_image.PixelWidth<br>    image_format = base_image.Format<br>    image_byte_per_pixel = int(base_image.Format.BitsPerPixel / 8)<br>    palette = base_image.Palette<br>    stride = int(image_size * image_byte_per_pixel)<br>    array_size = stride * image_size<br>    image_data = System.Array.CreateInstance(System.Byte, array_size)<br>    base_image.CopyPixels(image_data, stride, 0)<br>    scaled_size = int(adjusted_icon_size * screen_scaling)<br>    scaled_dpi = int(adjusted_dpi * screen_scaling)<br>    bitmap_source = \<br>        Imaging.BitmapSource.Create(scaled_size, scaled_size,<br>                                    scaled_dpi, scaled_dpi,<br>                                    image_format,<br>                                    palette,<br>                                    image_data,<br>                                    stride)<br>    return bitmap_source<br>``` |

### `GenericPyRevitUIContainer()`

Bases: `object`

Common type for all pyRevit ui containers.

Attributes:

| Name | Type | Description |
| --- | --- | --- |
| `name` | `str` | container name |
| `itemdata_mode` | `bool` | if container is wrapping UI.\*ItemData |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>218<br>``` | ```md-code__content<br>def __init__(self):<br>    self.name = ''<br>    self._rvtapi_object = None<br>    self._sub_pyrvt_components = OrderedDict()<br>    self.itemdata_mode = False<br>    self._dirty = False<br>    self._visible = None<br>    self._enabled = None<br>``` |

#### Attributes

##### `name = ''``instance-attribute`

##### `itemdata_mode = False``instance-attribute`

##### `visible``property``writable`

Is container visible.

##### `enabled``property``writable`

Is container enabled.

#### Functions

##### `process_deferred()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>``` | ```md-code__content<br>def process_deferred(self):<br>    try:<br>        if self._visible is not None:<br>            self.visible = self._visible<br>    except Exception as visible_err:<br>        raise PyRevitUIError('Error setting .visible {} | {} '<br>                             .format(self, visible_err))<br>    try:<br>        if self._enabled is not None:<br>            self.enabled = self._enabled<br>    except Exception as enable_err:<br>        raise PyRevitUIError('Error setting .enabled {} | {} '<br>                             .format(self, enable_err))<br>``` |

##### `get_rvtapi_object()`

Return underlying Revit API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>def get_rvtapi_object(self):<br>    """Return underlying Revit API object for this container."""<br>    # FIXME: return type<br>    return self._rvtapi_object<br>``` |

##### `set_rvtapi_object(rvtapi_obj)`

Set underlying Revit API object for this container.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvtapi_obj` | `obj` | Revit API container object | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>``` | ```md-code__content<br>def set_rvtapi_object(self, rvtapi_obj):<br>    """Set underlying Revit API object for this container.<br>    Args:<br>        rvtapi_obj (obj): Revit API container object<br>    """<br>    # FIXME: rvtapi_obj type<br>    self._rvtapi_object = rvtapi_obj<br>    self.itemdata_mode = False<br>    self._dirty = True<br>``` |

##### `get_adwindows_object()`

Return underlying AdWindows API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>``` | ```md-code__content<br>def get_adwindows_object(self):<br>    """Return underlying AdWindows API object for this container."""<br>    # FIXME: return type<br>    rvtapi_obj = self._rvtapi_object<br>    getRibbonItemMethod = \<br>        rvtapi_obj.GetType().GetMethod(<br>            'getRibbonItem',<br>            BindingFlags.NonPublic | BindingFlags.Instance<br>            )<br>    if getRibbonItemMethod:<br>        return getRibbonItemMethod.Invoke(rvtapi_obj, None)<br>``` |

##### `get_flagged_children(state=True)`

Get all children with their flag equal to given state.

Flagging is a mechanism to mark certain containers. There are various
reasons that container flagging might be used e.g. marking updated
containers or the ones in need of an update or removal.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | flag state to filter children | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[*]` | list of filtered child objects |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>``` | ```md-code__content<br>def get_flagged_children(self, state=True):<br>    """Get all children with their flag equal to given state.<br>    Flagging is a mechanism to mark certain containers. There are various<br>    reasons that container flagging might be used e.g. marking updated<br>    containers or the ones in need of an update or removal.<br>    Args:<br>        state (bool): flag state to filter children<br>    Returns:<br>        (list[*]): list of filtered child objects<br>    """<br>    # FIXME: return type<br>    flagged_cmps = []<br>    for component in self:<br>        flagged_cmps.extend(component.get_flagged_children(state))<br>        if component.is_dirty() == state:<br>            flagged_cmps.append(component)<br>    return flagged_cmps<br>``` |

##### `keys()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>346<br>347<br>348<br>``` | ```md-code__content<br>def keys(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.keys())<br>``` |

##### `values()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>350<br>351<br>352<br>``` | ```md-code__content<br>def values(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.values())<br>``` |

##### `is_native()``staticmethod`

Is this container generated by pyRevit or is native.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>354<br>355<br>356<br>357<br>``` | ```md-code__content<br>@staticmethod<br>def is_native():<br>    """Is this container generated by pyRevit or is native."""<br>    return False<br>``` |

##### `is_dirty()`

Is dirty flag set.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>``` | ```md-code__content<br>def is_dirty(self):<br>    """Is dirty flag set."""<br>    if self._dirty:<br>        return self._dirty<br>    else:<br>        # check if there is any dirty child<br>        for component in self:<br>            if component.is_dirty():<br>                return True<br>        return False<br>``` |

##### `set_dirty_flag(state=True)`

Set dirty flag to given state.

See .get\_flagged\_children()

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | state to set flag | `True` |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>``` | ```md-code__content<br>def set_dirty_flag(self, state=True):<br>    """Set dirty flag to given state.<br>    See .get_flagged_children()<br>    Args:<br>        state (bool): state to set flag<br>    """<br>    self._dirty = state<br>``` |

##### `contains(pyrvt_cmp_name)`

Check if container contains a component with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrvt_cmp_name` | `str` | target component name | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>``` | ```md-code__content<br>def contains(self, pyrvt_cmp_name):<br>    """Check if container contains a component with given name.<br>    Args:<br>        pyrvt_cmp_name (str): target component name<br>    """<br>    return pyrvt_cmp_name in self._sub_pyrvt_components.keys()<br>``` |

##### `find_child(child_name)`

Find a component with given name in children.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `child_name` | `str` | target component name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Any` | component object if found, otherwise None |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>``` | ```md-code__content<br>def find_child(self, child_name):<br>    """Find a component with given name in children.<br>    Args:<br>        child_name (str): target component name<br>    Returns:<br>        (Any): component object if found, otherwise None<br>    """<br>    for sub_cmp in self._sub_pyrvt_components.values():<br>        if child_name == sub_cmp.name:<br>            return sub_cmp<br>        elif hasattr(sub_cmp, 'ui_title') \<br>                and child_name == sub_cmp.ui_title:<br>            return sub_cmp<br>        component = sub_cmp.find_child(child_name)<br>        if component:<br>            return component<br>    return None<br>``` |

##### `activate()`

Activate this container in ui.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>``` | ```md-code__content<br>def activate(self):<br>    """Activate this container in ui."""<br>    try:<br>        self.enabled = True<br>        self.visible = True<br>        self._dirty = True<br>    except Exception:<br>        raise PyRevitUIError('Can not activate: {}'.format(self))<br>``` |

##### `deactivate()`

Deactivate this container in ui.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>``` | ```md-code__content<br>def deactivate(self):<br>    """Deactivate this container in ui."""<br>    try:<br>        self.enabled = False<br>        self.visible = False<br>        self._dirty = True<br>    except Exception:<br>        raise PyRevitUIError('Can not deactivate: {}'.format(self))<br>``` |

##### `get_updated_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>``` | ```md-code__content<br>def get_updated_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children()<br>``` |

##### `get_unchanged_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>432<br>433<br>434<br>``` | ```md-code__content<br>def get_unchanged_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children(state=False)<br>``` |

##### `reorder_before(item_name, ritem_name)`

Reorder and place item\_name before ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the right | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>``` | ```md-code__content<br>def reorder_before(self, item_name, ritem_name):<br>    """Reorder and place item_name before ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the right<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx - 1)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>``` |

##### `reorder_beforeall(item_name)`

Reorder and place item\_name before all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>``` | ```md-code__content<br>def reorder_beforeall(self, item_name):<br>    """Reorder and place item_name before all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    # FIXME: verify docs description is correct<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            apiobj.Panels.Move(litem_idx, 0)<br>``` |

##### `reorder_after(item_name, ritem_name)`

Reorder and place item\_name after ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the left | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>``` | ```md-code__content<br>def reorder_after(self, item_name, ritem_name):<br>    """Reorder and place item_name after ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the left<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx + 1)<br>``` |

##### `reorder_afterall(item_name)`

Reorder and place item\_name after all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>``` | ```md-code__content<br>def reorder_afterall(self, item_name):<br>    """Reorder and place item_name after all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            max_idx = len(apiobj.Panels) - 1<br>            apiobj.Panels.Move(litem_idx, max_idx)<br>``` |

### `GenericRevitNativeUIContainer()`

Bases: `GenericPyRevitUIContainer`

Common base type for native Revit API UI containers.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>515<br>516<br>``` | ```md-code__content<br>def __init__(self):<br>    GenericPyRevitUIContainer.__init__(self)<br>``` |

#### Attributes

##### `name = ''``instance-attribute`

##### `itemdata_mode = False``instance-attribute`

##### `visible``property``writable`

Is container visible.

##### `enabled``property``writable`

Is container enabled.

#### Functions

##### `process_deferred()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>``` | ```md-code__content<br>def process_deferred(self):<br>    try:<br>        if self._visible is not None:<br>            self.visible = self._visible<br>    except Exception as visible_err:<br>        raise PyRevitUIError('Error setting .visible {} | {} '<br>                             .format(self, visible_err))<br>    try:<br>        if self._enabled is not None:<br>            self.enabled = self._enabled<br>    except Exception as enable_err:<br>        raise PyRevitUIError('Error setting .enabled {} | {} '<br>                             .format(self, enable_err))<br>``` |

##### `get_rvtapi_object()`

Return underlying Revit API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>def get_rvtapi_object(self):<br>    """Return underlying Revit API object for this container."""<br>    # FIXME: return type<br>    return self._rvtapi_object<br>``` |

##### `set_rvtapi_object(rvtapi_obj)`

Set underlying Revit API object for this container.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvtapi_obj` | `obj` | Revit API container object | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>``` | ```md-code__content<br>def set_rvtapi_object(self, rvtapi_obj):<br>    """Set underlying Revit API object for this container.<br>    Args:<br>        rvtapi_obj (obj): Revit API container object<br>    """<br>    # FIXME: rvtapi_obj type<br>    self._rvtapi_object = rvtapi_obj<br>    self.itemdata_mode = False<br>    self._dirty = True<br>``` |

##### `get_adwindows_object()`

Return underlying AdWindows API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>``` | ```md-code__content<br>def get_adwindows_object(self):<br>    """Return underlying AdWindows API object for this container."""<br>    # FIXME: return type<br>    rvtapi_obj = self._rvtapi_object<br>    getRibbonItemMethod = \<br>        rvtapi_obj.GetType().GetMethod(<br>            'getRibbonItem',<br>            BindingFlags.NonPublic | BindingFlags.Instance<br>            )<br>    if getRibbonItemMethod:<br>        return getRibbonItemMethod.Invoke(rvtapi_obj, None)<br>``` |

##### `get_flagged_children(state=True)`

Get all children with their flag equal to given state.

Flagging is a mechanism to mark certain containers. There are various
reasons that container flagging might be used e.g. marking updated
containers or the ones in need of an update or removal.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | flag state to filter children | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[*]` | list of filtered child objects |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>``` | ```md-code__content<br>def get_flagged_children(self, state=True):<br>    """Get all children with their flag equal to given state.<br>    Flagging is a mechanism to mark certain containers. There are various<br>    reasons that container flagging might be used e.g. marking updated<br>    containers or the ones in need of an update or removal.<br>    Args:<br>        state (bool): flag state to filter children<br>    Returns:<br>        (list[*]): list of filtered child objects<br>    """<br>    # FIXME: return type<br>    flagged_cmps = []<br>    for component in self:<br>        flagged_cmps.extend(component.get_flagged_children(state))<br>        if component.is_dirty() == state:<br>            flagged_cmps.append(component)<br>    return flagged_cmps<br>``` |

##### `keys()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>346<br>347<br>348<br>``` | ```md-code__content<br>def keys(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.keys())<br>``` |

##### `values()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>350<br>351<br>352<br>``` | ```md-code__content<br>def values(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.values())<br>``` |

##### `is_dirty()`

Is dirty flag set.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>``` | ```md-code__content<br>def is_dirty(self):<br>    """Is dirty flag set."""<br>    if self._dirty:<br>        return self._dirty<br>    else:<br>        # check if there is any dirty child<br>        for component in self:<br>            if component.is_dirty():<br>                return True<br>        return False<br>``` |

##### `set_dirty_flag(state=True)`

Set dirty flag to given state.

See .get\_flagged\_children()

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | state to set flag | `True` |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>``` | ```md-code__content<br>def set_dirty_flag(self, state=True):<br>    """Set dirty flag to given state.<br>    See .get_flagged_children()<br>    Args:<br>        state (bool): state to set flag<br>    """<br>    self._dirty = state<br>``` |

##### `contains(pyrvt_cmp_name)`

Check if container contains a component with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrvt_cmp_name` | `str` | target component name | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>``` | ```md-code__content<br>def contains(self, pyrvt_cmp_name):<br>    """Check if container contains a component with given name.<br>    Args:<br>        pyrvt_cmp_name (str): target component name<br>    """<br>    return pyrvt_cmp_name in self._sub_pyrvt_components.keys()<br>``` |

##### `find_child(child_name)`

Find a component with given name in children.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `child_name` | `str` | target component name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Any` | component object if found, otherwise None |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>``` | ```md-code__content<br>def find_child(self, child_name):<br>    """Find a component with given name in children.<br>    Args:<br>        child_name (str): target component name<br>    Returns:<br>        (Any): component object if found, otherwise None<br>    """<br>    for sub_cmp in self._sub_pyrvt_components.values():<br>        if child_name == sub_cmp.name:<br>            return sub_cmp<br>        elif hasattr(sub_cmp, 'ui_title') \<br>                and child_name == sub_cmp.ui_title:<br>            return sub_cmp<br>        component = sub_cmp.find_child(child_name)<br>        if component:<br>            return component<br>    return None<br>``` |

##### `get_updated_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>``` | ```md-code__content<br>def get_updated_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children()<br>``` |

##### `get_unchanged_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>432<br>433<br>434<br>``` | ```md-code__content<br>def get_unchanged_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children(state=False)<br>``` |

##### `reorder_before(item_name, ritem_name)`

Reorder and place item\_name before ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the right | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>``` | ```md-code__content<br>def reorder_before(self, item_name, ritem_name):<br>    """Reorder and place item_name before ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the right<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx - 1)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>``` |

##### `reorder_beforeall(item_name)`

Reorder and place item\_name before all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>``` | ```md-code__content<br>def reorder_beforeall(self, item_name):<br>    """Reorder and place item_name before all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    # FIXME: verify docs description is correct<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            apiobj.Panels.Move(litem_idx, 0)<br>``` |

##### `reorder_after(item_name, ritem_name)`

Reorder and place item\_name after ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the left | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>``` | ```md-code__content<br>def reorder_after(self, item_name, ritem_name):<br>    """Reorder and place item_name after ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the left<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx + 1)<br>``` |

##### `reorder_afterall(item_name)`

Reorder and place item\_name after all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>``` | ```md-code__content<br>def reorder_afterall(self, item_name):<br>    """Reorder and place item_name after all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            max_idx = len(apiobj.Panels) - 1<br>            apiobj.Panels.Move(litem_idx, max_idx)<br>``` |

##### `is_native()``staticmethod`

Is this container generated by pyRevit or is native.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>518<br>519<br>520<br>521<br>``` | ```md-code__content<br>@staticmethod<br>def is_native():<br>    """Is this container generated by pyRevit or is native."""<br>    return True<br>``` |

##### `activate()`

Activate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>``` | ```md-code__content<br>def activate(self):<br>    """Activate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    return self.deactivate()<br>``` |

##### `deactivate()`

Deactivate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>``` | ```md-code__content<br>def deactivate(self):<br>    """Deactivate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    raise PyRevitUIError('Can not de/activate native item: {}'<br>                         .format(self))<br>``` |

### `RevitNativeRibbonButton(adwnd_ribbon_button)`

Bases: `GenericRevitNativeUIContainer`

Revit API UI native ribbon button.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>543<br>544<br>545<br>546<br>547<br>548<br>549<br>``` | ```md-code__content<br>def __init__(self, adwnd_ribbon_button):<br>    GenericRevitNativeUIContainer.__init__(self)<br>    self.name = \<br>        safe_strtype(adwnd_ribbon_button.AutomationName)\<br>        .replace('\r\n', ' ')<br>    self._rvtapi_object = adwnd_ribbon_button<br>``` |

#### Attributes

##### `itemdata_mode = False``instance-attribute`

##### `visible``property``writable`

Is container visible.

##### `enabled``property``writable`

Is container enabled.

##### `name = safe_strtype(adwnd_ribbon_button.AutomationName).replace('\r\n', ' ')``instance-attribute`

#### Functions

##### `process_deferred()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>``` | ```md-code__content<br>def process_deferred(self):<br>    try:<br>        if self._visible is not None:<br>            self.visible = self._visible<br>    except Exception as visible_err:<br>        raise PyRevitUIError('Error setting .visible {} | {} '<br>                             .format(self, visible_err))<br>    try:<br>        if self._enabled is not None:<br>            self.enabled = self._enabled<br>    except Exception as enable_err:<br>        raise PyRevitUIError('Error setting .enabled {} | {} '<br>                             .format(self, enable_err))<br>``` |

##### `get_rvtapi_object()`

Return underlying Revit API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>def get_rvtapi_object(self):<br>    """Return underlying Revit API object for this container."""<br>    # FIXME: return type<br>    return self._rvtapi_object<br>``` |

##### `set_rvtapi_object(rvtapi_obj)`

Set underlying Revit API object for this container.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvtapi_obj` | `obj` | Revit API container object | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>``` | ```md-code__content<br>def set_rvtapi_object(self, rvtapi_obj):<br>    """Set underlying Revit API object for this container.<br>    Args:<br>        rvtapi_obj (obj): Revit API container object<br>    """<br>    # FIXME: rvtapi_obj type<br>    self._rvtapi_object = rvtapi_obj<br>    self.itemdata_mode = False<br>    self._dirty = True<br>``` |

##### `get_adwindows_object()`

Return underlying AdWindows API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>``` | ```md-code__content<br>def get_adwindows_object(self):<br>    """Return underlying AdWindows API object for this container."""<br>    # FIXME: return type<br>    rvtapi_obj = self._rvtapi_object<br>    getRibbonItemMethod = \<br>        rvtapi_obj.GetType().GetMethod(<br>            'getRibbonItem',<br>            BindingFlags.NonPublic | BindingFlags.Instance<br>            )<br>    if getRibbonItemMethod:<br>        return getRibbonItemMethod.Invoke(rvtapi_obj, None)<br>``` |

##### `get_flagged_children(state=True)`

Get all children with their flag equal to given state.

Flagging is a mechanism to mark certain containers. There are various
reasons that container flagging might be used e.g. marking updated
containers or the ones in need of an update or removal.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | flag state to filter children | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[*]` | list of filtered child objects |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>``` | ```md-code__content<br>def get_flagged_children(self, state=True):<br>    """Get all children with their flag equal to given state.<br>    Flagging is a mechanism to mark certain containers. There are various<br>    reasons that container flagging might be used e.g. marking updated<br>    containers or the ones in need of an update or removal.<br>    Args:<br>        state (bool): flag state to filter children<br>    Returns:<br>        (list[*]): list of filtered child objects<br>    """<br>    # FIXME: return type<br>    flagged_cmps = []<br>    for component in self:<br>        flagged_cmps.extend(component.get_flagged_children(state))<br>        if component.is_dirty() == state:<br>            flagged_cmps.append(component)<br>    return flagged_cmps<br>``` |

##### `keys()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>346<br>347<br>348<br>``` | ```md-code__content<br>def keys(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.keys())<br>``` |

##### `values()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>350<br>351<br>352<br>``` | ```md-code__content<br>def values(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.values())<br>``` |

##### `is_native()``staticmethod`

Is this container generated by pyRevit or is native.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>518<br>519<br>520<br>521<br>``` | ```md-code__content<br>@staticmethod<br>def is_native():<br>    """Is this container generated by pyRevit or is native."""<br>    return True<br>``` |

##### `is_dirty()`

Is dirty flag set.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>``` | ```md-code__content<br>def is_dirty(self):<br>    """Is dirty flag set."""<br>    if self._dirty:<br>        return self._dirty<br>    else:<br>        # check if there is any dirty child<br>        for component in self:<br>            if component.is_dirty():<br>                return True<br>        return False<br>``` |

##### `set_dirty_flag(state=True)`

Set dirty flag to given state.

See .get\_flagged\_children()

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | state to set flag | `True` |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>``` | ```md-code__content<br>def set_dirty_flag(self, state=True):<br>    """Set dirty flag to given state.<br>    See .get_flagged_children()<br>    Args:<br>        state (bool): state to set flag<br>    """<br>    self._dirty = state<br>``` |

##### `contains(pyrvt_cmp_name)`

Check if container contains a component with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrvt_cmp_name` | `str` | target component name | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>``` | ```md-code__content<br>def contains(self, pyrvt_cmp_name):<br>    """Check if container contains a component with given name.<br>    Args:<br>        pyrvt_cmp_name (str): target component name<br>    """<br>    return pyrvt_cmp_name in self._sub_pyrvt_components.keys()<br>``` |

##### `find_child(child_name)`

Find a component with given name in children.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `child_name` | `str` | target component name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Any` | component object if found, otherwise None |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>``` | ```md-code__content<br>def find_child(self, child_name):<br>    """Find a component with given name in children.<br>    Args:<br>        child_name (str): target component name<br>    Returns:<br>        (Any): component object if found, otherwise None<br>    """<br>    for sub_cmp in self._sub_pyrvt_components.values():<br>        if child_name == sub_cmp.name:<br>            return sub_cmp<br>        elif hasattr(sub_cmp, 'ui_title') \<br>                and child_name == sub_cmp.ui_title:<br>            return sub_cmp<br>        component = sub_cmp.find_child(child_name)<br>        if component:<br>            return component<br>    return None<br>``` |

##### `activate()`

Activate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>``` | ```md-code__content<br>def activate(self):<br>    """Activate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    return self.deactivate()<br>``` |

##### `deactivate()`

Deactivate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>``` | ```md-code__content<br>def deactivate(self):<br>    """Deactivate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    raise PyRevitUIError('Can not de/activate native item: {}'<br>                         .format(self))<br>``` |

##### `get_updated_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>``` | ```md-code__content<br>def get_updated_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children()<br>``` |

##### `get_unchanged_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>432<br>433<br>434<br>``` | ```md-code__content<br>def get_unchanged_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children(state=False)<br>``` |

##### `reorder_before(item_name, ritem_name)`

Reorder and place item\_name before ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the right | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>``` | ```md-code__content<br>def reorder_before(self, item_name, ritem_name):<br>    """Reorder and place item_name before ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the right<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx - 1)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>``` |

##### `reorder_beforeall(item_name)`

Reorder and place item\_name before all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>``` | ```md-code__content<br>def reorder_beforeall(self, item_name):<br>    """Reorder and place item_name before all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    # FIXME: verify docs description is correct<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            apiobj.Panels.Move(litem_idx, 0)<br>``` |

##### `reorder_after(item_name, ritem_name)`

Reorder and place item\_name after ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the left | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>``` | ```md-code__content<br>def reorder_after(self, item_name, ritem_name):<br>    """Reorder and place item_name after ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the left<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx + 1)<br>``` |

##### `reorder_afterall(item_name)`

Reorder and place item\_name after all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>``` | ```md-code__content<br>def reorder_afterall(self, item_name):<br>    """Reorder and place item_name after all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            max_idx = len(apiobj.Panels) - 1<br>            apiobj.Panels.Move(litem_idx, max_idx)<br>``` |

### `RevitNativeRibbonGroupItem(adwnd_ribbon_item)`

Bases: `GenericRevitNativeUIContainer`

Revit API UI native ribbon button.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>554<br>555<br>556<br>557<br>558<br>559<br>560<br>561<br>562<br>``` | ```md-code__content<br>def __init__(self, adwnd_ribbon_item):<br>    GenericRevitNativeUIContainer.__init__(self)<br>    self.name = adwnd_ribbon_item.Source.Title<br>    self._rvtapi_object = adwnd_ribbon_item<br>    # finding children on this button group<br>    for adwnd_ribbon_button in adwnd_ribbon_item.Items:<br>        self._add_component(RevitNativeRibbonButton(adwnd_ribbon_button))<br>``` |

#### Attributes

##### `itemdata_mode = False``instance-attribute`

##### `visible``property``writable`

Is container visible.

##### `enabled``property``writable`

Is container enabled.

##### `name = adwnd_ribbon_item.Source.Title``instance-attribute`

#### Functions

##### `process_deferred()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>``` | ```md-code__content<br>def process_deferred(self):<br>    try:<br>        if self._visible is not None:<br>            self.visible = self._visible<br>    except Exception as visible_err:<br>        raise PyRevitUIError('Error setting .visible {} | {} '<br>                             .format(self, visible_err))<br>    try:<br>        if self._enabled is not None:<br>            self.enabled = self._enabled<br>    except Exception as enable_err:<br>        raise PyRevitUIError('Error setting .enabled {} | {} '<br>                             .format(self, enable_err))<br>``` |

##### `get_rvtapi_object()`

Return underlying Revit API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>def get_rvtapi_object(self):<br>    """Return underlying Revit API object for this container."""<br>    # FIXME: return type<br>    return self._rvtapi_object<br>``` |

##### `set_rvtapi_object(rvtapi_obj)`

Set underlying Revit API object for this container.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvtapi_obj` | `obj` | Revit API container object | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>``` | ```md-code__content<br>def set_rvtapi_object(self, rvtapi_obj):<br>    """Set underlying Revit API object for this container.<br>    Args:<br>        rvtapi_obj (obj): Revit API container object<br>    """<br>    # FIXME: rvtapi_obj type<br>    self._rvtapi_object = rvtapi_obj<br>    self.itemdata_mode = False<br>    self._dirty = True<br>``` |

##### `get_adwindows_object()`

Return underlying AdWindows API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>``` | ```md-code__content<br>def get_adwindows_object(self):<br>    """Return underlying AdWindows API object for this container."""<br>    # FIXME: return type<br>    rvtapi_obj = self._rvtapi_object<br>    getRibbonItemMethod = \<br>        rvtapi_obj.GetType().GetMethod(<br>            'getRibbonItem',<br>            BindingFlags.NonPublic | BindingFlags.Instance<br>            )<br>    if getRibbonItemMethod:<br>        return getRibbonItemMethod.Invoke(rvtapi_obj, None)<br>``` |

##### `get_flagged_children(state=True)`

Get all children with their flag equal to given state.

Flagging is a mechanism to mark certain containers. There are various
reasons that container flagging might be used e.g. marking updated
containers or the ones in need of an update or removal.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | flag state to filter children | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[*]` | list of filtered child objects |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>``` | ```md-code__content<br>def get_flagged_children(self, state=True):<br>    """Get all children with their flag equal to given state.<br>    Flagging is a mechanism to mark certain containers. There are various<br>    reasons that container flagging might be used e.g. marking updated<br>    containers or the ones in need of an update or removal.<br>    Args:<br>        state (bool): flag state to filter children<br>    Returns:<br>        (list[*]): list of filtered child objects<br>    """<br>    # FIXME: return type<br>    flagged_cmps = []<br>    for component in self:<br>        flagged_cmps.extend(component.get_flagged_children(state))<br>        if component.is_dirty() == state:<br>            flagged_cmps.append(component)<br>    return flagged_cmps<br>``` |

##### `keys()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>346<br>347<br>348<br>``` | ```md-code__content<br>def keys(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.keys())<br>``` |

##### `values()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>350<br>351<br>352<br>``` | ```md-code__content<br>def values(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.values())<br>``` |

##### `is_native()``staticmethod`

Is this container generated by pyRevit or is native.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>518<br>519<br>520<br>521<br>``` | ```md-code__content<br>@staticmethod<br>def is_native():<br>    """Is this container generated by pyRevit or is native."""<br>    return True<br>``` |

##### `is_dirty()`

Is dirty flag set.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>``` | ```md-code__content<br>def is_dirty(self):<br>    """Is dirty flag set."""<br>    if self._dirty:<br>        return self._dirty<br>    else:<br>        # check if there is any dirty child<br>        for component in self:<br>            if component.is_dirty():<br>                return True<br>        return False<br>``` |

##### `set_dirty_flag(state=True)`

Set dirty flag to given state.

See .get\_flagged\_children()

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | state to set flag | `True` |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>``` | ```md-code__content<br>def set_dirty_flag(self, state=True):<br>    """Set dirty flag to given state.<br>    See .get_flagged_children()<br>    Args:<br>        state (bool): state to set flag<br>    """<br>    self._dirty = state<br>``` |

##### `contains(pyrvt_cmp_name)`

Check if container contains a component with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrvt_cmp_name` | `str` | target component name | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>``` | ```md-code__content<br>def contains(self, pyrvt_cmp_name):<br>    """Check if container contains a component with given name.<br>    Args:<br>        pyrvt_cmp_name (str): target component name<br>    """<br>    return pyrvt_cmp_name in self._sub_pyrvt_components.keys()<br>``` |

##### `find_child(child_name)`

Find a component with given name in children.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `child_name` | `str` | target component name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Any` | component object if found, otherwise None |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>``` | ```md-code__content<br>def find_child(self, child_name):<br>    """Find a component with given name in children.<br>    Args:<br>        child_name (str): target component name<br>    Returns:<br>        (Any): component object if found, otherwise None<br>    """<br>    for sub_cmp in self._sub_pyrvt_components.values():<br>        if child_name == sub_cmp.name:<br>            return sub_cmp<br>        elif hasattr(sub_cmp, 'ui_title') \<br>                and child_name == sub_cmp.ui_title:<br>            return sub_cmp<br>        component = sub_cmp.find_child(child_name)<br>        if component:<br>            return component<br>    return None<br>``` |

##### `activate()`

Activate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>``` | ```md-code__content<br>def activate(self):<br>    """Activate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    return self.deactivate()<br>``` |

##### `deactivate()`

Deactivate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>``` | ```md-code__content<br>def deactivate(self):<br>    """Deactivate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    raise PyRevitUIError('Can not de/activate native item: {}'<br>                         .format(self))<br>``` |

##### `get_updated_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>``` | ```md-code__content<br>def get_updated_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children()<br>``` |

##### `get_unchanged_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>432<br>433<br>434<br>``` | ```md-code__content<br>def get_unchanged_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children(state=False)<br>``` |

##### `reorder_before(item_name, ritem_name)`

Reorder and place item\_name before ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the right | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>``` | ```md-code__content<br>def reorder_before(self, item_name, ritem_name):<br>    """Reorder and place item_name before ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the right<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx - 1)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>``` |

##### `reorder_beforeall(item_name)`

Reorder and place item\_name before all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>``` | ```md-code__content<br>def reorder_beforeall(self, item_name):<br>    """Reorder and place item_name before all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    # FIXME: verify docs description is correct<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            apiobj.Panels.Move(litem_idx, 0)<br>``` |

##### `reorder_after(item_name, ritem_name)`

Reorder and place item\_name after ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the left | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>``` | ```md-code__content<br>def reorder_after(self, item_name, ritem_name):<br>    """Reorder and place item_name after ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the left<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx + 1)<br>``` |

##### `reorder_afterall(item_name)`

Reorder and place item\_name after all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>``` | ```md-code__content<br>def reorder_afterall(self, item_name):<br>    """Reorder and place item_name after all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            max_idx = len(apiobj.Panels) - 1<br>            apiobj.Panels.Move(litem_idx, max_idx)<br>``` |

##### `button(name)`

Get button item with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `name` | `str` | name of button item to find | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `RevitNativeRibbonButton` | button object if found |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>564<br>565<br>566<br>567<br>568<br>569<br>570<br>571<br>572<br>573<br>``` | ```md-code__content<br>def button(self, name):<br>    """Get button item with given name.<br>    Args:<br>        name (str): name of button item to find<br>    Returns:<br>        (RevitNativeRibbonButton): button object if found<br>    """<br>    return super(RevitNativeRibbonGroupItem, self)._get_component(name)<br>``` |

### `RevitNativeRibbonPanel(adwnd_ribbon_panel)`

Bases: `GenericRevitNativeUIContainer`

Revit API UI native ribbon button.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>578<br>579<br>580<br>581<br>582<br>583<br>584<br>585<br>586<br>587<br>588<br>589<br>590<br>591<br>592<br>593<br>594<br>595<br>596<br>597<br>598<br>599<br>600<br>601<br>602<br>603<br>604<br>605<br>606<br>607<br>608<br>609<br>610<br>611<br>612<br>613<br>614<br>615<br>616<br>617<br>618<br>619<br>620<br>621<br>622<br>623<br>624<br>``` | ```md-code__content<br>def __init__(self, adwnd_ribbon_panel):<br>    GenericRevitNativeUIContainer.__init__(self)<br>    self.name = adwnd_ribbon_panel.Source.Title<br>    self._rvtapi_object = adwnd_ribbon_panel<br>    all_adwnd_ribbon_items = []<br>    # getting a list of existing items under this panel<br>    # RibbonFoldPanel items are not visible. they automatically fold<br>    # buttons into stack on revit ui resize since RibbonFoldPanel are<br>    # not visible it does not make sense to create objects for them.<br>    # This pre-cleaner loop, finds the RibbonFoldPanel items and<br>    # adds the children to the main list<br>    for adwnd_ribbon_item in adwnd_ribbon_panel.Source.Items:<br>        if isinstance(adwnd_ribbon_item, AdWindows.RibbonFoldPanel):<br>            try:<br>                for sub_rvtapi_item in adwnd_ribbon_item.Items:<br>                    all_adwnd_ribbon_items.append(sub_rvtapi_item)<br>            except Exception as append_err:<br>                mlogger.debug('Can not get RibbonFoldPanel children: %s '<br>                              '| %s', adwnd_ribbon_item, append_err)<br>        else:<br>            all_adwnd_ribbon_items.append(adwnd_ribbon_item)<br>    # processing the panel slideout for exising ribbon items<br>    for adwnd_slideout_item \<br>            in adwnd_ribbon_panel.Source.SlideOutPanelItemsView:<br>        all_adwnd_ribbon_items.append(adwnd_slideout_item)<br>    # processing the cleaned children list and<br>    # creating pyRevit native ribbon objects<br>    for adwnd_ribbon_item in all_adwnd_ribbon_items:<br>        try:<br>            if isinstance(adwnd_ribbon_item,<br>                          AdWindows.RibbonButton) \<br>                    or isinstance(adwnd_ribbon_item,<br>                                  AdWindows.RibbonToggleButton):<br>                self._add_component(<br>                    RevitNativeRibbonButton(adwnd_ribbon_item))<br>            elif isinstance(adwnd_ribbon_item,<br>                            AdWindows.RibbonSplitButton):<br>                self._add_component(<br>                    RevitNativeRibbonGroupItem(adwnd_ribbon_item))<br>        except Exception as append_err:<br>            mlogger.debug('Can not create native ribbon item: %s '<br>                          '| %s', adwnd_ribbon_item, append_err)<br>``` |

#### Attributes

##### `itemdata_mode = False``instance-attribute`

##### `visible``property``writable`

Is container visible.

##### `enabled``property``writable`

Is container enabled.

##### `name = adwnd_ribbon_panel.Source.Title``instance-attribute`

#### Functions

##### `process_deferred()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>``` | ```md-code__content<br>def process_deferred(self):<br>    try:<br>        if self._visible is not None:<br>            self.visible = self._visible<br>    except Exception as visible_err:<br>        raise PyRevitUIError('Error setting .visible {} | {} '<br>                             .format(self, visible_err))<br>    try:<br>        if self._enabled is not None:<br>            self.enabled = self._enabled<br>    except Exception as enable_err:<br>        raise PyRevitUIError('Error setting .enabled {} | {} '<br>                             .format(self, enable_err))<br>``` |

##### `get_rvtapi_object()`

Return underlying Revit API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>def get_rvtapi_object(self):<br>    """Return underlying Revit API object for this container."""<br>    # FIXME: return type<br>    return self._rvtapi_object<br>``` |

##### `set_rvtapi_object(rvtapi_obj)`

Set underlying Revit API object for this container.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvtapi_obj` | `obj` | Revit API container object | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>``` | ```md-code__content<br>def set_rvtapi_object(self, rvtapi_obj):<br>    """Set underlying Revit API object for this container.<br>    Args:<br>        rvtapi_obj (obj): Revit API container object<br>    """<br>    # FIXME: rvtapi_obj type<br>    self._rvtapi_object = rvtapi_obj<br>    self.itemdata_mode = False<br>    self._dirty = True<br>``` |

##### `get_adwindows_object()`

Return underlying AdWindows API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>``` | ```md-code__content<br>def get_adwindows_object(self):<br>    """Return underlying AdWindows API object for this container."""<br>    # FIXME: return type<br>    rvtapi_obj = self._rvtapi_object<br>    getRibbonItemMethod = \<br>        rvtapi_obj.GetType().GetMethod(<br>            'getRibbonItem',<br>            BindingFlags.NonPublic | BindingFlags.Instance<br>            )<br>    if getRibbonItemMethod:<br>        return getRibbonItemMethod.Invoke(rvtapi_obj, None)<br>``` |

##### `get_flagged_children(state=True)`

Get all children with their flag equal to given state.

Flagging is a mechanism to mark certain containers. There are various
reasons that container flagging might be used e.g. marking updated
containers or the ones in need of an update or removal.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | flag state to filter children | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[*]` | list of filtered child objects |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>``` | ```md-code__content<br>def get_flagged_children(self, state=True):<br>    """Get all children with their flag equal to given state.<br>    Flagging is a mechanism to mark certain containers. There are various<br>    reasons that container flagging might be used e.g. marking updated<br>    containers or the ones in need of an update or removal.<br>    Args:<br>        state (bool): flag state to filter children<br>    Returns:<br>        (list[*]): list of filtered child objects<br>    """<br>    # FIXME: return type<br>    flagged_cmps = []<br>    for component in self:<br>        flagged_cmps.extend(component.get_flagged_children(state))<br>        if component.is_dirty() == state:<br>            flagged_cmps.append(component)<br>    return flagged_cmps<br>``` |

##### `keys()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>346<br>347<br>348<br>``` | ```md-code__content<br>def keys(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.keys())<br>``` |

##### `values()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>350<br>351<br>352<br>``` | ```md-code__content<br>def values(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.values())<br>``` |

##### `is_native()``staticmethod`

Is this container generated by pyRevit or is native.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>518<br>519<br>520<br>521<br>``` | ```md-code__content<br>@staticmethod<br>def is_native():<br>    """Is this container generated by pyRevit or is native."""<br>    return True<br>``` |

##### `is_dirty()`

Is dirty flag set.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>``` | ```md-code__content<br>def is_dirty(self):<br>    """Is dirty flag set."""<br>    if self._dirty:<br>        return self._dirty<br>    else:<br>        # check if there is any dirty child<br>        for component in self:<br>            if component.is_dirty():<br>                return True<br>        return False<br>``` |

##### `set_dirty_flag(state=True)`

Set dirty flag to given state.

See .get\_flagged\_children()

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | state to set flag | `True` |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>``` | ```md-code__content<br>def set_dirty_flag(self, state=True):<br>    """Set dirty flag to given state.<br>    See .get_flagged_children()<br>    Args:<br>        state (bool): state to set flag<br>    """<br>    self._dirty = state<br>``` |

##### `contains(pyrvt_cmp_name)`

Check if container contains a component with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrvt_cmp_name` | `str` | target component name | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>``` | ```md-code__content<br>def contains(self, pyrvt_cmp_name):<br>    """Check if container contains a component with given name.<br>    Args:<br>        pyrvt_cmp_name (str): target component name<br>    """<br>    return pyrvt_cmp_name in self._sub_pyrvt_components.keys()<br>``` |

##### `find_child(child_name)`

Find a component with given name in children.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `child_name` | `str` | target component name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Any` | component object if found, otherwise None |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>``` | ```md-code__content<br>def find_child(self, child_name):<br>    """Find a component with given name in children.<br>    Args:<br>        child_name (str): target component name<br>    Returns:<br>        (Any): component object if found, otherwise None<br>    """<br>    for sub_cmp in self._sub_pyrvt_components.values():<br>        if child_name == sub_cmp.name:<br>            return sub_cmp<br>        elif hasattr(sub_cmp, 'ui_title') \<br>                and child_name == sub_cmp.ui_title:<br>            return sub_cmp<br>        component = sub_cmp.find_child(child_name)<br>        if component:<br>            return component<br>    return None<br>``` |

##### `activate()`

Activate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>``` | ```md-code__content<br>def activate(self):<br>    """Activate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    return self.deactivate()<br>``` |

##### `deactivate()`

Deactivate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>``` | ```md-code__content<br>def deactivate(self):<br>    """Deactivate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    raise PyRevitUIError('Can not de/activate native item: {}'<br>                         .format(self))<br>``` |

##### `get_updated_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>``` | ```md-code__content<br>def get_updated_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children()<br>``` |

##### `get_unchanged_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>432<br>433<br>434<br>``` | ```md-code__content<br>def get_unchanged_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children(state=False)<br>``` |

##### `reorder_before(item_name, ritem_name)`

Reorder and place item\_name before ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the right | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>``` | ```md-code__content<br>def reorder_before(self, item_name, ritem_name):<br>    """Reorder and place item_name before ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the right<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx - 1)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>``` |

##### `reorder_beforeall(item_name)`

Reorder and place item\_name before all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>``` | ```md-code__content<br>def reorder_beforeall(self, item_name):<br>    """Reorder and place item_name before all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    # FIXME: verify docs description is correct<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            apiobj.Panels.Move(litem_idx, 0)<br>``` |

##### `reorder_after(item_name, ritem_name)`

Reorder and place item\_name after ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the left | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>``` | ```md-code__content<br>def reorder_after(self, item_name, ritem_name):<br>    """Reorder and place item_name after ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the left<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx + 1)<br>``` |

##### `reorder_afterall(item_name)`

Reorder and place item\_name after all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>``` | ```md-code__content<br>def reorder_afterall(self, item_name):<br>    """Reorder and place item_name after all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            max_idx = len(apiobj.Panels) - 1<br>            apiobj.Panels.Move(litem_idx, max_idx)<br>``` |

##### `ribbon_item(item_name)`

Get panel item with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of panel item to find | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `object` | panel item if found, could be :obj: `RevitNativeRibbonButton`<br>or :obj: `RevitNativeRibbonGroupItem` |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>626<br>627<br>628<br>629<br>630<br>631<br>632<br>633<br>634<br>635<br>636<br>637<br>``` | ```md-code__content<br>def ribbon_item(self, item_name):<br>    """Get panel item with given name.<br>    Args:<br>        item_name (str): name of panel item to find<br>    Returns:<br>        (object):<br>            panel item if found, could be :obj:`RevitNativeRibbonButton`<br>            or :obj:`RevitNativeRibbonGroupItem`<br>    """<br>    return super(RevitNativeRibbonPanel, self)._get_component(item_name)<br>``` |

### `RevitNativeRibbonTab(adwnd_ribbon_tab)`

Bases: `GenericRevitNativeUIContainer`

Revit API UI native ribbon tab.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>642<br>643<br>644<br>645<br>646<br>647<br>648<br>649<br>650<br>651<br>652<br>653<br>654<br>655<br>656<br>657<br>658<br>``` | ```md-code__content<br>def __init__(self, adwnd_ribbon_tab):<br>    GenericRevitNativeUIContainer.__init__(self)<br>    self.name = adwnd_ribbon_tab.Title<br>    self._rvtapi_object = adwnd_ribbon_tab<br>    # getting a list of existing panels under this tab<br>    try:<br>        for adwnd_ribbon_panel in adwnd_ribbon_tab.Panels:<br>            # only listing visible panels<br>            if adwnd_ribbon_panel.IsVisible:<br>                self._add_component(<br>                    RevitNativeRibbonPanel(adwnd_ribbon_panel)<br>                )<br>    except Exception as append_err:<br>        mlogger.debug('Can not get native panels for this native tab: %s '<br>                      '| %s', adwnd_ribbon_tab, append_err)<br>``` |

#### Attributes

##### `itemdata_mode = False``instance-attribute`

##### `visible``property``writable`

Is container visible.

##### `enabled``property``writable`

Is container enabled.

##### `name = adwnd_ribbon_tab.Title``instance-attribute`

#### Functions

##### `process_deferred()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>``` | ```md-code__content<br>def process_deferred(self):<br>    try:<br>        if self._visible is not None:<br>            self.visible = self._visible<br>    except Exception as visible_err:<br>        raise PyRevitUIError('Error setting .visible {} | {} '<br>                             .format(self, visible_err))<br>    try:<br>        if self._enabled is not None:<br>            self.enabled = self._enabled<br>    except Exception as enable_err:<br>        raise PyRevitUIError('Error setting .enabled {} | {} '<br>                             .format(self, enable_err))<br>``` |

##### `get_rvtapi_object()`

Return underlying Revit API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>297<br>298<br>299<br>300<br>``` | ```md-code__content<br>def get_rvtapi_object(self):<br>    """Return underlying Revit API object for this container."""<br>    # FIXME: return type<br>    return self._rvtapi_object<br>``` |

##### `set_rvtapi_object(rvtapi_obj)`

Set underlying Revit API object for this container.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvtapi_obj` | `obj` | Revit API container object | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>``` | ```md-code__content<br>def set_rvtapi_object(self, rvtapi_obj):<br>    """Set underlying Revit API object for this container.<br>    Args:<br>        rvtapi_obj (obj): Revit API container object<br>    """<br>    # FIXME: rvtapi_obj type<br>    self._rvtapi_object = rvtapi_obj<br>    self.itemdata_mode = False<br>    self._dirty = True<br>``` |

##### `get_adwindows_object()`

Return underlying AdWindows API object for this container.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>``` | ```md-code__content<br>def get_adwindows_object(self):<br>    """Return underlying AdWindows API object for this container."""<br>    # FIXME: return type<br>    rvtapi_obj = self._rvtapi_object<br>    getRibbonItemMethod = \<br>        rvtapi_obj.GetType().GetMethod(<br>            'getRibbonItem',<br>            BindingFlags.NonPublic | BindingFlags.Instance<br>            )<br>    if getRibbonItemMethod:<br>        return getRibbonItemMethod.Invoke(rvtapi_obj, None)<br>``` |

##### `get_flagged_children(state=True)`

Get all children with their flag equal to given state.

Flagging is a mechanism to mark certain containers. There are various
reasons that container flagging might be used e.g. marking updated
containers or the ones in need of an update or removal.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | flag state to filter children | `True` |

Returns:

| Type | Description |
| --- | --- |
| `list[*]` | list of filtered child objects |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>``` | ```md-code__content<br>def get_flagged_children(self, state=True):<br>    """Get all children with their flag equal to given state.<br>    Flagging is a mechanism to mark certain containers. There are various<br>    reasons that container flagging might be used e.g. marking updated<br>    containers or the ones in need of an update or removal.<br>    Args:<br>        state (bool): flag state to filter children<br>    Returns:<br>        (list[*]): list of filtered child objects<br>    """<br>    # FIXME: return type<br>    flagged_cmps = []<br>    for component in self:<br>        flagged_cmps.extend(component.get_flagged_children(state))<br>        if component.is_dirty() == state:<br>            flagged_cmps.append(component)<br>    return flagged_cmps<br>``` |

##### `keys()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>346<br>347<br>348<br>``` | ```md-code__content<br>def keys(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.keys())<br>``` |

##### `values()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>350<br>351<br>352<br>``` | ```md-code__content<br>def values(self):<br>    # FIXME: what does this do?<br>    list(self._sub_pyrvt_components.values())<br>``` |

##### `is_native()``staticmethod`

Is this container generated by pyRevit or is native.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>518<br>519<br>520<br>521<br>``` | ```md-code__content<br>@staticmethod<br>def is_native():<br>    """Is this container generated by pyRevit or is native."""<br>    return True<br>``` |

##### `is_dirty()`

Is dirty flag set.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>359<br>360<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>``` | ```md-code__content<br>def is_dirty(self):<br>    """Is dirty flag set."""<br>    if self._dirty:<br>        return self._dirty<br>    else:<br>        # check if there is any dirty child<br>        for component in self:<br>            if component.is_dirty():<br>                return True<br>        return False<br>``` |

##### `set_dirty_flag(state=True)`

Set dirty flag to given state.

See .get\_flagged\_children()

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `state` | `bool` | state to set flag | `True` |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>``` | ```md-code__content<br>def set_dirty_flag(self, state=True):<br>    """Set dirty flag to given state.<br>    See .get_flagged_children()<br>    Args:<br>        state (bool): state to set flag<br>    """<br>    self._dirty = state<br>``` |

##### `contains(pyrvt_cmp_name)`

Check if container contains a component with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrvt_cmp_name` | `str` | target component name | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>``` | ```md-code__content<br>def contains(self, pyrvt_cmp_name):<br>    """Check if container contains a component with given name.<br>    Args:<br>        pyrvt_cmp_name (str): target component name<br>    """<br>    return pyrvt_cmp_name in self._sub_pyrvt_components.keys()<br>``` |

##### `find_child(child_name)`

Find a component with given name in children.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `child_name` | `str` | target component name | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Any` | component object if found, otherwise None |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>388<br>389<br>390<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>``` | ```md-code__content<br>def find_child(self, child_name):<br>    """Find a component with given name in children.<br>    Args:<br>        child_name (str): target component name<br>    Returns:<br>        (Any): component object if found, otherwise None<br>    """<br>    for sub_cmp in self._sub_pyrvt_components.values():<br>        if child_name == sub_cmp.name:<br>            return sub_cmp<br>        elif hasattr(sub_cmp, 'ui_title') \<br>                and child_name == sub_cmp.ui_title:<br>            return sub_cmp<br>        component = sub_cmp.find_child(child_name)<br>        if component:<br>            return component<br>    return None<br>``` |

##### `activate()`

Activate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>``` | ```md-code__content<br>def activate(self):<br>    """Activate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    return self.deactivate()<br>``` |

##### `deactivate()`

Deactivate this container in ui.

Under current implementation, raises PyRevitUIError exception as
native Revit API UI components should not be changed.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>``` | ```md-code__content<br>def deactivate(self):<br>    """Deactivate this container in ui.<br>    Under current implementation, raises PyRevitUIError exception as<br>    native Revit API UI components should not be changed.<br>    """<br>    raise PyRevitUIError('Can not de/activate native item: {}'<br>                         .format(self))<br>``` |

##### `get_updated_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>428<br>429<br>430<br>``` | ```md-code__content<br>def get_updated_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children()<br>``` |

##### `get_unchanged_items()`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>432<br>433<br>434<br>``` | ```md-code__content<br>def get_unchanged_items(self):<br>    # FIXME: reduntant, this is a use case and should be on uimaker side?<br>    return self.get_flagged_children(state=False)<br>``` |

##### `reorder_before(item_name, ritem_name)`

Reorder and place item\_name before ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the right | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>``` | ```md-code__content<br>def reorder_before(self, item_name, ritem_name):<br>    """Reorder and place item_name before ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the right<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx - 1)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>``` |

##### `reorder_beforeall(item_name)`

Reorder and place item\_name before all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>``` | ```md-code__content<br>def reorder_beforeall(self, item_name):<br>    """Reorder and place item_name before all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    # FIXME: verify docs description is correct<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            apiobj.Panels.Move(litem_idx, 0)<br>``` |

##### `reorder_after(item_name, ritem_name)`

Reorder and place item\_name after ritem\_name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |
| `ritem_name` | `str` | name of component that should be on the left | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>``` | ```md-code__content<br>def reorder_after(self, item_name, ritem_name):<br>    """Reorder and place item_name after ritem_name.<br>    Args:<br>        item_name (str): name of component to be moved<br>        ritem_name (str): name of component that should be on the left<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = ritem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>            elif item.Source.AutomationName == ritem_name:<br>                ritem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx and ritem_idx:<br>            if litem_idx < ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx)<br>            elif litem_idx > ritem_idx:<br>                apiobj.Panels.Move(litem_idx, ritem_idx + 1)<br>``` |

##### `reorder_afterall(item_name)`

Reorder and place item\_name after all others.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `item_name` | `str` | name of component to be moved | _required_ |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>``` | ```md-code__content<br>def reorder_afterall(self, item_name):<br>    """Reorder and place item_name after all others.<br>    Args:<br>        item_name (str): name of component to be moved<br>    """<br>    apiobj = self.get_rvtapi_object()<br>    litem_idx = None<br>    if hasattr(apiobj, 'Panels'):<br>        for item in apiobj.Panels:<br>            if item.Source.AutomationName == item_name:<br>                litem_idx = apiobj.Panels.IndexOf(item)<br>        if litem_idx:<br>            max_idx = len(apiobj.Panels) - 1<br>            apiobj.Panels.Move(litem_idx, max_idx)<br>``` |

##### `ribbon_panel(panel_name)`

Get panel with given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `panel_name` | `str` | name of panel to find | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `RevitNativeRibbonPanel` | panel if found |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>660<br>661<br>662<br>663<br>664<br>665<br>666<br>667<br>668<br>669<br>``` | ```md-code__content<br>def ribbon_panel(self, panel_name):<br>    """Get panel with given name.<br>    Args:<br>        panel_name (str): name of panel to find<br>    Returns:<br>        (RevitNativeRibbonPanel): panel if found<br>    """<br>    return super(RevitNativeRibbonTab, self)._get_component(panel_name)<br>``` |

##### `is_pyrevit_tab()``staticmethod`

Is this tab generated by pyRevit.

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>671<br>672<br>673<br>674<br>``` | ```md-code__content<br>@staticmethod<br>def is_pyrevit_tab():<br>    """Is this tab generated by pyRevit."""<br>    return False<br>``` |

## Functions

### `argb_to_brush(argb_color)`

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>``` | ```md-code__content<br>def argb_to_brush(argb_color):<br>    # argb_color is formatted as #AARRGGBB<br>    a = r = g = b = "FF"<br>    try:<br>        b = argb_color[-2:]<br>        g = argb_color[-4:-2]<br>        r = argb_color[-6:-4]<br>        if len(argb_color) > 7:<br>            a = argb_color[-8:-6]<br>        return Media.SolidColorBrush(Media.Color.FromArgb(<br>                Convert.ToInt32("0x" + a, 16),<br>                Convert.ToInt32("0x" + r, 16),<br>                Convert.ToInt32("0x" + g, 16),<br>                Convert.ToInt32("0x" + b, 16)<br>                )<br>            )<br>    except Exception as color_ex:<br>        mlogger.error("Bad color format %s | %s", argb_color, color_ex)<br>``` |

### `load_bitmapimage(image_file)`

Load given png file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `image_file` | `str` | image file path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `BitmapImage` | bitmap image object |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>``` | ```md-code__content<br>def load_bitmapimage(image_file):<br>    """Load given png file.<br>    Args:<br>        image_file (str): image file path<br>    Returns:<br>        (Imaging.BitmapImage): bitmap image object<br>    """<br>    bitmap = Imaging.BitmapImage()<br>    bitmap.BeginInit()<br>    bitmap.UriSource = Uri(image_file)<br>    bitmap.CacheOption = Imaging.BitmapCacheOption.OnLoad<br>    bitmap.CreateOptions = Imaging.BitmapCreateOptions.IgnoreImageCache<br>    bitmap.EndInit()<br>    bitmap.Freeze()<br>    return bitmap<br>``` |

### `get_current_ui(all_native=False)`

Revit UI Wrapper class for interacting with current pyRevit UI.

Returned class provides min required functionality for user interaction

Examples:

```md-code__content
current_ui = pyrevit.session.current_ui()
this_script = pyrevit.session.get_this_command()
current_ui.update_button_icon(this_script, new_icon)

```

Returns:

| Type | Description |
| --- | --- |
| `_PyRevitUI` | wrapper around active ribbon gui |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>1697<br>1698<br>1699<br>1700<br>1701<br>1702<br>1703<br>1704<br>1705<br>1706<br>1707<br>1708<br>1709<br>1710<br>1711<br>1712<br>``` | ````md-code__content<br>def get_current_ui(all_native=False):<br>    """Revit UI Wrapper class for interacting with current pyRevit UI.<br>    Returned class provides min required functionality for user interaction<br>    Examples:<br>        ```python<br>        current_ui = pyrevit.session.current_ui()<br>        this_script = pyrevit.session.get_this_command()<br>        current_ui.update_button_icon(this_script, new_icon)<br>        ```<br>    Returns:<br>        (_PyRevitUI): wrapper around active ribbon gui<br>    """<br>    return _PyRevitUI(all_native=all_native)<br>```` |

### `get_uibutton(command_unique_name)`

Find and return ribbon ui button with given unique id.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `command_unique_name` | `str` | unique id of pyRevit command | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `_PyRevitRibbonButton` | ui button wrapper object |

Source code in `pyrevitlib/pyrevit/coreutils/ribbon.py`

|     |     |
| --- | --- |
| ```<br>1715<br>1716<br>1717<br>1718<br>1719<br>1720<br>1721<br>1722<br>1723<br>1724<br>1725<br>1726<br>1727<br>1728<br>1729<br>1730<br>``` | ```md-code__content<br>def get_uibutton(command_unique_name):<br>    """Find and return ribbon ui button with given unique id.<br>    Args:<br>        command_unique_name (str): unique id of pyRevit command<br>    Returns:<br>        (_PyRevitRibbonButton): ui button wrapper object<br>    """<br>    # FIXME: verify return type<br>    pyrvt_tabs = get_current_ui().get_pyrevit_tabs()<br>    for tab in pyrvt_tabs:<br>        button = tab.find_child(command_unique_name)<br>        if button:<br>            return button<br>    return None<br>``` |

Back to top

## BIM360 Collaboration Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/bim360/#pyrevit.revit.bim360)

# bim360

BIM360-related utilities.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `COLLAB_CACHE_PATH_FORMAT = '%LOCALAPPDATA%/Autodesk/Revit/Autodesk Revit {version}/CollaborationCache'``module-attribute`

## Classes

### `CollabCacheModel(model_path)`

Bases: `object`

Collaboration cache for a Revit project.

Source code in `pyrevitlib/pyrevit/revit/bim360.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>``` | ```md-code__content<br>def __init__(self, model_path):<br>    self.model_path = model_path<br>    self.model_dir = op.dirname(model_path)<br>    self.model_name_ex = op.basename(model_path)<br>    self.model_name = op.splitext(self.model_name_ex)[0]<br>    self.central_cache_model_path = \<br>        op.join(self.model_dir, 'CentralCache', self.model_name_ex)<br>    self.model_backup_path = \<br>        op.join(self.model_dir, '{}_backup'.format(self.model_name))<br>    try:<br>        finfo = files.get_file_info(self.model_path)<br>        self.product = finfo.RevitProduct.Name<br>        self.project = op.basename(finfo.CentralModelPath)<br>    except Exception:<br>        self.product = "?"<br>        self.project = self.model_name_ex<br>``` |

#### Attributes

##### `model_path = model_path``instance-attribute`

##### `model_dir = op.dirname(model_path)``instance-attribute`

##### `model_name_ex = op.basename(model_path)``instance-attribute`

##### `model_name = op.splitext(self.model_name_ex)[0]``instance-attribute`

##### `central_cache_model_path = op.join(self.model_dir, 'CentralCache', self.model_name_ex)``instance-attribute`

##### `model_backup_path = op.join(self.model_dir, '{}_backup'.format(self.model_name))``instance-attribute`

##### `product = finfo.RevitProduct.Name``instance-attribute`

##### `project = op.basename(finfo.CentralModelPath)``instance-attribute`

### `CollabCache(cache_path)`

Bases: `object`

Collaboration cache instance containing multiple projects.

Source code in `pyrevitlib/pyrevit/revit/bim360.py`

|     |     |
| --- | --- |
| ```<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>``` | ```md-code__content<br>def __init__(self, cache_path):<br>    self.cache_path = cache_path<br>    self.cache_id = op.basename(cache_path)<br>    self.cache_models = []<br>    for entry in os.listdir(self.cache_path):<br>        if entry.lower().endswith('.rvt'):<br>            self.cache_models.append(<br>                CollabCacheModel(op.join(cache_path, entry))<br>                )<br>    self.cache_linked_models = []<br>    lmodels_path = op.join(self.cache_path, 'LinkedModels')<br>    if op.exists(lmodels_path):<br>        for entry in os.listdir(lmodels_path):<br>            if entry.lower().endswith('.rvt'):<br>                self.cache_linked_models.append(<br>                    CollabCacheModel(op.join(lmodels_path, entry))<br>                    )<br>``` |

#### Attributes

##### `cache_path = cache_path``instance-attribute`

##### `cache_id = op.basename(cache_path)``instance-attribute`

##### `cache_models = []``instance-attribute`

##### `cache_linked_models = []``instance-attribute`

## Functions

### `get_collab_caches()`

Get a list of project caches stored under collaboration cache.

Source code in `pyrevitlib/pyrevit/revit/bim360.py`

|     |     |
| --- | --- |
| ```<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>``` | ```md-code__content<br>def get_collab_caches():<br>    """Get a list of project caches stored under collaboration cache."""<br>    collab_root = op.normpath(op.expandvars(<br>        COLLAB_CACHE_PATH_FORMAT.format(version=HOST_APP.version)<br>    ))<br>    mlogger.debug('cache root: %s', collab_root)<br>    collab_caches = []<br>    if op.exists(collab_root):<br>        for cache_root in os.listdir(collab_root):<br>            cache_root_path = op.join(collab_root, cache_root)<br>            for cache_inst in os.listdir(cache_root_path):<br>                cache_inst_path = op.join(cache_root_path, cache_inst)<br>                mlogger.debug('cache inst: %s', cache_inst_path)<br>                if op.isdir(cache_inst_path):<br>                    collab_caches.append(<br>                        CollabCache(cache_inst_path)<br>                        )<br>    return collab_caches<br>``` |

### `clear_model_cache(collab_cache_model)`

Clear caches for given collaboration cache model.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `collab_cache_model` | `CollabCacheModel` | cache model to clear | _required_ |

Source code in `pyrevitlib/pyrevit/revit/bim360.py`

|     |     |
| --- | --- |
| ```<br> 92<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>``` | ```md-code__content<br>def clear_model_cache(collab_cache_model):<br>    """Clear caches for given collaboration cache model.<br>    Args:<br>        collab_cache_model (bim360.CollabCacheModel): cache model to clear<br>    """<br>    if isinstance(collab_cache_model, CollabCacheModel):<br>        cm = collab_cache_model<br>        mlogger.debug('Deleting %s', cm.model_path)<br>        try:<br>            if op.exists(cm.model_path):<br>                os.remove(cm.model_path)<br>        except Exception as cmdel_ex:<br>            mlogger.error(<br>                'Error deleting model cache @ %s | %s',<br>                cm.model_path,<br>                str(cmdel_ex)<br>                )<br>        mlogger.debug('Deleting %s', cm.model_backup_path)<br>        try:<br>            if op.exists(cm.model_backup_path):<br>                coreutils.fully_remove_dir(cm.model_backup_path)<br>        except Exception as cmbdel_ex:<br>            mlogger.error(<br>                'Error deleting model backup @ %s | %s',<br>                cm.model_backup_path,<br>                str(cmbdel_ex)<br>                )<br>        mlogger.debug('Deleting %s', cm.central_cache_model_path)<br>        try:<br>            if op.exists(cm.central_cache_model_path):<br>                os.remove(cm.central_cache_model_path)<br>        except Exception as ccmdel_ex:<br>            mlogger.error(<br>                'Error deleting central model cache @ %s | %s',<br>                cm.central_cache_model_path,<br>                str(ccmdel_ex)<br>                )<br>``` |

Back to top

## PTS PointCloud File Operations
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/pts/#pyrevit.interop.pts)

# pts

Read and Write PTS PointCloud Files.

## Functions

### `load(inputfile)`

Read list of point tuple from PTS file.

Source code in `pyrevitlib/pyrevit/interop/pts.py`

|     |     |
| --- | --- |
| ```<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>``` | ```md-code__content<br>def load(inputfile):<br>    """Read list of point tuple from PTS file."""<br>    points = []<br>    with open(inputfile, 'r') as ptsfile:<br>        # point_count = int(ptsfile.readline())   #noqa<br>        for line in ptsfile:<br>            data = line.split(' ')<br>            points.append(((float(data[0]), float(data[1]), float(data[2])),<br>                           int(data[3]),<br>                           (int(data[4]), int(data[5]), int(data[6])))<br>                          )<br>    return points<br>``` |

### `dump(outputfile, points)`

Write list of point tuple to PTS file.

Source code in `pyrevitlib/pyrevit/interop/pts.py`

|     |     |
| --- | --- |
| ```<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>``` | ```md-code__content<br>def dump(outputfile, points):<br>    """Write list of point tuple to PTS file."""<br>    point_count = len(points)<br>    with open(outputfile, 'w') as ptsfile:<br>        ptsfile.write(str(point_count) + '\n')<br>        for coord, intensity, color in points:<br>            x, y, z = coord<br>            r, g, b = color<br>            ptsfile.write('{:.10f} {:.10f} {:.10f} '<br>                          '{} '<br>                          '{:03} {:03} {:03}\n'.format(x, y, z,<br>                                                       intensity,<br>                                                       r, g, b))<br>``` |

Back to top

## API Routing Server
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/routes/server/#pyrevit.routes.server)

# server

Handles http api routing and serving with usage similar to flask.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Classes

### `Request(path='/', method='GET', data=None, params=None)`

Bases: `object`

Request wrapper object.

Source code in `pyrevitlib/pyrevit/routes/server/base.py`

|     |     |
| --- | --- |
| ```<br>22<br>23<br>24<br>25<br>26<br>27<br>``` | ```md-code__content<br>def __init__(self, path='/', method='GET', data=None, params=None):<br>    self.path = path<br>    self.method = method<br>    self.data = data<br>    self._headers = {}<br>    self._params = params or []<br>``` |

#### Attributes

##### `path = path``instance-attribute`

##### `method = method``instance-attribute`

##### `data = data``instance-attribute`

##### `headers``property`

Request headers dict.

##### `params``property`

Request parameters.

##### `callback_url``property`

Request callback url, if provided in payload.

#### Functions

##### `add_header(key, value)`

Add new header key:value.

Source code in `pyrevitlib/pyrevit/routes/server/base.py`

|     |     |
| --- | --- |
| ```<br>46<br>47<br>48<br>``` | ```md-code__content<br>def add_header(self, key, value):<br>    """Add new header key:value."""<br>    self._headers[key] = value<br>``` |

### `Response(status=200, data=None, headers=None)`

Bases: `object`

Response wrapper object.

Source code in `pyrevitlib/pyrevit/routes/server/base.py`

|     |     |
| --- | --- |
| ```<br>53<br>54<br>55<br>56<br>``` | ```md-code__content<br>def __init__(self, status=200, data=None, headers=None):<br>    self.status = status<br>    self.data = data<br>    self._headers = headers or {}<br>``` |

#### Attributes

##### `status = status``instance-attribute`

##### `data = data``instance-attribute`

##### `headers``property`

Response headers dict.

#### Functions

##### `add_header(key, value)`

Add new header key:value.

Source code in `pyrevitlib/pyrevit/routes/server/base.py`

|     |     |
| --- | --- |
| ```<br>63<br>64<br>65<br>``` | ```md-code__content<br>def add_header(self, key, value):<br>    """Add new header key:value."""<br>    self._headers[key] = value<br>``` |

## Functions

### `init()`

Initialize routes. Reset all registered routes and shutdown servers.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>32<br>33<br>34<br>35<br>36<br>37<br>``` | ```md-code__content<br>def init():<br>    """Initialize routes. Reset all registered routes and shutdown servers."""<br>    # clear all routes<br>    router.reset_routes()<br>    # stop existing server<br>    deactivate_server()<br>``` |

### `activate_server()`

Activate routes server for this host instance.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>``` | ```md-code__content<br>def activate_server():<br>    """Activate routes server for this host instance."""<br>    routes_server = envvars.get_pyrevit_env_var(envvars.ROUTES_SERVER)<br>    if not routes_server:<br>        try:<br>            rsinfo = serverinfo.register()<br>            routes_server = \<br>                server.RoutesServer(<br>                    host=rsinfo.server_host,<br>                    port=rsinfo.server_port<br>                    )<br>            routes_server.start()<br>            envvars.set_pyrevit_env_var(envvars.ROUTES_SERVER, routes_server)<br>            return routes_server<br>        except Exception as rs_ex:<br>            serverinfo.unregister()<br>            mlogger.error("Error starting Routes server | %s", str(rs_ex))<br>``` |

### `deactivate_server()`

Deactivate the active routes server for this host instance.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>``` | ```md-code__content<br>def deactivate_server():<br>    """Deactivate the active routes server for this host instance."""<br>    routes_server = envvars.get_pyrevit_env_var(envvars.ROUTES_SERVER)<br>    if routes_server:<br>        try:<br>            routes_server.stop()<br>            envvars.set_pyrevit_env_var(envvars.ROUTES_SERVER, None)<br>            serverinfo.unregister()<br>        except Exception as rs_ex:<br>            mlogger.error("Error stopping Routes server | %s", str(rs_ex))<br>``` |

### `get_active_server()`

Get active routes server for this host instance.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>71<br>72<br>73<br>``` | ```md-code__content<br>def get_active_server():<br>    """Get active routes server for this host instance."""<br>    return envvars.get_pyrevit_env_var(envvars.ROUTES_SERVER)<br>``` |

### `make_response(data, status=OK, headers=None)`

Create Reponse object with.

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>76<br>77<br>78<br>79<br>80<br>81<br>``` | ```md-code__content<br>def make_response(data, status=OK, headers=None):<br>    """Create Reponse object with."""<br>    res = Response(status=status, data=data)<br>    for key, value in (headers or {}).items():<br>        res.add_header(key, value)<br>    return res<br>``` |

### `get_routes(api_name)`

Get all registered routes for given API name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `api_name` | `str` | unique name of the api | _required_ |

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>``` | ```md-code__content<br>def get_routes(api_name):<br>    """Get all registered routes for given API name.<br>    Args:<br>        api_name (str): unique name of the api<br>    """<br>    return router.get_routes(api_name)<br>``` |

### `add_route(api_name, pattern, method, handler_func)`

Add new route for given API name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `api_name` | `str` | unique name of the api | _required_ |
| `pattern` | `str` | route pattern | _required_ |
| `method` | `str` | method name | _required_ |
| `handler_func` | `function` | route handler function | _required_ |

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>``` | ```md-code__content<br>def add_route(api_name, pattern, method, handler_func):<br>    """Add new route for given API name.<br>    Args:<br>        api_name (str): unique name of the api<br>        pattern (str): route pattern<br>        method (str): method name<br>        handler_func (function): route handler function<br>    """<br>    return router.add_route(api_name, pattern, method, handler_func)<br>``` |

### `remove_route(api_name, pattern, method)`

Remove previously registered route for given API name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `api_name` | `str` | unique name of the api | _required_ |
| `pattern` | `str` | route pattern | _required_ |
| `method` | `str` | method name | _required_ |

Source code in `pyrevitlib/pyrevit/routes/server/__init__.py`

|     |     |
| --- | --- |
| ```<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>``` | ```md-code__content<br>def remove_route(api_name, pattern, method):<br>    """Remove previously registered route for given API name.<br>    Args:<br>        api_name (str): unique name of the api<br>        pattern (str): route pattern<br>        method (str): method name<br>    """<br>    return router.remove_route(api_name, pattern, method)<br>``` |

Back to top

## IxMIlia.Dxf Assembly
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/dxf/#pyrevit.interop.dxf)

# dxf

IxMIlia.Dxf assembly import.

## Attributes

Back to top

## PyRevit Runtime Types
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/types/#pyrevit.runtime.types)

# types

Provide access to classes and functionalty inside base loader module.

## Attributes

Back to top

## WPF Component Utilities
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/forms/utils/#pyrevit.forms.utils)

# utils

Utility functions to support forms module.

## Functions

### `bitmap_from_file(bitmap_file)`

Create BitmapImage from a bitmap file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `bitmap_file` | `str` | path to bitmap file | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `BitmapImage` | bitmap image object |

Source code in `pyrevitlib/pyrevit/forms/utils.py`

|     |     |
| --- | --- |
| ```<br> 7<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>``` | ```md-code__content<br>def bitmap_from_file(bitmap_file):<br>    """Create BitmapImage from a bitmap file.<br>    Args:<br>        bitmap_file (str): path to bitmap file<br>    Returns:<br>        (BitmapImage): bitmap image object<br>    """<br>    bitmap = Imaging.BitmapImage()<br>    bitmap.BeginInit()<br>    bitmap.UriSource = framework.Uri(bitmap_file)<br>    bitmap.CacheOption = Imaging.BitmapCacheOption.OnLoad<br>    bitmap.CreateOptions = Imaging.BitmapCreateOptions.IgnoreImageCache<br>    bitmap.EndInit()<br>    bitmap.Freeze()<br>    return bitmap<br>``` |

### `load_component(xaml_file, comp_type)`

Load WPF component from xaml file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_file` | `str` | xaml file path | _required_ |
| `comp_type` | `Controls` | WPF control type | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `Controls` | loaded WPF control |

Source code in `pyrevitlib/pyrevit/forms/utils.py`

|     |     |
| --- | --- |
| ```<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>``` | ```md-code__content<br>def load_component(xaml_file, comp_type):<br>    """Load WPF component from xaml file.<br>    Args:<br>        xaml_file (str): xaml file path<br>        comp_type (System.Windows.Controls): WPF control type<br>    Returns:<br>        (System.Windows.Controls): loaded WPF control<br>    """<br>    return wpf.LoadComponent(comp_type, xaml_file)<br>``` |

### `load_ctrl_template(xaml_file)`

Load System.Windows.Controls.ControlTemplate from xaml file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_file` | `str` | xaml file path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `ControlTemplate` | loaded control template |

Source code in `pyrevitlib/pyrevit/forms/utils.py`

|     |     |
| --- | --- |
| ```<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>``` | ```md-code__content<br>def load_ctrl_template(xaml_file):<br>    """Load System.Windows.Controls.ControlTemplate from xaml file.<br>    Args:<br>        xaml_file (str): xaml file path<br>    Returns:<br>        (System.Windows.Controls.ControlTemplate): loaded control template<br>    """<br>    return load_component(xaml_file, Controls.ControlTemplate())<br>``` |

### `load_itemspanel_template(xaml_file)`

Load System.Windows.Controls.ItemsPanelTemplate from xaml file.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `xaml_file` | `str` | xaml file path | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `ControlTemplate` | loaded items-panel template |

Source code in `pyrevitlib/pyrevit/forms/utils.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>``` | ```md-code__content<br>def load_itemspanel_template(xaml_file):<br>    """Load System.Windows.Controls.ItemsPanelTemplate from xaml file.<br>    Args:<br>        xaml_file (str): xaml file path<br>    Returns:<br>        (System.Windows.Controls.ControlTemplate): loaded items-panel template<br>    """<br>    return load_component(xaml_file, Controls.ItemsPanelTemplate())<br>``` |

Back to top

## Telemetry Records Overview
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/telemetry/record/#pyrevit.telemetry.record)

# record

Provides base class for telemetry records.

## Attributes

## Classes

### `CommandCustomResults`

Bases: `object`

Wrapper around ScriptExecutor's EXEC\_PARAMS.result\_dict.

ScriptExecutor provides this results dictionary to all scripts, and scripts
can add key:value pairs to the dictionary. But since the provided
dictionary is a C# dictionary, this class provides a very easy
to use wrapper around it.

Examples:

```md-code__content
CommandCustomResults().returnparam = 'some return value'

```

#### Attributes

##### `RESERVED_NAMES = ['time', 'username', 'revit', 'revitbuild', 'sessionid', 'pyrevit', 'debug', 'config', 'commandname', 'result', 'source']``class-attribute``instance-attribute`

Back to top

## pyRevit Session Manager
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/loader/sessionmgr/#pyrevit.loader.sessionmgr)

# sessionmgr

The loader module manages the workflow of loading a new pyRevit session.

Its main purpose is to orchestrate the process of finding pyRevit extensions,
creating dll assemblies for them, and creating a user interface
in the host application.

Everything starts from `sessionmgr.load_session()` function...

The only public function is `load_session()` that loads a new session.
Everything else is private.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `AssembledExtension = namedtuple('AssembledExtension', ['ext', 'assm'])``module-attribute`

### `pyrevit_extcmdtype_cache = []``module-attribute`

## Classes

### `PyRevitExternalCommandType(extcmd_type, extcmd_availtype)`

Bases: `object`

PyRevit external command type.

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>334<br>335<br>336<br>337<br>338<br>339<br>340<br>341<br>342<br>``` | ```md-code__content<br>def __init__(self, extcmd_type, extcmd_availtype):<br>    self._extcmd_type = extcmd_type<br>    self._extcmd = extcmd_type()<br>    if extcmd_availtype:<br>        self._extcmd_availtype = extcmd_availtype<br>        self._extcmd_avail = extcmd_availtype()<br>    else:<br>        self._extcmd_availtype = None<br>        self._extcmd_avail = None<br>``` |

#### Attributes

##### `extcmd_type``property`

##### `typename``property`

##### `extcmd_availtype``property`

##### `avail_typename``property`

##### `script``property`

##### `config_script``property`

##### `search_paths``property`

##### `arguments``property`

##### `engine_cfgs``property`

##### `helpsource``property`

##### `tooltip``property`

##### `name``property`

##### `bundle``property`

##### `extension``property`

##### `unique_id``property`

#### Functions

##### `is_available(category_set, zerodoc=False)`

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>``` | ```md-code__content<br>def is_available(self, category_set, zerodoc=False):<br>    if self._extcmd_availtype:<br>        return self._extcmd_avail.IsCommandAvailable(HOST_APP.uiapp,<br>                                                     category_set)<br>    elif not zerodoc:<br>        return True<br>    return False<br>``` |

## Functions

### `load_session()`

Handles loading/reloading of the pyRevit addin and extensions.

To create a proper ui, pyRevit extensions needs to be properly parsed and
a dll assembly needs to be created. This function handles these tasks
through interactions with .extensions, .loader.asmmaker, and .loader.uimaker.

Examples:

```md-code__content
from pyrevit.loader.sessionmgr import load_session
load_session()     # start loading a new pyRevit session

```

Returns:

| Type | Description |
| --- | --- |
| `str` | sesion uuid |

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>260<br>261<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>285<br>286<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>302<br>303<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>``` | ````md-code__content<br>def load_session():<br>    """Handles loading/reloading of the pyRevit addin and extensions.<br>    To create a proper ui, pyRevit extensions needs to be properly parsed and<br>    a dll assembly needs to be created. This function handles these tasks<br>    through interactions with .extensions, .loader.asmmaker, and .loader.uimaker.<br>    Examples:<br>        ```python<br>        from pyrevit.loader.sessionmgr import load_session<br>        load_session()     # start loading a new pyRevit session<br>        ```<br>    Returns:<br>        (str): sesion uuid<br>    """<br>    # setup runtime environment variables<br>    sessioninfo.setup_runtime_vars()<br>    # the loader dll addon, does not create an output window<br>    # if an output window is not provided, create one<br>    if EXEC_PARAMS.first_load:<br>        output_window = _setup_output()<br>    else:<br>        from pyrevit import script<br>        output_window = script.get_output()<br>    # initialize timer to measure load time<br>    timer = Timer()<br>    # perform pre-load tasks<br>    _perform_onsessionloadstart_ops()<br>    # create a new session<br>    _new_session()<br>    # perform post-load tasks<br>    _perform_onsessionloadcomplete_ops()<br>    # log load time and thumbs-up :)<br>    endtime = timer.get_time()<br>    success_emoji = ':OK_hand:' if endtime < 3.00 else ':thumbs_up:'<br>    mlogger.info('Load time: %s seconds %s', endtime, success_emoji)<br>    # if everything went well, self destruct<br>    try:<br>        timeout = user_config.startuplog_timeout<br>        if timeout > 0 and not logger.loggers_have_errors():<br>            if EXEC_PARAMS.first_load:<br>                # output_window is of type ScriptConsole<br>                output_window.SelfDestructTimer(timeout)<br>            else:<br>                # output_window is of type PyRevitOutputWindow<br>                output_window.self_destruct(timeout)<br>    except Exception as imp_err:<br>        mlogger.error('Error setting up self_destruct on output window | %s',<br>                      imp_err)<br>    _cleanup_output()<br>    return sessioninfo.get_session_uuid()<br>```` |

### `reload_pyrevit()`

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>321<br>322<br>323<br>324<br>325<br>326<br>``` | ```md-code__content<br>def reload_pyrevit():<br>    _perform_onsessionreload_ops()<br>    mlogger.info('Reloading....')<br>    session_Id = load_session()<br>    _perform_onsessionreloadcomplete_ops()<br>    return session_Id<br>``` |

### `find_all_commands(category_set=None, cache=True)`

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>419<br>420<br>421<br>422<br>423<br>424<br>425<br>426<br>427<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>447<br>448<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>``` | ```md-code__content<br>def find_all_commands(category_set=None, cache=True):<br>    global pyrevit_extcmdtype_cache    #pylint: disable=W0603<br>    if cache and pyrevit_extcmdtype_cache:    #pylint: disable=E0601<br>        pyrevit_extcmds = pyrevit_extcmdtype_cache<br>    else:<br>        pyrevit_extcmds = []<br>        for loaded_assm_name in sessioninfo.get_loaded_pyrevit_assemblies():<br>            loaded_assm = assmutils.find_loaded_asm(loaded_assm_name)<br>            if loaded_assm:<br>                all_exported_types = loaded_assm[0].GetTypes()<br>                for pyrvt_type in all_exported_types:<br>                    tname = pyrvt_type.FullName<br>                    availtname = pyrvt_type.Name \<br>                                 + runtime.CMD_AVAIL_NAME_POSTFIX<br>                    pyrvt_availtype = None<br>                    if not tname.endswith(runtime.CMD_AVAIL_NAME_POSTFIX)\<br>                            and runtime.RUNTIME_NAMESPACE not in tname:<br>                        for exported_type in all_exported_types:<br>                            if exported_type.Name == availtname:<br>                                pyrvt_availtype = exported_type<br>                        pyrevit_extcmds.append(<br>                            PyRevitExternalCommandType(pyrvt_type,<br>                                                       pyrvt_availtype)<br>                            )<br>        if cache:<br>            pyrevit_extcmdtype_cache = pyrevit_extcmds<br>    # now check commands in current context if requested<br>    if category_set:<br>        return [x for x in pyrevit_extcmds<br>                if x.is_available(category_set=category_set,<br>                                  zerodoc=HOST_APP.uidoc is None)]<br>    else:<br>        return pyrevit_extcmds<br>``` |

### `find_all_available_commands(use_current_context=True, cache=True)`

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>``` | ```md-code__content<br>def find_all_available_commands(use_current_context=True, cache=True):<br>    if use_current_context:<br>        cset = revit.get_selection_category_set()<br>    else:<br>        cset = None<br>    return find_all_commands(category_set=cset, cache=cache)<br>``` |

### `find_pyrevitcmd(pyrevitcmd_unique_id)`

Find a pyRevit command.

Searches the pyRevit-generated assemblies under current session for
the command with the matching unique name (class name) and returns the
command type. Notice that this returned value is a 'type' and should be
instantiated before use.

Examples:

```md-code__content
cmd = find_pyrevitcmd('pyRevitCorepyRevitpyRevittoolsReload')
command_instance = cmd()
command_instance.Execute() # Provide commandData, message, elements

```

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrevitcmd_unique_id` | `str` | Unique name for the command | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `type` | Type for the command with matching unique name |

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>467<br>468<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>478<br>479<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>495<br>496<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>``` | ````md-code__content<br>def find_pyrevitcmd(pyrevitcmd_unique_id):<br>    """Find a pyRevit command.<br>    Searches the pyRevit-generated assemblies under current session for<br>    the command with the matching unique name (class name) and returns the<br>    command type. Notice that this returned value is a 'type' and should be<br>    instantiated before use.<br>    Examples:<br>        ```python<br>        cmd = find_pyrevitcmd('pyRevitCorepyRevitpyRevittoolsReload')<br>        command_instance = cmd()<br>        command_instance.Execute() # Provide commandData, message, elements<br>        ```<br>    Args:<br>        pyrevitcmd_unique_id (str): Unique name for the command<br>    Returns:<br>        (type):Type for the command with matching unique name<br>    """<br>    # go through assmebles loaded under current pyRevit session<br>    # and try to find the command<br>    mlogger.debug('Searching for pyrevit command: %s', pyrevitcmd_unique_id)<br>    for loaded_assm_name in sessioninfo.get_loaded_pyrevit_assemblies():<br>        mlogger.debug('Expecting assm: %s', loaded_assm_name)<br>        loaded_assm = assmutils.find_loaded_asm(loaded_assm_name)<br>        if loaded_assm:<br>            mlogger.debug('Found assm: %s', loaded_assm_name)<br>            for pyrvt_type in loaded_assm[0].GetTypes():<br>                mlogger.debug('Found Type: %s', pyrvt_type)<br>                if pyrvt_type.FullName == pyrevitcmd_unique_id:<br>                    mlogger.debug('Found pyRevit command in %s',<br>                                  loaded_assm_name)<br>                    return pyrvt_type<br>            mlogger.debug('Could not find pyRevit command.')<br>        else:<br>            mlogger.debug('Can not find assm: %s', loaded_assm_name)<br>    return None<br>```` |

### `create_tmp_commanddata()`

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>509<br>510<br>511<br>512<br>513<br>514<br>515<br>516<br>517<br>518<br>``` | ```md-code__content<br>def create_tmp_commanddata():<br>    tmp_cmd_data = \<br>        framework.FormatterServices.GetUninitializedObject(<br>            UI.ExternalCommandData<br>            )<br>    tmp_cmd_data.Application = HOST_APP.uiapp<br>    # tmp_cmd_data.IsReadOnly = False<br>    # tmp_cmd_data.View = None<br>    # tmp_cmd_data.JournalData = None<br>    return tmp_cmd_data<br>``` |

### `execute_command_cls(extcmd_type, arguments=None, config_mode=False, exec_from_ui=False)`

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>543<br>``` | ```md-code__content<br>def execute_command_cls(extcmd_type, arguments=None,<br>                        config_mode=False, exec_from_ui=False):<br>    command_instance = extcmd_type()<br>    # pass the arguments to the instance<br>    if arguments:<br>        command_instance.ScriptRuntimeConfigs.Arguments = \<br>            framework.List[str](arguments)<br>    # this is a manual execution from python code and not by user<br>    command_instance.ExecConfigs.MimicExecFromUI = exec_from_ui<br>    # force using the config script<br>    command_instance.ExecConfigs.UseConfigScript = config_mode<br>    # Execute(<br>    # ExternalCommandData commandData,<br>    # string message,<br>    # ElementSet elements<br>    # )<br>    re = command_instance.Execute(create_tmp_commanddata(),<br>                                  '',<br>                                  DB.ElementSet())<br>    command_instance = None<br>    return re<br>``` |

### `execute_command(pyrevitcmd_unique_id)`

Executes a pyRevit command.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `pyrevitcmd_unique_id` | `str` | Unique/Class Name of the pyRevit command | _required_ |

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>546<br>547<br>548<br>549<br>550<br>551<br>552<br>553<br>554<br>555<br>556<br>557<br>558<br>559<br>``` | ```md-code__content<br>def execute_command(pyrevitcmd_unique_id):<br>    """Executes a pyRevit command.<br>    Args:<br>        pyrevitcmd_unique_id (str): Unique/Class Name of the pyRevit command<br>    """<br>    cmd_class = find_pyrevitcmd(pyrevitcmd_unique_id)<br>    if not cmd_class:<br>        mlogger.error('Can not find command with unique name: %s',<br>                      pyrevitcmd_unique_id)<br>        return None<br>    else:<br>        execute_command_cls(cmd_class)<br>``` |

### `execute_extension_startup_script(script_path, ext_name, sys_paths=None)`

Executes a script using pyRevit script executor.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `script_path` | `str` | Address of the script file | _required_ |
| `ext_name` | `str` | Name of the extension | _required_ |
| `sys_paths` | `list` | additional search paths | `None` |

Source code in `pyrevitlib/pyrevit/loader/sessionmgr.py`

|     |     |
| --- | --- |
| ```<br>562<br>563<br>564<br>565<br>566<br>567<br>568<br>569<br>570<br>571<br>572<br>573<br>574<br>575<br>576<br>577<br>578<br>579<br>580<br>581<br>582<br>583<br>584<br>585<br>586<br>587<br>588<br>589<br>590<br>591<br>592<br>593<br>594<br>595<br>596<br>597<br>598<br>599<br>600<br>601<br>602<br>603<br>604<br>``` | ```md-code__content<br>def execute_extension_startup_script(script_path, ext_name, sys_paths=None):<br>    """Executes a script using pyRevit script executor.<br>    Args:<br>        script_path (str): Address of the script file<br>        ext_name (str): Name of the extension<br>        sys_paths (list): additional search paths<br>    """<br>    core_syspaths = [MAIN_LIB_DIR, MISC_LIB_DIR]<br>    if sys_paths:<br>        sys_paths.extend(core_syspaths)<br>    else:<br>        sys_paths = core_syspaths<br>    script_data = runtime.types.ScriptData()<br>    script_data.ScriptPath = script_path<br>    script_data.ConfigScriptPath = None<br>    script_data.CommandUniqueId = ''<br>    script_data.CommandName = 'Starting {}'.format(ext_name)<br>    script_data.CommandBundle = ''<br>    script_data.CommandExtension = ext_name<br>    script_data.HelpSource = ''<br>    script_runtime_cfg = runtime.types.ScriptRuntimeConfigs()<br>    script_runtime_cfg.CommandData = create_tmp_commanddata()<br>    script_runtime_cfg.SelectedElements = None<br>    script_runtime_cfg.SearchPaths = framework.List[str](sys_paths or [])<br>    script_runtime_cfg.Arguments = framework.List[str]([])<br>    script_runtime_cfg.EngineConfigs = \<br>        runtime.create_ipyengine_configs(<br>            clean=True,<br>            full_frame=True,<br>            persistent=True,<br>        )<br>    script_runtime_cfg.RefreshEngine = False<br>    script_runtime_cfg.ConfigMode = False<br>    script_runtime_cfg.DebugMode = False<br>    script_runtime_cfg.ExecutedFromUI = False<br>    runtime.types.ScriptExecutor.ExecuteScript(<br>        script_data,<br>        script_runtime_cfg<br>    )<br>``` |

Back to top

## Server Management API
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/routes/api/#pyrevit.routes.api)

# api

Builtin routes API.

This module also provides the API object to be used by third-party
api developers to define new apis

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `routes_api = routes.API('routes')``module-attribute`

## Functions

### `get_status()`

Get server status.

Source code in `pyrevitlib/pyrevit/routes/api.py`

|     |     |
| --- | --- |
| ```<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>``` | ```md-code__content<br>@routes_api.route('/status', methods=['GET'])<br>def get_status():<br>    """Get server status."""<br>    return {<br>        "host": HOST_APP.pretty_name,<br>        "username": HOST_APP.username,<br>        "session_id": sessioninfo.get_session_uuid(),<br>        }<br>``` |

### `get_sisters()`

Get other servers running on the same machine.

Source code in `pyrevitlib/pyrevit/routes/api.py`

|     |     |
| --- | --- |
| ```<br>35<br>36<br>37<br>38<br>``` | ```md-code__content<br>@routes_api.route('/sisters', methods=['GET'])<br>def get_sisters():<br>    """Get other servers running on the same machine."""<br>    return [x.get_cache_data() for x in serverinfo.get_registered_servers()]<br>``` |

### `get_sisters_by_year(version)`

Get servers of specific version, running on the same machine.

Source code in `pyrevitlib/pyrevit/routes/api.py`

|     |     |
| --- | --- |
| ```<br>42<br>43<br>44<br>45<br>46<br>``` | ```md-code__content<br>@routes_api.route('/sisters/<int:version>', methods=['GET'])<br>def get_sisters_by_year(version):<br>    """Get servers of specific version, running on the same machine."""<br>    return [x.get_cache_data() for x in serverinfo.get_registered_servers()<br>            if int(x.version) == version]<br>``` |

Back to top

## Python Script Type Maker
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/runtime/dynamotypemaker/#pyrevit.runtime.dynamotypemaker)

# dynamotypemaker

Prepare and compile python script types.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

## Functions

### `create_executor_type(extension, module_builder, cmd_component)`

Create the dotnet type for the executor.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `extension` | `Extension` | pyRevit extension | _required_ |
| `module_builder` | `ModuleBuilder` | module builder | _required_ |
| `cmd_component` | `GenericUICommand` | command | _required_ |

Source code in `pyrevitlib/pyrevit/runtime/dynamotypemaker.py`

|     |     |
| --- | --- |
| ```<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>``` | ```md-code__content<br>def create_executor_type(extension, module_builder, cmd_component):<br>    """Create the dotnet type for the executor.<br>    Args:<br>        extension (pyrevit.extensions.components.Extension): pyRevit extension<br>        module_builder (ModuleBuilder): module builder<br>        cmd_component (pyrevit.extensions.genericcomps.GenericUICommand):<br>            command<br>    """<br>    engine_configs = json.dumps({<br>        exts.MDATA_ENGINE_CLEAN:<br>            cmd_component.requires_clean_engine,<br>        exts.MDATA_ENGINE_DYNAMO_AUTOMATE:<br>            cmd_component.requires_mainthread_engine,<br>        exts.MDATA_ENGINE_DYNAMO_PATH:<br>            cmd_component.dynamo_path,<br>        # exts.MDATA_ENGINE_DYNAMO_PATH_EXEC:<br>        #     cmd_component.dynamo_path_exec,<br>        exts.MDATA_ENGINE_DYNAMO_PATH_CHECK_EXIST:<br>            cmd_component.dynamo_path_check_existing,<br>        exts.MDATA_ENGINE_DYNAMO_FORCE_MANUAL_RUN:<br>            cmd_component.dynamo_force_manual_run,<br>        exts.MDATA_ENGINE_DYNAMO_MODEL_NODES_INFO:<br>            cmd_component.dynamo_model_nodes_info,<br>    })<br>    bundletypemaker.create_executor_type(<br>        extension,<br>        module_builder,<br>        cmd_component,<br>        eng_cfgs=engine_configs<br>        )<br>``` |

Back to top

## Revit Event Handlers
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/events/#pyrevit.revit.events)

# events

Revit events handler management.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `REGISTERED_HANDLERS = {}``module-attribute`

### `HANDLER_UNREGISTERER = FuncAsEventHandler(unregister_exec_handlers, purge=False)``module-attribute`

### `HANDLER_UNREGISTERER_EXTEVENT = UI.ExternalEvent.Create(HANDLER_UNREGISTERER)``module-attribute`

## Classes

### `FuncAsEventHandler(handler_func, purge=True)`

Bases: `IExternalEventHandler`

Turns a function into an event handler.

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>16<br>17<br>18<br>19<br>20<br>``` | ```md-code__content<br>def __init__(self, handler_func, purge=True):<br>    self.name = 'FuncAsEventHandler'<br>    self.handler_group_id = None<br>    self.handler_func = handler_func<br>    self.purge = purge<br>``` |

#### Attributes

##### `name = 'FuncAsEventHandler'``instance-attribute`

##### `handler_group_id = None``instance-attribute`

##### `handler_func = handler_func``instance-attribute`

##### `purge = purge``instance-attribute`

#### Functions

##### `Execute(uiapp)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>22<br>23<br>24<br>25<br>26<br>``` | ```md-code__content<br>def Execute(self, uiapp):<br>    if self.handler_func and self.handler_group_id:<br>        self.handler_func(self.handler_group_id)<br>        if self.purge:<br>            self.handler_group_id = self.handler_func = None<br>``` |

##### `GetName()`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>28<br>29<br>``` | ```md-code__content<br>def GetName(self):<br>    return self.name<br>``` |

## Functions

### `create_handler(handler_func, handler_args_type)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>32<br>33<br>``` | ```md-code__content<br>def create_handler(handler_func, handler_args_type):<br>    return framework.EventHandler[handler_args_type](handler_func)<br>``` |

### `add_handler(event_name, handler_func)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>``` | ```md-code__content<br>def add_handler(event_name, handler_func):<br>    event_handler = None<br>    if event_name == 'doc-changed':<br>        event_handler = \<br>            create_handler(handler_func, DB.Events.DocumentChangedEventArgs)<br>        HOST_APP.app.DocumentChanged += event_handler<br>    elif event_name == 'doc-closed':<br>        event_handler = \<br>            create_handler(handler_func, DB.Events.DocumentClosedEventArgs)<br>        HOST_APP.app.DocumentClosed += event_handler<br>    elif event_name == 'doc-opened':<br>        event_handler = \<br>            create_handler(handler_func, DB.Events.DocumentOpenedEventArgs)<br>        HOST_APP.app.DocumentOpened += event_handler<br>    elif event_name == 'view-activated':<br>        event_handler = \<br>            create_handler(handler_func, UI.Events.ViewActivatedEventArgs)<br>        HOST_APP.uiapp.ViewActivated += event_handler<br>    return event_handler<br>``` |

### `remove_handler(event_name, event_handler)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>``` | ```md-code__content<br>def remove_handler(event_name, event_handler):<br>    if event_name == 'doc-changed':<br>        HOST_APP.app.DocumentChanged -= event_handler<br>    elif event_name == 'doc-closed':<br>        HOST_APP.app.DocumentClosed -= event_handler<br>    elif event_name == 'doc-opened':<br>        HOST_APP.app.DocumentOpened -= event_handler<br>    elif event_name == 'view-activated':<br>        HOST_APP.uiapp.ViewActivated -= event_handler<br>``` |

### `register_handler(event_name, handler_func, handler_group_id)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>76<br>77<br>78<br>79<br>80<br>81<br>``` | ```md-code__content<br>def register_handler(event_name, handler_func, handler_group_id):<br>    if handler_group_id not in REGISTERED_HANDLERS:<br>        REGISTERED_HANDLERS[handler_group_id] = {}<br>    event_handler = add_handler(event_name, handler_func)<br>    if event_handler:<br>        REGISTERED_HANDLERS[handler_group_id][event_name] = event_handler<br>``` |

### `unregister_handler(event_name, handler_func, handler_group_id)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>84<br>85<br>86<br>87<br>88<br>``` | ```md-code__content<br>def unregister_handler(event_name, handler_func, handler_group_id):<br>    if handler_group_id in REGISTERED_HANDLERS \<br>            and event_name in REGISTERED_HANDLERS[handler_group_id]:<br>        event_handler = REGISTERED_HANDLERS[handler_group_id].pop(event_name)<br>        remove_handler(event_name, event_handler)<br>``` |

### `unregister_exec_handlers(handler_group_id)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>91<br>92<br>93<br>94<br>95<br>``` | ```md-code__content<br>def unregister_exec_handlers(handler_group_id):<br>    if handler_group_id in REGISTERED_HANDLERS:<br>        for event_name, handler_func in \<br>                REGISTERED_HANDLERS[handler_group_id].items():<br>            unregister_handler(event_name, handler_func, handler_group_id)<br>``` |

### `delayed_unregister_exec_handlers(handler_group_id)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br> 98<br> 99<br>100<br>``` | ```md-code__content<br>def delayed_unregister_exec_handlers(handler_group_id):<br>    HANDLER_UNREGISTERER.handler_group_id = handler_group_id<br>    HANDLER_UNREGISTERER_EXTEVENT.Raise()<br>``` |

### `handle(*args)`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>``` | ```md-code__content<br>def handle(*args): #pylint: disable=no-method-argument<br>    def decorator(function):<br>        def wrapper(*args, **kwargs):<br>            return function(*args, **kwargs)<br>        for event_name in args:<br>            register_handler(event_name, wrapper, EXEC_PARAMS.exec_id)<br>        return wrapper<br>    return decorator<br>``` |

### `stop_events()`

Source code in `pyrevitlib/pyrevit/revit/events.py`

|     |     |
| --- | --- |
| ```<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>``` | ```md-code__content<br>def stop_events():<br>    if EXEC_PARAMS.exec_id in REGISTERED_HANDLERS:<br>        if HOST_APP.has_api_context:<br>            unregister_exec_handlers(EXEC_PARAMS.exec_id)<br>        else:<br>            # request underegister from external event<br>            delayed_unregister_exec_handlers(EXEC_PARAMS.exec_id)<br>``` |

Back to top

## pyRevit Extensions Parser
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/extensions/parser/#pyrevit.extensions.parser)

# parser

Base module ofr parsing extensions.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

## Functions

### `parse_comp_dir(comp_path, comp_class)`

Source code in `pyrevitlib/pyrevit/extensions/parser.py`

|     |     |
| --- | --- |
| ```<br>100<br>101<br>102<br>103<br>104<br>105<br>``` | ```md-code__content<br>def parse_comp_dir(comp_path, comp_class):<br>    return _create_subcomponents(<br>        comp_path,<br>        _get_subcomponents_classes([comp_class]),<br>        create_from_search_dir=True<br>        )<br>``` |

### `get_parsed_extension(extension)`

Creates and adds the extensions components to the package.

Each package object is the root to a tree of components that exists
under that package. (e.g. tabs, buttons, ...) sub components of package
can be accessed by iterating the \_get\_component.
See \_basecomponents for types.

Source code in `pyrevitlib/pyrevit/extensions/parser.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>``` | ```md-code__content<br>def get_parsed_extension(extension):<br>    """Creates and adds the extensions components to the package.<br>    Each package object is the root to a tree of components that exists<br>    under that package. (e.g. tabs, buttons, ...) sub components of package<br>    can be accessed by iterating the _get_component.<br>    See _basecomponents for types.<br>    """<br>    _parse_for_components(extension)<br>    return extension<br>``` |

### `parse_dir_for_ext_type(root_dir, parent_cmp_type)`

Return the objects of type parent\_cmp\_type of the extensions in root\_dir.

The package objects won't be parsed at this level.
This is useful for collecting basic info on an extension type
for cache cheching or updating extensions using their directory paths.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `root_dir` | `str` | directory to parse | _required_ |
| `parent_cmp_type` | `type` | type of objects to return | _required_ |

Source code in `pyrevitlib/pyrevit/extensions/parser.py`

|     |     |
| --- | --- |
| ```<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>``` | ```md-code__content<br>def parse_dir_for_ext_type(root_dir, parent_cmp_type):<br>    """Return the objects of type parent_cmp_type of the extensions in root_dir.<br>    The package objects won't be parsed at this level.<br>    This is useful for collecting basic info on an extension type<br>    for cache cheching or updating extensions using their directory paths.<br>    Args:<br>        root_dir (str): directory to parse<br>        parent_cmp_type (type): type of objects to return<br>    """<br>    # making sure the provided directory exists.<br>    # This is mainly for the user defined package directories<br>    if not op.exists(root_dir):<br>        mlogger.debug('Extension search directory does not exist: %s', root_dir)<br>        return []<br>    # try creating extensions in given directory<br>    ext_data_list = []<br>    mlogger.debug('Parsing directory for extensions of type: %s',<br>                  parent_cmp_type)<br>    for ext_data in _create_subcomponents(root_dir, [parent_cmp_type]):<br>        mlogger.debug('Extension directory found: %s', ext_data)<br>        ext_data_list.append(ext_data)<br>    return ext_data_list<br>``` |

Back to top

## STL File Handling
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/stl/#pyrevit.interop.stl)

# stl

Read and Write STL Binary and ASCII Files.

Back to top

## IFC.Net Assembly Import
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/ifc/#pyrevit.interop.ifc)

# ifc

IFC.Net assembly import.

## Attributes

Back to top

## Rhinoceros Interop
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/interop/rhino/#pyrevit.interop.rhino)

# rhino

Rhinoceros interop.

## Attributes

Back to top

## Markdown Post-Processors
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/coreutils/markdown/postprocessors/#pyrevit.coreutils.markdown.postprocessors)

# postprocessors

POST-PROCESSORS.

Markdown also allows post-processors, which are similar to preprocessors in
that they need to implement a "run" method. However, they are run after core
processing.

## Classes

### `Postprocessor(markdown_instance=None)`

Bases: `Processor`

Postprocessors are run after the ElementTree it converted back into text.

Each Postprocessor implements a "run" method that takes a pointer to a
text string, modifies it as necessary and returns a text string.

Postprocessors must extend markdown.Postprocessor.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/util.py`

|     |     |
| --- | --- |
| ```<br>141<br>142<br>143<br>``` | ```md-code__content<br>def __init__(self, markdown_instance=None):<br>    if markdown_instance:<br>        self.markdown = markdown_instance<br>``` |

#### Attributes

##### `markdown = markdown_instance``instance-attribute`

#### Functions

##### `run(text)`

Main postprocessor method.

Subclasses of Postprocessor should implement a `run` method, which
takes the html document as a single text string and returns a
(possibly modified) string.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/postprocessors.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>``` | ```md-code__content<br>def run(self, text):<br>    """Main postprocessor method.<br>    Subclasses of Postprocessor should implement a `run` method, which<br>    takes the html document as a single text string and returns a<br>    (possibly modified) string.<br>    """<br>    pass  # pragma: no cover<br>``` |

### `RawHtmlPostprocessor(markdown_instance=None)`

Bases: `Postprocessor`

Restore raw html to the document.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/util.py`

|     |     |
| --- | --- |
| ```<br>141<br>142<br>143<br>``` | ```md-code__content<br>def __init__(self, markdown_instance=None):<br>    if markdown_instance:<br>        self.markdown = markdown_instance<br>``` |

#### Attributes

##### `markdown = markdown_instance``instance-attribute`

#### Functions

##### `run(text)`

Iterate over html stash and restore "safe" html.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/postprocessors.py`

|     |     |
| --- | --- |
| ```<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>``` | ```md-code__content<br>def run(self, text):<br>    """Iterate over html stash and restore "safe" html."""<br>    replacements = OrderedDict()<br>    for i in range(self.markdown.htmlStash.html_counter):<br>        html, safe = self.markdown.htmlStash.rawHtmlBlocks[i]<br>        if self.markdown.safeMode and not safe:<br>            if unicode(self.markdown.safeMode).lower() == 'escape':<br>                html = self.escape(html)<br>            elif unicode(self.markdown.safeMode).lower() == 'remove':<br>                html = ''<br>            else:<br>                html = self.markdown.html_replacement_text<br>        if (self.isblocklevel(html) and<br>           (safe or not self.markdown.safeMode)):<br>            replacements["<p>%s</p>" %<br>                         (self.markdown.htmlStash.get_placeholder(i))] = \<br>                html + "\n"<br>        replacements[self.markdown.htmlStash.get_placeholder(i)] = html<br>    if replacements:<br>        pattern = re.compile("|".join(re.escape(k) for k in replacements))<br>        text = pattern.sub(lambda m: replacements[m.group(0)], text)<br>    return text<br>``` |

##### `escape(html)`

Basic html escaping.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/postprocessors.py`

|     |     |
| --- | --- |
| ```<br>75<br>76<br>77<br>78<br>79<br>80<br>``` | ```md-code__content<br>def escape(self, html):<br>    """Basic html escaping."""<br>    html = html.replace('&', '&amp;')<br>    html = html.replace('<', '&lt;')<br>    html = html.replace('>', '&gt;')<br>    return html.replace('"', '&quot;')<br>``` |

##### `isblocklevel(html)`

Source code in `pyrevitlib/pyrevit/coreutils/markdown/postprocessors.py`

|     |     |
| --- | --- |
| ```<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>``` | ```md-code__content<br>def isblocklevel(self, html):<br>    m = re.match(r'^\<\/?([^ >]+)', html)<br>    if m:<br>        if m.group(1)[0] in ('!', '?', '@', '%'):<br>            # Comment, php etc...<br>            return True<br>        return util.isBlockLevel(m.group(1))<br>    return False<br>``` |

### `AndSubstitutePostprocessor(markdown_instance=None)`

Bases: `Postprocessor`

Restore valid entities.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/util.py`

|     |     |
| --- | --- |
| ```<br>141<br>142<br>143<br>``` | ```md-code__content<br>def __init__(self, markdown_instance=None):<br>    if markdown_instance:<br>        self.markdown = markdown_instance<br>``` |

#### Attributes

##### `markdown = markdown_instance``instance-attribute`

#### Functions

##### `run(text)`

Source code in `pyrevitlib/pyrevit/coreutils/markdown/postprocessors.py`

|     |     |
| --- | --- |
| ```<br>95<br>96<br>97<br>``` | ```md-code__content<br>def run(self, text):<br>    text = text.replace(util.AMP_SUBSTITUTE, "&")<br>    return text<br>``` |

### `UnescapePostprocessor(markdown_instance=None)`

Bases: `Postprocessor`

Restore escaped chars.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/util.py`

|     |     |
| --- | --- |
| ```<br>141<br>142<br>143<br>``` | ```md-code__content<br>def __init__(self, markdown_instance=None):<br>    if markdown_instance:<br>        self.markdown = markdown_instance<br>``` |

#### Attributes

##### `markdown = markdown_instance``instance-attribute`

##### `RE = re.compile('%s(\\d+)%s' % (util.STX, util.ETX))``class-attribute``instance-attribute`

#### Functions

##### `unescape(m)`

Source code in `pyrevitlib/pyrevit/coreutils/markdown/postprocessors.py`

|     |     |
| --- | --- |
| ```<br>105<br>106<br>``` | ```md-code__content<br>def unescape(self, m):<br>    return util.int2str(int(m.group(1)))<br>``` |

##### `run(text)`

Source code in `pyrevitlib/pyrevit/coreutils/markdown/postprocessors.py`

|     |     |
| --- | --- |
| ```<br>108<br>109<br>``` | ```md-code__content<br>def run(self, text):<br>    return self.RE.sub(self.unescape, text)<br>``` |

## Functions

### `build_postprocessors(md_instance, **kwargs)`

Build the default postprocessors for Markdown.

Source code in `pyrevitlib/pyrevit/coreutils/markdown/postprocessors.py`

|     |     |
| --- | --- |
| ```<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>``` | ```md-code__content<br>def build_postprocessors(md_instance, **kwargs):<br>    """Build the default postprocessors for Markdown."""<br>    postprocessors = odict.OrderedDict()<br>    postprocessors["raw_html"] = RawHtmlPostprocessor(md_instance)<br>    postprocessors["amp_substitute"] = AndSubstitutePostprocessor()<br>    postprocessors["unescape"] = UnescapePostprocessor()<br>    return postprocessors<br>``` |

Back to top

## Server Error Exceptions
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/routes/server/exceptions/#pyrevit.routes.server.exceptions)

# exceptions

Route custom exceptions.

## Attributes

## Classes

### `ServerException(message, exception_type, exception_traceback)`

Bases: `Exception`

Server error.

Source code in `pyrevitlib/pyrevit/routes/server/exceptions.py`

|     |     |
| --- | --- |
| ```<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>15<br>``` | ```md-code__content<br>def __init__(self, message, exception_type, exception_traceback):<br>    message = "Server error (%s): %s\n%s\n" % (<br>        exception_type.__name__ if exception_type else "",<br>        message,<br>        exception_traceback<br>    )<br>    super(ServerException, self).__init__(message)<br>    self.status = 500 # https://httpstatuses.com/500<br>``` |

#### Attributes

##### `status = 500``instance-attribute`

### `APINotDefinedException(api_name)`

Bases: `Exception`

API is not defined exception.

Source code in `pyrevitlib/pyrevit/routes/server/exceptions.py`

|     |     |
| --- | --- |
| ```<br>20<br>21<br>22<br>23<br>``` | ```md-code__content<br>def __init__(self, api_name):<br>    message = "API is not defined: \"%s\"" % api_name<br>    super(APINotDefinedException, self).__init__(message)<br>    self.status = 404 # https://httpstatuses.com/404<br>``` |

#### Attributes

##### `status = 404``instance-attribute`

### `RouteHandlerNotDefinedException(api_name, route, method)`

Bases: `Exception`

Route does not exits exception.

Source code in `pyrevitlib/pyrevit/routes/server/exceptions.py`

|     |     |
| --- | --- |
| ```<br>28<br>29<br>30<br>31<br>32<br>``` | ```md-code__content<br>def __init__(self, api_name, route, method):<br>    message = \<br>    "Route does not exits: \"%s %s%s\"" % (method, api_name, route)<br>    super(RouteHandlerNotDefinedException, self).__init__(message)<br>    self.status = 404 # https://httpstatuses.com/404<br>``` |

#### Attributes

##### `status = 404``instance-attribute`

### `RouteHandlerDeniedException(request)`

Bases: `Exception`

Route handler was denied by host.

Source code in `pyrevitlib/pyrevit/routes/server/exceptions.py`

|     |     |
| --- | --- |
| ```<br>37<br>38<br>39<br>40<br>41<br>``` | ```md-code__content<br>def __init__(self, request):<br>    message = "Route handler was denied by host: \"%s\"" % request.route<br>    super(RouteHandlerDeniedException, self).__init__(message)<br>    self.status = 406 # https://httpstatuses.com/406<br>    self.source = HOST_APP.pretty_name<br>``` |

#### Attributes

##### `status = 406``instance-attribute`

##### `source = HOST_APP.pretty_name``instance-attribute`

### `RouteHandlerTimedOutException(request)`

Bases: `Exception`

Route handler was timed out by host.

Source code in `pyrevitlib/pyrevit/routes/server/exceptions.py`

|     |     |
| --- | --- |
| ```<br>46<br>47<br>48<br>49<br>50<br>``` | ```md-code__content<br>def __init__(self, request):<br>    message = "Route handler was timed out by host: \"%s\"" % request.route<br>    super(RouteHandlerTimedOutException, self).__init__(message)<br>    self.status = 408 # https://httpstatuses.com/408<br>    self.source = HOST_APP.pretty_name<br>``` |

#### Attributes

##### `status = 408``instance-attribute`

##### `source = HOST_APP.pretty_name``instance-attribute`

### `RouteHandlerIsNotCallableException(hndlr_name)`

Bases: `Exception`

Route handler is not callable.

Source code in `pyrevitlib/pyrevit/routes/server/exceptions.py`

|     |     |
| --- | --- |
| ```<br>55<br>56<br>57<br>58<br>59<br>``` | ```md-code__content<br>def __init__(self, hndlr_name):<br>    message = "Route handler is not callable: \"%s\"" % hndlr_name<br>    super(RouteHandlerIsNotCallableException, self).__init__(message)<br>    self.status = 405 # https://httpstatuses.com/405<br>    self.source = HOST_APP.pretty_name<br>``` |

#### Attributes

##### `status = 405``instance-attribute`

##### `source = HOST_APP.pretty_name``instance-attribute`

### `RouteHandlerExecException(message)`

Bases: `Exception`

Route handler exception.

Source code in `pyrevitlib/pyrevit/routes/server/exceptions.py`

|     |     |
| --- | --- |
| ```<br>64<br>65<br>66<br>67<br>68<br>``` | ```md-code__content<br>def __init__(self, message):<br>    message = "Route exception in Execute: %s" % message<br>    super(RouteHandlerExecException, self).__init__(message)<br>    self.status = 408 # https://httpstatuses.com/408<br>    self.source = HOST_APP.pretty_name<br>``` |

#### Attributes

##### `status = 408``instance-attribute`

##### `source = HOST_APP.pretty_name``instance-attribute`

### `RouteHandlerException(message, exception_type, exception_traceback, clsx_message, clsx_source, clsx_stacktrace, clsx_targetsite)`

Bases: `Exception`

Route handler exception.

Source code in `pyrevitlib/pyrevit/routes/server/exceptions.py`

|     |     |
| --- | --- |
| ```<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>``` | ```md-code__content<br>def __init__(self,<br>             message, exception_type, exception_traceback,<br>             clsx_message, clsx_source, clsx_stacktrace, clsx_targetsite):<br>    message = "%s: %s\n%s\n" \<br>              "Script Executor Traceback:\n" \<br>              "%s: %s\n%s\n%s" % (<br>                  exception_type.__name__ if exception_type else "",<br>                  message,<br>                  exception_traceback,<br>                  clsx_source,<br>                  clsx_message,<br>                  clsx_stacktrace,<br>                  clsx_targetsite<br>              )<br>    super(RouteHandlerException, self).__init__(message)<br>    self.status = 408 # https://httpstatuses.com/408<br>    self.source = HOST_APP.pretty_name<br>``` |

#### Attributes

##### `status = 408``instance-attribute`

##### `source = HOST_APP.pretty_name``instance-attribute`

Back to top

## Revit Failure Handling
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/db/failure/#pyrevit.revit.db.failure)

# failure

Revit failures handler.

## Attributes

### `mlogger = get_logger(__name__)``module-attribute`

### `RESOLUTION_TYPES = [DB.FailureResolutionType.MoveElements, DB.FailureResolutionType.CreateElements, DB.FailureResolutionType.DetachElements, DB.FailureResolutionType.FixElements, DB.FailureResolutionType.UnlockConstraints, DB.FailureResolutionType.SkipElements, DB.FailureResolutionType.DeleteElements, DB.FailureResolutionType.QuitEditMode, DB.FailureResolutionType.SetValue, DB.FailureResolutionType.SaveDocument]``module-attribute`

## Classes

### `FailureSwallower(log_errors=True)`

Bases: `IFailuresPreprocessor`

Swallows all failures.

Source code in `pyrevitlib/pyrevit/revit/db/failure.py`

|     |     |
| --- | --- |
| ```<br>33<br>34<br>35<br>``` | ```md-code__content<br>def __init__(self, log_errors=True):<br>    self._logerror = log_errors<br>    self._failures_swallowed = []<br>``` |

#### Functions

##### `get_swallowed_failures()`

Source code in `pyrevitlib/pyrevit/revit/db/failure.py`

|     |     |
| --- | --- |
| ```<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>``` | ```md-code__content<br>def get_swallowed_failures(self):<br>    failures = set()<br>    failure_reg = HOST_APP.app.GetFailureDefinitionRegistry()<br>    if failure_reg:<br>        for failure_id in self._failures_swallowed:<br>            failure_obj = failure_reg.FindFailureDefinition(failure_id)<br>            if failure_obj:<br>                failures.add(failure_obj)<br>            else:<br>                mlogger.debug(<br>                    'can not find failure definition for: %s', failure_id<br>                    )<br>    return failures<br>``` |

##### `reset()`

Reset swallowed errors.

Source code in `pyrevitlib/pyrevit/revit/db/failure.py`

|     |     |
| --- | --- |
| ```<br>65<br>66<br>67<br>``` | ```md-code__content<br>def reset(self):<br>    """Reset swallowed errors."""<br>    self._failures_swallowed = []<br>``` |

##### `preprocess_failures(failure_accessor)`

Pythonic wrapper for `PreprocessFailures` interface method.

Source code in `pyrevitlib/pyrevit/revit/db/failure.py`

|     |     |
| --- | --- |
| ```<br>69<br>70<br>71<br>``` | ```md-code__content<br>def preprocess_failures(self, failure_accessor):<br>    """Pythonic wrapper for `PreprocessFailures` interface method."""<br>    return self.PreprocessFailures(failure_accessor)<br>``` |

##### `PreprocessFailures(failuresAccessor)`

Required IFailuresPreprocessor interface method.

Source code in `pyrevitlib/pyrevit/revit/db/failure.py`

|     |     |
| --- | --- |
| ```<br> 73<br> 74<br> 75<br> 76<br> 77<br> 78<br> 79<br> 80<br> 81<br> 82<br> 83<br> 84<br> 85<br> 86<br> 87<br> 88<br> 89<br> 90<br> 91<br> 92<br> 93<br> 94<br> 95<br> 96<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>``` | ```md-code__content<br>def PreprocessFailures(self, failuresAccessor):<br>    """Required IFailuresPreprocessor interface method."""<br>    severity = failuresAccessor.GetSeverity()<br>    # log some info<br>    mlogger.debug('processing failure with severity: %s', severity)<br>    if severity == coreutils.get_enum_none(DB.FailureSeverity):<br>        mlogger.debug('clean document. returning with'<br>                      'FailureProcessingResult.Continue')<br>        return DB.FailureProcessingResult.Continue<br>    # log the failure messages<br>    failures = failuresAccessor.GetFailureMessages()<br>    mlogger.debug('processing %s failure messages.', len(failures))<br>    # go through failures and attempt resolution<br>    action_taken = False<br>    get_elementid_value = get_elementid_value_func()<br>    for failure in failures:<br>        failure_id = failure.GetFailureDefinitionId()<br>        failure_guid = getattr(failure_id, 'Guid', '')<br>        failure_severity = failure.GetSeverity()<br>        failure_desc = failure.GetDescriptionText()<br>        failure_has_res = failure.HasResolutions()<br>        # log failure info<br>        mlogger.debug('processing failure msg: %s', failure_guid)<br>        mlogger.debug('\tseverity: %s', failure_severity)<br>        mlogger.debug('\tdescription: %s', failure_desc)<br>        mlogger.debug('\telements: %s',<br>                      [get_elementid_value(x)<br>                       for x in failure.GetFailingElementIds()])<br>        mlogger.debug('\thas resolutions: %s', failure_has_res)<br>        # attempt resolution<br>        mlogger.debug('attempt resolving failure: %s', failure_guid)<br>        # if it's a warning and does not have any resolution<br>        # delete it! it might have a popup window<br>        if not failure_has_res \<br>                and failure_severity == DB.FailureSeverity.Warning:<br>            failuresAccessor.DeleteWarning(failure)<br>            mlogger.debug(<br>                'deleted warning with no acceptable resolution: %s',<br>                failure_guid<br>                )<br>            continue<br>        # find failure definition id<br>        # at this point the failure_has_res is True<br>        failure_def_accessor = get_failure_by_id(failure_id)<br>        default_res = failure_def_accessor.GetDefaultResolutionType()<br>        # iterate through resolution options, pick one and resolve<br>        for res_type in RESOLUTION_TYPES:<br>            if default_res == res_type:<br>                mlogger.debug(<br>                    'using default failure resolution: %s', res_type)<br>                self._set_and_resolve(failuresAccessor, failure, res_type)<br>                action_taken = True<br>                break<br>            elif failure.HasResolutionOfType(res_type):<br>                mlogger.debug('setting failure resolution to: %s', res_type)<br>                self._set_and_resolve(failuresAccessor, failure, res_type)<br>                # marked as action taken<br>                action_taken = True<br>                break<br>            else:<br>                mlogger.debug('invalid failure resolution: %s', res_type)<br>    # report back<br>    if action_taken:<br>        mlogger.debug('resolving failures with '<br>                      'FailureProcessingResult.ProceedWithCommit')<br>        return DB.FailureProcessingResult.ProceedWithCommit<br>    else:<br>        mlogger.debug('resolving failures with '<br>                      'FailureProcessingResult.Continue')<br>        return DB.FailureProcessingResult.Continue<br>``` |

## Functions

### `get_failure_by_guid(failure_guid)`

Source code in `pyrevitlib/pyrevit/revit/db/failure.py`

|     |     |
| --- | --- |
| ```<br>155<br>156<br>157<br>158<br>159<br>``` | ```md-code__content<br>def get_failure_by_guid(failure_guid):<br>    fdr = HOST_APP.app.GetFailureDefinitionRegistry()<br>    fgid = framework.Guid(failure_guid)<br>    fid = DB.FailureDefinitionId(fgid)<br>    return fdr.FindFailureDefinition(fid)<br>``` |

### `get_failure_by_id(failure_id)`

Source code in `pyrevitlib/pyrevit/revit/db/failure.py`

|     |     |
| --- | --- |
| ```<br>162<br>163<br>164<br>``` | ```md-code__content<br>def get_failure_by_id(failure_id):<br>    fdr = HOST_APP.app.GetFailureDefinitionRegistry()<br>    return fdr.FindFailureDefinition(failure_id)<br>``` |

Back to top

## Revit Query Functions
[Skip to content](https://docs.pyrevitlabs.io/reference/pyrevit/revit/db/query/#pyrevit.revit.db.query)

# query

Helper functions to query info and elements from Revit.

## Attributes

### `mlogger = logger.get_logger(__name__)``module-attribute`

### `GRAPHICAL_VIEWTYPES = [DB.ViewType.FloorPlan, DB.ViewType.CeilingPlan, DB.ViewType.Elevation, DB.ViewType.ThreeD, DB.ViewType.Schedule, DB.ViewType.DrawingSheet, DB.ViewType.Report, DB.ViewType.DraftingView, DB.ViewType.Legend, DB.ViewType.EngineeringPlan, DB.ViewType.AreaPlan, DB.ViewType.Section, DB.ViewType.Detail, DB.ViewType.CostReport, DB.ViewType.LoadsReport, DB.ViewType.PresureLossReport, DB.ViewType.ColumnSchedule, DB.ViewType.PanelSchedule, DB.ViewType.Walkthrough, DB.ViewType.Rendering]``module-attribute`

### `DETAIL_CURVES = (DB.DetailLine, DB.DetailArc, DB.DetailEllipse, DB.DetailNurbSpline)``module-attribute`

### `MODEL_CURVES = (DB.ModelLine, DB.ModelArc, DB.ModelEllipse, DB.ModelNurbSpline)``module-attribute`

### `BUILTINCATEGORIES_VIEW = [DB.BuiltInCategory.OST_Views, DB.BuiltInCategory.OST_ReferenceViewer, DB.BuiltInCategory.OST_Viewers]``module-attribute`

### `GridPoint = namedtuple('GridPoint', ['point', 'grids'])``module-attribute`

### `SheetRefInfo = namedtuple('SheetRefInfo', ['sheet_num', 'sheet_name', 'detail_num', 'ref_viewid'])``module-attribute`

### `ElementHistory = namedtuple('ElementHistory', ['creator', 'owner', 'last_changed_by'])``module-attribute`

## Classes

## Functions

### `get_name(element, title_on_sheet=False)`

Retrieves the name of a Revit element, with special handling for views.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element whose name is to be retrieved. | _required_ |
| `title_on_sheet` | `bool` | If True and the element is a view,<br>attempts to retrieve the view's title<br>on the sheet. Defaults to False. | `False` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The name of the element. For views, it may return the view's title<br>on the sheet if `title_on_sheet` is True and the title is available. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>94<br>``` | ```md-code__content<br>def get_name(element, title_on_sheet=False):<br>    """<br>    Retrieves the name of a Revit element, with special handling for views.<br>    Args:<br>        element (DB.Element): The Revit element whose name is to be retrieved.<br>        title_on_sheet (bool, optional): If True and the element is a view,<br>                                         attempts to retrieve the view's title<br>                                         on the sheet. Defaults to False.<br>    Returns:<br>        str: The name of the element. For views, it may return the view's title<br>             on the sheet if `title_on_sheet` is True and the title is available.<br>    """<br>    if isinstance(element, DB.View):<br>        view_name = None<br>        if title_on_sheet:<br>            titleos_param = element.Parameter[DB.BuiltInParameter.VIEW_DESCRIPTION]<br>            view_name = titleos_param.AsString()<br>        if view_name:<br>            return view_name<br>        else:<br>            if HOST_APP.is_newer_than("2019", or_equal=True):<br>                return element.Name<br>            else:<br>                return element.ViewName<br>    if PY3:<br>        return element.Name<br>    else:<br>        return Element.Name.GetValue(element)<br>``` |

### `get_type(element)`

Get element type.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | source element | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `ElementType` | type object of given element |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br> 97<br> 98<br> 99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>``` | ```md-code__content<br>def get_type(element):<br>    """Get element type.<br>    Args:<br>        element (DB.Element): source element<br>    Returns:<br>        (DB.ElementType): type object of given element<br>    """<br>    type_id = element.GetTypeId()<br>    return element.Document.GetElement(type_id)<br>``` |

### `get_symbol_name(element)`

Retrieves the name of the symbol associated with the given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` |  | The Revit element from which to retrieve the symbol name. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The name of the symbol associated with the given element. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>``` | ```md-code__content<br>def get_symbol_name(element):<br>    """<br>    Retrieves the name of the symbol associated with the given Revit element.<br>    Args:<br>        element: The Revit element from which to retrieve the symbol name.<br>    Returns:<br>        str: The name of the symbol associated with the given element.<br>    """<br>    return get_name(element.Symbol)<br>``` |

### `get_family_name(element)`

Retrieves the family name of a given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` |  | The Revit element from which to get the family name.<br>It is expected to have a 'Symbol' attribute with a 'Family' property. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The name of the family to which the element belongs. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>``` | ```md-code__content<br>def get_family_name(element):<br>    """<br>    Retrieves the family name of a given Revit element.<br>    Args:<br>        element: The Revit element from which to get the family name.<br>                 It is expected to have a 'Symbol' attribute with a 'Family' property.<br>    Returns:<br>        str: The name of the family to which the element belongs.<br>    """<br>    return get_name(element.Symbol.Family)<br>``` |

### `get_episodeid(element)`

Extract episode id from the given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` |  | The Revit element from which to extract the episode id. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The episode id extracted from the element's UniqueId. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>``` | ```md-code__content<br>def get_episodeid(element):<br>    """<br>    Extract episode id from the given Revit element.<br>    Args:<br>        element: The Revit element from which to extract the episode id.<br>    Returns:<br>        str: The episode id extracted from the element's UniqueId.<br>    """<br>    return str(element.UniqueId)[:36]<br>``` |

### `get_guid(element)`

Generates a GUID for a given Revit element by performing a bitwise XOR operation
on parts of the element's UniqueId.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` |  | The Revit element for which the GUID is to be generated. The element<br>must have a UniqueId attribute. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | A string representing the generated GUID. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>``` | ```md-code__content<br>def get_guid(element):<br>    """<br>    Generates a GUID for a given Revit element by performing a bitwise XOR operation<br>    on parts of the element's UniqueId.<br>    Args:<br>        element: The Revit element for which the GUID is to be generated. The element<br>                 must have a UniqueId attribute.<br>    Returns:<br>        str: A string representing the generated GUID.<br>    """<br>    uid = str(element.UniqueId)<br>    last_32_bits = int(uid[28:36], 16)<br>    element_id = int(uid[37:], 16)<br>    xor = last_32_bits ^ element_id<br>    return uid[:28] + "{0:x}".format(xor)<br>``` |

### `get_param(element, param_name, default=None)`

Retrieves a parameter from a Revit element by its name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element from which to retrieve the parameter. | _required_ |
| `param_name` | `str` | The name of the parameter to retrieve. | _required_ |
| `default` |  | The value to return if the parameter is not found or an error occurs. Defaults to None. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | The parameter if found, otherwise the default value. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>``` | ```md-code__content<br>def get_param(element, param_name, default=None):<br>    """<br>    Retrieves a parameter from a Revit element by its name.<br>    Args:<br>        element (DB.Element): The Revit element from which to retrieve the parameter.<br>        param_name (str): The name of the parameter to retrieve.<br>        default: The value to return if the parameter is not found or an error occurs. Defaults to None.<br>    Returns:<br>        The parameter if found, otherwise the default value.<br>    """<br>    if isinstance(element, DB.Element):<br>        try:<br>            return element.LookupParameter(param_name)<br>        except Exception:<br>            return default<br>``` |

### `get_mark(element)`

Retrieves the 'Mark' parameter value from a given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` |  | The Revit element from which to retrieve the 'Mark' parameter. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The value of the 'Mark' parameter as a string. |

Returns an empty string if the parameter is not found.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>``` | ```md-code__content<br>def get_mark(element):<br>    """<br>    Retrieves the 'Mark' parameter value from a given Revit element.<br>    Args:<br>        element: The Revit element from which to retrieve the 'Mark' parameter.<br>    Returns:<br>        str: The value of the 'Mark' parameter as a string.<br>    Returns an empty string if the parameter is not found.<br>    """<br>    mparam = element.Parameter[DB.BuiltInParameter.ALL_MODEL_MARK]<br>    return mparam.AsString() if mparam else ""<br>``` |

### `get_location(element)`

Get element location point.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | source element | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `XYZ` | X, Y, Z of location point element |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>205<br>206<br>207<br>208<br>209<br>210<br>211<br>212<br>213<br>214<br>215<br>216<br>217<br>``` | ```md-code__content<br>def get_location(element):<br>    """Get element location point.<br>    Args:<br>        element (DB.Element): source element<br>    Returns:<br>        (DB.XYZ): X, Y, Z of location point element<br>    """<br>    locp = element.Location.Point<br>    return (locp.X, locp.Y, locp.Z)<br>``` |

### `get_biparam_stringequals_filter(bip_paramvalue_dict)`

Creates a Revit ElementParameterFilter based on a dictionary of built-in parameter (BIP)
values and their corresponding filter values.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `bip_paramvalue_dict` | `dict` | A dictionary where keys are built-in parameter (BIP)<br>identifiers and values are the corresponding filter values. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | DB.ElementParameterFilter: A filter that can be used to filter Revit elements based<br>on the specified BIP values. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If no filters could be created from the provided dictionary. |

Notes

- The function handles different Revit API versions by checking if the host application
is newer than the 2022 version.
- For Revit versions newer than 2022, the `FilterStringRule` does not require the
`caseSensitive` parameter.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>220<br>221<br>222<br>223<br>224<br>225<br>226<br>227<br>228<br>229<br>230<br>231<br>232<br>233<br>234<br>235<br>236<br>237<br>238<br>239<br>240<br>241<br>242<br>243<br>244<br>245<br>246<br>247<br>248<br>249<br>250<br>251<br>252<br>253<br>254<br>255<br>256<br>257<br>258<br>259<br>``` | ```md-code__content<br>def get_biparam_stringequals_filter(bip_paramvalue_dict):<br>    """<br>    Creates a Revit ElementParameterFilter based on a dictionary of built-in parameter (BIP)<br>    values and their corresponding filter values.<br>    Args:<br>        bip_paramvalue_dict (dict): A dictionary where keys are built-in parameter (BIP)<br>                                    identifiers and values are the corresponding filter values.<br>    Returns:<br>        DB.ElementParameterFilter: A filter that can be used to filter Revit elements based<br>                                   on the specified BIP values.<br>    Raises:<br>        PyRevitException: If no filters could be created from the provided dictionary.<br>    Notes:<br>        - The function handles different Revit API versions by checking if the host application<br>          is newer than the 2022 version.<br>        - For Revit versions newer than 2022, the `FilterStringRule` does not require the<br>          `caseSensitive` parameter.<br>    """<br>    filters = []<br>    for bip, fvalue in bip_paramvalue_dict.items():<br>        bip_id = DB.ElementId(bip)<br>        bip_valueprovider = DB.ParameterValueProvider(bip_id)<br>        if HOST_APP.is_newer_than(2022):<br>            bip_valuerule = DB.FilterStringRule(<br>                bip_valueprovider, DB.FilterStringEquals(), fvalue<br>            )<br>        else:<br>            bip_valuerule = DB.FilterStringRule(<br>                bip_valueprovider, DB.FilterStringEquals(), fvalue, True<br>            )<br>        filters.append(bip_valuerule)<br>    if filters:<br>        return DB.ElementParameterFilter(framework.List[DB.FilterRule](filters))<br>    else:<br>        raise PyRevitException("Error creating filters.")<br>``` |

### `get_all_elements(doc=None)`

Retrieves all elements from the given Revit document.
This function uses a FilteredElementCollector to collect all elements
in the provided document, including both element types and instances.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to collect elements from.<br>If not provided, the default document (DOCS.doc) is used. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | List\[Element\]: A list of all elements in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>262<br>263<br>264<br>265<br>266<br>267<br>268<br>269<br>270<br>271<br>272<br>273<br>274<br>275<br>276<br>277<br>278<br>279<br>280<br>281<br>282<br>283<br>284<br>``` | ```md-code__content<br>def get_all_elements(doc=None):<br>    """<br>    Retrieves all elements from the given Revit document.<br>    This function uses a FilteredElementCollector to collect all elements<br>    in the provided document, including both element types and instances.<br>    Args:<br>        doc (Document, optional): The Revit document to collect elements from.<br>                                  If not provided, the default document (DOCS.doc) is used.<br>    Returns:<br>        List[Element]: A list of all elements in the document.<br>    """<br>    return (<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .WherePasses(<br>            DB.LogicalOrFilter(<br>                DB.ElementIsElementTypeFilter(False),<br>                DB.ElementIsElementTypeFilter(True),<br>            )<br>        )<br>        .ToElements()<br>    )<br>``` |

### `get_all_elements_in_view(view)`

Retrieves all elements in the specified Revit view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view from which to collect elements. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | list\[Autodesk.Revit.DB.Element\]: A list of elements present in the specified view. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>287<br>288<br>289<br>290<br>291<br>292<br>293<br>294<br>295<br>296<br>297<br>298<br>299<br>300<br>301<br>``` | ```md-code__content<br>def get_all_elements_in_view(view):<br>    """<br>    Retrieves all elements in the specified Revit view.<br>    Args:<br>        view (Autodesk.Revit.DB.View): The Revit view from which to collect elements.<br>    Returns:<br>        list[Autodesk.Revit.DB.Element]: A list of elements present in the specified view.<br>    """<br>    return (<br>        DB.FilteredElementCollector(view.Document, view.Id)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>``` |

### `get_param_value(targetparam)`

Retrieves the value of a given Revit parameter.
Parameters:
targetparam (DB.Parameter or DB.GlobalParameter): The parameter whose value is to be retrieved.

value (varies): The value of the parameter. The type of the returned value depends on the storage type of the parameter:
\- Double:
Returns a float.
\- Integer:
Returns an int.
\- String:
Returns a str.
\- ElementId:
Returns an ElementId.
If the parameter is a GlobalParameter, returns the value directly from the GlobalParameter.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>304<br>305<br>306<br>307<br>308<br>309<br>310<br>311<br>312<br>313<br>314<br>315<br>316<br>317<br>318<br>319<br>320<br>321<br>322<br>323<br>324<br>325<br>326<br>327<br>328<br>329<br>330<br>331<br>332<br>333<br>334<br>``` | ```md-code__content<br>def get_param_value(targetparam):<br>    """<br>    Retrieves the value of a given Revit parameter.<br>    Parameters:<br>    targetparam (DB.Parameter or DB.GlobalParameter): The parameter whose value is to be retrieved.<br>    Returns:<br>    value (varies): The value of the parameter. The type of the returned value depends on the storage type of the parameter:<br>        - Double:<br>    Returns a float.<br>        - Integer:<br>    Returns an int.<br>        - String:<br>    Returns a str.<br>        - ElementId:<br>    Returns an ElementId.<br>        If the parameter is a GlobalParameter, returns the value directly from the GlobalParameter.<br>    """<br>    value = None<br>    if isinstance(targetparam, DB.Parameter):<br>        if targetparam.StorageType == DB.StorageType.Double:<br>            value = targetparam.AsDouble()<br>        elif targetparam.StorageType == DB.StorageType.Integer:<br>            value = targetparam.AsInteger()<br>        elif targetparam.StorageType == DB.StorageType.String:<br>            value = targetparam.AsString()<br>        elif targetparam.StorageType == DB.StorageType.ElementId:<br>            value = targetparam.AsElementId()<br>    elif isinstance(targetparam, DB.GlobalParameter):<br>        return targetparam.GetValue().Value<br>    return value<br>``` |

### `get_value_range(param_name, doc=None)`

Retrieves a set of unique values for a specified parameter from all elements in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | The name of the parameter to retrieve values for. | _required_ |
| `doc` | `Document` | The Revit document to search within. If None, the current document is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `set` |  | A set of unique values for the specified parameter. The values can be of any type, but are typically strings. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>337<br>338<br>339<br>340<br>341<br>342<br>343<br>344<br>345<br>346<br>347<br>348<br>349<br>350<br>351<br>352<br>353<br>354<br>355<br>356<br>357<br>358<br>``` | ```md-code__content<br>def get_value_range(param_name, doc=None):<br>    """<br>    Retrieves a set of unique values for a specified parameter from all elements in the given Revit document.<br>    Args:<br>        param_name (str): The name of the parameter to retrieve values for.<br>        doc (Document, optional): The Revit document to search within. If None, the current document is used.<br>    Returns:<br>        set: A set of unique values for the specified parameter. The values can be of any type, but are typically strings.<br>    """<br>    values = set()<br>    for element in get_all_elements(doc):<br>        targetparam = element.LookupParameter(param_name)<br>        if targetparam:<br>            value = get_param_value(targetparam)<br>            if value is not None and safe_strtype(value).lower() != "none":<br>                if isinstance(value, str) and not value.isspace():<br>                    values.add(value)<br>                else:<br>                    values.add(value)<br>    return values<br>``` |

### `get_elements_by_parameter(param_name, param_value, doc=None, partial=False)`

Retrieves elements from the Revit document that match a given parameter name and value.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | The name of the parameter to search for. | _required_ |
| `param_value` | `str or other` | The value of the parameter to match. | _required_ |
| `doc` | `Document` | The Revit document to search in. If None, the current document is used. | `None` |
| `partial` | `bool` | If True, performs a partial match on string parameter values. Defaults to False. | `False` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of elements that match the specified parameter name and value. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>361<br>362<br>363<br>364<br>365<br>366<br>367<br>368<br>369<br>370<br>371<br>372<br>373<br>374<br>375<br>376<br>377<br>378<br>379<br>380<br>381<br>382<br>383<br>384<br>385<br>386<br>387<br>388<br>``` | ```md-code__content<br>def get_elements_by_parameter(param_name, param_value, doc=None, partial=False):<br>    """<br>    Retrieves elements from the Revit document that match a given parameter name and value.<br>    Args:<br>        param_name (str): The name of the parameter to search for.<br>        param_value (str or other): The value of the parameter to match.<br>        doc (Document, optional): The Revit document to search in. If None, the current document is used.<br>        partial (bool, optional): If True, performs a partial match on string parameter values. Defaults to False.<br>    Returns:<br>        list: A list of elements that match the specified parameter name and value.<br>    """<br>    found_els = []<br>    for element in get_all_elements(doc):<br>        targetparam = element.LookupParameter(param_name)<br>        if targetparam:<br>            value = get_param_value(targetparam)<br>            if (<br>                partial<br>                and value is not None<br>                and isinstance(value, str)<br>                and param_value in value<br>            ):<br>                found_els.append(element)<br>            elif param_value == value:<br>                found_els.append(element)<br>    return found_els<br>``` |

### `get_elements_by_param_value(param_name, param_value, inverse=False, doc=None)`

Retrieves elements from the Revit document based on a parameter name and value.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | The name of the parameter to filter by. | _required_ |
| `param_value` | `str` | The value of the parameter to filter by. | _required_ |
| `inverse` | `bool` | If True, inverts the filter to exclude elements with the specified parameter value. Defaults to False. | `False` |
| `doc` | `Document` | The Revit document to search in. If None, uses the default document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of elements that match the parameter name and value. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>391<br>392<br>393<br>394<br>395<br>396<br>397<br>398<br>399<br>400<br>401<br>402<br>403<br>404<br>405<br>406<br>407<br>408<br>409<br>410<br>411<br>412<br>413<br>414<br>415<br>416<br>417<br>418<br>``` | ```md-code__content<br>def get_elements_by_param_value(param_name, param_value, inverse=False, doc=None):<br>    """<br>    Retrieves elements from the Revit document based on a parameter name and value.<br>    Args:<br>        param_name (str): The name of the parameter to filter by.<br>        param_value (str): The value of the parameter to filter by.<br>        inverse (bool, optional): If True, inverts the filter to exclude elements with the specified parameter value. Defaults to False.<br>        doc (Document, optional): The Revit document to search in. If None, uses the default document.<br>    Returns:<br>        list: A list of elements that match the parameter name and value.<br>    """<br>    doc = doc or DOCS.doc<br>    param_id = get_project_parameter_id(param_name, doc)<br>    if param_id:<br>        pvprov = DB.ParameterValueProvider(param_id)<br>        pfilter = DB.FilterStringEquals()<br>        if HOST_APP.is_newer_than(2022):<br>            vrule = DB.FilterStringRule(pvprov, pfilter, param_value)<br>        else:<br>            vrule = DB.FilterStringRule(pvprov, pfilter, param_value, True)<br>        if inverse:<br>            vrule = DB.FilterInverseRule(vrule)<br>        param_filter = DB.ElementParameterFilter(vrule)<br>        return DB.FilteredElementCollector(doc).WherePasses(param_filter).ToElements()<br>    else:<br>        return []<br>``` |

### `get_elements_by_categories(element_bicats, elements=None, doc=None)`

Retrieves elements from a Revit document based on specified categories.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element_bicats` | `list` | A list of built-in categories to filter elements by. | _required_ |
| `elements` | `list` | A list of elements to filter. If provided, the function will filter these elements. | `None` |
| `doc` | `Document` | The Revit document to collect elements from. If not provided, the active document is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of elements that belong to the specified categories. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>421<br>422<br>423<br>424<br>425<br>426<br>427<br>428<br>429<br>430<br>431<br>432<br>433<br>434<br>435<br>436<br>437<br>438<br>439<br>440<br>441<br>442<br>443<br>444<br>445<br>446<br>``` | ```md-code__content<br>def get_elements_by_categories(element_bicats, elements=None, doc=None):<br>    """<br>    Retrieves elements from a Revit document based on specified categories.<br>    Args:<br>        element_bicats (list): A list of built-in categories to filter elements by.<br>        elements (list, optional): A list of elements to filter. If provided, the function will filter these elements.<br>        doc (DB.Document, optional): The Revit document to collect elements from. If not provided, the active document is used.<br>    Returns:<br>        list: A list of elements that belong to the specified categories.<br>    """<br>    if elements:<br>        return [<br>            x<br>            for x in elements<br>            if get_builtincategory(x.Category.Name) in element_bicats<br>        ]<br>    cat_filters = [DB.ElementCategoryFilter(x) for x in element_bicats if x]<br>    elcats_filter = DB.LogicalOrFilter(framework.List[DB.ElementFilter](cat_filters))<br>    return (<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .WherePasses(elcats_filter)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>``` |

### `get_elements_by_class(element_class, elements=None, doc=None, view_id=None)`

Retrieves elements of a specified class from a Revit document or a given list of elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element_class` | `type` | The class type of the elements to retrieve. | _required_ |
| `elements` | `list` | A list of elements to filter by the specified class. Defaults to None. | `None` |
| `doc` | `Document` | The Revit document to search within. Defaults to None. | `None` |
| `view_id` | `ElementId` | The ID of the view to restrict the search to. Defaults to None. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of elements of the specified class. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>449<br>450<br>451<br>452<br>453<br>454<br>455<br>456<br>457<br>458<br>459<br>460<br>461<br>462<br>463<br>464<br>465<br>466<br>467<br>468<br>469<br>470<br>471<br>472<br>473<br>474<br>475<br>476<br>477<br>``` | ```md-code__content<br>def get_elements_by_class(element_class, elements=None, doc=None, view_id=None):<br>    """<br>    Retrieves elements of a specified class from a Revit document or a given list of elements.<br>    Args:<br>        element_class (type): The class type of the elements to retrieve.<br>        elements (list, optional): A list of elements to filter by the specified class. Defaults to None.<br>        doc (DB.Document, optional): The Revit document to search within. Defaults to None.<br>        view_id (DB.ElementId, optional): The ID of the view to restrict the search to. Defaults to None.<br>    Returns:<br>        list: A list of elements of the specified class.<br>    """<br>    if elements:<br>        return [x for x in elements if isinstance(x, element_class)]<br>    if view_id:<br>        return (<br>            DB.FilteredElementCollector(doc or DOCS.doc, view_id)<br>            .OfClass(element_class)<br>            .WhereElementIsNotElementType()<br>            .ToElements()<br>        )<br>    else:<br>        return (<br>            DB.FilteredElementCollector(doc or DOCS.doc)<br>            .OfClass(element_class)<br>            .WhereElementIsNotElementType()<br>            .ToElements()<br>        )<br>``` |

### `get_types_by_class(type_class, types=None, doc=None)`

Retrieves elements of a specified class type from a given list or from the Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `type_class` | `type` | The class type to filter elements by. | _required_ |
| `types` | `list` | A list of elements to filter. If not provided, elements will be collected from the Revit document. | `None` |
| `doc` | `Document` | The Revit document to collect elements from if 'types' is not provided. Defaults to the active document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of elements that are instances of the specified class type. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>480<br>481<br>482<br>483<br>484<br>485<br>486<br>487<br>488<br>489<br>490<br>491<br>492<br>493<br>494<br>``` | ```md-code__content<br>def get_types_by_class(type_class, types=None, doc=None):<br>    """<br>    Retrieves elements of a specified class type from a given list or from the Revit document.<br>    Args:<br>        type_class (type): The class type to filter elements by.<br>        types (list, optional): A list of elements to filter. If not provided, elements will be collected from the Revit document.<br>        doc (Document, optional): The Revit document to collect elements from if 'types' is not provided. Defaults to the active document.<br>    Returns:<br>        list: A list of elements that are instances of the specified class type.<br>    """<br>    if types:<br>        return [x for x in types if isinstance(x, type_class)]<br>    return DB.FilteredElementCollector(doc or DOCS.doc).OfClass(type_class).ToElements()<br>``` |

### `get_family(family_name, doc=None)`

Retrieves all family elements in the Revit document that match the given family name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `family_name` | `str` | The name of the family to search for. | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided, the current document is used. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | list\[DB.Element\]: A list of family elements that match the given family name. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>497<br>498<br>499<br>500<br>501<br>502<br>503<br>504<br>505<br>506<br>507<br>508<br>509<br>510<br>511<br>512<br>513<br>514<br>515<br>516<br>517<br>518<br>``` | ```md-code__content<br>def get_family(family_name, doc=None):<br>    """<br>    Retrieves all family elements in the Revit document that match the given family name.<br>    Args:<br>        family_name (str): The name of the family to search for.<br>        doc (DB.Document, optional): The Revit document to search in. If not provided, the current document is used.<br>    Returns:<br>        list[DB.Element]: A list of family elements that match the given family name.<br>    """<br>    families = (<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .WherePasses(<br>            get_biparam_stringequals_filter(<br>                {DB.BuiltInParameter.SYMBOL_FAMILY_NAME_PARAM: family_name}<br>            )<br>        )<br>        .WhereElementIsElementType()<br>        .ToElements()<br>    )<br>    return families<br>``` |

### `get_family_symbol(family_name, symbol_name, doc=None)`

Retrieves family symbols from a Revit document based on the specified family name and symbol name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `family_name` | `str` | The name of the family to search for. | _required_ |
| `symbol_name` | `str` | The name of the symbol within the family to search for. | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided, the default document is used. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | list\[DB.Element\]: A list of family symbols that match the specified family name and symbol name. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>521<br>522<br>523<br>524<br>525<br>526<br>527<br>528<br>529<br>530<br>531<br>532<br>533<br>534<br>535<br>536<br>537<br>538<br>539<br>540<br>541<br>542<br>543<br>544<br>545<br>546<br>``` | ```md-code__content<br>def get_family_symbol(family_name, symbol_name, doc=None):<br>    """<br>    Retrieves family symbols from a Revit document based on the specified family name and symbol name.<br>    Args:<br>        family_name (str): The name of the family to search for.<br>        symbol_name (str): The name of the symbol within the family to search for.<br>        doc (DB.Document, optional): The Revit document to search in. If not provided, the default document is used.<br>    Returns:<br>        list[DB.Element]: A list of family symbols that match the specified family name and symbol name.<br>    """<br>    famsyms = (<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .WherePasses(<br>            get_biparam_stringequals_filter(<br>                {<br>                    DB.BuiltInParameter.SYMBOL_FAMILY_NAME_PARAM: family_name,<br>                    DB.BuiltInParameter.SYMBOL_NAME_PARAM: symbol_name,<br>                }<br>            )<br>        )<br>        .WhereElementIsElementType()<br>        .ToElements()<br>    )<br>    return famsyms<br>``` |

### `get_families(doc=None, only_editable=True)`

Retrieves a list of families from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve families from.<br>If not provided, defaults to DOCS.doc. | `None` |
| `only_editable` | `bool` | If True, only returns families that are editable.<br>Defaults to True. | `True` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of Family objects from the document. If only\_editable is True,<br>only includes families that are editable. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>549<br>550<br>551<br>552<br>553<br>554<br>555<br>556<br>557<br>558<br>559<br>560<br>561<br>562<br>563<br>564<br>565<br>566<br>567<br>568<br>569<br>570<br>571<br>572<br>573<br>``` | ```md-code__content<br>def get_families(doc=None, only_editable=True):<br>    """<br>    Retrieves a list of families from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve families from.<br>                                  If not provided, defaults to DOCS.doc.<br>        only_editable (bool, optional): If True, only returns families that are editable.<br>                                        Defaults to True.<br>    Returns:<br>        list: A list of Family objects from the document. If only_editable is True,<br>              only includes families that are editable.<br>    """<br>    doc = doc or DOCS.doc<br>    families = [<br>        x.Family<br>        for x in set(<br>            DB.FilteredElementCollector(doc).WhereElementIsElementType().ToElements()<br>        )<br>        if isinstance(x, (DB.FamilySymbol, DB.AnnotationSymbolType))<br>    ]<br>    if only_editable:<br>        return [x for x in families if x.IsEditable]<br>    return families<br>``` |

### `get_noteblock_families(doc=None)`

Retrieves a list of noteblock families from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to query. If not provided,<br>the default document (DOCS.doc) will be used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of noteblock family elements in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>576<br>577<br>578<br>579<br>580<br>581<br>582<br>583<br>584<br>585<br>586<br>587<br>588<br>589<br>590<br>``` | ```md-code__content<br>def get_noteblock_families(doc=None):<br>    """<br>    Retrieves a list of noteblock families from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to query. If not provided,<br>                                  the default document (DOCS.doc) will be used.<br>    Returns:<br>        list: A list of noteblock family elements in the document.<br>    """<br>    doc = doc or DOCS.doc<br>    return [<br>        doc.GetElement(x) for x in DB.ViewSchedule.GetValidFamiliesForNoteBlock(doc)<br>    ]<br>``` |

### `get_elements_by_family(family_name, doc=None)`

Retrieves elements from a Revit document based on the specified family name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `family_name` | `str` | The name of the family to filter elements by. | _required_ |
| `doc` | `Document` | The Revit document to search within. If not provided,<br>the default document (DOCS.doc) will be used. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | list\[DB.Element\]: A list of elements that belong to the specified family. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>593<br>594<br>595<br>596<br>597<br>598<br>599<br>600<br>601<br>602<br>603<br>604<br>605<br>606<br>607<br>608<br>609<br>610<br>611<br>612<br>613<br>614<br>615<br>``` | ```md-code__content<br>def get_elements_by_family(family_name, doc=None):<br>    """<br>    Retrieves elements from a Revit document based on the specified family name.<br>    Args:<br>        family_name (str): The name of the family to filter elements by.<br>        doc (DB.Document, optional): The Revit document to search within. If not provided,<br>                                     the default document (DOCS.doc) will be used.<br>    Returns:<br>        list[DB.Element]: A list of elements that belong to the specified family.<br>    """<br>    famsyms = (<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .WherePasses(<br>            get_biparam_stringequals_filter(<br>                {DB.BuiltInParameter.SYMBOL_FAMILY_NAME_PARAM: family_name}<br>            )<br>        )<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>    return famsyms<br>``` |

### `get_elements_by_familytype(family_name, symbol_name, doc=None)`

Retrieves elements from a Revit document based on the specified family and symbol names.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `family_name` | `str` | The name of the family to filter elements by. | _required_ |
| `symbol_name` | `str` | The name of the symbol (type) to filter elements by. | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided, the current document is used. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | list\[DB.Element\]: A list of elements that match the specified family and symbol names. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>618<br>619<br>620<br>621<br>622<br>623<br>624<br>625<br>626<br>627<br>628<br>629<br>630<br>631<br>632<br>633<br>634<br>635<br>636<br>637<br>638<br>639<br>640<br>641<br>642<br>643<br>``` | ```md-code__content<br>def get_elements_by_familytype(family_name, symbol_name, doc=None):<br>    """<br>    Retrieves elements from a Revit document based on the specified family and symbol names.<br>    Args:<br>        family_name (str): The name of the family to filter elements by.<br>        symbol_name (str): The name of the symbol (type) to filter elements by.<br>        doc (DB.Document, optional): The Revit document to search in. If not provided, the current document is used.<br>    Returns:<br>        list[DB.Element]: A list of elements that match the specified family and symbol names.<br>    """<br>    syms = (<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .WherePasses(<br>            get_biparam_stringequals_filter(<br>                {<br>                    DB.BuiltInParameter.SYMBOL_FAMILY_NAME_PARAM: family_name,<br>                    DB.BuiltInParameter.SYMBOL_NAME_PARAM: symbol_name,<br>                }<br>            )<br>        )<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>    return syms<br>``` |

### `find_workset(workset_name_or_list, doc=None, partial=True)`

Finds a workset in the given Revit document by name or list of names.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `workset_name_or_list` | `str or list` | The name of the workset to find or a list of workset names. | _required_ |
| `doc` | `Document` | The Revit document to search in. If None, the default document is used. | `None` |
| `partial` | `bool` | If True, allows partial matching of workset names. Defaults to True. | `True` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `Workset` |  | The first matching workset found, or None if no match is found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>646<br>647<br>648<br>649<br>650<br>651<br>652<br>653<br>654<br>655<br>656<br>657<br>658<br>659<br>660<br>661<br>662<br>663<br>664<br>665<br>666<br>667<br>668<br>669<br>670<br>671<br>672<br>673<br>674<br>``` | ```md-code__content<br>def find_workset(workset_name_or_list, doc=None, partial=True):<br>    """<br>    Finds a workset in the given Revit document by name or list of names.<br>    Args:<br>        workset_name_or_list (str or list): The name of the workset to find or a list of workset names.<br>        doc (Document, optional): The Revit document to search in. If None, the default document is used.<br>        partial (bool, optional): If True, allows partial matching of workset names. Defaults to True.<br>    Returns:<br>        Workset: The first matching workset found, or None if no match is found.<br>    """<br>    workset_clctr = DB.FilteredWorksetCollector(doc or DOCS.doc).ToWorksets()<br>    if isinstance(workset_name_or_list, list):<br>        for workset in workset_clctr:<br>            for workset_name in workset_name_or_list:<br>                if workset_name in workset.Name:<br>                    return workset<br>    elif isinstance(workset_name_or_list, str):<br>        workset_name = workset_name_or_list<br>        if partial:<br>            for workset in workset_clctr:<br>                if workset_name in workset.Name:<br>                    return workset<br>        else:<br>            for workset in workset_clctr:<br>                if workset_name == workset.Name:<br>                    return workset<br>``` |

### `model_has_family(family_name, doc=None)`

Checks if the Revit model contains a family with the given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `family_name` | `str` | The name of the family to search for. | _required_ |
| `doc` | `Document` | The Revit document to search in. If None, the current document is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the family is found in the model, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>677<br>678<br>679<br>680<br>681<br>682<br>683<br>684<br>685<br>686<br>687<br>688<br>689<br>``` | ```md-code__content<br>def model_has_family(family_name, doc=None):<br>    """<br>    Checks if the Revit model contains a family with the given name.<br>    Args:<br>        family_name (str): The name of the family to search for.<br>        doc (Document, optional): The Revit document to search in. If None, the current document is used.<br>    Returns:<br>        bool: True if the family is found in the model, False otherwise.<br>    """<br>    collector = get_family(family_name, doc=doc)<br>    return hasattr(collector, "Count") and collector.Count > 0<br>``` |

### `model_has_workset(workset_name, partial=False, doc=None)`

Checks if the model has a workset with the given name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `workset_name` | `str` | The name of the workset to search for. | _required_ |
| `partial` | `bool` | If True, allows partial matching of the workset name. Defaults to False. | `False` |
| `doc` | `Document` | The Revit document to search within. If None, the current document is used. Defaults to None. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the workset is found, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>692<br>693<br>694<br>695<br>696<br>697<br>698<br>699<br>700<br>701<br>702<br>703<br>704<br>705<br>``` | ```md-code__content<br>def model_has_workset(workset_name, partial=False, doc=None):<br>    """<br>    Checks if the model has a workset with the given name.<br>    Args:<br>        workset_name (str): The name of the workset to search for.<br>        partial (bool, optional): If True, allows partial matching of the workset name. Defaults to False.<br>        doc (Document, optional): The Revit document to search within. If None, the current document is used. Defaults to None.<br>    Returns:<br>        bool: True if the workset is found, False otherwise.<br>    """<br>    return find_workset(workset_name, partial=partial, doc=doc)<br>``` |

### `get_worksets_names(doc=None)`

Returns a string with the names of all user worksets in a document

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `document` | `Document` | A Revit document. de | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | A string with the names of all user worksets in a document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>708<br>709<br>710<br>711<br>712<br>713<br>714<br>715<br>716<br>717<br>718<br>719<br>720<br>721<br>722<br>723<br>724<br>725<br>726<br>727<br>728<br>729<br>``` | ```md-code__content<br>def get_worksets_names(doc=None):<br>    """<br>    Returns a string with the names of all user worksets in a document<br>    Args:<br>        document (Document): A Revit document. de<br>    Returns:<br>        str: A string with the names of all user worksets in a document.<br>    """<br>    doc = doc or DOCS.doc<br>    if not hasattr(doc, "IsWorkshared"):<br>        return "-"<br>    if not doc.IsWorkshared:<br>        return "Not Workshared"<br>    worksets_collection = (<br>        DB.FilteredWorksetCollector(doc).OfKind(DB.WorksetKind.UserWorkset).ToWorksets()<br>    )<br>    return ", ".join(w.Name for w in worksets_collection)<br>``` |

### `get_critical_warnings_count(warnings, critical_warnings_template)`

Counts the number of critical warnings from a list of warnings based on a template.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `warnings` | `list` | A list of warning objects. Each warning object should have a method <br>`GetFailureDefinitionId` that returns an object with a `Guid` attribute. | _required_ |
| `critical_warnings_template` | `list` | A list of string representations of GUIDs that are <br>considered critical warnings. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `int` |  | The count of critical warnings. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>732<br>733<br>734<br>735<br>736<br>737<br>738<br>739<br>740<br>741<br>742<br>743<br>744<br>745<br>746<br>747<br>748<br>749<br>750<br>``` | ```md-code__content<br>def get_critical_warnings_count(warnings, critical_warnings_template):<br>    """<br>    Counts the number of critical warnings from a list of warnings based on a template.<br>    Args:<br>        warnings (list): A list of warning objects. Each warning object should have a method <br>                         `GetFailureDefinitionId` that returns an object with a `Guid` attribute.<br>        critical_warnings_template (list): A list of string representations of GUIDs that are <br>                                           considered critical warnings.<br>    Returns:<br>        int: The count of critical warnings.<br>    """<br>    warnings_guid = [warning.GetFailureDefinitionId().Guid for warning in warnings] <br>    return sum(<br>        1<br>        for warning_guid in warnings_guid<br>        if str(warning_guid) in critical_warnings_template<br>    )<br>``` |

### `get_sharedparam_definition_file()`

Retrieves the shared parameters definition file from the host application.

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `SharedParameterFile` |  | The shared parameters file if it exists and is successfully opened. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If the shared parameters file is not defined or cannot be opened. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>753<br>754<br>755<br>756<br>757<br>758<br>759<br>760<br>761<br>762<br>763<br>764<br>765<br>766<br>767<br>768<br>769<br>770<br>``` | ```md-code__content<br>def get_sharedparam_definition_file():<br>    """<br>    Retrieves the shared parameters definition file from the host application.<br>    Returns:<br>        SharedParameterFile: The shared parameters file if it exists and is successfully opened.<br>    Raises:<br>        PyRevitException: If the shared parameters file is not defined or cannot be opened.<br>    """<br>    if HOST_APP.app.SharedParametersFilename:<br>        sparamf = HOST_APP.app.OpenSharedParameterFile()<br>        if sparamf:<br>            return sparamf<br>        else:<br>            raise PyRevitException("Failed opening Shared Parameters file.")<br>    else:<br>        raise PyRevitException("No Shared Parameters file defined.")<br>``` |

### `get_defined_sharedparams()`

Retrieves all defined shared parameters from the shared parameter file.

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of DB.ExternalDefinition objects representing the shared parameters. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If there is an error accessing the shared parameter file. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>773<br>774<br>775<br>776<br>777<br>778<br>779<br>780<br>781<br>782<br>783<br>784<br>785<br>786<br>787<br>788<br>789<br>``` | ```md-code__content<br>def get_defined_sharedparams():<br>    """<br>    Retrieves all defined shared parameters from the shared parameter file.<br>    Returns:<br>        list: A list of DB.ExternalDefinition objects representing the shared parameters.<br>    Raises:<br>        PyRevitException: If there is an error accessing the shared parameter file.<br>    """<br>    pp_list = []<br>    try:<br>        for def_group in get_sharedparam_definition_file().Groups:<br>            pp_list.extend([x for x in def_group.Definitions])<br>    except PyRevitException as ex:<br>        mlogger.debug("Error getting shared parameters. | %s", ex)<br>    return pp_list<br>``` |

### `get_project_parameters(doc=None)`

Retrieves the project parameters from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document from which to retrieve the project parameters.<br>If not provided, defaults to `DOCS.doc`. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of ProjectParameter objects representing the project parameters in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>792<br>793<br>794<br>795<br>796<br>797<br>798<br>799<br>800<br>801<br>802<br>803<br>804<br>805<br>806<br>807<br>808<br>809<br>810<br>811<br>812<br>813<br>814<br>815<br>816<br>817<br>818<br>``` | ```md-code__content<br>def get_project_parameters(doc=None):<br>    """<br>    Retrieves the project parameters from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document from which to retrieve the project parameters.<br>                                  If not provided, defaults to `DOCS.doc`.<br>    Returns:<br>        list: A list of ProjectParameter objects representing the project parameters in the document.<br>    """<br>    doc = doc or DOCS.doc<br>    shared_params = {x.Name: x for x in get_defined_sharedparams()}<br>    pp_list = []<br>    if doc and not doc.IsFamilyDocument:<br>        param_bindings = doc.ParameterBindings<br>        pb_iterator = param_bindings.ForwardIterator()<br>        pb_iterator.Reset()<br>        while pb_iterator.MoveNext():<br>            msp = db.ProjectParameter(<br>                pb_iterator.Key,<br>                param_bindings[pb_iterator.Key],<br>                param_ext_def=shared_params.get(pb_iterator.Key.Name, None),<br>            )<br>            pp_list.append(msp)<br>    return pp_list<br>``` |

### `get_project_parameter_id(param_name, doc=None)`

Retrieves the ID of a project parameter by its name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | The name of the project parameter to find. | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided,<br>the default document (DOCS.doc) will be used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `ElementId` |  | The ID of the project parameter. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If the parameter with the specified name is not found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>821<br>822<br>823<br>824<br>825<br>826<br>827<br>828<br>829<br>830<br>831<br>832<br>833<br>834<br>835<br>836<br>837<br>838<br>839<br>840<br>``` | ```md-code__content<br>def get_project_parameter_id(param_name, doc=None):<br>    """<br>    Retrieves the ID of a project parameter by its name.<br>    Args:<br>        param_name (str): The name of the project parameter to find.<br>        doc (Document, optional): The Revit document to search in. If not provided,<br>                                  the default document (DOCS.doc) will be used.<br>    Returns:<br>        ElementId: The ID of the project parameter.<br>    Raises:<br>        PyRevitException: If the parameter with the specified name is not found.<br>    """<br>    doc = doc or DOCS.doc<br>    for project_param in get_project_parameters(doc):<br>        if project_param.name == param_name:<br>            return project_param.param_id<br>    raise PyRevitException("Parameter not found: {}".format(param_name))<br>``` |

### `get_project_parameter(param_id_or_name, doc=None)`

Retrieves a project parameter by its ID or name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_id_or_name` | `str or int` | The ID or name of the project parameter to retrieve. | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided, the default document is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `ProjectParameter` |  | The matching project parameter if found, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>843<br>844<br>845<br>846<br>847<br>848<br>849<br>850<br>851<br>852<br>853<br>854<br>855<br>856<br>857<br>858<br>``` | ```md-code__content<br>def get_project_parameter(param_id_or_name, doc=None):<br>    """<br>    Retrieves a project parameter by its ID or name.<br>    Args:<br>        param_id_or_name (str or int): The ID or name of the project parameter to retrieve.<br>        doc (Document, optional): The Revit document to search in. If not provided, the default document is used.<br>    Returns:<br>        ProjectParameter: The matching project parameter if found, otherwise None.<br>    """<br>    pp_list = get_project_parameters(doc or DOCS.doc)<br>    for msp in pp_list:<br>        if msp == param_id_or_name:<br>            return msp<br>    return None<br>``` |

### `model_has_parameter(param_id_or_name, doc=None)`

Checks if the model has a specific parameter by its ID or name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_id_or_name` | `str or int` | The parameter ID or name to check for. | _required_ |
| `doc` | `Document` | The Revit document to search in. If None, the current document is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the parameter exists in the model, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>861<br>862<br>863<br>864<br>865<br>866<br>867<br>868<br>869<br>870<br>871<br>872<br>``` | ```md-code__content<br>def model_has_parameter(param_id_or_name, doc=None):<br>    """<br>    Checks if the model has a specific parameter by its ID or name.<br>    Args:<br>        param_id_or_name (str or int): The parameter ID or name to check for.<br>        doc (Document, optional): The Revit document to search in. If None, the current document is used.<br>    Returns:<br>        bool: True if the parameter exists in the model, False otherwise.<br>    """<br>    return get_project_parameter(param_id_or_name, doc=doc)<br>``` |

### `get_global_parameters(doc=None)`

Retrieves all global parameters from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document from which to retrieve global parameters.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of global parameter elements in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>875<br>876<br>877<br>878<br>879<br>880<br>881<br>882<br>883<br>884<br>885<br>886<br>887<br>888<br>889<br>890<br>``` | ```md-code__content<br>def get_global_parameters(doc=None):<br>    """<br>    Retrieves all global parameters from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document from which to retrieve global parameters.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of global parameter elements in the document.<br>    """<br>    doc = doc or DOCS.doc<br>    return [<br>        doc.GetElement(x)<br>        for x in DB.GlobalParametersManager.GetAllGlobalParameters(doc)<br>    ]<br>``` |

### `get_global_parameter(param_name, doc=None)`

Retrieves a global parameter by its name from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | The name of the global parameter to retrieve. | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | DB.GlobalParameter: The global parameter element if found, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>893<br>894<br>895<br>896<br>897<br>898<br>899<br>900<br>901<br>902<br>903<br>904<br>905<br>906<br>907<br>908<br>``` | ```md-code__content<br>def get_global_parameter(param_name, doc=None):<br>    """<br>    Retrieves a global parameter by its name from the given Revit document.<br>    Args:<br>        param_name (str): The name of the global parameter to retrieve.<br>        doc (DB.Document, optional): The Revit document to search in. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        DB.GlobalParameter: The global parameter element if found, otherwise None.<br>    """<br>    doc = doc or DOCS.doc<br>    if features.GLOBAL_PARAMS:<br>        param_id = DB.GlobalParametersManager.FindByName(doc, param_name)<br>        if param_id != DB.ElementId.InvalidElementId:<br>            return doc.GetElement(param_id)<br>``` |

### `get_project_info(doc=None)`

Retrieves the project information from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document from which to retrieve the project information.<br>If not provided, the default document (DOCS.doc) will be used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `ProjectInfo` |  | The project information of the specified or default Revit document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>911<br>912<br>913<br>914<br>915<br>916<br>917<br>918<br>919<br>920<br>921<br>922<br>``` | ```md-code__content<br>def get_project_info(doc=None):<br>    """<br>    Retrieves the project information from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document from which to retrieve the project information.<br>                                  If not provided, the default document (DOCS.doc) will be used.<br>    Returns:<br>        ProjectInfo: The project information of the specified or default Revit document.<br>    """<br>    return db.ProjectInfo(doc or DOCS.doc)<br>``` |

### `get_phases_names(doc=None)`

Returns a comma-separated list of the names of the phases in a project.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `document` | `Document` | A Revit document. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | A comma-separated list of the names of the phases in a project. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>925<br>926<br>927<br>928<br>929<br>930<br>931<br>932<br>933<br>934<br>935<br>936<br>937<br>938<br>939<br>940<br>``` | ```md-code__content<br>def get_phases_names(doc=None):<br>    """<br>    Returns a comma-separated list of the names of the phases in a project.<br>    Args:<br>        document (Document): A Revit document.<br>    Returns:<br>        str: A comma-separated list of the names of the phases in a project.<br>    """<br>    if not hasattr(doc, "Phases"):<br>        return "-"<br>    return ", ".join(phase.Name for phase in doc.Phases)<br>``` |

### `get_revisions(doc=None)`

Retrieves a list of revision elements from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve revisions from.<br>If not provided, the default document (DOCS.doc) is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of revision elements in the specified Revit document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>943<br>944<br>945<br>946<br>947<br>948<br>949<br>950<br>951<br>952<br>953<br>954<br>955<br>956<br>957<br>958<br>``` | ```md-code__content<br>def get_revisions(doc=None):<br>    """<br>    Retrieves a list of revision elements from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve revisions from.<br>                                  If not provided, the default document (DOCS.doc) is used.<br>    Returns:<br>        list: A list of revision elements in the specified Revit document.<br>    """<br>    return list(<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .OfCategory(DB.BuiltInCategory.OST_Revisions)<br>        .WhereElementIsNotElementType()<br>    )<br>``` |

### `get_sheet_revisions(sheet)`

Retrieves the revisions associated with a given Revit sheet.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `sheet` | `ViewSheet` | The Revit sheet from which to retrieve revisions. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | list\[Autodesk.Revit.DB.Element\]: A list of revision elements associated with the sheet. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>961<br>962<br>963<br>964<br>965<br>966<br>967<br>968<br>969<br>970<br>971<br>972<br>``` | ```md-code__content<br>def get_sheet_revisions(sheet):<br>    """<br>    Retrieves the revisions associated with a given Revit sheet.<br>    Args:<br>        sheet (Autodesk.Revit.DB.ViewSheet): The Revit sheet from which to retrieve revisions.<br>    Returns:<br>        list[Autodesk.Revit.DB.Element]: A list of revision elements associated with the sheet.<br>    """<br>    doc = sheet.Document<br>    return [doc.GetElement(x) for x in sheet.GetAdditionalRevisionIds()]<br>``` |

### `get_current_sheet_revision(sheet)`

Retrieves the current revision of the given sheet.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `sheet` | `ViewSheet` | The sheet for which to get the current revision. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | Autodesk.Revit.DB.Element: The current revision element of the sheet. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>975<br>976<br>977<br>978<br>979<br>980<br>981<br>982<br>983<br>984<br>985<br>986<br>``` | ```md-code__content<br>def get_current_sheet_revision(sheet):<br>    """<br>    Retrieves the current revision of the given sheet.<br>    Args:<br>        sheet (Autodesk.Revit.DB.ViewSheet): The sheet for which to get the current revision.<br>    Returns:<br>        Autodesk.Revit.DB.Element: The current revision element of the sheet.<br>    """<br>    doc = sheet.Document<br>    return doc.GetElement(sheet.GetCurrentRevision())<br>``` |

### `get_sheets(include_placeholders=True, include_noappear=True, doc=None)`

Retrieves a list of sheets from the Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `include_placeholders` | `bool` | If True, includes placeholder sheets in the result. Defaults to True. | `True` |
| `include_noappear` | `bool` | If True, includes sheets that do not appear in the project browser. Defaults to True. | `True` |
| `doc` | `Document` | The Revit document to retrieve sheets from. If None, uses the current document. Defaults to None. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of sheets from the specified Revit document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br> 989<br> 990<br> 991<br> 992<br> 993<br> 994<br> 995<br> 996<br> 997<br> 998<br> 999<br>1000<br>1001<br>1002<br>1003<br>1004<br>1005<br>1006<br>1007<br>1008<br>1009<br>1010<br>1011<br>1012<br>1013<br>1014<br>1015<br>``` | ```md-code__content<br>def get_sheets(include_placeholders=True, include_noappear=True, doc=None):<br>    """<br>    Retrieves a list of sheets from the Revit document.<br>    Args:<br>        include_placeholders (bool, optional): If True, includes placeholder sheets in the result. Defaults to True.<br>        include_noappear (bool, optional): If True, includes sheets that do not appear in the project browser. Defaults to True.<br>        doc (Document, optional): The Revit document to retrieve sheets from. If None, uses the current document. Defaults to None.<br>    Returns:<br>        list: A list of sheets from the specified Revit document.<br>    """<br>    sheets = list(<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .OfCategory(DB.BuiltInCategory.OST_Sheets)<br>        .WhereElementIsNotElementType()<br>    )<br>    if not include_noappear:<br>        sheets = [<br>            x<br>            for x in sheets<br>            if x.Parameter[DB.BuiltInParameter.SHEET_SCHEDULED].AsInteger() > 0<br>        ]<br>    if not include_placeholders:<br>        return [x for x in sheets if not x.IsPlaceholder]<br>    return sheets<br>``` |

### `get_document_clean_name(doc=None)`

Return the name of the given document without the file path or file
extension.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve links from. If None, the default document<br>(DOCS.doc) is used. Defaults to None. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The name of the given document without the file path or file |
|  |  | extension. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1018<br>1019<br>1020<br>1021<br>1022<br>1023<br>1024<br>1025<br>1026<br>1027<br>1028<br>1029<br>1030<br>1031<br>1032<br>1033<br>1034<br>1035<br>1036<br>1037<br>1038<br>``` | ```md-code__content<br>def get_document_clean_name(doc=None):<br>    """<br>    Return the name of the given document without the file path or file<br>    extension.<br>    Args:<br>        doc (DB.Document, optional): The Revit document to retrieve links from. If None, the default document<br>            (DOCS.doc) is used. Defaults to None.<br>    Returns:<br>        str: The name of the given document without the file path or file<br>        extension.<br>    """<br>    document_name = db.ProjectInfo(doc or DOCS.doc).path<br>    if not document_name:<br>        return "File Not Saved"<br>    if document_name.startswith("BIM 360://"):<br>        path = document_name.split("://", 1)[1]<br>    else:<br>        path = document_name<br>    return splitext(basename(path))[0]<br>``` |

### `get_links(linktype=None, doc=None)`

Retrieves external file references (links) from a Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `linktype` | `ExternalFileReferenceType` | The type of external file reference to filter by.<br>If None, all external file references are returned. Defaults to None. | `None` |
| `doc` | `Document` | The Revit document to retrieve links from. If None, the default document<br>(DOCS.doc) is used. Defaults to None. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of db.ExternalRef objects representing the external file references in the document. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If the document is not saved or if there is an error reading the links from the model path. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1041<br>1042<br>1043<br>1044<br>1045<br>1046<br>1047<br>1048<br>1049<br>1050<br>1051<br>1052<br>1053<br>1054<br>1055<br>1056<br>1057<br>1058<br>1059<br>1060<br>1061<br>1062<br>1063<br>1064<br>1065<br>1066<br>1067<br>1068<br>1069<br>1070<br>1071<br>1072<br>1073<br>1074<br>1075<br>1076<br>1077<br>1078<br>1079<br>1080<br>``` | ```md-code__content<br>def get_links(linktype=None, doc=None):<br>    """<br>    Retrieves external file references (links) from a Revit document.<br>    Args:<br>        linktype (DB.ExternalFileReferenceType, optional): The type of external file reference to filter by.<br>            If None, all external file references are returned. Defaults to None.<br>        doc (DB.Document, optional): The Revit document to retrieve links from. If None, the default document<br>            (DOCS.doc) is used. Defaults to None.<br>    Returns:<br>        list: A list of db.ExternalRef objects representing the external file references in the document.<br>    Raises:<br>        PyRevitException: If the document is not saved or if there is an error reading the links from the model path.<br>    """<br>    doc = doc or DOCS.doc<br>    location = doc.PathName<br>    if not location:<br>        raise PyRevitException("PathName is empty. Model is not saved.")<br>    links = []<br>    model_path = DB.ModelPathUtils.ConvertUserVisiblePathToModelPath(location)<br>    if not model_path:<br>        raise PyRevitException("Model is not saved. Can not read links.")<br>    try:<br>        trans_data = DB.TransmissionData.ReadTransmissionData(model_path)<br>        external_refs = trans_data.GetAllExternalFileReferenceIds()<br>        for ref_id in external_refs:<br>            ext_ref = trans_data.GetLastSavedReferenceData(ref_id)<br>            link = doc.GetElement(ref_id)<br>            if linktype:<br>                if ext_ref.ExternalFileReferenceType == linktype:<br>                    links.append(db.ExternalRef(link, ext_ref))<br>            else:<br>                links.append(db.ExternalRef(link, ext_ref))<br>        return links<br>    except Exception as data_err:<br>        raise PyRevitException(<br>            "Error reading links from model path: {} | {}".format(model_path, data_err)<br>        )<br>``` |

### `get_linked_models(doc=None, loaded_only=False)`

Retrieves the linked Revit models in the given document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search for linked models.<br>If None, defaults to DOCS.doc. | `None` |
| `loaded_only` | `bool` | If True, only returns the linked models that are currently loaded.<br>Defaults to False. | `False` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of linked Revit models. If loaded\_only is True, only the loaded models are returned. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1083<br>1084<br>1085<br>1086<br>1087<br>1088<br>1089<br>1090<br>1091<br>1092<br>1093<br>1094<br>1095<br>1096<br>1097<br>1098<br>1099<br>1100<br>1101<br>``` | ```md-code__content<br>def get_linked_models(doc=None, loaded_only=False):<br>    """<br>    Retrieves the linked Revit models in the given document.<br>    Args:<br>        doc (Document, optional): The Revit document to search for linked models.<br>                                  If None, defaults to DOCS.doc.<br>        loaded_only (bool, optional): If True, only returns the linked models that are currently loaded.<br>                                      Defaults to False.<br>    Returns:<br>        list: A list of linked Revit models. If loaded_only is True, only the loaded models are returned.<br>    """<br>    doc = doc or DOCS.doc<br>    linkedmodels = get_links(linktype=DB.ExternalFileReferenceType.RevitLink, doc=doc)<br>    if loaded_only:<br>        return [x for x in linkedmodels if DB.RevitLinkType.IsLoaded(doc, x.id)]<br>    return linkedmodels<br>``` |

### `get_linked_model_doc(linked_model)`

Retrieves the document of a linked Revit model.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `linked_model` | `Union[RevitLinkType, ExternalRef]` | The linked model, which can be either a RevitLinkType or an ExternalRef. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `Document` |  | The document of the linked model if found, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1104<br>1105<br>1106<br>1107<br>1108<br>1109<br>1110<br>1111<br>1112<br>1113<br>1114<br>1115<br>1116<br>1117<br>1118<br>1119<br>1120<br>1121<br>1122<br>1123<br>``` | ```md-code__content<br>def get_linked_model_doc(linked_model):<br>    """<br>    Retrieves the document of a linked Revit model.<br>    Args:<br>        linked_model (Union[DB.RevitLinkType, db.ExternalRef]): The linked model, which can be either a RevitLinkType or an ExternalRef.<br>    Returns:<br>        Document: The document of the linked model if found, otherwise None.<br>    """<br>    lmodel = None<br>    if isinstance(linked_model, DB.RevitLinkType):<br>        lmodel = db.ExternalRef(linked_model)  # pylint: disable=E1120<br>    elif isinstance(linked_model, db.ExternalRef):<br>        lmodel = linked_model<br>    if lmodel:<br>        for open_doc in DOCS.docs:<br>            if open_doc.Title == lmodel.name:<br>                return open_doc<br>``` |

### `get_linked_model_types(doc, rvt_links_instances)`

Retrieves the types of linked Revit models.
Args:
doc (Document): The Revit document. Defaults to None.
rvt\_links\_instances (list): A list of Revit link instances.
Returns:
list: A list of linked model types.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1126<br>1127<br>1128<br>1129<br>1130<br>1131<br>1132<br>1133<br>1134<br>1135<br>``` | ```md-code__content<br>def get_linked_model_types(doc, rvt_links_instances):<br>    """<br>    Retrieves the types of linked Revit models.<br>    Args:<br>        doc (Document): The Revit document. Defaults to None.<br>        rvt_links_instances (list): A list of Revit link instances.<br>    Returns:<br>        list: A list of linked model types.<br>    """<br>    return [doc.GetElement(rvtlink.GetTypeId()) for rvtlink in rvt_links_instances]<br>``` |

### `get_linked_model_instances(doc=None)`

Returns a list of all rvt\_links instances in a document

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | A Revit document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of Revit link instances. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1138<br>1139<br>1140<br>1141<br>1142<br>1143<br>1144<br>1145<br>1146<br>1147<br>1148<br>1149<br>1150<br>1151<br>1152<br>``` | ```md-code__content<br>def get_linked_model_instances(doc=None):<br>    """<br>    Returns a list of all rvt_links instances in a document<br>    Args:<br>        doc (Document): A Revit document.<br>    Returns:<br>        list: A list of Revit link instances.<br>    """<br>    return (<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .OfCategory(DB.BuiltInCategory.OST_RvtLinks)<br>        .WhereElementIsNotElementType()<br>    )<br>``` |

### `get_rvt_link_status(doc=None)`

Retrieves the status of linked Revit models in the given document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to query. If None, the current document is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of statuses for each linked Revit model type. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1155<br>1156<br>1157<br>1158<br>1159<br>1160<br>1161<br>1162<br>1163<br>1164<br>1165<br>1166<br>1167<br>1168<br>``` | ```md-code__content<br>def get_rvt_link_status(doc=None):<br>    """<br>    Retrieves the status of linked Revit models in the given document.<br>    Args:<br>        doc (Document, optional): The Revit document to query. If None, the current document is used.<br>    Returns:<br>        list: A list of statuses for each linked Revit model type.<br>    """<br>    doc = doc or DOCS.doc<br>    rvtlinks_instances = get_linked_model_instances(doc)<br>    rvtlinks_types = get_linked_model_types(doc, rvtlinks_instances)<br>    return [rvtlinktype.GetLinkedFileStatus() for rvtlinktype in rvtlinks_types]<br>``` |

### `get_rvt_link_doc_name(rvtlink_instance)`

Retrieves the name of the Revit link document from the given Revit link instance.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvtlink_instance` |  | The Revit link instance from which to extract the document name. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The name of the Revit link document, without the file extension and any directory paths. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1171<br>1172<br>1173<br>1174<br>1175<br>1176<br>1177<br>1178<br>1179<br>1180<br>1181<br>``` | ```md-code__content<br>def get_rvt_link_doc_name(rvtlink_instance):<br>    """<br>    Retrieves the name of the Revit link document from the given Revit link instance.<br>    Args:<br>        rvtlink_instance: The Revit link instance from which to extract the document name.<br>    Returns:<br>        str: The name of the Revit link document, without the file extension and any directory paths.<br>    """<br>    return get_name(rvtlink_instance).split("\\")[0].split(".rvt")[0]<br>``` |

### `get_rvt_link_instance_name(rvtlink_instance=None)`

Retrieves the name of a Revit link instance.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `rvtlink_instance` |  | The Revit link instance object. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The name of the Revit link instance, extracted from the full name. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1184<br>1185<br>1186<br>1187<br>1188<br>1189<br>1190<br>1191<br>1192<br>1193<br>1194<br>``` | ```md-code__content<br>def get_rvt_link_instance_name(rvtlink_instance=None):<br>    """<br>    Retrieves the name of a Revit link instance.<br>    Args:<br>        rvtlink_instance: The Revit link instance object.<br>    Returns:<br>        str: The name of the Revit link instance, extracted from the full name.<br>    """<br>    return get_name(rvtlink_instance).split(" : ")[1]<br>``` |

### `find_first_legend(doc=None)`

Finds the first legend view in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search in. If not provided,<br>it defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `View` |  | The first legend view found in the document, or None if no legend view is found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1197<br>1198<br>1199<br>1200<br>1201<br>1202<br>1203<br>1204<br>1205<br>1206<br>1207<br>1208<br>1209<br>1210<br>1211<br>1212<br>``` | ```md-code__content<br>def find_first_legend(doc=None):<br>    """<br>    Finds the first legend view in the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to search in. If not provided,<br>                                  it defaults to DOCS.doc.<br>    Returns:<br>        View: The first legend view found in the document, or None if no legend view is found.<br>    """<br>    doc = doc or DOCS.doc<br>    for view in DB.FilteredElementCollector(doc).OfClass(DB.View):<br>        if view.ViewType == DB.ViewType.Legend and not view.IsTemplate:<br>            return view<br>    return None<br>``` |

### `compare_revisions(src_rev, dest_rev, case_sensitive=False)`

Compare two revision objects based on specific attributes.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `src_rev` | `object` | The source revision object to compare. | _required_ |
| `dest_rev` | `object` | The destination revision object to compare. | _required_ |
| `case_sensitive` | `bool` | Flag to indicate if the comparison should be case sensitive. Defaults to False. | `False` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if all specified attributes match between the two revisions, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1215<br>1216<br>1217<br>1218<br>1219<br>1220<br>1221<br>1222<br>1223<br>1224<br>1225<br>1226<br>1227<br>1228<br>1229<br>1230<br>1231<br>1232<br>1233<br>1234<br>``` | ```md-code__content<br>def compare_revisions(src_rev, dest_rev, case_sensitive=False):<br>    """<br>    Compare two revision objects based on specific attributes.<br>    Args:<br>        src_rev (object): The source revision object to compare.<br>        dest_rev (object): The destination revision object to compare.<br>        case_sensitive (bool, optional): Flag to indicate if the comparison should be case sensitive. Defaults to False.<br>    Returns:<br>        bool: True if all specified attributes match between the two revisions, False otherwise.<br>    """<br>    return all(<br>        db.BaseWrapper.compare_attrs(<br>            src_rev,<br>            dest_rev,<br>            ["RevisionDate", "Description", "IssuedBy", "IssuedTo"],<br>            case_sensitive=case_sensitive,<br>        )<br>    )<br>``` |

### `get_all_views(doc=None, view_types=None, include_nongraphical=False)`

Retrieves all views from the given Revit document, with optional filtering by view types and graphical views.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve views from. If None, defaults to DOCS.doc. | `None` |
| `view_types` | `list` | A list of view types to filter the views. If None, no filtering is applied. | `None` |
| `include_nongraphical` | `bool` | If True, includes non-graphical views in the result. Defaults to False. | `False` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of views from the Revit document, filtered by the specified criteria. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1237<br>1238<br>1239<br>1240<br>1241<br>1242<br>1243<br>1244<br>1245<br>1246<br>1247<br>1248<br>1249<br>1250<br>1251<br>1252<br>1253<br>1254<br>1255<br>1256<br>1257<br>1258<br>1259<br>1260<br>1261<br>1262<br>1263<br>1264<br>1265<br>1266<br>1267<br>``` | ```md-code__content<br>def get_all_views(doc=None, view_types=None, include_nongraphical=False):<br>    """<br>    Retrieves all views from the given Revit document, with optional filtering by view types and graphical views.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve views from. If None, defaults to DOCS.doc.<br>        view_types (list, optional): A list of view types to filter the views. If None, no filtering is applied.<br>        include_nongraphical (bool, optional): If True, includes non-graphical views in the result. Defaults to False.<br>    Returns:<br>        list: A list of views from the Revit document, filtered by the specified criteria.<br>    """<br>    doc = doc or DOCS.doc<br>    all_views = (<br>        DB.FilteredElementCollector(doc)<br>        .OfClass(DB.View)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>    if view_types:<br>        all_views = [x for x in all_views if x.ViewType in view_types]<br>    if not include_nongraphical:<br>        return [<br>            x<br>            for x in all_views<br>            if x.ViewType in GRAPHICAL_VIEWTYPES<br>            and not x.IsTemplate<br>            and not x.ViewSpecific<br>        ]<br>    return all_views<br>``` |

### `get_all_view_templates(doc=None, view_types=None)`

Retrieves all view templates from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search for view templates.<br>If None, the active document will be used. | `None` |
| `view_types` | `list` | A list of view types to filter the views.<br>If None, all view types will be considered. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of view templates found in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1270<br>1271<br>1272<br>1273<br>1274<br>1275<br>1276<br>1277<br>1278<br>1279<br>1280<br>1281<br>1282<br>1283<br>1284<br>1285<br>1286<br>1287<br>1288<br>1289<br>``` | ```md-code__content<br>def get_all_view_templates(doc=None, view_types=None):<br>    """<br>    Retrieves all view templates from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to search for view templates.<br>                                  If None, the active document will be used.<br>        view_types (list, optional): A list of view types to filter the views.<br>                                     If None, all view types will be considered.<br>    Returns:<br>        list: A list of view templates found in the document.<br>    """<br>    return [<br>        x<br>        for x in get_all_views(<br>            doc=doc, view_types=view_types, include_nongraphical=True<br>        )<br>        if x.IsTemplate<br>    ]<br>``` |

### `get_sheet_by_number(sheet_num, doc=None)`

Retrieves a sheet from the document by its sheet number.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `sheet_num` | `str` | The sheet number to search for. | _required_ |
| `doc` | `Document` | The Revit document to search within.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `Element` |  | The sheet element with the specified sheet number,<br>or None if no matching sheet is found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1292<br>1293<br>1294<br>1295<br>1296<br>1297<br>1298<br>1299<br>1300<br>1301<br>1302<br>1303<br>1304<br>1305<br>1306<br>``` | ```md-code__content<br>def get_sheet_by_number(sheet_num, doc=None):<br>    """<br>    Retrieves a sheet from the document by its sheet number.<br>    Args:<br>        sheet_num (str): The sheet number to search for.<br>        doc (Document, optional): The Revit document to search within.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        Element: The sheet element with the specified sheet number,<br>                 or None if no matching sheet is found.<br>    """<br>    doc = doc or DOCS.doc<br>    return next((x for x in get_sheets(doc=doc) if x.SheetNumber == sheet_num), None)<br>``` |

### `get_viewport_by_number(sheet_num, detail_num, doc=None)`

Retrieves a viewport from a Revit document based on the sheet number and detail number.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `sheet_num` | `str` | The number of the sheet containing the viewport. | _required_ |
| `detail_num` | `str` | The detail number of the viewport to retrieve. | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `Element` |  | The viewport element if found, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1309<br>1310<br>1311<br>1312<br>1313<br>1314<br>1315<br>1316<br>1317<br>1318<br>1319<br>1320<br>1321<br>1322<br>1323<br>1324<br>1325<br>1326<br>1327<br>1328<br>1329<br>1330<br>``` | ```md-code__content<br>def get_viewport_by_number(sheet_num, detail_num, doc=None):<br>    """<br>    Retrieves a viewport from a Revit document based on the sheet number and detail number.<br>    Args:<br>        sheet_num (str): The number of the sheet containing the viewport.<br>        detail_num (str): The detail number of the viewport to retrieve.<br>        doc (Document, optional): The Revit document to search in. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        Element: The viewport element if found, otherwise None.<br>    """<br>    doc = doc or DOCS.doc<br>    sheet = get_sheet_by_number(sheet_num, doc=doc)<br>    if sheet:<br>        vps = [doc.GetElement(x) for x in sheet.GetAllViewports()]<br>        for vp in vps:<br>            det_num = vp.Parameter[<br>                DB.BuiltInParameter.VIEWPORT_DETAIL_NUMBER<br>            ].AsString()<br>            if det_num == detail_num:<br>                return vp<br>``` |

### `get_view_by_sheetref(sheet_num, detail_num, doc=None)`

Retrieves the view ID associated with a given sheet number and detail number.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `sheet_num` | `int` | The sheet number to search for. | _required_ |
| `detail_num` | `int` | The detail number to search for. | _required_ |
| `doc` | `Document` | The Revit document to search within. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `ElementId` |  | The ID of the view associated with the specified sheet and detail numbers, or None if not found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1333<br>1334<br>1335<br>1336<br>1337<br>1338<br>1339<br>1340<br>1341<br>1342<br>1343<br>1344<br>1345<br>1346<br>1347<br>1348<br>``` | ```md-code__content<br>def get_view_by_sheetref(sheet_num, detail_num, doc=None):<br>    """<br>    Retrieves the view ID associated with a given sheet number and detail number.<br>    Args:<br>        sheet_num (int): The sheet number to search for.<br>        detail_num (int): The detail number to search for.<br>        doc (Document, optional): The Revit document to search within. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        ElementId: The ID of the view associated with the specified sheet and detail numbers, or None if not found.<br>    """<br>    doc = doc or DOCS.doc<br>    vport = get_viewport_by_number(sheet_num, detail_num, doc=doc)<br>    if vport:<br>        return vport.ViewId<br>``` |

### `is_schedule(view)`

Determines if the given view is a schedule that is not a template,
title block revision schedule, internal keynote schedule, or keynote legend.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view to check. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the view is a schedule and not one of the excluded types, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1351<br>1352<br>1353<br>1354<br>1355<br>1356<br>1357<br>1358<br>1359<br>1360<br>1361<br>1362<br>1363<br>1364<br>1365<br>1366<br>1367<br>1368<br>1369<br>1370<br>1371<br>``` | ```md-code__content<br>def is_schedule(view):<br>    """<br>    Determines if the given view is a schedule that is not a template,<br>    title block revision schedule, internal keynote schedule, or keynote legend.<br>    Args:<br>        view (DB.View): The Revit view to check.<br>    Returns:<br>        bool: True if the view is a schedule and not one of the excluded types, False otherwise.<br>    """<br>    if isinstance(view, DB.ViewSchedule) and not view.IsTemplate:<br>        isrevsched = view.IsTitleblockRevisionSchedule<br>        isintkeynote = view.IsInternalKeynoteSchedule<br>        iskeynotelegend = (<br>            view.Definition.CategoryId<br>            == get_category(DB.BuiltInCategory.OST_KeynoteTags).Id<br>        )<br>        return not (isrevsched or isintkeynote or iskeynotelegend)<br>    return False<br>``` |

### `get_all_schedules(doc=None)`

Retrieves all schedule views from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve schedules from.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `filter` |  | A filter object containing all schedule views in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1374<br>1375<br>1376<br>1377<br>1378<br>1379<br>1380<br>1381<br>1382<br>1383<br>1384<br>1385<br>1386<br>1387<br>1388<br>1389<br>1390<br>1391<br>1392<br>``` | ```md-code__content<br>def get_all_schedules(doc=None):<br>    """<br>    Retrieves all schedule views from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve schedules from.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        filter: A filter object containing all schedule views in the document.<br>    """<br>    doc = doc or DOCS.doc<br>    all_scheds = (<br>        DB.FilteredElementCollector(doc)<br>        .OfClass(DB.ViewSchedule)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>    return filter(is_schedule, all_scheds)<br>``` |

### `get_view_by_name(view_name, view_types=None, doc=None)`

Retrieves a Revit view by its name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view_name` | `str` | The name of the view to retrieve. | _required_ |
| `view_types` | `list` | A list of view types to filter the search. Defaults to None. | `None` |
| `doc` | `Document` | The Revit document to search within. Defaults to the active document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `View` |  | The Revit view that matches the given name, or None if no match is found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1395<br>1396<br>1397<br>1398<br>1399<br>1400<br>1401<br>1402<br>1403<br>1404<br>1405<br>1406<br>1407<br>1408<br>1409<br>1410<br>``` | ```md-code__content<br>def get_view_by_name(view_name, view_types=None, doc=None):<br>    """<br>    Retrieves a Revit view by its name.<br>    Args:<br>        view_name (str): The name of the view to retrieve.<br>        view_types (list, optional): A list of view types to filter the search. Defaults to None.<br>        doc (Document, optional): The Revit document to search within. Defaults to the active document.<br>    Returns:<br>        View: The Revit view that matches the given name, or None if no match is found.<br>    """<br>    doc = doc or DOCS.doc<br>    for view in get_all_views(doc=doc, view_types=view_types):<br>        if get_name(view) == view_name:<br>            return view<br>``` |

### `get_all_referencing_elements(doc=None)`

Retrieves all elements in the given Revit document that reference views.
This function collects all elements in the provided Revit document that are not element types,
belong to a category, are instances of DB.Element, and whose category is in the predefined
set of view-related built-in categories.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search for referencing elements.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | list\[DB.ElementId\]: A list of element IDs that reference views in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1413<br>1414<br>1415<br>1416<br>1417<br>1418<br>1419<br>1420<br>1421<br>1422<br>1423<br>1424<br>1425<br>1426<br>1427<br>1428<br>1429<br>1430<br>1431<br>1432<br>1433<br>1434<br>1435<br>1436<br>1437<br>1438<br>``` | ```md-code__content<br>def get_all_referencing_elements(doc=None):<br>    """<br>    Retrieves all elements in the given Revit document that reference views.<br>    This function collects all elements in the provided Revit document that are not element types,<br>    belong to a category, are instances of DB.Element, and whose category is in the predefined<br>    set of view-related built-in categories.<br>    Args:<br>        doc (DB.Document, optional): The Revit document to search for referencing elements.<br>                                     If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list[DB.ElementId]: A list of element IDs that reference views in the document.<br>    """<br>    doc = doc or DOCS.doc<br>    all_referencing_elements = []<br>    for el in (<br>        DB.FilteredElementCollector(doc).WhereElementIsNotElementType().ToElements()<br>    ):<br>        if (<br>            el.Category<br>            and isinstance(el, DB.Element)<br>            and get_builtincategory(el.Category) in BUILTINCATEGORIES_VIEW<br>        ):<br>            all_referencing_elements.append(el.Id)<br>    return all_referencing_elements<br>``` |

### `get_all_referencing_elements_in_view(view)`

Retrieves all elements in the given view that reference other elements.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view from which to collect referencing elements. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | list\[DB.ElementId\]: A list of element IDs that reference other elements in the view. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1441<br>1442<br>1443<br>1444<br>1445<br>1446<br>1447<br>1448<br>1449<br>1450<br>1451<br>1452<br>1453<br>1454<br>1455<br>1456<br>1457<br>1458<br>1459<br>1460<br>1461<br>1462<br>1463<br>``` | ```md-code__content<br>def get_all_referencing_elements_in_view(view):<br>    """<br>    Retrieves all elements in the given view that reference other elements.<br>    Args:<br>        view (DB.View): The Revit view from which to collect referencing elements.<br>    Returns:<br>        list[DB.ElementId]: A list of element IDs that reference other elements in the view.<br>    """<br>    all_referencing_elements_in_view = []<br>    for el in (<br>        DB.FilteredElementCollector(view.Document, view.Id)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    ):<br>        if (<br>            el.Category<br>            and isinstance(el, DB.Element)<br>            and get_builtincategory(el.Category) in BUILTINCATEGORIES_VIEW<br>        ):<br>            all_referencing_elements_in_view.append(el.Id)<br>    return all_referencing_elements_in_view<br>``` |

### `get_schedules_on_sheet(viewsheet, doc=None)`

Retrieves all schedule instances placed on a given Revit view sheet.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `viewsheet` | `ViewSheet` | The Revit view sheet from which to retrieve schedule instances. | _required_ |
| `doc` | `Document` | The Revit document. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of schedule instances (DB.ScheduleSheetInstance) that are placed on the given view sheet,<br>excluding title block revision schedules. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1466<br>1467<br>1468<br>1469<br>1470<br>1471<br>1472<br>1473<br>1474<br>1475<br>1476<br>1477<br>1478<br>1479<br>1480<br>1481<br>1482<br>1483<br>1484<br>1485<br>1486<br>1487<br>``` | ```md-code__content<br>def get_schedules_on_sheet(viewsheet, doc=None):<br>    """<br>    Retrieves all schedule instances placed on a given Revit view sheet.<br>    Args:<br>        viewsheet (DB.ViewSheet): The Revit view sheet from which to retrieve schedule instances.<br>        doc (DB.Document, optional): The Revit document. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of schedule instances (DB.ScheduleSheetInstance) that are placed on the given view sheet,<br>              excluding title block revision schedules.<br>    """<br>    doc = doc or DOCS.doc<br>    all_sheeted_scheds = (<br>        DB.FilteredElementCollector(doc).OfClass(DB.ScheduleSheetInstance).ToElements()<br>    )<br>    return [<br>        x<br>        for x in all_sheeted_scheds<br>        if x.OwnerViewId == viewsheet.Id<br>        and not doc.GetElement(x.ScheduleId).IsTitleblockRevisionSchedule<br>    ]<br>``` |

### `get_schedules_instances(doc=None)`

Retrieves all schedule instances placed on sheets.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search within. If not provided, <br>the default document (DOCS.doc) will be used. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | List\[ScheduleSheetInstance\]: A list of ScheduleSheetInstance elements. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1490<br>1491<br>1492<br>1493<br>1494<br>1495<br>1496<br>1497<br>1498<br>1499<br>1500<br>1501<br>1502<br>1503<br>1504<br>1505<br>``` | ```md-code__content<br>def get_schedules_instances(doc=None):<br>    """<br>    Retrieves all schedule instances placed on sheets.<br>    Args:<br>        doc (Document, optional): The Revit document to search within. If not provided, <br>                                  the default document (DOCS.doc) will be used.<br>    Returns:<br>        List[ScheduleSheetInstance]: A list of ScheduleSheetInstance elements.<br>    """<br>    return (<br>        DB.FilteredElementCollector(doc or DOCS.doc)<br>        .OfClass(DB.ScheduleSheetInstance)<br>        .ToElements()<br>    )<br>``` |

### `is_sheet_empty(viewsheet)`

Checks if a given Revit sheet is empty.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `viewsheet` |  | The Revit sheet to check. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the sheet has no viewports or schedules, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1508<br>1509<br>1510<br>1511<br>1512<br>1513<br>1514<br>1515<br>1516<br>1517<br>1518<br>1519<br>1520<br>1521<br>1522<br>``` | ```md-code__content<br>def is_sheet_empty(viewsheet):<br>    """<br>    Checks if a given Revit sheet is empty.<br>    Args:<br>        viewsheet: The Revit sheet to check.<br>    Returns:<br>        bool: True if the sheet has no viewports or schedules, False otherwise.<br>    """<br>    sheet_views = viewsheet.GetAllViewports()<br>    sheet_scheds = get_schedules_on_sheet(viewsheet, doc=viewsheet.Document)<br>    if sheet_views or sheet_scheds:<br>        return False<br>    return True<br>``` |

### `get_doc_categories(doc=None, include_subcats=True)`

Retrieves all categories from the given Revit document, optionally including subcategories.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document from which to retrieve categories.<br>If not provided, defaults to DOCS.doc. | `None` |
| `include_subcats` | `bool` | Whether to include subcategories in the result.<br>Defaults to True. | `True` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of all categories (and subcategories, if include\_subcats is True) in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1525<br>1526<br>1527<br>1528<br>1529<br>1530<br>1531<br>1532<br>1533<br>1534<br>1535<br>1536<br>1537<br>1538<br>1539<br>1540<br>1541<br>1542<br>1543<br>1544<br>1545<br>``` | ```md-code__content<br>def get_doc_categories(doc=None, include_subcats=True):<br>    """<br>    Retrieves all categories from the given Revit document, optionally including subcategories.<br>    Args:<br>        doc (Document, optional): The Revit document from which to retrieve categories.<br>                                  If not provided, defaults to DOCS.doc.<br>        include_subcats (bool, optional): Whether to include subcategories in the result.<br>                                          Defaults to True.<br>    Returns:<br>        list: A list of all categories (and subcategories, if include_subcats is True) in the document.<br>    """<br>    doc = doc or DOCS.doc<br>    all_cats = []<br>    cats = doc.Settings.Categories<br>    all_cats.extend(cats)<br>    if include_subcats:<br>        for cat in cats:<br>            all_cats.extend([x for x in cat.SubCategories])<br>    return all_cats<br>``` |

### `get_schedule_categories(doc=None)`

Retrieves the categories that are valid for schedules in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve the schedule categories from.<br>If not provided, it defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of categories that are valid for schedules in the given Revit document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1548<br>1549<br>1550<br>1551<br>1552<br>1553<br>1554<br>1555<br>1556<br>1557<br>1558<br>1559<br>1560<br>1561<br>1562<br>1563<br>1564<br>1565<br>1566<br>``` | ```md-code__content<br>def get_schedule_categories(doc=None):<br>    """<br>    Retrieves the categories that are valid for schedules in the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve the schedule categories from.<br>                                  If not provided, it defaults to DOCS.doc.<br>    Returns:<br>        list: A list of categories that are valid for schedules in the given Revit document.<br>    """<br>    doc = doc or DOCS.doc<br>    all_cats = get_doc_categories(doc)<br>    cats = []<br>    for cat_id in DB.ViewSchedule.GetValidCategoriesForSchedule():<br>        for cat in all_cats:<br>            if cat.Id == cat_id:<br>                cats.append(cat)<br>    return cats<br>``` |

### `get_key_schedule_categories(doc=None)`

Retrieves the categories that are valid for key schedules in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve categories from.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of categories that are valid for key schedules. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1569<br>1570<br>1571<br>1572<br>1573<br>1574<br>1575<br>1576<br>1577<br>1578<br>1579<br>1580<br>1581<br>1582<br>1583<br>1584<br>1585<br>1586<br>1587<br>``` | ```md-code__content<br>def get_key_schedule_categories(doc=None):<br>    """<br>    Retrieves the categories that are valid for key schedules in the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve categories from.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of categories that are valid for key schedules.<br>    """<br>    doc = doc or DOCS.doc<br>    all_cats = get_doc_categories(doc)<br>    cats = []<br>    for cat_id in DB.ViewSchedule.GetValidCategoriesForKeySchedule():<br>        for cat in all_cats:<br>            if cat.Id == cat_id:<br>                cats.append(cat)<br>    return cats<br>``` |

### `get_takeoff_categories(doc=None)`

Retrieves the categories that are valid for material takeoff schedules in a given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve categories from. If not provided,<br>the default document (DOCS.doc) will be used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of categories that are valid for material takeoff schedules. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1590<br>1591<br>1592<br>1593<br>1594<br>1595<br>1596<br>1597<br>1598<br>1599<br>1600<br>1601<br>1602<br>1603<br>1604<br>1605<br>1606<br>1607<br>1608<br>``` | ```md-code__content<br>def get_takeoff_categories(doc=None):<br>    """<br>    Retrieves the categories that are valid for material takeoff schedules in a given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve categories from. If not provided,<br>                                  the default document (DOCS.doc) will be used.<br>    Returns:<br>        list: A list of categories that are valid for material takeoff schedules.<br>    """<br>    doc = doc or DOCS.doc<br>    all_cats = get_doc_categories(doc)<br>    cats = []<br>    for cat_id in DB.ViewSchedule.GetValidCategoriesForMaterialTakeoff():<br>        for cat in all_cats:<br>            if cat.Id == cat_id:<br>                cats.append(cat)<br>    return cats<br>``` |

### `get_category(cat_name_or_builtin, doc=None)`

Retrieves a Revit category based on the provided category name, built-in category, or category object.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_builtin` | `Union[str, BuiltInCategory, Category]` | The category name as a string,<br>a built-in category enum, or a category object. | _required_ |
| `doc` | `Optional[Document]` | The Revit document to search within. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | DB.Category: The matching Revit category object, or None if no match is found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1611<br>1612<br>1613<br>1614<br>1615<br>1616<br>1617<br>1618<br>1619<br>1620<br>1621<br>1622<br>1623<br>1624<br>1625<br>1626<br>1627<br>1628<br>1629<br>1630<br>1631<br>1632<br>1633<br>1634<br>1635<br>``` | ```md-code__content<br>def get_category(cat_name_or_builtin, doc=None):<br>    """<br>    Retrieves a Revit category based on the provided category name, built-in category, or category object.<br>    Args:<br>        cat_name_or_builtin (Union[str, DB.BuiltInCategory, DB.Category]): The category name as a string,<br>            a built-in category enum, or a category object.<br>        doc (Optional[Document]): The Revit document to search within. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        DB.Category: The matching Revit category object, or None if no match is found.<br>    """<br>    doc = doc or DOCS.doc<br>    all_cats = get_doc_categories(doc)<br>    if isinstance(cat_name_or_builtin, str):<br>        for cat in all_cats:<br>            if cat.Name == cat_name_or_builtin:<br>                return cat<br>    elif isinstance(cat_name_or_builtin, DB.BuiltInCategory):<br>        get_elementid_value = get_elementid_value_func()<br>        for cat in all_cats:<br>            if get_elementid_value(cat.Id) == int(cat_name_or_builtin):<br>                return cat<br>    elif isinstance(cat_name_or_builtin, DB.Category):<br>        return cat_name_or_builtin<br>``` |

### `get_builtincategory(cat_name_or_id, doc=None)`

Retrieves the BuiltInCategory for a given category name or ElementId.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_id` | `str or ElementId` | The name of the category as a string or the ElementId of the category. | _required_ |
| `doc` | `optional` | The Revit document. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | DB.BuiltInCategory: The corresponding BuiltInCategory if found, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1638<br>1639<br>1640<br>1641<br>1642<br>1643<br>1644<br>1645<br>1646<br>1647<br>1648<br>1649<br>1650<br>1651<br>1652<br>1653<br>1654<br>1655<br>1656<br>1657<br>1658<br>1659<br>1660<br>1661<br>``` | ```md-code__content<br>def get_builtincategory(cat_name_or_id, doc=None):<br>    """<br>    Retrieves the BuiltInCategory for a given category name or ElementId.<br>    Args:<br>        cat_name_or_id (str or DB.ElementId): The name of the category as a string or the ElementId of the category.<br>        doc (optional): The Revit document. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        DB.BuiltInCategory: The corresponding BuiltInCategory if found, otherwise None.<br>    """<br>    doc = doc or DOCS.doc<br>    cat_id = None<br>    if isinstance(cat_name_or_id, str):<br>        cat = get_category(cat_name_or_id)<br>        if cat:<br>            cat_id = cat.Id<br>    elif isinstance(cat_name_or_id, DB.ElementId):<br>        cat_id = cat_name_or_id<br>    if cat_id:<br>        get_elementid_value = get_elementid_value_func()<br>        for bicat in DB.BuiltInCategory.GetValues(DB.BuiltInCategory):<br>            if int(bicat) == get_elementid_value(cat_id):<br>                return bicat<br>``` |

### `get_subcategories(doc=None, purgable=False, filterfunc=None)`

Retrieves subcategories from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve subcategories from.<br>If None, defaults to DOCS.doc. | `None` |
| `purgable` | `bool` | If True, only includes subcategories that are purgable<br>(element ID value greater than 1). Defaults to False. | `False` |
| `filterfunc` | `function` | A function to filter the subcategories.<br>If provided, only subcategories that satisfy<br>the filter function will be included. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of subcategories from the given Revit document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1664<br>1665<br>1666<br>1667<br>1668<br>1669<br>1670<br>1671<br>1672<br>1673<br>1674<br>1675<br>1676<br>1677<br>1678<br>1679<br>1680<br>1681<br>1682<br>1683<br>1684<br>1685<br>1686<br>1687<br>1688<br>1689<br>1690<br>1691<br>1692<br>1693<br>``` | ```md-code__content<br>def get_subcategories(doc=None, purgable=False, filterfunc=None):<br>    """<br>    Retrieves subcategories from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve subcategories from.<br>                                  If None, defaults to DOCS.doc.<br>        purgable (bool, optional): If True, only includes subcategories that are purgable<br>                                   (element ID value greater than 1). Defaults to False.<br>        filterfunc (function, optional): A function to filter the subcategories.<br>                                         If provided, only subcategories that satisfy<br>                                         the filter function will be included.<br>    Returns:<br>        list: A list of subcategories from the given Revit document.<br>    """<br>    doc = doc or DOCS.doc<br>    # collect custom categories<br>    subcategories = []<br>    get_elementid_value = get_elementid_value_func()<br>    for cat in doc.Settings.Categories:<br>        for subcat in cat.SubCategories:<br>            if purgable:<br>                if get_elementid_value(subcat.Id) > 1:<br>                    subcategories.append(subcat)<br>            else:<br>                subcategories.append(subcat)<br>    if filterfunc:<br>        subcategories = filter(filterfunc, subcategories)<br>    return subcategories<br>``` |

### `get_subcategory(cat_name_or_builtin, subcategory_name, doc=None)`

Retrieves a subcategory from a given category in a Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `cat_name_or_builtin` | `str or BuiltInCategory` | The name of the category or a built-in category. | _required_ |
| `subcategory_name` | `str` | The name of the subcategory to retrieve. | _required_ |
| `doc` | `Document` | The Revit document to search in. Defaults to the active document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `Category` |  | The subcategory if found, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1696<br>1697<br>1698<br>1699<br>1700<br>1701<br>1702<br>1703<br>1704<br>1705<br>1706<br>1707<br>1708<br>1709<br>1710<br>1711<br>1712<br>1713<br>``` | ```md-code__content<br>def get_subcategory(cat_name_or_builtin, subcategory_name, doc=None):<br>    """<br>    Retrieves a subcategory from a given category in a Revit document.<br>    Args:<br>        cat_name_or_builtin (str or BuiltInCategory): The name of the category or a built-in category.<br>        subcategory_name (str): The name of the subcategory to retrieve.<br>        doc (Document, optional): The Revit document to search in. Defaults to the active document.<br>    Returns:<br>        Category: The subcategory if found, otherwise None.<br>    """<br>    doc = doc or DOCS.doc<br>    cat = get_category(cat_name_or_builtin)<br>    if cat:<br>        for subcat in cat.SubCategories:<br>            if subcat.Name == subcategory_name:<br>                return subcat<br>``` |

### `get_builtinparameter(element, param_name, doc=None)`

Retrieves the built-in parameter associated with a given element and parameter name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element from which to retrieve the parameter. | _required_ |
| `param_name` | `str` | The name of the parameter to look up. | _required_ |
| `doc` | `Document` | The Revit document. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `BuiltInParameter` |  | The built-in parameter corresponding to the given element and parameter name. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If the parameter with the given name is not found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1716<br>1717<br>1718<br>1719<br>1720<br>1721<br>1722<br>1723<br>1724<br>1725<br>1726<br>1727<br>1728<br>1729<br>1730<br>1731<br>1732<br>1733<br>1734<br>1735<br>1736<br>1737<br>1738<br>1739<br>1740<br>``` | ```md-code__content<br>def get_builtinparameter(element, param_name, doc=None):<br>    """<br>    Retrieves the built-in parameter associated with a given element and parameter name.<br>    Args:<br>        element (Element): The Revit element from which to retrieve the parameter.<br>        param_name (str): The name of the parameter to look up.<br>        doc (Document, optional): The Revit document. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        BuiltInParameter: The built-in parameter corresponding to the given element and parameter name.<br>    Raises:<br>        PyRevitException: If the parameter with the given name is not found.<br>    """<br>    doc = doc or DOCS.doc<br>    eparam = element.LookupParameter(param_name)<br>    if eparam:<br>        eparam_def_id = eparam.Definition.Id<br>        get_elementid_value = get_elementid_value_func()<br>        for biparam in DB.BuiltInParameter.GetValues(DB.BuiltInParameter):<br>            if int(biparam) == get_elementid_value(eparam_def_id):<br>                return biparam<br>    else:<br>        raise PyRevitException("Parameter not found: {}".format(param_name))<br>``` |

### `get_view_cutplane_offset(view)`

Retrieves the offset of the cut plane for a given Revit view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view from which to get the cut plane offset. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `float` |  | The offset of the cut plane in the view. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1743<br>1744<br>1745<br>1746<br>1747<br>1748<br>1749<br>1750<br>1751<br>1752<br>1753<br>1754<br>``` | ```md-code__content<br>def get_view_cutplane_offset(view):<br>    """<br>    Retrieves the offset of the cut plane for a given Revit view.<br>    Args:<br>        view (Autodesk.Revit.DB.View): The Revit view from which to get the cut plane offset.<br>    Returns:<br>        float: The offset of the cut plane in the view.<br>    """<br>    viewrange = view.GetViewRange()<br>    return viewrange.GetOffset(DB.PlanViewPlane.CutPlane)<br>``` |

### `get_project_location_transform(doc=None)`

Retrieves the transformation matrix of the active project location in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document from which to get the project location transform.<br>If not provided, it defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `Transform` |  | The transformation matrix of the active project location. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1757<br>1758<br>1759<br>1760<br>1761<br>1762<br>1763<br>1764<br>1765<br>1766<br>1767<br>1768<br>1769<br>``` | ```md-code__content<br>def get_project_location_transform(doc=None):<br>    """<br>    Retrieves the transformation matrix of the active project location in the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document from which to get the project location transform.<br>                                  If not provided, it defaults to DOCS.doc.<br>    Returns:<br>        Transform: The transformation matrix of the active project location.<br>    """<br>    doc = doc or DOCS.doc<br>    return doc.ActiveProjectLocation.GetTransform()<br>``` |

### `get_all_linkedmodels(doc=None)`

Retrieves all linked Revit models in the given document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search for linked models.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | List\[Element\]: A list of RevitLinkType elements representing the linked models. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1772<br>1773<br>1774<br>1775<br>1776<br>1777<br>1778<br>1779<br>1780<br>1781<br>1782<br>1783<br>1784<br>``` | ```md-code__content<br>def get_all_linkedmodels(doc=None):<br>    """<br>    Retrieves all linked Revit models in the given document.<br>    Args:<br>        doc (Document, optional): The Revit document to search for linked models.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        List[Element]: A list of RevitLinkType elements representing the linked models.<br>    """<br>    doc = doc or DOCS.doc<br>    return DB.FilteredElementCollector(doc).OfClass(DB.RevitLinkType).ToElements()<br>``` |

### `get_all_linkeddocs(doc=None)`

Retrieves all linked documents in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search for linked documents.<br>If None, it defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of linked Revit documents. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1787<br>1788<br>1789<br>1790<br>1791<br>1792<br>1793<br>1794<br>1795<br>1796<br>1797<br>1798<br>1799<br>1800<br>1801<br>1802<br>1803<br>``` | ```md-code__content<br>def get_all_linkeddocs(doc=None):<br>    """<br>    Retrieves all linked documents in the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to search for linked documents.<br>                                  If None, it defaults to DOCS.doc.<br>    Returns:<br>        list: A list of linked Revit documents.<br>    """<br>    doc = doc or DOCS.doc<br>    linkinstances = (<br>        DB.FilteredElementCollector(doc).OfClass(DB.RevitLinkInstance).ToElements()<br>    )<br>    docs = [x.GetLinkDocument() for x in linkinstances]<br>    return [x for x in docs if x]<br>``` |

### `get_all_grids(group_by_direction=False, include_linked_models=False, doc=None)`

Retrieves all grid elements from the given Revit document and optionally from linked models.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `group_by_direction` | `bool` | If True, groups the grids by their direction. | `False` |
| `include_linked_models` | `bool` | If True, includes grids from linked models. | `False` |
| `doc` | `Document` | The Revit document to retrieve grids from. If None, uses the current document. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | list or dict: A list of all grid elements if group\_by\_direction is False.<br>A dictionary grouping grid elements by their direction if group\_by\_direction is True. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1806<br>1807<br>1808<br>1809<br>1810<br>1811<br>1812<br>1813<br>1814<br>1815<br>1816<br>1817<br>1818<br>1819<br>1820<br>1821<br>1822<br>1823<br>1824<br>1825<br>1826<br>1827<br>1828<br>1829<br>1830<br>1831<br>1832<br>1833<br>1834<br>1835<br>1836<br>1837<br>1838<br>1839<br>1840<br>1841<br>1842<br>1843<br>1844<br>``` | ```md-code__content<br>def get_all_grids(group_by_direction=False, include_linked_models=False, doc=None):<br>    """<br>    Retrieves all grid elements from the given Revit document and optionally from linked models.<br>    Args:<br>        group_by_direction (bool): If True, groups the grids by their direction.<br>        include_linked_models (bool): If True, includes grids from linked models.<br>        doc (Document, optional): The Revit document to retrieve grids from. If None, uses the current document.<br>    Returns:<br>        list or dict: A list of all grid elements if group_by_direction is False.<br>                      A dictionary grouping grid elements by their direction if group_by_direction is True.<br>    """<br>    doc = doc or DOCS.doc<br>    target_docs = [doc]<br>    if include_linked_models:<br>        target_docs.extend(get_all_linkeddocs())<br>    all_grids = []<br>    for tdoc in target_docs:<br>        if tdoc is not None:<br>            all_grids.extend(<br>                list(<br>                    DB.FilteredElementCollector(tdoc)<br>                    .OfCategory(DB.BuiltInCategory.OST_Grids)<br>                    .WhereElementIsNotElementType()<br>                    .ToElements()<br>                )<br>            )<br>    if group_by_direction:<br>        direcs = {db.XYZPoint(x.Curve.Direction) for x in all_grids}<br>        grouped_grids = {}<br>        for direc in direcs:<br>            grouped_grids[direc] = [<br>                x for x in all_grids if direc == db.XYZPoint(x.Curve.Direction)<br>            ]<br>        return grouped_grids<br>    return all_grids<br>``` |

### `get_gridpoints(grids=None, include_linked_models=False, doc=None)`

Retrieves the intersection points of grid lines in a Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `grids` | `list` | A list of grid elements to consider. If None, all grids in the document are considered. | `None` |
| `include_linked_models` | `bool` | If True, includes grids from linked models. Defaults to False. | `False` |
| `doc` | `Document` | The Revit document to operate on. If None, uses the current active document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of GridPoint objects representing the intersection points of the grid lines. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1847<br>1848<br>1849<br>1850<br>1851<br>1852<br>1853<br>1854<br>1855<br>1856<br>1857<br>1858<br>1859<br>1860<br>1861<br>1862<br>1863<br>1864<br>1865<br>1866<br>1867<br>1868<br>1869<br>1870<br>``` | ```md-code__content<br>def get_gridpoints(grids=None, include_linked_models=False, doc=None):<br>    """<br>    Retrieves the intersection points of grid lines in a Revit document.<br>    Args:<br>        grids (list, optional): A list of grid elements to consider. If None, all grids in the document are considered.<br>        include_linked_models (bool, optional): If True, includes grids from linked models. Defaults to False.<br>        doc (Document, optional): The Revit document to operate on. If None, uses the current active document.<br>    Returns:<br>        list: A list of GridPoint objects representing the intersection points of the grid lines.<br>    """<br>    doc = doc or DOCS.doc<br>    source_grids = grids or get_all_grids(<br>        doc=doc, include_linked_models=include_linked_models<br>    )<br>    gints = {}<br>    for grid1 in source_grids:<br>        for grid2 in source_grids:<br>            results = framework.clr.Reference[DB.IntersectionResultArray]()<br>            intres = grid1.Curve.Intersect(grid2.Curve, results)<br>            if intres == DB.SetComparisonResult.Overlap:<br>                gints[db.XYZPoint(results.get_Item(0).XYZPoint)] = [grid1, grid2]<br>    return [GridPoint(point=k, grids=v) for k, v in gints.items()]<br>``` |

### `get_closest_gridpoint(element, gridpoints)`

Finds the closest grid point to a given element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` |  | The element for which the closest grid point is to be found.<br>It is expected to have a Location attribute with a Point property. | _required_ |
| `gridpoints` |  | A list of grid points. Each grid point is expected to have a<br>point attribute with an unwrap() method that returns an object<br>with a DistanceTo method. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | The grid point that is closest to the given element. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1873<br>1874<br>1875<br>1876<br>1877<br>1878<br>1879<br>1880<br>1881<br>1882<br>1883<br>1884<br>1885<br>1886<br>1887<br>1888<br>1889<br>1890<br>1891<br>1892<br>1893<br>1894<br>1895<br>``` | ```md-code__content<br>def get_closest_gridpoint(element, gridpoints):<br>    """<br>    Finds the closest grid point to a given element.<br>    Args:<br>        element: The element for which the closest grid point is to be found.<br>                 It is expected to have a Location attribute with a Point property.<br>        gridpoints: A list of grid points. Each grid point is expected to have a<br>                    point attribute with an unwrap() method that returns an object<br>                    with a DistanceTo method.<br>    Returns:<br>        The grid point that is closest to the given element.<br>    """<br>    dist = (<br>        gridpoints[0].point.unwrap().DistanceTo(element.Location.Point),<br>        gridpoints[0],<br>    )<br>    for grid_point in gridpoints:<br>        gp_dist = grid_point.point.unwrap().DistanceTo(element.Location.Point)<br>        if gp_dist < dist[0]:<br>            dist = (gp_dist, grid_point)<br>    return dist[1]<br>``` |

### `get_category_set(category_list, doc=None)`

Creates a CategorySet from a list of built-in categories.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `category_list` | `list` | A list of built-in categories to include in the CategorySet. | _required_ |
| `doc` | `Document` | The Revit document to use. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `CategorySet` |  | A set of categories created from the provided list. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1898<br>1899<br>1900<br>1901<br>1902<br>1903<br>1904<br>1905<br>1906<br>1907<br>1908<br>1909<br>1910<br>1911<br>1912<br>1913<br>1914<br>``` | ```md-code__content<br>def get_category_set(category_list, doc=None):<br>    """<br>    Creates a CategorySet from a list of built-in categories.<br>    Args:<br>        category_list (list): A list of built-in categories to include in the CategorySet.<br>        doc (Document, optional): The Revit document to use. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        CategorySet: A set of categories created from the provided list.<br>    """<br>    doc = doc or DOCS.doc<br>    cat_set = HOST_APP.app.Create.NewCategorySet()<br>    for builtin_cat in category_list:<br>        cat = doc.Settings.Categories.get_Item(builtin_cat)<br>        cat_set.Insert(cat)<br>    return cat_set<br>``` |

### `get_all_category_set(bindable=True, doc=None)`

Retrieves a set of all categories in the Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `bindable` | `bool` | If True, only includes categories that allow bound parameters. Defaults to True. | `True` |
| `doc` | `Document` | The Revit document to retrieve categories from. If None, uses the default document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `CategorySet` |  | A set of categories from the specified Revit document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1917<br>1918<br>1919<br>1920<br>1921<br>1922<br>1923<br>1924<br>1925<br>1926<br>1927<br>1928<br>1929<br>1930<br>1931<br>1932<br>1933<br>1934<br>1935<br>1936<br>``` | ```md-code__content<br>def get_all_category_set(bindable=True, doc=None):<br>    """<br>    Retrieves a set of all categories in the Revit document.<br>    Args:<br>        bindable (bool, optional): If True, only includes categories that allow bound parameters. Defaults to True.<br>        doc (Document, optional): The Revit document to retrieve categories from. If None, uses the default document.<br>    Returns:<br>        CategorySet: A set of categories from the specified Revit document.<br>    """<br>    doc = doc or DOCS.doc<br>    cat_set = HOST_APP.app.Create.NewCategorySet()<br>    for cat in doc.Settings.Categories:<br>        if bindable:<br>            if cat.AllowsBoundParameters:<br>                cat_set.Insert(cat)<br>        else:<br>            cat_set.Insert(cat)<br>    return cat_set<br>``` |

### `get_rule_filters(doc=None)`

Retrieves a list of rule-based filters from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve the filters from.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of ParameterFilterElement instances from the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1939<br>1940<br>1941<br>1942<br>1943<br>1944<br>1945<br>1946<br>1947<br>1948<br>1949<br>1950<br>1951<br>1952<br>1953<br>1954<br>1955<br>1956<br>1957<br>``` | ```md-code__content<br>def get_rule_filters(doc=None):<br>    """<br>    Retrieves a list of rule-based filters from the given Revit document.<br>    Args:<br>        doc (DB.Document, optional): The Revit document to retrieve the filters from.<br>                                     If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of ParameterFilterElement instances from the document.<br>    """<br>    doc = doc or DOCS.doc<br>    rfcl = (<br>        DB.FilteredElementCollector(doc)<br>        .OfClass(DB.ParameterFilterElement)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>    return list(rfcl)<br>``` |

### `get_connected_circuits(element, spare=False, space=False)`

Retrieves the electrical circuits connected to a given element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element to get connected circuits for. | _required_ |
| `spare` | `bool` | Include spare circuits if True. Defaults to False. | `False` |
| `space` | `bool` | Include space circuits if True. Defaults to False. | `False` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of electrical systems connected to the element that match the specified circuit types. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1960<br>1961<br>1962<br>1963<br>1964<br>1965<br>1966<br>1967<br>1968<br>1969<br>1970<br>1971<br>1972<br>1973<br>1974<br>1975<br>1976<br>1977<br>1978<br>1979<br>1980<br>1981<br>1982<br>1983<br>1984<br>1985<br>1986<br>1987<br>1988<br>1989<br>1990<br>1991<br>1992<br>``` | ```md-code__content<br>def get_connected_circuits(element, spare=False, space=False):<br>    """<br>    Retrieves the electrical circuits connected to a given element.<br>    Args:<br>        element (DB.Element): The Revit element to get connected circuits for.<br>        spare (bool, optional): Include spare circuits if True. Defaults to False.<br>        space (bool, optional): Include space circuits if True. Defaults to False.<br>    Returns:<br>        list: A list of electrical systems connected to the element that match the specified circuit types.<br>    """<br>    circuit_types = [DB.Electrical.CircuitType.Circuit]<br>    if spare:<br>        circuit_types.append(DB.Electrical.CircuitType.Spare)<br>    if space:<br>        circuit_types.append(DB.Electrical.CircuitType.Space)<br>    if HOST_APP.is_newer_than(<br>        2021, or_equal=True<br>    ):  # deprecation of ElectricalSystems in 2021<br>        if element.MEPModel and element.MEPModel.GetElectricalSystems():<br>            return [<br>                x<br>                for x in element.MEPModel.GetElectricalSystems()<br>                if x.CircuitType in circuit_types<br>            ]<br>    else:<br>        if element.MEPModel and element.MEPModel.ElectricalSystems:<br>            return [<br>                x<br>                for x in element.MEPModel.ElectricalSystems<br>                if x.CircuitType in circuit_types<br>            ]<br>``` |

### `get_element_categories(elements)`

Given a list of Revit elements, returns a list of unique categories.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `elements` | `list` | A list of Revit elements. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of unique categories of the given elements. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>1995<br>1996<br>1997<br>1998<br>1999<br>2000<br>2001<br>2002<br>2003<br>2004<br>2005<br>2006<br>2007<br>``` | ```md-code__content<br>def get_element_categories(elements):<br>    """<br>    Given a list of Revit elements, returns a list of unique categories.<br>    Args:<br>        elements (list): A list of Revit elements.<br>    Returns:<br>        list: A list of unique categories of the given elements.<br>    """<br>    catsdict = {x.Category.Name: x.Category for x in elements}<br>    uniquenames = set(catsdict.keys())<br>    return [catsdict[x] for x in uniquenames]<br>``` |

### `get_category_schedules(category_or_catname, doc=None)`

Retrieves all schedules for a given category in a Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `category_or_catname` | `str or Category` | The category or category name to filter schedules. | _required_ |
| `doc` | `Document` | The Revit document to search in. Defaults to None, in which case the default document is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of schedules that belong to the specified category. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2010<br>2011<br>2012<br>2013<br>2014<br>2015<br>2016<br>2017<br>2018<br>2019<br>2020<br>2021<br>2022<br>2023<br>2024<br>``` | ```md-code__content<br>def get_category_schedules(category_or_catname, doc=None):<br>    """<br>    Retrieves all schedules for a given category in a Revit document.<br>    Args:<br>        category_or_catname (str or Category): The category or category name to filter schedules.<br>        doc (Document, optional): The Revit document to search in. Defaults to None, in which case the default document is used.<br>    Returns:<br>        list: A list of schedules that belong to the specified category.<br>    """<br>    doc = doc or DOCS.doc<br>    cat = get_category(category_or_catname)<br>    scheds = get_all_schedules(doc=doc)<br>    return [x for x in scheds if x.Definition.CategoryId == cat.Id]<br>``` |

### `get_schedule_field(schedule, field_name)`

Retrieves a specific field from a Revit schedule by its name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `schedule` | `Schedule` | The Revit schedule object. | _required_ |
| `field_name` | `str` | The name of the field to retrieve. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `ScheduleField` |  | The field object if found, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2027<br>2028<br>2029<br>2030<br>2031<br>2032<br>2033<br>2034<br>2035<br>2036<br>2037<br>2038<br>2039<br>2040<br>2041<br>``` | ```md-code__content<br>def get_schedule_field(schedule, field_name):<br>    """<br>    Retrieves a specific field from a Revit schedule by its name.<br>    Args:<br>        schedule (Schedule): The Revit schedule object.<br>        field_name (str): The name of the field to retrieve.<br>    Returns:<br>        ScheduleField: The field object if found, otherwise None.<br>    """<br>    for field_idx in schedule.Definition.GetFieldOrder():<br>        field = schedule.Definition.GetField(field_idx)<br>        if field.GetName() == field_name:<br>            return field<br>``` |

### `get_schedule_filters(schedule, field_name, return_index=False)`

Retrieves the filters applied to a schedule based on a specified field name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `schedule` | `Schedule` | The schedule from which to retrieve filters. | _required_ |
| `field_name` | `str` | The name of the field to match filters against. | _required_ |
| `return_index` | `bool` | If True, returns the indices of the matching filters.<br>If False, returns the filter objects. Defaults to False. | `False` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of matching filters or their indices, depending on the value of return\_index. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2044<br>2045<br>2046<br>2047<br>2048<br>2049<br>2050<br>2051<br>2052<br>2053<br>2054<br>2055<br>2056<br>2057<br>2058<br>2059<br>2060<br>2061<br>2062<br>2063<br>2064<br>2065<br>2066<br>``` | ```md-code__content<br>def get_schedule_filters(schedule, field_name, return_index=False):<br>    """<br>    Retrieves the filters applied to a schedule based on a specified field name.<br>    Args:<br>        schedule (Schedule): The schedule from which to retrieve filters.<br>        field_name (str): The name of the field to match filters against.<br>        return_index (bool, optional): If True, returns the indices of the matching filters.<br>                                       If False, returns the filter objects. Defaults to False.<br>    Returns:<br>        list: A list of matching filters or their indices, depending on the value of return_index.<br>    """<br>    matching_filters = []<br>    field = get_schedule_field(schedule, field_name)<br>    if field:<br>        for idx, sfilter in enumerate(schedule.Definition.GetFilters()):<br>            if sfilter.FieldId == field.FieldId:<br>                if return_index:<br>                    matching_filters.append(idx)<br>                else:<br>                    matching_filters.append(sfilter)<br>    return matching_filters<br>``` |

### `get_sheet_tblocks(src_sheet)`

Retrieves all title block elements from a given Revit sheet.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `src_sheet` | `ViewSheet` | The source Revit sheet from which to collect title blocks. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of title block elements present on the specified sheet. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2069<br>2070<br>2071<br>2072<br>2073<br>2074<br>2075<br>2076<br>2077<br>2078<br>2079<br>2080<br>2081<br>2082<br>2083<br>2084<br>2085<br>``` | ```md-code__content<br>def get_sheet_tblocks(src_sheet):<br>    """<br>    Retrieves all title block elements from a given Revit sheet.<br>    Args:<br>        src_sheet (DB.ViewSheet): The source Revit sheet from which to collect title blocks.<br>    Returns:<br>        list: A list of title block elements present on the specified sheet.<br>    """<br>    sheet_tblocks = (<br>        DB.FilteredElementCollector(src_sheet.Document, src_sheet.Id)<br>        .OfCategory(DB.BuiltInCategory.OST_TitleBlocks)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>    return list(sheet_tblocks)<br>``` |

### `get_sheet_sets(doc=None)`

Retrieves all sheet sets from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve sheet sets from.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of ViewSheetSet elements from the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2088<br>2089<br>2090<br>2091<br>2092<br>2093<br>2094<br>2095<br>2096<br>2097<br>2098<br>2099<br>2100<br>2101<br>2102<br>2103<br>2104<br>2105<br>2106<br>``` | ```md-code__content<br>def get_sheet_sets(doc=None):<br>    """<br>    Retrieves all sheet sets from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve sheet sets from.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of ViewSheetSet elements from the document.<br>    """<br>    doc = doc or DOCS.doc<br>    sheet_sets = (<br>        DB.FilteredElementCollector(doc)<br>        .OfClass(DB.ViewSheetSet)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>    return list(sheet_sets)<br>``` |

### `get_rev_number(revision, sheet=None)`

Get the revision number for a given revision.
If a sheet is provided and it is an instance of DB.ViewSheet, the function
returns the revision number as it appears on the sheet. Otherwise, it returns
the sequence number of the revision or the revision number if it exists.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `revision` | `Revision` | The revision object to get the number for. | _required_ |
| `sheet` | `ViewSheet` | The sheet object to get the revision number from. Defaults to None. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The revision number as a string. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2109<br>2110<br>2111<br>2112<br>2113<br>2114<br>2115<br>2116<br>2117<br>2118<br>2119<br>2120<br>2121<br>2122<br>2123<br>2124<br>2125<br>2126<br>2127<br>2128<br>2129<br>2130<br>``` | ```md-code__content<br>def get_rev_number(revision, sheet=None):<br>    """<br>    Get the revision number for a given revision.<br>    If a sheet is provided and it is an instance of DB.ViewSheet, the function<br>    returns the revision number as it appears on the sheet. Otherwise, it returns<br>    the sequence number of the revision or the revision number if it exists.<br>    Args:<br>        revision (DB.Revision): The revision object to get the number for.<br>        sheet (DB.ViewSheet, optional): The sheet object to get the revision number from. Defaults to None.<br>    Returns:<br>        str: The revision number as a string.<br>    """<br>    # if sheet is provided, get number on sheet<br>    if sheet and isinstance(sheet, DB.ViewSheet):<br>        return sheet.GetRevisionNumberOnSheet(revision.Id)<br>    # otherwise get number from revision<br>    revnum = revision.SequenceNumber<br>    if hasattr(revision, "RevisionNumber"):<br>        revnum = revision.RevisionNumber<br>    return revnum<br>``` |

### `get_pointclouds(doc=None)`

Retrieves all point cloud elements from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search for point cloud elements.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of point cloud elements found in the specified document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2133<br>2134<br>2135<br>2136<br>2137<br>2138<br>2139<br>2140<br>2141<br>2142<br>2143<br>2144<br>2145<br>``` | ```md-code__content<br>def get_pointclouds(doc=None):<br>    """<br>    Retrieves all point cloud elements from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to search for point cloud elements.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of point cloud elements found in the specified document.<br>    """<br>    doc = doc or DOCS.doc<br>    return get_elements_by_categories([DB.BuiltInCategory.OST_PointClouds], doc=doc)<br>``` |

### `get_mep_connections(element)`

Retrieves the MEP (Mechanical, Electrical, and Plumbing) connections for a given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element for which to retrieve MEP connections. This can be a<br>FamilyInstance or a Plumbing Pipe. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of elements that are connected to the given element through MEP connections. |

Returns an empty list if no connections are found or if the element does not have a
ConnectorManager.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2148<br>2149<br>2150<br>2151<br>2152<br>2153<br>2154<br>2155<br>2156<br>2157<br>2158<br>2159<br>2160<br>2161<br>2162<br>2163<br>2164<br>2165<br>2166<br>2167<br>2168<br>2169<br>2170<br>2171<br>2172<br>2173<br>2174<br>2175<br>2176<br>2177<br>``` | ```md-code__content<br>def get_mep_connections(element):<br>    """<br>    Retrieves the MEP (Mechanical, Electrical, and Plumbing) connections for a given Revit element.<br>    Args:<br>        element (DB.Element): The Revit element for which to retrieve MEP connections. This can be a<br>                              FamilyInstance or a Plumbing Pipe.<br>    Returns:<br>        list: A list of elements that are connected to the given element through MEP connections.<br>    Returns an empty list if no connections are found or if the element does not have a<br>              ConnectorManager.<br>    """<br>    connmgr = None<br>    if isinstance(element, DB.FamilyInstance):<br>        connmgr = element.MEPModel.ConnectorManager<br>    elif isinstance(element, DB.Plumbing.Pipe):<br>        connmgr = element.ConnectorManager<br>    if connmgr:<br>        connelements = [<br>            y.Owner<br>            for x in connmgr.Connectors<br>            for y in x.AllRefs<br>            if x.IsConnected<br>            and y.Owner.Id != element.Id<br>            and y.ConnectorType != DB.ConnectorType.Logical<br>        ]<br>        return connelements<br>``` |

### `get_fillpattern_element(fillpattern_name, fillpattern_target, doc=None)`

Retrieves a FillPatternElement from the Revit document based on the given fill pattern name and target.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `fillpattern_name` | `str` | The name of the fill pattern to search for. | _required_ |
| `fillpattern_target` | `FillPatternTarget` | The target type of the fill pattern (e.g., Drafting or Model). | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | DB.FillPatternElement: The FillPatternElement that matches the given name and target, or None if not found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2180<br>2181<br>2182<br>2183<br>2184<br>2185<br>2186<br>2187<br>2188<br>2189<br>2190<br>2191<br>2192<br>2193<br>2194<br>2195<br>2196<br>2197<br>2198<br>2199<br>2200<br>2201<br>2202<br>2203<br>``` | ```md-code__content<br>def get_fillpattern_element(fillpattern_name, fillpattern_target, doc=None):<br>    """<br>    Retrieves a FillPatternElement from the Revit document based on the given fill pattern name and target.<br>    Args:<br>        fillpattern_name (str): The name of the fill pattern to search for.<br>        fillpattern_target (DB.FillPatternTarget): The target type of the fill pattern (e.g., Drafting or Model).<br>        doc (DB.Document, optional): The Revit document to search in. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        DB.FillPatternElement: The FillPatternElement that matches the given name and target, or None if not found.<br>    """<br>    doc = doc or DOCS.doc<br>    existing_fp_elements = DB.FilteredElementCollector(doc).OfClass(<br>        framework.get_type(DB.FillPatternElement)<br>    )<br>    for existing_fp_element in existing_fp_elements:<br>        fillpattern = existing_fp_element.GetFillPattern()<br>        if (<br>            fillpattern_name == fillpattern.Name<br>            and fillpattern_target == fillpattern.Target<br>        ):<br>            return existing_fp_element<br>``` |

### `get_all_fillpattern_elements(fillpattern_target, doc=None)`

Retrieves all fill pattern elements from the given document that match the specified fill pattern target.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `fillpattern_target` | `FillPatternTarget` | The target fill pattern to match. | _required_ |
| `doc` | `Document` | The Revit document to search within. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of fill pattern elements that match the specified fill pattern target. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2206<br>2207<br>2208<br>2209<br>2210<br>2211<br>2212<br>2213<br>2214<br>2215<br>2216<br>2217<br>2218<br>2219<br>2220<br>2221<br>2222<br>2223<br>2224<br>2225<br>2226<br>``` | ```md-code__content<br>def get_all_fillpattern_elements(fillpattern_target, doc=None):<br>    """<br>    Retrieves all fill pattern elements from the given document that match the specified fill pattern target.<br>    Args:<br>        fillpattern_target (DB.FillPatternTarget): The target fill pattern to match.<br>        doc (DB.Document, optional): The Revit document to search within. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of fill pattern elements that match the specified fill pattern target.<br>    """<br>    doc = doc or DOCS.doc<br>    existing_fp_elements = DB.FilteredElementCollector(doc).OfClass(<br>        framework.get_type(DB.FillPatternElement)<br>    )<br>    return [<br>        x<br>        for x in existing_fp_elements<br>        if x.GetFillPattern().Target == fillpattern_target<br>    ]<br>``` |

### `get_fillpattern_from_element(element, background=True, doc=None)`

Retrieves the fill pattern from a given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element from which to retrieve the fill pattern. | _required_ |
| `background` | `bool` | If True, retrieves the background fill pattern;<br>otherwise, retrieves the foreground fill pattern.<br>Defaults to True. | `True` |
| `doc` | `Document` | The Revit document. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | DB.FillPattern: The fill pattern of the specified element, or None if not found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2229<br>2230<br>2231<br>2232<br>2233<br>2234<br>2235<br>2236<br>2237<br>2238<br>2239<br>2240<br>2241<br>2242<br>2243<br>2244<br>2245<br>2246<br>2247<br>2248<br>2249<br>2250<br>2251<br>2252<br>2253<br>2254<br>2255<br>2256<br>2257<br>2258<br>2259<br>2260<br>``` | ```md-code__content<br>def get_fillpattern_from_element(element, background=True, doc=None):<br>    """<br>    Retrieves the fill pattern from a given Revit element.<br>    Args:<br>        element (DB.Element): The Revit element from which to retrieve the fill pattern.<br>        background (bool, optional): If True, retrieves the background fill pattern;<br>                                     otherwise, retrieves the foreground fill pattern.<br>                                     Defaults to True.<br>        doc (DB.Document, optional): The Revit document. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        DB.FillPattern: The fill pattern of the specified element, or None if not found.<br>    """<br>    doc = doc or DOCS.doc<br>    def get_fpm_from_frtype(etype):<br>        fp_id = None<br>        if HOST_APP.is_newer_than(2018):<br>            # return requested fill pattern (background or foreground)<br>            fp_id = (<br>                etype.BackgroundPatternId if background else etype.ForegroundPatternId<br>            )<br>        else:<br>            fp_id = etype.FillPatternId<br>        if fp_id:<br>            fillpat_element = doc.GetElement(fp_id)<br>            if fillpat_element:<br>                return fillpat_element.GetFillPattern()<br>    if isinstance(element, DB.FilledRegion):<br>        return get_fpm_from_frtype(doc.GetElement(element.GetTypeId()))<br>``` |

### `get_local_keynote_file(doc=None)`

Retrieves the path to the local keynote file for the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document. If not provided, the default document (DOCS.doc) is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The user-visible path to the local keynote file if it is an external file reference, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2263<br>2264<br>2265<br>2266<br>2267<br>2268<br>2269<br>2270<br>2271<br>2272<br>2273<br>2274<br>2275<br>2276<br>2277<br>2278<br>2279<br>2280<br>``` | ```md-code__content<br>def get_local_keynote_file(doc=None):<br>    """<br>    Retrieves the path to the local keynote file for the given Revit document.<br>    Args:<br>        doc (DB.Document, optional): The Revit document. If not provided, the default document (DOCS.doc) is used.<br>    Returns:<br>        str: The user-visible path to the local keynote file if it is an external file reference, otherwise None.<br>    """<br>    doc = doc or DOCS.doc<br>    knote_table = DB.KeynoteTable.GetKeynoteTable(doc)<br>    if knote_table.IsExternalFileReference():<br>        knote_table_ref = knote_table.GetExternalFileReference()<br>        return DB.ModelPathUtils.ConvertModelPathToUserVisiblePath(<br>            knote_table_ref.GetAbsolutePath()<br>        )<br>    return None<br>``` |

### `get_external_keynote_file(doc=None)`

Retrieves the path to the external keynote file associated with the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to query. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The in-session path to the external keynote file if it exists and has a valid display path, otherwise None. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2283<br>2284<br>2285<br>2286<br>2287<br>2288<br>2289<br>2290<br>2291<br>2292<br>2293<br>2294<br>2295<br>2296<br>2297<br>2298<br>2299<br>2300<br>2301<br>``` | ```md-code__content<br>def get_external_keynote_file(doc=None):<br>    """<br>    Retrieves the path to the external keynote file associated with the given Revit document.<br>    Args:<br>        doc (DB.Document, optional): The Revit document to query. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        str: The in-session path to the external keynote file if it exists and has a valid display path, otherwise None.<br>    """<br>    doc = doc or DOCS.doc<br>    knote_table = DB.KeynoteTable.GetKeynoteTable(doc)<br>    if knote_table.RefersToExternalResourceReferences():<br>        refs = knote_table.GetExternalResourceReferences()<br>        if refs:<br>            for ref_type, ref in dict(refs).items():<br>                if ref.HasValidDisplayPath():<br>                    return ref.InSessionPath<br>    return None<br>``` |

### `get_keynote_file(doc=None)`

Retrieves the keynote file path for the given Revit document.
If a local keynote file is available, it returns the local path.
Otherwise, it returns the external keynote file path.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document. If not provided,<br>the default document (DOCS.doc) is used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The path to the keynote file. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2304<br>2305<br>2306<br>2307<br>2308<br>2309<br>2310<br>2311<br>2312<br>2313<br>2314<br>2315<br>2316<br>2317<br>2318<br>2319<br>2320<br>2321<br>``` | ```md-code__content<br>def get_keynote_file(doc=None):<br>    """<br>    Retrieves the keynote file path for the given Revit document.<br>    If a local keynote file is available, it returns the local path.<br>    Otherwise, it returns the external keynote file path.<br>    Args:<br>        doc (Document, optional): The Revit document. If not provided,<br>                                  the default document (DOCS.doc) is used.<br>    Returns:<br>        str: The path to the keynote file.<br>    """<br>    doc = doc or DOCS.doc<br>    local_path = get_local_keynote_file(doc=doc)<br>    if not local_path:<br>        return get_external_keynote_file(doc=doc)<br>    return local_path<br>``` |

### `get_used_keynotes(doc=None)`

Retrieves all keynote tags used in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search for keynote tags.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | List\[Element\]: A list of keynote tag elements found in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2324<br>2325<br>2326<br>2327<br>2328<br>2329<br>2330<br>2331<br>2332<br>2333<br>2334<br>2335<br>2336<br>2337<br>2338<br>2339<br>2340<br>2341<br>``` | ```md-code__content<br>def get_used_keynotes(doc=None):<br>    """<br>    Retrieves all keynote tags used in the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to search for keynote tags.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        List[Element]: A list of keynote tag elements found in the document.<br>    """<br>    doc = doc or DOCS.doc<br>    return (<br>        DB.FilteredElementCollector(doc)<br>        .OfCategory(DB.BuiltInCategory.OST_KeynoteTags)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>``` |

### `get_visible_keynotes(view=None)`

Retrieves all visible keynote tags in the specified Revit view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view from which to retrieve keynote tags. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | list\[Autodesk.Revit.DB.Element\]: A list of keynote tag elements visible in the specified view. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2344<br>2345<br>2346<br>2347<br>2348<br>2349<br>2350<br>2351<br>2352<br>2353<br>2354<br>2355<br>2356<br>2357<br>2358<br>2359<br>2360<br>``` | ```md-code__content<br>def get_visible_keynotes(view=None):<br>    """<br>    Retrieves all visible keynote tags in the specified Revit view.<br>    Args:<br>        view (Autodesk.Revit.DB.View): The Revit view from which to retrieve keynote tags.<br>    Returns:<br>        list[Autodesk.Revit.DB.Element]: A list of keynote tag elements visible in the specified view.<br>    """<br>    doc = view.Document<br>    return (<br>        DB.FilteredElementCollector(doc, view.Id)<br>        .OfCategory(DB.BuiltInCategory.OST_KeynoteTags)<br>        .WhereElementIsNotElementType()<br>        .ToElements()<br>    )<br>``` |

### `get_available_keynotes(doc=None)`

Retrieves the available keynotes from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document from which to retrieve keynotes.<br>If not provided, the default document (DOCS.doc) will be used. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | DB.KeyBasedTreeEntries: A collection of keynote entries from the keynote table. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2363<br>2364<br>2365<br>2366<br>2367<br>2368<br>2369<br>2370<br>2371<br>2372<br>2373<br>2374<br>2375<br>2376<br>``` | ```md-code__content<br>def get_available_keynotes(doc=None):<br>    """<br>    Retrieves the available keynotes from the given Revit document.<br>    Args:<br>        doc (DB.Document, optional): The Revit document from which to retrieve keynotes.<br>                                     If not provided, the default document (DOCS.doc) will be used.<br>    Returns:<br>        DB.KeyBasedTreeEntries: A collection of keynote entries from the keynote table.<br>    """<br>    doc = doc or DOCS.doc<br>    knote_table = DB.KeynoteTable.GetKeynoteTable(doc)<br>    return knote_table.GetKeyBasedTreeEntries()<br>``` |

### `get_available_keynotes_tree(doc=None)`

Retrieves the available keynotes in a hierarchical tree structure.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve keynotes from.<br>If not provided, defaults to the current document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `dict` |  | A dictionary representing the hierarchical structure of keynotes. |

Raises:

| Type | Description |
| --- | --- |
| `NotImplementedError` | This function is not yet implemented. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2379<br>2380<br>2381<br>2382<br>2383<br>2384<br>2385<br>2386<br>2387<br>2388<br>2389<br>2390<br>2391<br>2392<br>2393<br>2394<br>2395<br>2396<br>``` | ```md-code__content<br>def get_available_keynotes_tree(doc=None):<br>    """<br>    Retrieves the available keynotes in a hierarchical tree structure.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve keynotes from.<br>                                  If not provided, defaults to the current document.<br>    Returns:<br>        dict: A dictionary representing the hierarchical structure of keynotes.<br>    Raises:<br>        NotImplementedError: This function is not yet implemented.<br>    """<br>    doc = doc or DOCS.doc<br>    knotes = get_available_keynotes(doc=doc)<br>    # TODO: implement knotes tree<br>    raise NotImplementedError()<br>``` |

### `is_placed(spatial_element)`

Check if a spatial element (Room, Area, or Space) is placed and has a positive area.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `spatial_element` | `Element` | The spatial element to check. It can be an instance of<br>DB.Architecture.Room, DB.Area, or DB.Mechanical.Space. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the spatial element is placed and has an area greater than 0, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2399<br>2400<br>2401<br>2402<br>2403<br>2404<br>2405<br>2406<br>2407<br>2408<br>2409<br>2410<br>2411<br>2412<br>2413<br>2414<br>2415<br>``` | ```md-code__content<br>def is_placed(spatial_element):<br>    """<br>    Check if a spatial element (Room, Area, or Space) is placed and has a positive area.<br>    Args:<br>        spatial_element (DB.Element): The spatial element to check. It can be an instance of<br>                                      DB.Architecture.Room, DB.Area, or DB.Mechanical.Space.<br>    Returns:<br>        bool: True if the spatial element is placed and has an area greater than 0, False otherwise.<br>    """<br>    return (<br>        isinstance(<br>            spatial_element, (DB.Architecture.Room, DB.Area, DB.Mechanical.Space)<br>        )<br>        and spatial_element.Area > 0<br>    )<br>``` |

### `get_central_path(doc=None)`

Returns the central model path of a Revit document if it is workshared.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `str` |  | The user-visible path to the central model if the document is workshared. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2418<br>2419<br>2420<br>2421<br>2422<br>2423<br>2424<br>2425<br>2426<br>2427<br>2428<br>2429<br>2430<br>2431<br>2432<br>``` | ```md-code__content<br>def get_central_path(doc=None):<br>    """<br>    Returns the central model path of a Revit document if it is workshared.<br>    Args:<br>        doc (Document, optional): The Revit document. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        str: The user-visible path to the central model if the document is workshared.<br>    """<br>    doc = doc or DOCS.doc<br>    if doc.IsWorkshared:<br>        model_path = doc.GetWorksharingCentralModelPath()<br>        return DB.ModelPathUtils.ConvertModelPathToUserVisiblePath(model_path)<br>``` |

### `is_metric(doc=None)`

Determines if the given Revit document uses the metric unit system.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to check. If not provided,<br>the default document (DOCS.doc) will be used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the document uses the metric unit system, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2435<br>2436<br>2437<br>2438<br>2439<br>2440<br>2441<br>2442<br>2443<br>2444<br>2445<br>2446<br>2447<br>``` | ```md-code__content<br>def is_metric(doc=None):<br>    """<br>    Determines if the given Revit document uses the metric unit system.<br>    Args:<br>        doc (Document, optional): The Revit document to check. If not provided,<br>                                  the default document (DOCS.doc) will be used.<br>    Returns:<br>        bool: True if the document uses the metric unit system, False otherwise.<br>    """<br>    doc = doc or DOCS.doc<br>    return doc.DisplayUnitSystem == DB.DisplayUnit.METRIC<br>``` |

### `is_imperial(doc=None)`

Checks if the given Revit document uses the imperial unit system.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to check. If not provided,<br>the default document (DOCS.doc) will be used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the document uses the imperial unit system, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2450<br>2451<br>2452<br>2453<br>2454<br>2455<br>2456<br>2457<br>2458<br>2459<br>2460<br>2461<br>2462<br>``` | ```md-code__content<br>def is_imperial(doc=None):<br>    """<br>    Checks if the given Revit document uses the imperial unit system.<br>    Args:<br>        doc (Document, optional): The Revit document to check. If not provided,<br>                                  the default document (DOCS.doc) will be used.<br>    Returns:<br>        bool: True if the document uses the imperial unit system, False otherwise.<br>    """<br>    doc = doc or DOCS.doc<br>    return doc.DisplayUnitSystem == DB.DisplayUnit.IMPERIAL<br>``` |

### `get_view_sheetrefinfo(view)`

Retrieves sheet reference information for a given view.
This function checks if the view is placed on a sheet by looking at the
'Sheet Number' and 'Sheet Name' parameters. If the view is placed on a
sheet, it returns the sheet number, sheet name, and detail number. If the
view is not placed on a sheet, it checks the 'Referencing Sheet' and
'Referencing Detail' parameters to see if the view is referenced by another
view on a sheet, and returns the corresponding information.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view object to retrieve sheet reference<br>information from. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `SheetRefInfo` |  | An object containing the sheet number, sheet name, detail<br>number, and reference view ID if applicable. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2465<br>2466<br>2467<br>2468<br>2469<br>2470<br>2471<br>2472<br>2473<br>2474<br>2475<br>2476<br>2477<br>2478<br>2479<br>2480<br>2481<br>2482<br>2483<br>2484<br>2485<br>2486<br>2487<br>2488<br>2489<br>2490<br>2491<br>2492<br>2493<br>2494<br>2495<br>2496<br>2497<br>2498<br>2499<br>2500<br>2501<br>2502<br>2503<br>2504<br>2505<br>2506<br>2507<br>2508<br>``` | ```md-code__content<br>def get_view_sheetrefinfo(view):<br>    """<br>    Retrieves sheet reference information for a given view.<br>    This function checks if the view is placed on a sheet by looking at the<br>    'Sheet Number' and 'Sheet Name' parameters. If the view is placed on a<br>    sheet, it returns the sheet number, sheet name, and detail number. If the<br>    view is not placed on a sheet, it checks the 'Referencing Sheet' and<br>    'Referencing Detail' parameters to see if the view is referenced by another<br>    view on a sheet, and returns the corresponding information.<br>    Args:<br>        view (DB.View): The Revit view object to retrieve sheet reference<br>                        information from.<br>    Returns:<br>        SheetRefInfo: An object containing the sheet number, sheet name, detail<br>                      number, and reference view ID if applicable.<br>    """<br>    sheet_num = view.Parameter[DB.BuiltInParameter.VIEWPORT_SHEET_NUMBER].AsString()<br>    sheet_name = view.Parameter[DB.BuiltInParameter.VIEWPORT_SHEET_NAME].AsString()<br>    detail_num = view.Parameter[DB.BuiltInParameter.VIEWPORT_DETAIL_NUMBER].AsString()<br>    if sheet_num:<br>        return SheetRefInfo(<br>            sheet_num=sheet_num,<br>            sheet_name=sheet_name,<br>            detail_num=detail_num,<br>            ref_viewid=None,<br>        )<br>    ref_sheet_num = view.Parameter[<br>        DB.BuiltInParameter.VIEW_REFERENCING_SHEET<br>    ].AsString()<br>    ref_sheet = get_sheet_by_number(ref_sheet_num)<br>    ref_sheet_name = get_name(ref_sheet) if ref_sheet else ""<br>    ref_detail_num = view.Parameter[<br>        DB.BuiltInParameter.VIEW_REFERENCING_DETAIL<br>    ].AsString()<br>    if ref_sheet_num:<br>        return SheetRefInfo(<br>            sheet_num=ref_sheet_num,<br>            sheet_name=ref_sheet_name,<br>            detail_num=ref_detail_num,<br>            ref_viewid=get_view_by_sheetref(ref_sheet_num, ref_detail_num),<br>        )<br>``` |

### `get_all_sheeted_views(doc=None, sheets=None)`

Retrieves all view IDs that are placed on sheets in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to query. If not provided, defaults to DOCS.doc. | `None` |
| `sheets` | `list` | A list of sheet elements to query. If not provided, defaults to all sheets in the document. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `set` |  | A set of view IDs that are placed on the provided sheets. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2511<br>2512<br>2513<br>2514<br>2515<br>2516<br>2517<br>2518<br>2519<br>2520<br>2521<br>2522<br>2523<br>2524<br>2525<br>2526<br>2527<br>2528<br>``` | ```md-code__content<br>def get_all_sheeted_views(doc=None, sheets=None):<br>    """<br>    Retrieves all view IDs that are placed on sheets in the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to query. If not provided, defaults to DOCS.doc.<br>        sheets (list, optional): A list of sheet elements to query. If not provided, defaults to all sheets in the document.<br>    Returns:<br>        set: A set of view IDs that are placed on the provided sheets.<br>    """<br>    doc = doc or DOCS.doc<br>    sheets = sheets or get_sheets(doc=doc)<br>    all_sheeted_view_ids = set()<br>    for sht in sheets:<br>        vp_ids = [doc.GetElement(x).ViewId for x in sht.GetAllViewports()]<br>        all_sheeted_view_ids.update(vp_ids)<br>    return all_sheeted_view_ids<br>``` |

### `is_view_sheeted(view)`

Checks if a given view is placed on a sheet.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view to check. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the view is placed on a sheet, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2531<br>2532<br>2533<br>2534<br>2535<br>2536<br>2537<br>2538<br>2539<br>2540<br>2541<br>``` | ```md-code__content<br>def is_view_sheeted(view):<br>    """<br>    Checks if a given view is placed on a sheet.<br>    Args:<br>        view (Autodesk.Revit.DB.View): The Revit view to check.<br>    Returns:<br>        bool: True if the view is placed on a sheet, False otherwise.<br>    """<br>    return view.Id in get_all_sheeted_views(doc=view.Document)<br>``` |

### `can_refer_other_views(source_view)`

Determines if the given source view can refer to other views.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `source_view` |  | The view to check. Expected to be an instance of a Revit view class. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the source view is an instance of DB.ViewDrafting, DB.ViewPlan, or DB.ViewSection; otherwise, False. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2544<br>2545<br>2546<br>2547<br>2548<br>2549<br>2550<br>2551<br>2552<br>2553<br>2554<br>``` | ```md-code__content<br>def can_refer_other_views(source_view):<br>    """<br>    Determines if the given source view can refer to other views.<br>    Args:<br>        source_view: The view to check. Expected to be an instance of a Revit view class.<br>    Returns:<br>        bool: True if the source view is an instance of DB.ViewDrafting, DB.ViewPlan, or DB.ViewSection; otherwise, False.<br>    """<br>    return isinstance(source_view, (DB.ViewDrafting, DB.ViewPlan, DB.ViewSection))<br>``` |

### `is_referring_to(source_view, target_view)`

Determines if the source view is referring to the target view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `source_view` | `View` | The view that may be referring to another view. | _required_ |
| `target_view` | `View` | The view that is being checked if it is referred to by the source view. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the source view is referring to the target view, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2557<br>2558<br>2559<br>2560<br>2561<br>2562<br>2563<br>2564<br>2565<br>2566<br>2567<br>2568<br>2569<br>2570<br>2571<br>2572<br>2573<br>2574<br>2575<br>2576<br>2577<br>2578<br>2579<br>2580<br>2581<br>2582<br>2583<br>``` | ```md-code__content<br>def is_referring_to(source_view, target_view):<br>    """<br>    Determines if the source view is referring to the target view.<br>    Args:<br>        source_view (Autodesk.Revit.DB.View): The view that may be referring to another view.<br>        target_view (Autodesk.Revit.DB.View): The view that is being checked if it is referred to by the source view.<br>    Returns:<br>        bool: True if the source view is referring to the target view, False otherwise.<br>    """<br>    doc = source_view.Document<br>    target_viewname = get_name(target_view)<br>    if can_refer_other_views(source_view):<br>        for ref_elid in get_all_referencing_elements_in_view(source_view):<br>            viewref_el = doc.GetElement(ref_elid)<br>            targetview_param = viewref_el.Parameter[<br>                DB.BuiltInParameter.REFERENCE_VIEWER_TARGET_VIEW<br>            ]<br>            if targetview_param:<br>                tvp_view = doc.GetElement(targetview_param.AsElementId())<br>                if tvp_view and get_name(tvp_view) == target_viewname:<br>                    return True<br>            else:<br>                viewref_name = get_name(viewref_el)<br>                if viewref_name == target_viewname:<br>                    return True<br>``` |

### `yield_referring_views(target_view, all_views=None)`

Yields the IDs of views that refer to the target view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `target_view` | `View` | The view that other views may refer to. | _required_ |
| `all_views` | `list[View]` | A list of all views to check. If not provided,<br>all views in the document of the target view will be used. | `None` |

Yields:
ElementId: The ID of a view that refers to the target view.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2586<br>2587<br>2588<br>2589<br>2590<br>2591<br>2592<br>2593<br>2594<br>2595<br>2596<br>2597<br>2598<br>2599<br>2600<br>``` | ```md-code__content<br>def yield_referring_views(target_view, all_views=None):<br>    """<br>    Yields the IDs of views that refer to the target view.<br>    Args:<br>        target_view (View): The view that other views may refer to.<br>        all_views (list[View], optional): A list of all views to check. If not provided,<br>                                          all views in the document of the target view will be used.<br>    Yields:<br>        ElementId: The ID of a view that refers to the target view.<br>    """<br>    all_views = all_views or get_all_views(doc=target_view.Document)<br>    for view in all_views:<br>        if is_referring_to(view, target_view):<br>            yield view.Id<br>``` |

### `yield_referenced_views(doc=None, all_views=None)`

Yields the IDs of views that have referring views.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to query. Defaults to None, in which case the global DOCS.doc is used. | `None` |
| `all_views` | `list` | A list of all views in the document. Defaults to None, in which case all views are retrieved using get\_all\_views(doc). | `None` |

Yields:
ElementId: The ID of a view that has referring views.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2603<br>2604<br>2605<br>2606<br>2607<br>2608<br>2609<br>2610<br>2611<br>2612<br>2613<br>2614<br>2615<br>2616<br>2617<br>2618<br>``` | ```md-code__content<br>def yield_referenced_views(doc=None, all_views=None):<br>    """<br>    Yields the IDs of views that have referring views.<br>    Args:<br>        doc (Document, optional): The Revit document to query. Defaults to None, in which case the global DOCS.doc is used.<br>        all_views (list, optional): A list of all views in the document. Defaults to None, in which case all views are retrieved using get_all_views(doc).<br>    Yields:<br>        ElementId: The ID of a view that has referring views.<br>    """<br>    doc = doc or DOCS.doc<br>    all_views = all_views or get_all_views(doc=doc)<br>    for view in all_views:<br>        # if it has any referring views, yield<br>        if next(yield_referring_views(view), None):<br>            yield view.Id<br>``` |

### `yield_unreferenced_views(doc=None, all_views=None)`

Yields the IDs of views in a Revit document that have no referring views.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to search for unreferenced views.<br>If not provided, defaults to DOCS.doc. | `None` |
| `all_views` | `list` | A list of all views in the document.<br>If not provided, it will be retrieved using get\_all\_views(doc). | `None` |

Yields:
ElementId: The ID of each view that has no referring views.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2621<br>2622<br>2623<br>2624<br>2625<br>2626<br>2627<br>2628<br>2629<br>2630<br>2631<br>2632<br>2633<br>2634<br>2635<br>2636<br>2637<br>2638<br>``` | ```md-code__content<br>def yield_unreferenced_views(doc=None, all_views=None):<br>    """<br>    Yields the IDs of views in a Revit document that have no referring views.<br>    Args:<br>        doc (Document, optional): The Revit document to search for unreferenced views.<br>                                  If not provided, defaults to DOCS.doc.<br>        all_views (list, optional): A list of all views in the document.<br>                                    If not provided, it will be retrieved using get_all_views(doc).<br>    Yields:<br>        ElementId: The ID of each view that has no referring views.<br>    """<br>    doc = doc or DOCS.doc<br>    all_views = all_views or get_all_views(doc=doc)<br>    for view in all_views:<br>        # if it has NO referring views, yield<br>        if len(list(yield_referring_views(view))) == 0:<br>            yield view.Id<br>``` |

### `get_line_categories(doc=None)`

Retrieves the line categories from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve the line categories from.<br>If not provided, it defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `SubCategories` |  | The subcategories of the line category in the Revit document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2641<br>2642<br>2643<br>2644<br>2645<br>2646<br>2647<br>2648<br>2649<br>2650<br>2651<br>2652<br>2653<br>2654<br>``` | ```md-code__content<br>def get_line_categories(doc=None):<br>    """<br>    Retrieves the line categories from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve the line categories from.<br>                                  If not provided, it defaults to DOCS.doc.<br>    Returns:<br>        SubCategories: The subcategories of the line category in the Revit document.<br>    """<br>    doc = doc or DOCS.doc<br>    lines_cat = doc.Settings.Categories.get_Item(DB.BuiltInCategory.OST_Lines)<br>    return lines_cat.SubCategories<br>``` |

### `get_line_styles(doc=None)`

Retrieves the line styles from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to retrieve line styles from.<br>If None, the current document will be used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of GraphicsStyle objects representing the line styles in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2657<br>2658<br>2659<br>2660<br>2661<br>2662<br>2663<br>2664<br>2665<br>2666<br>2667<br>2668<br>2669<br>2670<br>2671<br>``` | ```md-code__content<br>def get_line_styles(doc=None):<br>    """<br>    Retrieves the line styles from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to retrieve line styles from.<br>                                  If None, the current document will be used.<br>    Returns:<br>        list: A list of GraphicsStyle objects representing the line styles in the document.<br>    """<br>    return [<br>        x.GetGraphicsStyle(DB.GraphicsStyleType.Projection)<br>        for x in get_line_categories(doc=doc)<br>    ]<br>``` |

### `get_history(target_element)`

Retrieves the worksharing history of a given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `target_element` | `Element` | The Revit element for which to retrieve the history. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `ElementHistory` |  | An object containing the creator, owner, and last changed by information of the element. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2674<br>2675<br>2676<br>2677<br>2678<br>2679<br>2680<br>2681<br>2682<br>2683<br>2684<br>2685<br>2686<br>2687<br>2688<br>2689<br>``` | ```md-code__content<br>def get_history(target_element):<br>    """<br>    Retrieves the worksharing history of a given Revit element.<br>    Args:<br>        target_element (DB.Element): The Revit element for which to retrieve the history.<br>    Returns:<br>        ElementHistory: An object containing the creator, owner, and last changed by information of the element.<br>    """<br>    doc = target_element.Document<br>    if doc.IsWorkshared:<br>        wti = DB.WorksharingUtils.GetWorksharingTooltipInfo(doc, target_element.Id)<br>        return ElementHistory(<br>            creator=wti.Creator, owner=wti.Owner, last_changed_by=wti.LastChangedBy<br>        )<br>``` |

### `is_detail_curve(element)`

Check if the given element is a detail curve.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` |  | The element to check. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the element is a detail curve, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2692<br>2693<br>2694<br>2695<br>2696<br>2697<br>2698<br>2699<br>2700<br>2701<br>2702<br>``` | ```md-code__content<br>def is_detail_curve(element):<br>    """<br>    Check if the given element is a detail curve.<br>    Args:<br>        element: The element to check.<br>    Returns:<br>        bool: True if the element is a detail curve, False otherwise.<br>    """<br>    return isinstance(element, DETAIL_CURVES)<br>``` |

### `is_model_curve(element)`

Check if the given element is a model curve.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` |  | The element to check. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the element is a model curve, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2705<br>2706<br>2707<br>2708<br>2709<br>2710<br>2711<br>2712<br>2713<br>2714<br>2715<br>``` | ```md-code__content<br>def is_model_curve(element):<br>    """<br>    Check if the given element is a model curve.<br>    Args:<br>        element: The element to check.<br>    Returns:<br>        bool: True if the element is a model curve, False otherwise.<br>    """<br>    return isinstance(element, MODEL_CURVES)<br>``` |

### `is_sketch_curve(element)`

Determines if the given Revit element is a sketch curve.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element to check. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the element is a sketch curve, False otherwise. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2718<br>2719<br>2720<br>2721<br>2722<br>2723<br>2724<br>2725<br>2726<br>2727<br>2728<br>2729<br>2730<br>``` | ```md-code__content<br>def is_sketch_curve(element):<br>    """<br>    Determines if the given Revit element is a sketch curve.<br>    Args:<br>        element (DB.Element): The Revit element to check.<br>    Returns:<br>        bool: True if the element is a sketch curve, False otherwise.<br>    """<br>    if element.Category:<br>        cid = element.Category.Id<br>        return cid == DB.ElementId(DB.BuiltInCategory.OST_SketchLines)<br>``` |

### `get_all_schemas()`

Retrieves all the schemas from the Extensible Storage in Revit.

Returns:

| Type | Description |
| --- | --- |
|  | IList\[Schema\]: A list of all schemas available in the Extensible Storage. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2733<br>2734<br>2735<br>2736<br>2737<br>2738<br>2739<br>2740<br>``` | ```md-code__content<br>def get_all_schemas():<br>    """<br>    Retrieves all the schemas from the Extensible Storage in Revit.<br>    Returns:<br>        IList[Schema]: A list of all schemas available in the Extensible Storage.<br>    """<br>    return DB.ExtensibleStorage.Schema.ListSchemas()<br>``` |

### `get_schema_field_values(element, schema)`

Retrieves the values of fields from a given schema for a specified Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element from which to retrieve the schema field values. | _required_ |
| `schema` | `Schema` | The schema that defines the fields to retrieve. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `dict` |  | A dictionary where the keys are field names and the values are the corresponding field values. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2743<br>2744<br>2745<br>2746<br>2747<br>2748<br>2749<br>2750<br>2751<br>2752<br>2753<br>2754<br>2755<br>2756<br>2757<br>2758<br>2759<br>2760<br>2761<br>2762<br>2763<br>2764<br>2765<br>2766<br>2767<br>2768<br>2769<br>2770<br>2771<br>``` | ```md-code__content<br>def get_schema_field_values(element, schema):<br>    """<br>    Retrieves the values of fields from a given schema for a specified Revit element.<br>    Args:<br>        element (DB.Element): The Revit element from which to retrieve the schema field values.<br>        schema (DB.ExtensibleStorage.Schema): The schema that defines the fields to retrieve.<br>    Returns:<br>        dict: A dictionary where the keys are field names and the values are the corresponding field values.<br>    """<br>    field_values = {}<br>    entity = element.GetEntity(schema)<br>    if entity:<br>        for field in schema.ListFields():<br>            field_type = field.ValueType<br>            if field.ContainerType == DB.ExtensibleStorage.ContainerType.Array:<br>                field_type = framework.IList[field.ValueType]<br>            elif field.ContainerType == DB.ExtensibleStorage.ContainerType.Map:<br>                field_type = framework.IDictionary[field.KeyType, field.ValueType]<br>            try:<br>                value = entity.Get[field_type](<br>                    field.FieldName, DB.DisplayUnitType.DUT_UNDEFINED<br>                )<br>            except:<br>                value = None<br>            field_values[field.FieldName] = value<br>    return field_values<br>``` |

### `get_family_type(type_name, family_doc)`

Retrieves a family type from a Revit family document by its name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `type_name` | `str` | The name of the family type to retrieve. | _required_ |
| `family_doc` | `Document` | The Revit family document to search in. If None, the default document (DOCS.doc) is used. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `FamilyType` |  | The family type with the specified name. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If the provided document is not a family document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2774<br>2775<br>2776<br>2777<br>2778<br>2779<br>2780<br>2781<br>2782<br>2783<br>2784<br>2785<br>2786<br>2787<br>2788<br>2789<br>2790<br>2791<br>2792<br>2793<br>2794<br>``` | ```md-code__content<br>def get_family_type(type_name, family_doc):<br>    """<br>    Retrieves a family type from a Revit family document by its name.<br>    Args:<br>        type_name (str): The name of the family type to retrieve.<br>        family_doc (Document): The Revit family document to search in. If None, the default document (DOCS.doc) is used.<br>    Returns:<br>        FamilyType: The family type with the specified name.<br>    Raises:<br>        PyRevitException: If the provided document is not a family document.<br>    """<br>    family_doc = family_doc or DOCS.doc<br>    if family_doc.IsFamilyDocument:<br>        for ftype in family_doc.FamilyManager.Types:<br>            if ftype.Name == type_name:<br>                return ftype<br>    else:<br>        raise PyRevitException("Document is not a family")<br>``` |

### `get_family_parameter(param_name, family_doc)`

Retrieves a family parameter from a Revit family document by its name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `param_name` | `str` | The name of the parameter to retrieve. | _required_ |
| `family_doc` | `Document` | The Revit family document to search in. If None, defaults to DOCS.doc. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `FamilyParameter` |  | The family parameter with the specified name. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If the provided document is not a family document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2797<br>2798<br>2799<br>2800<br>2801<br>2802<br>2803<br>2804<br>2805<br>2806<br>2807<br>2808<br>2809<br>2810<br>2811<br>2812<br>2813<br>2814<br>2815<br>2816<br>2817<br>``` | ```md-code__content<br>def get_family_parameter(param_name, family_doc):<br>    """<br>    Retrieves a family parameter from a Revit family document by its name.<br>    Args:<br>        param_name (str): The name of the parameter to retrieve.<br>        family_doc (Document): The Revit family document to search in. If None, defaults to DOCS.doc.<br>    Returns:<br>        FamilyParameter: The family parameter with the specified name.<br>    Raises:<br>        PyRevitException: If the provided document is not a family document.<br>    """<br>    family_doc = family_doc or DOCS.doc<br>    if family_doc.IsFamilyDocument:<br>        for fparam in family_doc.FamilyManager.GetParameters():<br>            if fparam.Definition.Name == param_name:<br>                return fparam<br>    else:<br>        raise PyRevitException("Document is not a family")<br>``` |

### `get_family_parameters(family_doc)`

Retrieves the parameters of a Revit family document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `family_doc` |  | The Revit family document from which to retrieve parameters.<br>If None, the default document (DOCS.doc) will be used. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | A collection of family parameters from the specified family document. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If the provided document is not a family document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2820<br>2821<br>2822<br>2823<br>2824<br>2825<br>2826<br>2827<br>2828<br>2829<br>2830<br>2831<br>2832<br>2833<br>2834<br>2835<br>2836<br>2837<br>2838<br>``` | ```md-code__content<br>def get_family_parameters(family_doc):<br>    """<br>    Retrieves the parameters of a Revit family document.<br>    Args:<br>        family_doc: The Revit family document from which to retrieve parameters.<br>                    If None, the default document (DOCS.doc) will be used.<br>    Returns:<br>        A collection of family parameters from the specified family document.<br>    Raises:<br>        PyRevitException: If the provided document is not a family document.<br>    """<br>    family_doc = family_doc or DOCS.doc<br>    if family_doc.IsFamilyDocument:<br>        return family_doc.FamilyManager.GetParameters()<br>    else:<br>        raise PyRevitException("Document is not a family")<br>``` |

### `get_family_label_parameters(family_doc)`

Retrieves the set of family label parameters from a given Revit family document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `family_doc` | `Document` | The Revit family document to retrieve label parameters from.<br>If None, the default document (DOCS.doc) is used. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `set` |  | A set of family label parameters (DB.FamilyParameter) found in the document. |

Raises:

| Type | Description |
| --- | --- |
| `PyRevitException` | If the provided document is not a family document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2841<br>2842<br>2843<br>2844<br>2845<br>2846<br>2847<br>2848<br>2849<br>2850<br>2851<br>2852<br>2853<br>2854<br>2855<br>2856<br>2857<br>2858<br>2859<br>2860<br>2861<br>2862<br>2863<br>2864<br>2865<br>2866<br>2867<br>2868<br>2869<br>2870<br>2871<br>2872<br>``` | ```md-code__content<br>def get_family_label_parameters(family_doc):<br>    """<br>    Retrieves the set of family label parameters from a given Revit family document.<br>    Args:<br>        family_doc (DB.Document): The Revit family document to retrieve label parameters from.<br>                                  If None, the default document (DOCS.doc) is used.<br>    Returns:<br>        set: A set of family label parameters (DB.FamilyParameter) found in the document.<br>    Raises:<br>        PyRevitException: If the provided document is not a family document.<br>    """<br>    family_doc = family_doc or DOCS.doc<br>    if family_doc.IsFamilyDocument:<br>        dims = (<br>            DB.FilteredElementCollector(family_doc)<br>            .OfClass(DB.Dimension)<br>            .WhereElementIsNotElementType()<br>        )<br>        label_params = set()<br>        for dim in dims:<br>            try:<br>                # throws exception when dimension can not be labeled<br>                if isinstance(dim.FamilyLabel, DB.FamilyParameter):<br>                    label_params.add(dim.FamilyLabel)<br>            except Exception:<br>                pass<br>        return label_params<br>    else:<br>        raise PyRevitException("Document is not a family")<br>``` |

### `get_door_rooms(door)`

Get from/to rooms associated with given door element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `door` | `FamilyInstance` | door instance | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `tuple` | `(Room, Room)` | from/to rooms |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2875<br>2876<br>2877<br>2878<br>2879<br>2880<br>2881<br>2882<br>2883<br>2884<br>2885<br>2886<br>2887<br>``` | ```md-code__content<br>def get_door_rooms(door):<br>    """Get from/to rooms associated with given door element.<br>    Args:<br>        door (DB.FamilyInstance): door instance<br>    Returns:<br>        tuple(DB.Architecture.Room, DB.Architecture.Room): from/to rooms<br>    """<br>    door_phase = door.Document.GetElement(door.CreatedPhaseId)<br>    return (door.FromRoom[door_phase], door.ToRoom[door_phase])<br>``` |

### `get_doors(elements=None, doc=None, room_id=None)`

Get all doors in active or given document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `elements` | `list[Element]` | find rooms in given elements instead | `None` |
| `doc` | `Document` | target document; default is active document | `None` |
| `room_id` | `ElementId` | only doors associated with given room | `None` |

Returns:

| Type | Description |
| --- | --- |
| `list[Element]` | room instances |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2890<br>2891<br>2892<br>2893<br>2894<br>2895<br>2896<br>2897<br>2898<br>2899<br>2900<br>2901<br>2902<br>2903<br>2904<br>2905<br>2906<br>2907<br>2908<br>2909<br>2910<br>2911<br>2912<br>2913<br>2914<br>2915<br>2916<br>2917<br>``` | ```md-code__content<br>def get_doors(elements=None, doc=None, room_id=None):<br>    """Get all doors in active or given document.<br>    Args:<br>        elements (list[DB.Element]): find rooms in given elements instead<br>        doc (DB.Document): target document; default is active document<br>        room_id (DB.ElementId): only doors associated with given room<br>    Returns:<br>        (list[DB.Element]): room instances<br>    """<br>    doc = doc or DOCS.doc<br>    all_doors = get_elements_by_categories(<br>        [DB.BuiltInCategory.OST_Doors], elements=elements, doc=doc<br>    )<br>    if room_id:<br>        room_doors = []<br>        for door in all_doors:<br>            from_room, to_room = get_door_rooms(door)<br>            if (from_room and from_room.Id == room_id) or (<br>                to_room and to_room.Id == room_id<br>            ):<br>                room_doors.append(door)<br>        return room_doors<br>    else:<br>        return list(all_doors)<br>``` |

### `get_all_print_settings(doc=None)`

Retrieves all print settings from the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document from which to retrieve print settings.<br>If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of print settings elements from the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2920<br>2921<br>2922<br>2923<br>2924<br>2925<br>2926<br>2927<br>2928<br>2929<br>2930<br>2931<br>2932<br>``` | ```md-code__content<br>def get_all_print_settings(doc=None):<br>    """<br>    Retrieves all print settings from the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document from which to retrieve print settings.<br>                                  If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of print settings elements from the document.<br>    """<br>    doc = doc or DOCS.doc<br>    return [doc.GetElement(x) for x in doc.GetPrintSettingIds()]<br>``` |

### `get_used_paper_sizes(doc=None)`

Retrieves a list of used paper sizes from the print settings in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` | `Document` | The Revit document to query. If not provided, defaults to DOCS.doc. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of paper sizes used in the print settings of the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2935<br>2936<br>2937<br>2938<br>2939<br>2940<br>2941<br>2942<br>2943<br>2944<br>2945<br>2946<br>``` | ```md-code__content<br>def get_used_paper_sizes(doc=None):<br>    """<br>    Retrieves a list of used paper sizes from the print settings in the given Revit document.<br>    Args:<br>        doc (Document, optional): The Revit document to query. If not provided, defaults to DOCS.doc.<br>    Returns:<br>        list: A list of paper sizes used in the print settings of the document.<br>    """<br>    doc = doc or DOCS.doc<br>    return [x.PrintParameters.PaperSize for x in get_all_print_settings(doc=doc)]<br>``` |

### `find_paper_size_by_name(paper_size_name, doc=None)`

Finds and returns a paper size object by its name.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `paper_size_name` | `str` | The name of the paper size to find. | _required_ |
| `doc` | `Document` | The Revit document to search in. If not provided,<br>the default document (DOCS.doc) will be used. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `PaperSize` |  | The paper size object that matches the given name, or None if not found. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2949<br>2950<br>2951<br>2952<br>2953<br>2954<br>2955<br>2956<br>2957<br>2958<br>2959<br>2960<br>2961<br>2962<br>2963<br>2964<br>2965<br>``` | ```md-code__content<br>def find_paper_size_by_name(paper_size_name, doc=None):<br>    """<br>    Finds and returns a paper size object by its name.<br>    Args:<br>        paper_size_name (str): The name of the paper size to find.<br>        doc (Document, optional): The Revit document to search in. If not provided,<br>                                  the default document (DOCS.doc) will be used.<br>    Returns:<br>        PaperSize: The paper size object that matches the given name, or None if not found.<br>    """<br>    doc = doc or DOCS.doc<br>    paper_size_name = paper_size_name.lower()<br>    for psize in doc.PrintManager.PaperSizes:<br>        if psize.Name.lower() == paper_size_name:<br>            return psize<br>``` |

### `find_paper_sizes_by_dims(printer_name, paper_width, paper_height, doc=None)`

Finds paper sizes by dimensions for a given printer.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `printer_name` | `str` | The name of the printer. | _required_ |
| `paper_width` | `float` | The width of the paper in inches. | _required_ |
| `paper_height` | `float` | The height of the paper in inches. | _required_ |
| `doc` | `optional` | The document context. Defaults to None. | `None` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of matching paper sizes. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>2968<br>2969<br>2970<br>2971<br>2972<br>2973<br>2974<br>2975<br>2976<br>2977<br>2978<br>2979<br>2980<br>2981<br>2982<br>2983<br>2984<br>2985<br>2986<br>2987<br>2988<br>2989<br>2990<br>2991<br>2992<br>2993<br>2994<br>2995<br>2996<br>2997<br>2998<br>2999<br>3000<br>3001<br>3002<br>3003<br>3004<br>3005<br>3006<br>3007<br>3008<br>``` | ```md-code__content<br>def find_paper_sizes_by_dims(printer_name, paper_width, paper_height, doc=None):<br>    """<br>    Finds paper sizes by dimensions for a given printer.<br>    Args:<br>        printer_name (str): The name of the printer.<br>        paper_width (float): The width of the paper in inches.<br>        paper_height (float): The height of the paper in inches.<br>        doc (optional): The document context. Defaults to None.<br>    Returns:<br>        list: A list of matching paper sizes.<br>    """<br>    doc = doc or DOCS.doc<br>    paper_sizes = []<br>    system_paper_sizes = coreutils.get_paper_sizes(printer_name)<br>    mlogger.debug("looking for paper size W:%s H:%s", paper_width, paper_height)<br>    mlogger.debug(<br>        "system paper sizes: %s -> %s",<br>        printer_name,<br>        [x.PaperName for x in system_paper_sizes],<br>    )<br>    for sys_psize in system_paper_sizes:<br>        sys_pname = sys_psize.PaperName<br>        sys_pwidth = int(sys_psize.Width / 100.00)<br>        sys_pheight = int(sys_psize.Height / 100.00)<br>        wxd = paper_width == sys_pwidth and paper_height == sys_pheight<br>        dxw = paper_width == sys_pheight and paper_height == sys_pwidth<br>        mlogger.debug(<br>            '%s "%s" W:%s H:%s',<br>            "✓" if wxd or dxw else " ",<br>            sys_pname,<br>            sys_pwidth,<br>            sys_pheight,<br>        )<br>        if wxd or dxw:<br>            psize = find_paper_size_by_name(sys_pname)<br>            if psize:<br>                paper_sizes.append(psize)<br>                mlogger.debug("found matching paper: %s", psize.Name)<br>    return paper_sizes<br>``` |

### `get_titleblock_print_settings(tblock, printer_name, doc_psettings)`

Retrieves the print settings for a given title block that match the specified printer and document print settings.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `tblock` | `FamilyInstance` | The title block instance. | _required_ |
| `printer_name` | `str` | The name of the printer. | _required_ |
| `doc_psettings` | `list[PrintSetting]` | A list of document print settings. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | list\[DB.PrintSetting\]: A sorted list of print settings that match the title block size and orientation. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>3011<br>3012<br>3013<br>3014<br>3015<br>3016<br>3017<br>3018<br>3019<br>3020<br>3021<br>3022<br>3023<br>3024<br>3025<br>3026<br>3027<br>3028<br>3029<br>3030<br>3031<br>3032<br>3033<br>3034<br>3035<br>3036<br>3037<br>3038<br>3039<br>3040<br>3041<br>3042<br>3043<br>3044<br>3045<br>3046<br>3047<br>3048<br>3049<br>3050<br>3051<br>3052<br>``` | ```md-code__content<br>def get_titleblock_print_settings(tblock, printer_name, doc_psettings):<br>    """<br>    Retrieves the print settings for a given title block that match the specified printer and document print settings.<br>    Args:<br>        tblock (DB.FamilyInstance): The title block instance.<br>        printer_name (str): The name of the printer.<br>        doc_psettings (list[DB.PrintSetting]): A list of document print settings.<br>    Returns:<br>        list[DB.PrintSetting]: A sorted list of print settings that match the title block size and orientation.<br>    """<br>    doc = tblock.Document<br>    page_width_param = tblock.Parameter[DB.BuiltInParameter.SHEET_WIDTH]<br>    page_height_param = tblock.Parameter[DB.BuiltInParameter.SHEET_HEIGHT]<br>    page_width = int(round(page_width_param.AsDouble() * 12.0))<br>    page_height = int(round(page_height_param.AsDouble() * 12.0))<br>    tform = tblock.GetTotalTransform()<br>    is_portrait = (page_width < page_height) or (int(tform.BasisX.Y) == -1)<br>    paper_sizes = find_paper_sizes_by_dims(<br>        printer_name, page_width, page_height, doc=doc<br>    )<br>    paper_size_names = [x.Name for x in paper_sizes]<br>    page_orient = (<br>        DB.PageOrientationType.Portrait<br>        if is_portrait<br>        else DB.PageOrientationType.Landscape<br>    )<br>    all_tblock_psettings = set()<br>    for doc_psetting in doc_psettings:<br>        try:<br>            pparams = doc_psetting.PrintParameters<br>            if (<br>                pparams.PaperSize<br>                and pparams.PaperSize.Name in paper_size_names<br>                and (pparams.ZoomType == DB.ZoomType.Zoom and pparams.Zoom == 100)<br>                and pparams.PageOrientation == page_orient<br>            ):<br>                all_tblock_psettings.add(doc_psetting)<br>        except Exception:<br>            mlogger.debug("incompatible psettings: %s", doc_psetting.Name)<br>    return sorted(all_tblock_psettings, key=lambda x: x.Name)<br>``` |

### `get_crop_region(view)`

Takes crop region of a view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | view to get crop region from | _required_ |

Returns:

| Type | Description |
| --- | --- |
| `list[CurveLoop]` | list of curve loops |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>3055<br>3056<br>3057<br>3058<br>3059<br>3060<br>3061<br>3062<br>3063<br>3064<br>3065<br>3066<br>3067<br>3068<br>3069<br>3070<br>3071<br>3072<br>3073<br>3074<br>3075<br>3076<br>3077<br>``` | ```md-code__content<br>def get_crop_region(view):<br>    """Takes crop region of a view.<br>    Args:<br>        view (DB.View): view to get crop region from<br>    Returns:<br>        (list[DB.CurveLoop]): list of curve loops<br>    """<br>    crsm = view.GetCropRegionShapeManager()<br>    if HOST_APP.is_newer_than(2015):<br>        crsm_valid = crsm.CanHaveShape<br>    else:<br>        crsm_valid = crsm.Valid<br>    if crsm_valid:<br>        if HOST_APP.is_newer_than(2015):<br>            curve_loops = list(crsm.GetCropShape())<br>        else:<br>            curve_loops = [crsm.GetCropRegionShape()]<br>        if curve_loops:<br>            return curve_loops<br>``` |

### `is_cropable_view(view)`

Determines if a given Revit view can be cropped.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view to check. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `bool` |  | True if the view can be cropped, False otherwise. |

Notes

A view is considered cropable if it is not an instance of DB.ViewSheet or DB.TableView,
and its ViewType is not Legend or DraftingView.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>3080<br>3081<br>3082<br>3083<br>3084<br>3085<br>3086<br>3087<br>3088<br>3089<br>3090<br>3091<br>3092<br>3093<br>3094<br>3095<br>3096<br>3097<br>``` | ```md-code__content<br>def is_cropable_view(view):<br>    """<br>    Determines if a given Revit view can be cropped.<br>    Args:<br>        view (DB.View): The Revit view to check.<br>    Returns:<br>        bool: True if the view can be cropped, False otherwise.<br>    Notes:<br>        A view is considered cropable if it is not an instance of DB.ViewSheet or DB.TableView,<br>        and its ViewType is not Legend or DraftingView.<br>    """<br>    return not isinstance(view, (DB.ViewSheet, DB.TableView)) and view.ViewType not in (<br>        DB.ViewType.Legend,<br>        DB.ViewType.DraftingView,<br>    )<br>``` |

### `get_view_filters(view)`

Retrieves the filters applied to a given Revit view.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `view` | `View` | The Revit view from which to retrieve the filters. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | list\[Autodesk.Revit.DB.Element\]: A list of filter elements applied to the view. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>3100<br>3101<br>3102<br>3103<br>3104<br>3105<br>3106<br>3107<br>3108<br>3109<br>3110<br>3111<br>3112<br>3113<br>3114<br>``` | ```md-code__content<br>def get_view_filters(view):<br>    """<br>    Retrieves the filters applied to a given Revit view.<br>    Args:<br>        view (Autodesk.Revit.DB.View): The Revit view from which to retrieve the filters.<br>    Returns:<br>        list[Autodesk.Revit.DB.Element]: A list of filter elements applied to the view.<br>    """<br>    view_filters = []<br>    for filter_id in view.GetFilters():<br>        filter_element = view.Document.GetElement(filter_id)<br>        view_filters.append(filter_element)<br>    return view_filters<br>``` |

### `get_element_workset(element)`

Retrieves the workset of a given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element for which to retrieve the workset. | _required_ |

Returns:

| Type | Description |
| --- | --- |
|  | DB.Workset: The workset to which the element belongs, or None if the element's workset ID is invalid. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>3117<br>3118<br>3119<br>3120<br>3121<br>3122<br>3123<br>3124<br>3125<br>3126<br>3127<br>3128<br>3129<br>3130<br>``` | ```md-code__content<br>def get_element_workset(element):<br>    """<br>    Retrieves the workset of a given Revit element.<br>    Args:<br>        element (DB.Element): The Revit element for which to retrieve the workset.<br>    Returns:<br>        DB.Workset: The workset to which the element belongs, or None if the element's workset ID is invalid.<br>    """<br>    doc = element.Document<br>    workset_table = doc.GetWorksetTable()<br>    if element.WorksetId != DB.WorksetId.InvalidWorksetId:<br>        return workset_table.GetWorkset(element.WorksetId)<br>``` |

### `get_geometry(element, include_invisible=False, compute_references=False)`

Retrieves the geometry of a given Revit element.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `element` | `Element` | The Revit element from which to retrieve geometry. | _required_ |
| `include_invisible` | `bool` | If True, includes non-visible objects in the geometry. Defaults to False. | `False` |
| `compute_references` | `bool` | If True, computes references for the geometry objects. Defaults to False. | `False` |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of geometry objects associated with the element. If the element has no geometry, returns None. |

Raises:

| Type | Description |
| --- | --- |
| `TypeError` | If the element's geometry cannot be retrieved. |

Notes

- If the geometry object is an instance of DB.GeometryInstance, its instance geometry is retrieved and added to the list.
- Logs a debug message if the element has no geometry.

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>3133<br>3134<br>3135<br>3136<br>3137<br>3138<br>3139<br>3140<br>3141<br>3142<br>3143<br>3144<br>3145<br>3146<br>3147<br>3148<br>3149<br>3150<br>3151<br>3152<br>3153<br>3154<br>3155<br>3156<br>3157<br>3158<br>3159<br>3160<br>3161<br>3162<br>3163<br>3164<br>3165<br>3166<br>3167<br>``` | ```md-code__content<br>def get_geometry(element, include_invisible=False, compute_references=False):<br>    """<br>    Retrieves the geometry of a given Revit element.<br>    Args:<br>        element (DB.Element): The Revit element from which to retrieve geometry.<br>        include_invisible (bool, optional): If True, includes non-visible objects in the geometry. Defaults to False.<br>        compute_references (bool, optional): If True, computes references for the geometry objects. Defaults to False.<br>    Returns:<br>        list: A list of geometry objects associated with the element. If the element has no geometry, returns None.<br>    Raises:<br>        TypeError: If the element's geometry cannot be retrieved.<br>    Notes:<br>        - If the geometry object is an instance of DB.GeometryInstance, its instance geometry is retrieved and added to the list.<br>        - Logs a debug message if the element has no geometry.<br>    """<br>    geom_opts = DB.Options()<br>    geom_opts.IncludeNonVisibleObjects = include_invisible<br>    geom_opts.ComputeReferences = compute_references<br>    geom_objs = []<br>    try:<br>        for gobj in element.Geometry[geom_opts]:<br>            if isinstance(gobj, DB.GeometryInstance):<br>                inst_geom = gobj.GetInstanceGeometry()<br>                geom_objs.extend(list(inst_geom))<br>            else:<br>                geom_objs.append(gobj)<br>        return geom_objs<br>    except TypeError:<br>        get_elementid_value = get_elementid_value_func()<br>        mlogger.debug("element %s has no geometry", get_elementid_value(element.Id))<br>        return<br>``` |

### `get_array_group_ids(doc=None)`

Collects and returns the IDs of all array groups in the given document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `document` | `Document` | The Revit document to search for array groups. | _required_ |

Returns:

| Name | Type | Description |
| --- | --- | --- |
| `list` |  | A list of element IDs representing the array groups. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>3170<br>3171<br>3172<br>3173<br>3174<br>3175<br>3176<br>3177<br>3178<br>3179<br>3180<br>3181<br>3182<br>3183<br>3184<br>3185<br>3186<br>3187<br>``` | ```md-code__content<br>def get_array_group_ids(doc=None):<br>    """<br>    Collects and returns the IDs of all array groups in the given document.<br>    Args:<br>        document (DB.Document): The Revit document to search for array groups.<br>    Returns:<br>        list: A list of element IDs representing the array groups.<br>    """<br>    array_list = DB.FilteredElementCollector(doc or DOCS.doc).OfCategory(<br>        DB.BuiltInCategory.OST_IOSArrays<br>    )<br>    arrays_groups = []<br>    for ar in array_list:<br>        arrays_groups.extend(ar.GetOriginalMemberIds())<br>        arrays_groups.extend(ar.GetCopiedMemberIds())<br>    return set(arrays_groups)<br>``` |

### `get_array_group_ids_types(doc=None)`

Retrieves the unique types of array groups in the given Revit document.

Parameters:

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `doc` |  | The Revit document from which to collect array group types. | `None` |

Returns:

| Type | Description |
| --- | --- |
|  | A set of unique array group type IDs present in the document. |

Source code in `pyrevitlib/pyrevit/revit/db/query.py`

|     |     |
| --- | --- |
| ```<br>3190<br>3191<br>3192<br>3193<br>3194<br>3195<br>3196<br>3197<br>3198<br>3199<br>3200<br>3201<br>``` | ```md-code__content<br>def get_array_group_ids_types(doc=None):<br>    """<br>    Retrieves the unique types of array groups in the given Revit document.<br>    Args:<br>        doc: The Revit document from which to collect array group types.<br>    Returns:<br>        A set of unique array group type IDs present in the document.<br>    """<br>    arrays_groups = get_array_group_ids(doc or DOCS.doc)<br>    return {doc.GetElement(ar).GetTypeId() for ar in arrays_groups}<br>``` |

Back to top

